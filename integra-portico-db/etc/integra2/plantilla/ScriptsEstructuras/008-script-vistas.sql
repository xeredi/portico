/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- SIN_V_TC_LOGEVENTOSAIS  (View)
--

CREATE OR REPLACE FORCE VIEW SIN_V_TC_LOGEVENTOSAIS
(
   IDLOG,
   CODPUE,
   ESCALA,
   BARCO,
   CODTIPOBUQUEAIS,
   TIPOBUQUEAIS,
   IMOAIS,
   MMSI,
   ESLORA,
   MANGA,
   CODTIPOEVENTO,
   TIPOEVENTO,
   IDZONA,
   ZONAMUELLE,
   DISTLLAMADA,
   VELOCIDAD,
   LONGITUD,
   LATITUD,
   RUMBO,
   DESTINOAIS,
   FECHAHORA
)
AS
   SELECT 1,
          'P',
          'a',
          'b',
          1,
          'tipo buque',
          2,
          3,
          4,
          5,
          6,
          'tipoevento',
          'c',
          'd',
          'e ',
          7,
          8,
          9,
          10,
          ' ',
          SYSDATE
     FROM DUAL;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_BUQ_RORO_BAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_BUQ_RORO_BAL
(
   CODBUQUE,
   NOMBRE,
   CODTIPOBUQUE,
   CODIMO,
   BANDERA,
   CALLSIGN,
   CODARMADOR,
   CODPAIREGISTRO,
   CODPUEREGISTRO,
   SOCCLASIFICACION,
   CIAASEGURADORA,
   CLUBPI,
   FECCONSTRUCCION,
   CALMAXIMO,
   GT,
   TPM,
   TRB,
   ESLORATOTAL,
   MANGA,
   PUNTAL,
   ALTURAARBOLADURA,
   POTENCIA,
   VELCRUCERO,
   VELMAXIMA,
   INDDOBLECASCO,
   SBTVOLUMEN,
   SBTUNIDADES,
   RAMPA1SITUACION,
   RAMPA1ALCANCE,
   RAMPA1ANCHURA,
   RAMPA2SITUACION,
   RAMPA2ALCANCE,
   RAMPA2ANCHURA,
   RAMPA3SITUACION,
   RAMPA3ALCANCE,
   RAMPA3ANCHURA,
   RAMPA4SITUACION,
   RAMPA4ALCANCE,
   RAMPA4ANCHURA,
   NUMHELICES,
   SITUACIONHELICES,
   LASTRESUCIO,
   TANFANGOS,
   TANAGUASOLEOSAS,
   AGUASSUCIAS,
   BASURAS,
   INDCERTARQ,
   FECEMICERTARQ,
   LIBROREGISTRO,
   INDINSPMOU,
   CODPAIINSPMOU,
   CODPUEINSPMOU,
   FECINSPMOU,
   NUMDEFINSPMOU,
   CODPAIMATRICULA,
   CODPUEMATRICULA,
   FECMATRICULA,
   MATRICULA,
   INDCERTIGS,
   FECVIGCERTIGS,
   NUMREGCERTIGS,
   CODMMSI,
   OBSERVACIONES,
   FECALTA,
   FECMODIF,
   USRALTA,
   USRMODIF,
   INDCERTMATRICULA,
   CODLLOYDS,
   CODTIPOPRESTACION,
   CODPUEBASE,
   IDNAVIERA,
   INDAPLIC195,
   INDTERCEROSPAISES,
   IDAPLICANTERIOR,
   INDPDTEREV
)
AS
   SELECT M_BUQUE.CODBUQUE,
          "NOMBRE",
          "CODTIPOBUQUE",
          "CODIMO",
          "BANDERA",
          "CALLSIGN",
          "CODARMADOR",
          "CODPAIREGISTRO",
          "CODPUEREGISTRO",
          "SOCCLASIFICACION",
          "CIAASEGURADORA",
          "CLUBPI",
          "FECCONSTRUCCION",
          "CALMAXIMO",
          "GT",
          "TPM",
          "TRB",
          "ESLORATOTAL",
          "MANGA",
          "PUNTAL",
          "ALTURAARBOLADURA",
          "POTENCIA",
          "VELCRUCERO",
          "VELMAXIMA",
          "INDDOBLECASCO",
          "SBTVOLUMEN",
          "SBTUNIDADES",
          "RAMPA1SITUACION",
          "RAMPA1ALCANCE",
          "RAMPA1ANCHURA",
          "RAMPA2SITUACION",
          "RAMPA2ALCANCE",
          "RAMPA2ANCHURA",
          "RAMPA3SITUACION",
          "RAMPA3ALCANCE",
          "RAMPA3ANCHURA",
          "RAMPA4SITUACION",
          "RAMPA4ALCANCE",
          "RAMPA4ANCHURA",
          "NUMHELICES",
          "SITUACIONHELICES",
          "LASTRESUCIO",
          "TANFANGOS",
          "TANAGUASOLEOSAS",
          "AGUASSUCIAS",
          "BASURAS",
          "INDCERTARQ",
          "FECEMICERTARQ",
          "LIBROREGISTRO",
          "INDINSPMOU",
          "CODPAIINSPMOU",
          "CODPUEINSPMOU",
          "FECINSPMOU",
          "NUMDEFINSPMOU",
          "CODPAIMATRICULA",
          "CODPUEMATRICULA",
          "FECMATRICULA",
          "MATRICULA",
          "INDCERTIGS",
          "FECVIGCERTIGS",
          "NUMREGCERTIGS",
          "CODMMSI",
          "OBSERVACIONES",
          M_BUQUE.FECALTA,
          M_BUQUE.FECMODIF,
          M_BUQUE.USRALTA,
          M_BUQUE.USRMODIF,
          "INDCERTMATRICULA",
          "CODLLOYDS",
          "CODTIPOPRESTACION",
          "CODPUEBASE",
          "IDNAVIERA",
          "INDAPLIC195",
          "INDTERCEROSPAISES",
          "IDAPLICANTERIOR",
          "INDPDTEREV"
     FROM    M_BUQUE
          LEFT JOIN
             M_BUQUEVERSION BV
          ON (BV.CODBUQUE = M_BUQUE.CODBUQUE AND BV.FECFINVIG IS NULL)
    WHERE CODTIPOBUQUE IN ('UA', 'UB', 'RM', 'RC', 'RB');


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_G3CABECERAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_G3CABECERAS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   INDRECIBCOARRI,
   CODUSUARIO,
   PUERTOUSUARIO,
   CIF,
   NOMBRECOMPLETO,
   NUMESCALA,
   TIPODECLARACION,
   NUMDECLARACION
)
AS
   SELECT CAB.CODPUE,
          CAB.anyo,
          CAB.CODSER,
          TRA.CODTRAMO,
          CAB.INDRECIBCOARRI,
          TRA.IDCONSIGNATARIO,
          UP.CODPUE,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          CAB.NUMESCALA,
          CAB.TIPODECLARACION,
          CAB.NUMDECLARACION
     FROM G3_CABECERA CAB
          LEFT JOIN G3_TRAMO TRA
             ON     TRA.codpue = CAB.CODPUE
                AND TRA.ANYO = CAB.ANYO
                AND TRA.CODSER = CAB.CODSER
          LEFT JOIN M_USUARIO U
             ON U.CODUSUARIO = TRA.IDCONSIGNATARIO
          LEFT JOIN M_USUARIO_PUERTO UP
             ON UP.CODUSUARIO = U.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_G3EQUIPAMIENTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_G3EQUIPAMIENTOS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   CODEQUIP,
   CODTIPOEQUIP,
   CODTIPOTAMANYO,
   CODESTADO,
   TARA,
   UNIDADESVACIOS,
   NUMBULTOS,
   CODPAI1,
   CODPUE1,
   CODPAI3,
   CODPUE3,
   CODTIPOCN,
   CODTIPOTRANSPORTE,
   PUERTOORIGEN,
   PUERTODESTINO,
   INDCANARIASORIGEN,
   INDCANARIASDESTINO
)
AS
   SELECT EQUIP.CODPUE,
          EQUIP.anyo,
          EQUIP.CODSER,
          EQUIP.CODTRAMO,
          EQUIP.NUMORDEN,
          EQUIP.TIPOCONOC,
          EQUIP.CODEQUIP,
          EQUIP.CODTIPOEQUIP,
          EQUIP.CODTIPOTAMANYO,
          EQUIP.CODESTADO,
          EQUIP.TARA,
          EQUIP.UNIDADESVACIOS,
          EQUIP.NUMBULTOS,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI3,
          CON.CODPUE3,
          EQUIP.CODTIPOCN,
          CON.CODTIPTRANSPORTE,
          P1.CODPUE,
          P2.CODPUE,
          P3.INDCANARIAS,
          P4.INDCANARIAS
     FROM G3_EQUIPAMIENTO EQUIP
          LEFT JOIN G3_CONOCIMIENTO CON
             ON     CON.codpue = EQUIP.CODPUE
                AND CON.ANYO = EQUIP.ANYO
                AND CON.CODSER = EQUIP.CODSER
                AND CON.CODTRAMO = EQUIP.CODTRAMO
                AND CON.NUMORDEN = EQUIP.NUMORDEN
                AND CON.TIPOCONOC = EQUIP.TIPOCONOC
          LEFT JOIN M_PUERTO_LOCAL P1
             ON P1.CODPAILOCODE = CON.CODPAI1
                AND P1.CODPUELOCODE = CON.CODPUE1
          LEFT JOIN M_PUERTO_LOCAL P2
             ON P2.CODPAILOCODE = CON.CODPAI3
                AND P2.CODPUELOCODE = CON.CODPUE3
          LEFT JOIN M_PUERTO P3
             ON P3.CODPAIS = CON.CODPAI1 AND P3.CODPUE = CON.CODPUE1
          LEFT JOIN M_PUERTO P4
             ON P4.CODPAIS = CON.CODPAI3 AND P4.CODPUE = CON.CODPUE3
    WHERE EQUIP.INDBAJA IS NULL OR EQUIP.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_G3EXCEPCIONESCN  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_G3EXCEPCIONESCN
(
   CODTIPOTAMEQUIP,
   CODTIPOCN
)
AS
   SELECT G3_EXCEPCIONCN.CODTIPOTAMEQUIP, G3_EXCEPCIONCN.CODTIPOCN
     FROM G3_EXCEPCIONCN;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_G3PARTIDA  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_G3PARTIDA
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   NUMPARTIDA,
   CODARAN,
   NUMDOCADUANERO,
   CODGRUPO,
   CODPAI1,
   CODPUE1,
   CODPAI3,
   CODPUE3,
   SITADUANERA,
   CODTIPOTRANSPORTE,
   PUERTOORIGEN,
   PUERTODESTINO,
   TIPODECLARACION,
   PESO
)
AS
   SELECT PAR.CODPUE,
          PAR.ANYO,
          PAR.CODSER,
          PAR.CODTRAMO,
          PAR.NUMORDEN,
          PAR.TIPOCONOC,
          PAR.NUMPARTIDA,
          PAR.CODARAN,
          '',
          MER.CODGRUPO,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI3,
          CON.CODPUE3,
          PAR.SITADUANERA,
          CON.CODTIPTRANSPORTE,
          P1.CODPUE,
          P2.CODPUE,
          C.TIPODECLARACION,
          PAR.PESO
     FROM G3_PARTIDA PAR
          LEFT JOIN G3_CONOCIMIENTO CON
             ON     CON.CODPUE = PAR.CODPUE
                AND CON.ANYO = PAR.ANYO
                AND CON.CODSER = PAR.CODSER
                AND CON.CODTRAMO = PAR.CODTRAMO
                AND CON.NUMORDEN = PAR.NUMORDEN
                AND CON.TIPOCONOC = PAR.TIPOCONOC
          LEFT JOIN M_MERCANCIA MER
             ON MER.CODARAN = PAR.CODARAN AND MER.VERSION = PAR.VERCODARAN
          LEFT JOIN M_PUERTO_LOCAL P1
             ON P1.CODPAILOCODE = CON.CODPAI1
                AND P1.CODPUELOCODE = CON.CODPUE1
          LEFT JOIN M_PUERTO_LOCAL P2
             ON P2.CODPAILOCODE = CON.CODPAI3
                AND P2.CODPUELOCODE = CON.CODPUE3
          INNER JOIN G3_CABECERA C
             ON     C.CODPUE = PAR.CODPUE
                AND C.ANYO = PAR.ANYO
                AND C.CODSER = PAR.CODSER
    WHERE PAR.INDBAJA IS NULL OR PAR.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_MERCANCIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_MERCANCIAS
(
   CODARAN,
   DESCRIPCION,
   CODGRUPO
)
AS
   SELECT MER.CODARAN, MER.DESCRIPCION, MER.CODGRUPO
     FROM    M_MERCANCIA MER
          LEFT JOIN
             G3_GRUPOMERCANCIA GRUP
          ON GRUP.CODIGO = MER.CODGRUPO;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_AUX_CONT_USUARIOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_AUX_CONT_USUARIOS
(
   CODUSUARIO,
   CODAPSCT,
   NOMBRECOMPLETO,
   PUERTOUSUARIO,
   CIF
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF
     FROM    M_USUARIO
          LEFT JOIN
             M_USUARIO_PUERTO
          ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_BORRADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_BORRADORES
(
   NOMBRE,
   CODPUE,
   ANYO,
   CODBORRADOR,
   FECLIQ,
   CONCEPTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   NUMESCALA,
   IDPROCESO,
   FECINISER,
   FECFINSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   CODEXPEDRDIRECTA,
   CODEXPEDRINDIRECTA,
   CODPESCALITORAL,
   CODPUEDP,
   CODDP,
   CODEXPAGUAINSTFIJA,
   CODEXPAGUANODP,
   CODAGUAEDR,
   CODEMBDEPBASENOAP,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   CODESTADO,
   ESTADO
)
AS
   SELECT M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          CASE
             WHEN DIVERSO_GENERICO.GUIDSRV IS NOT NULL
             THEN
                DIVERSO_GENERICO.GUIDSRV
             WHEN B4_MANIFIESTO.GUIDSRV IS NOT NULL
             THEN
                B4_MANIFIESTO.GUIDSRV
             WHEN OCUPSUP_RODANTE.GUIDSRV IS NOT NULL
             THEN
                OCUPSUP_RODANTE.GUIDSRV
             WHEN T8_SUMINBUQUE.GUIDSRV IS NOT NULL
             THEN
                T8_SUMINBUQUE.GUIDSRV
             WHEN G3_TRAMO.GUIDSRV IS NOT NULL
             THEN
                G3_TRAMO.GUIDSRV
             WHEN TM_SERVICIO.GUIDSRV IS NOT NULL
             THEN
                TM_SERVICIO.GUIDSRV
             WHEN G5_TRANSITO.GUIDSRV IS NOT NULL
             THEN
                G5_TRANSITO.GUIDSRV
             WHEN LQ_BORRADORAGRUPADO.GUIDSRVASOCIADO IS NOT NULL
             THEN
                LQ_BORRADORAGRUPADO.GUIDSRVASOCIADO
             ELSE
                LQ_BORRADOR.GUIDSRV
          END,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDPROCESO,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.CODESTADIA,
          LQ_BORRADOR.CODEXPEDRDIRECTA,
          LQ_BORRADOR.CODEXPEDRINDIRECTA,
          LQ_BORRADOR.CODPESCALITORAL,
          LQ_BORRADOR.CODPUEDP,
          LQ_BORRADOR.CODDP,
          LQ_BORRADOR.CODEXPAGUAINSTFIJA,
          LQ_BORRADOR.CODEXPAGUANODP,
          LQ_BORRADOR.CODAGUAEDR,
          LQ_BORRADOR.CODEMBDEPBASENOAP,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_BORRADOR.CODESTADO,
          LQ_ESTADOBORRADOR.DESCRIPCION
     FROM LQ_BORRADOR
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO)
          LEFT JOIN LQ_BORRADORAGRUPADO
             ON (LQ_BORRADORAGRUPADO.CODPUEBORRADOR = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOBORRADOR = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORAGRUPADO.CODBORRADOR =
                        LQ_BORRADOR.CODBORRADOR)
          LEFT JOIN DIVERSO_GENERICO
             ON (LQ_BORRADORAGRUPADO.CODSERVDIVERSO = DIVERSO_GENERICO.CODIGO)
          LEFT JOIN B4_MANIFIESTO
             ON (LQ_BORRADORAGRUPADO.CODPUEMANIFPESCA = B4_MANIFIESTO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOMANIFPESCA = B4_MANIFIESTO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODMANIFPESCA =
                        B4_MANIFIESTO.CODMANIF)
          LEFT JOIN OCUPSUP_RODANTE
             ON (LQ_BORRADORAGRUPADO.CODPUEOCUPSUPRODANTE =
                    OCUPSUP_RODANTE.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOOCUPSUPRODANTE =
                        OCUPSUP_RODANTE.ANYO
                 AND LQ_BORRADORAGRUPADO.CODSEROCUPSUPRODANTE =
                        OCUPSUP_RODANTE.CODSER)
          LEFT JOIN T8_SUMINBUQUE
             ON (LQ_BORRADORAGRUPADO.CODPUESUMINBUQUE = T8_SUMINBUQUE.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOSUMINBUQUE = T8_SUMINBUQUE.ANYO
                 AND LQ_BORRADORAGRUPADO.CODSUMINBUQUE = T8_SUMINBUQUE.CODIGO)
          LEFT JOIN G3_TRAMO
             ON (    LQ_BORRADORAGRUPADO.CODPUEMERC = G3_TRAMO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOMERC = G3_TRAMO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODMERC = G3_TRAMO.CODSER
                 AND LQ_BORRADORAGRUPADO.CODTRAMOMERC = G3_TRAMO.CODTRAMO)
          LEFT JOIN TM_SERVICIO
             ON (LQ_BORRADORAGRUPADO.CODPUETMSERVICIO = TM_SERVICIO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOTMSERVICIO = TM_SERVICIO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODIGOTMSERVICIO =
                        TM_SERVICIO.CODIGO)
          LEFT JOIN G5_TRANSITO
             ON (LQ_BORRADORAGRUPADO.CODPUEG5TRANSITO = G5_TRANSITO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOG5TRANSITO = G5_TRANSITO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODG5TRANSITO = G5_TRANSITO.CODSER);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_BORRADORES_ESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_BORRADORES_ESCALA
(
   NOMBRE,
   CODPUE,
   ANYO,
   CODBORRADOR,
   FECLIQ,
   CONCEPTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   NUMESCALA,
   IDPROCESO,
   FECINISER,
   FECFINSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   NUMVERSION,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   CODESTADO,
   ESTADO
)
AS
   SELECT M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.GUIDSRV,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDPROCESO,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.CODESTADIA,
          LQ_BORRADOR.NUMREVESCALA,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_BORRADOR.CODESTADO,
          LQ_ESTADOBORRADOR.DESCRIPCION
     FROM LQ_BORRADOR
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO)
   UNION
   SELECT DISTINCT (M_PUERTO_LOCAL.NOMBRE),
                   LQ_BORRADOR.CODPUE,
                   LQ_BORRADOR.ANYO,
                   LQ_BORRADOR.CODBORRADOR,
                   LQ_BORRADOR.FECLIQ,
                   LQ_BORRADOR.CONCEPTO,
                   LQ_BORRADOR.IMPNET,
                   LQ_BORRADOR.IMPIMPUESTO,
                   LQ_BORRADOR.IMPTOT,
                   LQ_BORRADOR.GUIDSRV,
                   ESCALA.NUMESCALA,
                   LQ_BORRADOR.IDPROCESO,
                   LQ_BORRADOR.FECINISER,
                   LQ_BORRADOR.FECFINSER,
                   LQ_BORRADORAGRUPADO.CODPUEESCALA,
                   LQ_BORRADORAGRUPADO.ANYOESCALA,
                   LQ_BORRADORAGRUPADO.CODESCALA,
                   NULL,
                   LQ_BORRADOR.NUMREVESCALA,
                   LQ_BORRADOR.IDASPECTOTARIFA,
                   LQ_BORRADOR.IDASPECTOSUBTARIFA,
                   LQ_BORRADOR.IDASPECTOEXTENSION,
                   LQ_BORRADOR.CODESTADO,
                   LQ_ESTADOBORRADOR.DESCRIPCION
     FROM LQ_BORRADOR
          INNER JOIN LQ_BORRADORAGRUPADO
             ON (LQ_BORRADORAGRUPADO.CODPUEBORRADOR = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOBORRADOR = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORAGRUPADO.CODBORRADOR =
                        LQ_BORRADOR.CODBORRADOR)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO)
          INNER JOIN ESCALA
             ON (    ESCALA.CODPUE = LQ_BORRADORAGRUPADO.CODPUEESCALA
                 AND ESCALA.ANYO = LQ_BORRADORAGRUPADO.ANYOESCALA
                 AND ESCALA.CODESCALA = LQ_BORRADORAGRUPADO.CODESCALA);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_BORRADORES_SUMINAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_BORRADORES_SUMINAGUA
(
   NOMBRE,
   CODPUE,
   ANYO,
   CODBORRADOR,
   FECLIQ,
   CONCEPTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   IDPROCESO,
   FECINISER,
   FECFINSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   CODOPERACION,
   NUMESCALA,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   CODESTADO,
   ESTADO
)
AS
   SELECT M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADORSUMINAGUA.CODPUEBORRADOR,
          LQ_BORRADORSUMINAGUA.ANYOBORRADOR,
          LQ_BORRADORSUMINAGUA.CODBORRADOR,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.GUIDSRV,
          LQ_BORRADOR.IDPROCESO,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADORSUMINAGUA.CODPUEESCALA,
          LQ_BORRADORSUMINAGUA.ANYOESCALA,
          LQ_BORRADORSUMINAGUA.CODESCALA,
          LQ_BORRADORSUMINAGUA.CODESTADIA,
          LQ_BORRADORSUMINAGUA.CODOPERACION,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_BORRADOR.CODESTADO,
          LQ_ESTADOBORRADOR.DESCRIPCION
     FROM LQ_BORRADORSUMINAGUA
          INNER JOIN LQ_BORRADOR
             ON (LQ_BORRADOR.CODPUE = LQ_BORRADORSUMINAGUA.CODPUEBORRADOR
                 AND LQ_BORRADOR.ANYO = LQ_BORRADORSUMINAGUA.ANYOBORRADOR
                 AND LQ_BORRADOR.CODBORRADOR =
                        LQ_BORRADORSUMINAGUA.CODBORRADOR)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_BORRADORES_TRAMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_BORRADORES_TRAMO
(
   NOMBRE,
   CODPUE,
   ANYO,
   CODBORRADOR,
   FECLIQ,
   CONCEPTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   NUMESCALA,
   IDPROCESO,
   FECINISER,
   FECFINSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   CODPUEMERC,
   ANYOMERC,
   CODMERC,
   CODTRAMOMERC,
   NUMTRAMOSIME,
   NUMVERSION,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   CODESTADO,
   ESTADO
)
AS
   SELECT M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.GUIDSRV,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDPROCESO,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.CODESTADIA,
          G3_TRAMO.CODPUE,
          G3_TRAMO.ANYO,
          G3_TRAMO.CODSER,
          G3_TRAMO.CODTRAMO,
          G3_TRAMO.NUMTRAMOSIME,
          G3_TRAMO.NUMVERSION,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_BORRADOR.CODESTADO,
          LQ_ESTADOBORRADOR.DESCRIPCION
     FROM LQ_BORRADOR
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN G3_TRAMO
             ON (    LQ_BORRADOR.CODPUEMERC = G3_TRAMO.CODPUE
                 AND LQ_BORRADOR.ANYOMERC = G3_TRAMO.ANYO
                 AND LQ_BORRADOR.CODMERC = G3_TRAMO.CODSER
                 AND LQ_BORRADOR.CODTRAMOMERC = G3_TRAMO.CODTRAMO)
          INNER JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_ARMADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_ARMADORES
(
   CODIGO,
   NOMBRE
)
AS
   SELECT M_ARMADORCONTENEDOR.CODIGO, M_ARMADORCONTENEDOR.NOMBRE
     FROM M_ARMADORCONTENEDOR;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_ESCALAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_ESCALAS
(
   CODPUE,
   ANYO,
   CODESCALA,
   NUMESCALA,
   CODCONSIGNATARIO
)
AS
   SELECT ESCALA.CODPUE,
          ESCALA.ANYO,
          ESCALA.CODESCALA,
          ESCALA.NUMESCALA,
          ESCALA.CODCONSIGNATARIO
     FROM ESCALA;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_G3EQUIPAMIENTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_G3EQUIPAMIENTOS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   CODEQUIP,
   CODTIPOEQUIP,
   CODTIPOTAMANYO,
   CODESTADO,
   TARA,
   UNIDADESVACIOS,
   NUMBULTOS,
   CODTIPOCN,
   CODTIPOTRANSPORTE,
   PUERTOORIGEN,
   PUERTODESTINO,
   MATRICULA
)
AS
   SELECT EQUIP.CODPUE,
          EQUIP.anyo,
          EQUIP.CODSER,
          EQUIP.CODTRAMO,
          EQUIP.NUMORDEN,
          EQUIP.TIPOCONOC,
          EQUIP.CODEQUIP,
          EQUIP.CODTIPOEQUIP,
          EQUIP.CODTIPOTAMANYO,
          EQUIP.CODESTADO,
          EQUIP.TARA,
          EQUIP.UNIDADESVACIOS,
          EQUIP.NUMBULTOS,
          EQUIP.CODTIPOCN,
          CON.CODTIPTRANSPORTE,
          P1.CODPUE,
          P2.CODPUE,
          EQUIP.MATRICULA
     FROM G3_EQUIPAMIENTO EQUIP
          INNER JOIN G3_CONOCIMIENTO CON
             ON     CON.CODPUE = EQUIP.CODPUE
                AND CON.ANYO = EQUIP.ANYO
                AND CON.CODSER = EQUIP.CODSER
                AND CON.CODTRAMO = EQUIP.CODTRAMO
                AND CON.NUMORDEN = EQUIP.NUMORDEN
                AND CON.TIPOCONOC = EQUIP.TIPOCONOC
          INNER JOIN G3_TRAMO T
             ON     CON.CODPUE = T.CODPUE
                AND CON.ANYO = T.ANYO
                AND CON.CODSER = T.CODSER
                AND CON.CODTRAMO = T.CODTRAMO
                AND T.INDULTIMAVERSION = '1'
          LEFT JOIN M_PUERTO_LOCAL P1
             ON P1.CODPAILOCODE = CON.CODPAI1
                AND P1.CODPUELOCODE = CON.CODPUE1
          LEFT JOIN M_PUERTO_LOCAL P2
             ON P2.CODPAILOCODE = CON.CODPAI3
                AND P2.CODPUELOCODE = CON.CODPUE3
    WHERE (EQUIP.INDBAJA IS NULL OR EQUIP.INDBAJA = '0');


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_G3TIPOTAMEQUIPS  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_G3TIPOTAMEQUIPS
(
   CODIGO,
   NOMBRE
)
AS
   SELECT G3_TIPOTAMEQUIP.CODIGO, G3_TIPOTAMEQUIP.DESCRIPCION
     FROM G3_TIPOTAMEQUIP;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_G3TRAMOCOARRICONT  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_G3TRAMOCOARRICONT
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   CODCONTRASTE,
   NUMCN20LLEDEC,
   NUMCN20LLECOARRI,
   NUMCN20VACDEC,
   NUMCN20VACCOARRI,
   NUMCN40LLEDEC,
   NUMCN40LLECOARRI,
   NUMCN40VACDEC,
   NUMCN40VACCOARRI,
   FECPROCESO,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF,
   NUMCNTRAMOHUERF,
   NUMCN20LLEDECSM,
   NUMCN20LLECOARRISM,
   NUMCN20VACDECSM,
   NUMCN20VACCOARRISM,
   NUMCN40LLEDECSM,
   NUMCN40LLECOARRISM,
   NUMCN40VACDECSM,
   NUMCN40VACCOARRISM,
   NUMROROTRAMOHUERF,
   NUMARTLLEDEC,
   NUMARTLLECOARRI,
   NUMARTVACDEC,
   NUMARTVACCOARRI,
   NUMLORLLEDEC,
   NUMLORLLECOARRI,
   NUMLORVACDEC,
   NUMLORVACCOARRI,
   NUMPLLLEDEC,
   NUMPLLLECOARRI,
   NUMPLVACDEC,
   NUMPLVACCOARRI,
   NUMTRULLEDEC,
   NUMTRULLECOARRI,
   NUMTRUVACDEC,
   NUMTRUVACCOARRI,
   NUMVANLLEDEC,
   NUMVANLLECOARRI,
   NUMVANVACDEC,
   NUMVANVACCOARRI,
   NUMTELLEDEC,
   NUMTELLECOARRI,
   NUMTEVACDEC,
   NUMTEVACCOARRI,
   NUMTATLLEDEC,
   NUMTATLLECOARRI,
   NUMTATVACDEC,
   NUMTATVACCOARRI,
   NUMARTLLEDECSM,
   NUMARTLLECOARRISM,
   NUMARTVACDECSM,
   NUMARTVACCOARRISM,
   NUMLORLLEDECSM,
   NUMLORLLECOARRISM,
   NUMLORVACDECSM,
   NUMLORVACCOARRISM,
   NUMPLLLEDECSM,
   NUMPLLLECOARRISM,
   NUMPLVACDECSM,
   NUMPLVACCOARRISM,
   NUMTRULLEDECSM,
   NUMTRULLECOARRISM,
   NUMTRUVACDECSM,
   NUMTRUVACCOARRISM,
   NUMVANLLEDECSM,
   NUMVANLLECOARRISM,
   NUMVANVACDECSM,
   NUMVANVACCOARRISM,
   NUMTELLEDECSM,
   NUMTELLECOARRISM,
   NUMTEVACDECSM,
   NUMTEVACCOARRISM,
   NUMTATLLEDECSM,
   NUMTATLLECOARRISM,
   NUMTATVACDECSM,
   NUMTATVACCOARRISM
)
AS
   SELECT TC.CODPUE,
          TC.ANYO,
          TC.CODSER,
          TC.CODTRAMO,
          TC.CODCONTRASTE,
          TC.NUMCN20LLEDEC,
          TC.NUMCN20LLECOARRI,
          TC.NUMCN20VACDEC,
          TC.NUMCN20VACCOARRI,
          TC.NUMCN40LLEDEC,
          TC.NUMCN40LLECOARRI,
          TC.NUMCN40VACDEC,
          TC.NUMCN40VACCOARRI,
          TC.FECPROCESO,
          TC.USRALTA,
          TC.USRMODIF,
          TC.FECALTA,
          TC.FECMODIF,
          TC.NUMCNTRAMOHUERF,
          TC.NUMCN20LLEDECSM,
          TC.NUMCN20LLECOARRISM,
          TC.NUMCN20VACDECSM,
          TC.NUMCN20VACCOARRISM,
          TC.NUMCN40LLEDECSM,
          TC.NUMCN40LLECOARRISM,
          TC.NUMCN40VACDECSM,
          TC.NUMCN40VACCOARRISM,
          TC.NUMROROTRAMOHUERF,
          TC.NUMARTLLEDEC,
          TC.NUMARTLLECOARRI,
          TC.NUMARTVACDEC,
          TC.NUMARTVACCOARRI,
          TC.NUMLORLLEDEC,
          TC.NUMLORLLECOARRI,
          TC.NUMLORVACDEC,
          TC.NUMLORVACCOARRI,
          TC.NUMPLLLEDEC,
          TC.NUMPLLLECOARRI,
          TC.NUMPLVACDEC,
          TC.NUMPLVACCOARRI,
          TC.NUMTRULLEDEC,
          TC.NUMTRULLECOARRI,
          TC.NUMTRUVACDEC,
          TC.NUMTRUVACCOARRI,
          TC.NUMVANLLEDEC,
          TC.NUMVANLLECOARRI,
          TC.NUMVANVACDEC,
          TC.NUMVANVACCOARRI,
          TC.NUMTELLEDEC,
          TC.NUMTELLECOARRI,
          TC.NUMTEVACDEC,
          TC.NUMTEVACCOARRI,
          TC.NUMTATLLEDEC,
          TC.NUMTATLLECOARRI,
          TC.NUMTATVACDEC,
          TC.NUMTATVACCOARRI,
          TC.NUMARTLLEDECSM,
          TC.NUMARTLLECOARRISM,
          TC.NUMARTVACDECSM,
          TC.NUMARTVACCOARRISM,
          TC.NUMLORLLEDECSM,
          TC.NUMLORLLECOARRISM,
          TC.NUMLORVACDECSM,
          TC.NUMLORVACCOARRISM,
          TC.NUMPLLLEDECSM,
          TC.NUMPLLLECOARRISM,
          TC.NUMPLVACDECSM,
          TC.NUMPLVACCOARRISM,
          TC.NUMTRULLEDECSM,
          TC.NUMTRULLECOARRISM,
          TC.NUMTRUVACDECSM,
          TC.NUMTRUVACCOARRISM,
          TC.NUMVANLLEDECSM,
          TC.NUMVANLLECOARRISM,
          TC.NUMVANVACDECSM,
          TC.NUMVANVACCOARRISM,
          TC.NUMTELLEDECSM,
          TC.NUMTELLECOARRISM,
          TC.NUMTEVACDECSM,
          TC.NUMTEVACCOARRISM,
          TC.NUMTATLLEDECSM,
          TC.NUMTATLLECOARRISM,
          TC.NUMTATVACDECSM,
          TC.NUMTATVACCOARRISM
     FROM G3_TRAMO_COARRICONT TC;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_G3TRAMOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_G3TRAMOS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   INDPDTECONTCOARRI,
   INDCONTRASTECOARRI,
   NUMESCALA,
   TIPODECLARACION,
   NUMDECLARACION,
   NUMVERSION,
   DESCDECLARACION,
   INDULTIMAVERSION
)
AS
   SELECT TRA.CODPUE,
          TRA.anyo,
          TRA.CODSER,
          TRA.CODTRAMO,
          TRA.INDPDTECONTCOARRI,
          TRA.INDCONTRASTECOARRI,
          CAB.NUMESCALA,
          DECODE (CAB.TIPODECLARACION,  'C', '270',  'D', '98'),
          CAB.NUMDECLARACION,
          TRA.NUMVERSION,
          DECODE (cab.TIPODECLARACION,
                  'C', 'Manifiesto Carga',
                  'D', 'Declaracion Sumaria'),
          TRA.INDULTIMAVERSION
     FROM G3_CABECERA CAB
          INNER JOIN G3_TRAMO TRA
             ON     TRA.codpue = CAB.CODPUE
                AND TRA.ANYO = CAB.ANYO
                AND TRA.CODSER = CAB.CODSER
                AND TRA.INDULTIMAVERSION = '1'
          INNER JOIN M_MUELLE MU
             ON TRA.CODMUELLE = MU.CODIGO AND MU.INDCOARRI = '1';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_MENCOARRI  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_MENCOARRI
(
   CODIGO,
   CODSIME,
   FECRECEPCION,
   CODPUE,
   NUMESCALA,
   IMOBUQUE,
   NOMBREBUQUE,
   TIPOOPERACION,
   CODTERMINAL,
   DESCTERMINAL,
   INDBAJA,
   FECBAJA,
   NUMVIAJEBUQUE,
   CODLINEA,
   CALLSIGNBUQUE,
   NACIONALIDADBUQUE,
   CODPAICARGA,
   CODPUECARGA,
   CODPAIDESCARGA,
   CODPUEDESCARGA,
   FECLLEGADA,
   FECSALIDA,
   TIPOENTIDAD,
   IDENTIDAD,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF,
   NUMCNHUERFANO,
   NUMROROHUERFANO,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMCNIFCVACSINMATRIC,
   NUMROROIFCVACSINMATRIC
)
AS
   SELECT MC.CODIGO,
          MC.CODSIME,
          MC.FECRECEPCION,
          MC.CODPUE,
          MC.NUMESCALA,
          MC.IMOBUQUE,
          MC.NOMBREBUQUE,
          MC.TIPOOPERACION,
          MC.CODTERMINAL,
          MC.DESCTERMINAL,
          MC.INDBAJA,
          MC.FECBAJA,
          MC.NUMVIAJEBUQUE,
          MC.CODLINEA,
          MC.CALLSIGNBUQUE,
          MC.NACIONALIDADBUQUE,
          MC.CODPAICARGA,
          MC.CODPUECARGA,
          MC.CODPAIDESCARGA,
          MC.CODPUEDESCARGA,
          MC.FECLLEGADA,
          MC.FECSALIDA,
          MC.TIPOENTIDAD,
          MC.IDENTIDAD,
          MC.USRALTA,
          MC.USRMODIF,
          MC.FECALTA,
          MC.FECMODIF,
          MC.NUMCNHUERFANO,
          MC.NUMROROHUERFANO,
          MC.CODPUEESC,
          MC.ANYOESC,
          MC.CODESC,
          MC.NUMCNIFCVACSINMATRIC,
          MC.NUMROROIFCVACSINMATRIC
     FROM MEN_COARRI MC;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_MENCOARRIDETALLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_MENCOARRIDETALLE
(
   CODMENSAJE,
   CODIGO,
   CODARMADOR,
   CODARMADORNOTIP,
   INDARMADORNOTIP,
   CODCALIFEQUIP,
   CODTIPOTAMEQUIP,
   MATRICULA,
   NUMEROBL,
   LLENOVACIO,
   ESTADO,
   NUMEROBOOKING,
   MATVEHICULO,
   FECHACARDES,
   UBICACIONDES,
   TIPOENTIDADDES,
   IDENTIDADDES,
   CODPAI1,
   CODPUE1,
   CODPAI2,
   CODPUE2,
   UBICACIONCAR,
   TIPOENTIDADCAR,
   IDENTIDADCAR,
   CODPAI3,
   CODPUE3,
   CODPAI4,
   CODPUE4,
   TIPOPESO,
   UNIDADPESO,
   VALORPESO,
   TEMPERATURA,
   TEMPERATURAUND,
   TEMPERATURAMIN,
   TEMPERATURAMAX,
   TEMPERATURARANGOUND,
   CODPUEEQUIPIFC,
   ANYEQUIPIFC,
   CODSEREQUIPIFC,
   CODTRAMOEQUIPIFC,
   NUMORDENEQUIPIFC,
   TIPOCONOCEQUIPIFC,
   CODEQUIPIFC,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF
)
AS
   SELECT MCD.CODMENSAJE,
          MCD.CODIGO,
          MCD.CODARMADOR,
          MCD.CODARMADORNOTIP,
          MCD.INDARMADORNOTIP,
          MCD.CODCALIFEQUIP,
          MCD.CODTIPOTAMEQUIP,
          MCD.MATRICULA,
          MCD.NUMEROBL,
          MCD.LLENOVACIO,
          MCD.ESTADO,
          MCD.NUMEROBOOKING,
          MCD.MATVEHICULO,
          MCD.FECHACARDES,
          MCD.UBICACIONDES,
          MCD.TIPOENTIDADDES,
          MCD.IDENTIDADDES,
          MCD.CODPAI1,
          MCD.CODPUE1,
          MCD.CODPAI2,
          MCD.CODPUE2,
          MCD.UBICACIONCAR,
          MCD.TIPOENTIDADCAR,
          MCD.IDENTIDADCAR,
          MCD.CODPAI3,
          MCD.CODPUE3,
          MCD.CODPAI4,
          MCD.CODPUE4,
          MCD.TIPOPESO,
          MCD.UNIDADPESO,
          MCD.VALORPESO,
          MCD.TEMPERATURA,
          MCD.TEMPERATURAUND,
          MCD.TEMPERATURAMIN,
          MCD.TEMPERATURAMAX,
          MCD.TEMPERATURARANGOUND,
          MCD.CODPUEEQUIPIFC,
          MCD.ANYEQUIPIFC,
          MCD.CODSEREQUIPIFC,
          MCD.CODTRAMOEQUIPIFC,
          MCD.NUMORDENEQUIPIFC,
          MCD.TIPOCONOCEQUIPIFC,
          MCD.CODEQUIPIFC,
          MCD.USRALTA,
          MCD.USRMODIF,
          MCD.FECALTA,
          MCD.FECMODIF
     FROM MEN_COARRIDETALLE MCD;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_PROCESOCOARRI  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_PROCESOCOARRI
(
   IDPROCESO,
   FECPROCESO,
   NUMERRORES,
   NUMCONTRASTES,
   ESTADO
)
AS
   SELECT PROCESO_COARRI.IDPROCESO,
          PROCESO_COARRI.FECPROCESO,
          PROCESO_COARRI.NUMERRORES,
          PROCESO_COARRI.NUMCONTRASTES,
          PROCESO_COARRI.ESTADO
     FROM PROCESO_COARRI;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_CONT_PROCESOCOARRIERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_CONT_PROCESOCOARRIERROR
(
   IDPROCESO,
   IDERROR,
   DESCERROR,
   DESCTRAMO,
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO
)
AS
   SELECT PROCESO_COARRI_ERROR.IDPROCESO,
          PROCESO_COARRI_ERROR.IDERROR,
          PROCESO_COARRI_ERROR.DESCERROR,
          PROCESO_COARRI_ERROR.DESCTRAMO,
          PROCESO_COARRI_ERROR.CODPUE,
          PROCESO_COARRI_ERROR.ANYO,
          PROCESO_COARRI_ERROR.CODSER,
          PROCESO_COARRI_ERROR.CODTRAMO
     FROM PROCESO_COARRI_ERROR;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_EQUIPAMIENTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_EQUIPAMIENTO
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   FECHAEST,
   TIPODECLARACION,
   ESTCODTIPOPE,
   ESTCODTIPNAV,
   ESTCODTIPTER,
   ESTCODTIPNAVGLOBAL,
   ESTCODTIPUTI,
   ESTNUMEQUIPS,
   ESTINDVACIO,
   ESTCODTIPOCN,
   ESTINDNACIONAL,
   IDCONSIGNATARIO,
   NUMESCALA,
   NUMDECLARACION,
   CODMUELLE,
   ESTINDTRANSITO,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   IMOBUQUE,
   ESTNUMTEUS,
   ESTCODTIPEQMEM,
   ESTTUCAOPPE,
   GT,
   ESLORATOTAL,
   CALMAXIMO,
   FECINIREAL,
   FECFINREAL,
   CODTIPOEQUIP,
   CODTIPOTAMANYO,
   CODPAIPRIMERACARGA,
   CODPUEPRIMERACARGA,
   CODPAIULTTRANSBORDO,
   CODPUEULTTRANSBORDO,
   ESTCODTIPOPEROPPE,
   ESCCODPAIORIGEN,
   ESCCODPUEORIGEN,
   ESCCODPAIDESTINO,
   ESCCODPUEDESTINO,
   INDULTIMAVERSION,
   ESTCODTIPBUQOPPE,
   ESTCODTIPBUQ,
   ESTINDOPPE
)
AS
   SELECT E.CODPUE,
          E.ANYO,
          E.CODSER,
          E.CODTRAMO,
          E.NUMORDEN,
          E.TIPOCONOC,
          CASE
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'P'
             THEN
                ES.FECINIREAL
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'O'
             THEN
                ES.FECFINREAL
             WHEN C.TIPODECLARACION = 'C'
             THEN
                ES.FECFINREAL
             ELSE
                C.FECDECLARACION
          END,
          C.TIPODECLARACION,
          CO.ESTCODTIPOPE,
          CO.ESTCODTIPNAV,
          CO.ESTCODTIPTER,
          TN.CODTIPO,
          E.ESTCODTIPOUTI,
          E.ESTNUMEQUIPS,
          E.ESTINDVACIO,
          E.CODTIPOCN,
          CO.ESTINDNACIONAL,
          T.IDCONSIGNATARIO,
          C.NUMESCALA,
          C.NUMDECLARACION,
          T.CODMUELLE,
          CO.ESTINDTRANSITO,
          CO.CODPAI1,
          CO.CODPUE1,
          CO.CODPAI3,
          CO.CODPUE3,
          BU.CODIMO,
          E.ESTNUMTEUS,
          E.ESTCODTIPEQMEM,
          E.ESTTUCAOPPE,
          BV.GT,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          ES.FECINIREAL,
          ES.FECFINREAL,
          E.CODTIPOEQUIP,
          E.CODTIPOTAMANYO,
          CO.CODPAI2,
          CO.CODPUE2,
          CO.CODPAI4,
          CO.CODPUE4,
          CO.ESTCODTIPOPEROPPE,
          ES.CODPAIORIGEN,
          ES.CODPUEORIGEN,
          ES.CODPAIDESTINO,
          ES.CODPUEDESTINO,
          T.INDULTIMAVERSION,
          TB.CODTIPOOPPE,
          BV.CODTIPOBUQUE,
          CASE
             WHEN C.TIPODECLARACION IN ('C', 'D') THEN '1'
             WHEN C.TIPODECLARACION = 'T' THEN '0'
          END
     FROM G3_EQUIPAMIENTO E
          INNER JOIN G3_CABECERA C
             ON (    C.CODPUE = E.CODPUE
                 AND C.ANYO = E.ANYO
                 AND C.CODSER = E.CODSER)
          INNER JOIN G3_TRAMO T
             ON (    T.CODPUE = C.CODPUE
                 AND T.ANYO = C.ANYO
                 AND T.CODSER = C.CODSER
                 AND T.CODTRAMO = E.CODTRAMO)
          INNER JOIN G3_CONOCIMIENTO CO
             ON (    CO.CODPUE = T.CODPUE
                 AND CO.ANYO = T.ANYO
                 AND CO.CODSER = T.CODSER
                 AND CO.CODTRAMO = T.CODTRAMO
                 AND CO.NUMORDEN = E.NUMORDEN
                 AND CO.TIPOCONOC = E.TIPOCONOC)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = CO.ESTCODTIPNAV)
          LEFT JOIN ESCALA ES
             ON (ES.CODPUE = C.CODPUE AND ES.NUMESCALA = C.NUMESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ES.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ES.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ES.FECINIREAL)
                            ELSE
                               TRUNC (ES.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ES.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ES.FECINIREAL)
                             ELSE
                                TRUNC (ES.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
    WHERE     C.ESTINDEXENTA = '0'
          AND T.ESTINDEXENTA = '0'
          AND (E.INDBAJA = '0' OR E.INDBAJA IS NULL)
          AND (E.INDMATREPETIDA = '0' OR E.INDMATREPETIDA IS NULL)
          AND (   (C.TIPODECLARACION = 'D' AND ES.FECINIREAL IS NOT NULL)
               OR (C.TIPODECLARACION = 'C' AND ES.FECFINREAL IS NOT NULL)
               OR (C.TIPODECLARACION NOT IN ('C', 'D')));


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_ESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_ESCALA
(
   CODPUE,
   ANYO,
   CODSER,
   NUMESCALA,
   FECHAEST,
   GT,
   ESTCODTIPNAV,
   ESTCODTIPNAVENT,
   ESTCODTIPNAVSAL,
   ESTCODTIPTER,
   ESTCODTIPSITOPPE,
   ESTINDDESGUACE,
   ESTCODTIPBUQOPPE,
   ESTINDMERCANTE,
   IDCONSIGNATARIO,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   ESTCODTIPNAVGLOBAL,
   BANDERA,
   ESTCODTIPNAVENTOPPE,
   ESTCODTIPNAVSALOPPE,
   ESTINDOPPE,
   ESTRANGOGTOPPE,
   IMOBUQUE,
   NUMESCALAS,
   ESLORATOTAL,
   CALMAXIMO,
   FECINIREAL,
   FECFINREAL,
   ESTCODTIPBUQ,
   NOMBUQUE,
   INDGUERRA
)
AS
   SELECT E.CODPUE,
          E.ANYO,
          E.CODESCALA,
          E.NUMESCALA,
          CASE
             WHEN CRITERIOFECHAEST () = 'O' THEN E.FECFINREAL
             WHEN CRITERIOFECHAEST () = 'P' THEN E.FECINIREAL
          END,
          BV.GT,
          E.ESTCODTIPNAV,
          E.ESTCODTIPNAVENT,
          E.ESTCODTIPNAVSAL,
          E.ESTCODTIPTER,
          E.ESTCODTIPSITOPPE,
          E.ESTINDDESGUACE,
          TB.CODTIPOOPPE,
          T.INDMERCANTE,
          E.CODCONSIGNATARIO,
          E.CODPAIORIGEN,
          E.CODPUEORIGEN,
          E.CODPAIDESTINO,
          E.CODPUEDESTINO,
          TN.CODTIPO,
          BV.BANDERA,
          E.ESTCODTIPNAVENTOPPE,
          E.ESTCODTIPNAVSALOPPE,
          T.INDMERCANTE,
          CASE
             WHEN BV.GT >= 0 AND BV.GT <= 99 THEN '99'
             WHEN BV.GT >= 100 AND BV.GT <= 499 THEN '01'
             WHEN BV.GT >= 500 AND BV.GT <= 999 THEN '02'
             WHEN BV.GT >= 1000 AND BV.GT <= 1999 THEN '03'
             WHEN BV.GT >= 2000 AND BV.GT <= 2999 THEN '04'
             WHEN BV.GT >= 3000 AND BV.GT <= 3999 THEN '05'
             WHEN BV.GT >= 4000 AND BV.GT <= 4999 THEN '06'
             WHEN BV.GT >= 5000 AND BV.GT <= 5999 THEN '07'
             WHEN BV.GT >= 6000 AND BV.GT <= 6999 THEN '08'
             WHEN BV.GT >= 7000 AND BV.GT <= 7999 THEN '09'
             WHEN BV.GT >= 8000 AND BV.GT <= 8999 THEN '10'
             WHEN BV.GT >= 9000 AND BV.GT <= 9999 THEN '11'
             WHEN BV.GT >= 10000 AND BV.GT <= 19999 THEN '12'
             WHEN BV.GT >= 20000 AND BV.GT <= 29999 THEN '13'
             WHEN BV.GT >= 30000 AND BV.GT <= 39999 THEN '14'
             WHEN BV.GT >= 40000 AND BV.GT <= 49999 THEN '15'
             WHEN BV.GT >= 50000 AND BV.GT <= 79999 THEN '16'
             WHEN BV.GT >= 80000 AND BV.GT <= 99999 THEN '17'
             WHEN BV.GT >= 100000 AND BV.GT <= 149999 THEN '18'
             WHEN BV.GT >= 150000 AND BV.GT <= 199999 THEN '19'
             WHEN BV.GT >= 200000 AND BV.GT <= 249999 THEN '20'
             WHEN BV.GT >= 250000 AND BV.GT <= 299999 THEN '21'
             WHEN BV.GT >= 300000 AND BV.GT <= 9999999 THEN '22'
          END,
          BU.CODIMO,
          1,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          E.FECINIREAL,
          E.FECFINREAL,
          BV.CODTIPOBUQUE,
          BU.NOMBRE,
          TB.INDGUERRA
     FROM ESCALA E
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN E.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (E.FECINIREAL)
                            ELSE
                               TRUNC (E.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN E.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (E.FECINIREAL)
                             ELSE
                                TRUNC (E.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          INNER JOIN TIPO_BUQUEOPPE T
             ON (T.CODIGO = TB.CODTIPOOPPE)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = E.ESTCODTIPNAV)
    WHERE     E.ESTINDEXENTA = '0'
          AND E.INDTRAFINT = '0'
          AND E.CODESTADO IN ('IN', 'FI', 'LD');


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_ESCALATI  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_ESCALATI
(
   CODPUE,
   ANYO,
   CODSER,
   NUMESCALA,
   FECHAEST,
   GT,
   ESTCODTIPNAV,
   ESTCODTIPNAVENT,
   ESTCODTIPNAVSAL,
   ESTCODTIPTER,
   ESTCODTIPSITOPPE,
   ESTINDDESGUACE,
   ESTCODTIPBUQOPPE,
   ESTINDMERCANTE,
   IDCONSIGNATARIO,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   ESTCODTIPNAVGLOBAL,
   BANDERA,
   ESTCODTIPNAVENTOPPE,
   ESTCODTIPNAVSALOPPE,
   ESTINDOPPE,
   ESTRANGOGTOPPE,
   IMOBUQUE,
   NUMESCALAS,
   ESLORATOTAL,
   CALMAXIMO,
   FECINIREAL,
   FECFINREAL,
   ESTCODTIPBUQ,
   NOMBUQUE,
   CODTIPOTRAFINT
)
AS
   SELECT E.CODPUE,
          E.ANYO,
          E.CODESCALA,
          E.NUMESCALA,
          CASE
             WHEN CRITERIOFECHAEST () = 'O' THEN E.FECFINREAL
             WHEN CRITERIOFECHAEST () = 'P' THEN E.FECINIREAL
          END,
          BV.GT,
          E.ESTCODTIPNAV,
          E.ESTCODTIPNAVENT,
          E.ESTCODTIPNAVSAL,
          E.ESTCODTIPTER,
          E.ESTCODTIPSITOPPE,
          E.ESTINDDESGUACE,
          TB.CODTIPOOPPE,
          T.INDMERCANTE,
          E.CODCONSIGNATARIO,
          E.CODPAIORIGEN,
          E.CODPUEORIGEN,
          E.CODPAIDESTINO,
          E.CODPUEDESTINO,
          TN.CODTIPO,
          BV.BANDERA,
          E.ESTCODTIPNAVENTOPPE,
          E.ESTCODTIPNAVSALOPPE,
          T.INDMERCANTE,
          CASE
             WHEN BV.GT >= 0 AND BV.GT <= 99 THEN '99'
             WHEN BV.GT >= 100 AND BV.GT <= 499 THEN '01'
             WHEN BV.GT >= 500 AND BV.GT <= 999 THEN '02'
             WHEN BV.GT >= 1000 AND BV.GT <= 1999 THEN '03'
             WHEN BV.GT >= 2000 AND BV.GT <= 2999 THEN '04'
             WHEN BV.GT >= 3000 AND BV.GT <= 3999 THEN '05'
             WHEN BV.GT >= 4000 AND BV.GT <= 4999 THEN '06'
             WHEN BV.GT >= 5000 AND BV.GT <= 5999 THEN '07'
             WHEN BV.GT >= 6000 AND BV.GT <= 6999 THEN '08'
             WHEN BV.GT >= 7000 AND BV.GT <= 7999 THEN '09'
             WHEN BV.GT >= 8000 AND BV.GT <= 8999 THEN '10'
             WHEN BV.GT >= 9000 AND BV.GT <= 9999 THEN '11'
             WHEN BV.GT >= 10000 AND BV.GT <= 19999 THEN '12'
             WHEN BV.GT >= 20000 AND BV.GT <= 29999 THEN '13'
             WHEN BV.GT >= 30000 AND BV.GT <= 39999 THEN '14'
             WHEN BV.GT >= 40000 AND BV.GT <= 49999 THEN '15'
             WHEN BV.GT >= 50000 AND BV.GT <= 79999 THEN '16'
             WHEN BV.GT >= 80000 AND BV.GT <= 99999 THEN '17'
             WHEN BV.GT >= 100000 AND BV.GT <= 149999 THEN '18'
             WHEN BV.GT >= 150000 AND BV.GT <= 199999 THEN '19'
             WHEN BV.GT >= 200000 AND BV.GT <= 249999 THEN '20'
             WHEN BV.GT >= 250000 AND BV.GT <= 299999 THEN '21'
             WHEN BV.GT >= 300000 AND BV.GT <= 9999999 THEN '22'
          END,
          BU.CODIMO,
          1,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          E.FECINIREAL,
          E.FECFINREAL,
          BV.CODTIPOBUQUE,
          BU.NOMBRE,
          E.CODTIPOTRAFINT
     FROM ESCALA E
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN E.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (E.FECINIREAL)
                            ELSE
                               TRUNC (E.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN E.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (E.FECINIREAL)
                             ELSE
                                TRUNC (E.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          INNER JOIN TIPO_BUQUEOPPE T
             ON (T.CODIGO = TB.CODTIPOOPPE)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = E.ESTCODTIPNAV)
    WHERE     E.ESTINDEXENTA = '0'
          AND E.INDTRAFINT = '1'
          AND E.CODESTADO IN ('IN', 'FI', 'LD');


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_ESTADIAMEM  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_ESTADIAMEM
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   NUMESCALA,
   FECHAEST,
   FECHAFIN,
   NUMDIAS,
   NUMESTADIAS,
   GT,
   IMOBUQUE,
   ESLORA,
   INDFONDEO,
   CODMUELLEREAL,
   GTPORDIAS,
   ESLORAPORDIAS,
   TPM,
   NOMBREBUQUE,
   CODBANDERA,
   NACIONALIDAD,
   CALADOMAXBUQUE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   ZONAMUELLEREAL,
   CALADOENTRADA,
   CALADOSALIDA,
   INDCOSTADO
)
AS
   SELECT ES.CODPUE,
          ES.ANYO,
          ES.CODESCALA,
          ES.CODESTADIA,
          E.NUMESCALA,
          CASE
             WHEN CRITERIOFECHAEST () = 'O' THEN ES.FECDESATRAQUEREAL
             WHEN CRITERIOFECHAEST () = 'P' THEN ES.FECATRAQUEREAL
          END,
          ES.FECDESATRAQUEREAL,
          TRUNC (ES.FECDESATRAQUEREAL - ES.FECATRAQUEREAL, 6),
          1,
          BV.GT,
          BU.CODIMO,
          BV.ESLORATOTAL,
          ES.ESTINDFONDEO,
          ES.CODMUELLEINIREAL,
          TRUNC (BV.GT * TRUNC (ES.FECDESATRAQUEREAL - ES.FECATRAQUEREAL, 6),
                 6),
          TRUNC (
             BV.ESLORATOTAL
             * TRUNC (ES.FECDESATRAQUEREAL - ES.FECATRAQUEREAL, 6),
             6),
          BV.TPM,
          BU.NOMBRE,
          BV.BANDERA,
          PA.NOMBRE,
          BV.CALMAXIMO,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          MU.CODZONAAGUA,
          ES.CALADOENTRADA,
          ES.CALADOSALIDA,
          F.INDCOSTADOB1
     FROM ESTADIA ES
          INNER JOIN ESCALA E
             ON (    E.CODPUE = ES.CODPUE
                 AND E.ANYO = ES.ANYO
                 AND E.CODESCALA = ES.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN E.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (E.FECINIREAL)
                            ELSE
                               TRUNC (E.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN E.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (E.FECINIREAL)
                             ELSE
                                TRUNC (E.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          LEFT JOIN M_PAIS PA
             ON (PA.CODPAIS = BV.BANDERA)
          LEFT JOIN M_MUELLE MU
             ON (MU.CODIGO = ES.CODMUELLEINIREAL)
          LEFT JOIN FORMA_ATRAQUE F
             ON (F.CODTIPATRAQUE = ES.CODTIPATRAQUEREAL)
    WHERE     E.INDTRAFINT = '0'
          AND E.ESTINDEXENTA = '0'
          AND ES.INDTRAFINT = '0'
          AND ES.CODESTADO = 'FI'
          AND (ES.ESTINDEXENTA = '0' OR ES.ESTINDEXENTA IS NULL);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_EXCURSIONISTA  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_EXCURSIONISTA
(
   CODPUE,
   ANYO,
   CODSER,
   FECHAEST,
   NUMUNIDADES,
   IDCLIENTE,
   NUMESCALA,
   IMOBUQUE,
   ESTCODTIPBUQOPPE
)
AS
   SELECT EX.CODPUE,
          EX.ANYO,
          EX.CODSER,
          EX.FECFIN,
          CASE
             WHEN EX.CODTIPOSERVICIO = 'E'
             THEN
                EX.NUMEXCURSIONISTAS
             WHEN EX.CODTIPOSERVICIO = 'L'
             THEN
                NVL (EX.NUMPASAJLOCALE, 0) + NVL (EX.NUMPASAJLOCALD, 0)
          END,
          EX.IDUSUARIO,
          E.NUMESCALA,
          BU.CODIMO,
          TB.CODTIPOOPPE
     FROM T2_EXCURSIONISTA EX
          LEFT JOIN ESCALA E
             ON (    EX.CODPUEESCTI = E.CODPUE
                 AND EX.ANYOESCTI = E.ANYO
                 AND EX.CODESCTI = E.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN E.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (E.FECINIREAL)
                            ELSE
                               TRUNC (E.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN E.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (E.FECINIREAL)
                             ELSE
                                TRUNC (E.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
    WHERE EX.ESTINDEXENTA = '0';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_MBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_MBUQUE (CODIGO, NOMBRE)
AS
   SELECT DISTINCT (B.CODIMO), B.NOMBRE
     FROM M_BUQUE B;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_MERCANCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_MERCANCIA
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   CODPARTIDA,
   CODEQUIP,
   FECHAEST,
   ESTINDTERMCONCT3,
   ESTCODTIPOPE,
   ESTCODTIPNAV,
   ESTCODTIPNAVGLOBAL,
   TIPODECLARACION,
   ESTCODGRUPO43,
   CODARAN,
   ESTCODPAI,
   ESTCODPUE,
   ESTCODTIPEQMEM,
   ESTCODVEH,
   NUMVEHREGMERC,
   ESTCODGRUPONAT,
   ESTCODSUBGRUPONAT,
   ESTINDTIENEEQUIP,
   ESTCODFORMAPRESENT,
   ESTINDINSTALESPECIAL,
   ESTCODTIPOCN,
   ESTINDVACIO,
   IDCONSIGNATARIO,
   NUMESCALA,
   NUMDECLARACION,
   CODMUELLE,
   ESTCODTIPOPEROPPE,
   ESTCODPAIPUEOROPPE,
   ESTCODPAIPUEDEOPPE,
   ESTALINOPPE,
   ESTCODTIPNAVOPPE,
   ESTTUCAOPPE,
   ESTINDINSTALOPPE,
   ESTTIPOTRANSOPPE,
   NUMKG,
   NUMTON,
   ESTNUMEQUIPS,
   ESTNUMTEUS,
   ESTTUCAOPPE2,
   ESTCODPAIPUEOPPE,
   ESTDIRTRANSOPPE,
   ESTNUMTONOPPEEME,
   ESTNUMPASAJOPPEEME,
   ESTNUMEQLLEOPPEEME,
   ESTNUMEQVACOPPEEME,
   ESTPAIREGOPPEEME,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   IMOBUQUE,
   ESTCODTIPTER,
   CODARANOPPE,
   GT,
   ESLORATOTAL,
   CALMAXIMO,
   FECINIREAL,
   FECFINREAL,
   CODPAIPRIMERACARGA,
   CODPUEPRIMERACARGA,
   CODPAIULTTRANSBORDO,
   CODPUEULTTRANSBORDO,
   ESCCODPAIORIGEN,
   ESCCODPUEORIGEN,
   ESCCODPAIDESTINO,
   ESCCODPUEDESTINO,
   INDULTIMAVERSION,
   ESTINDNACIONAL,
   ESTCODTIPUTI,
   ESTCODTIPBUQOPPE,
   ESTCODTIPBUQ,
   ESTINDOPPE,
   ESTINDTARA,
   CODTIPTRANSPORTE,
   CODINSTESP
)
AS
   SELECT C.CODPUE,
          C.ANYO,
          C.CODSER,
          T.CODTRAMO,
          CO.NUMORDEN,
          CO.TIPOCONOC,
          NULL,
          E.CODEQUIP,
          CASE
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'P'
             THEN
                ES.FECINIREAL
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'O'
             THEN
                ES.FECFINREAL
             WHEN C.TIPODECLARACION = 'C'
             THEN
                ES.FECFINREAL
             ELSE
                C.FECDECLARACION
          END,
          CASE
             WHEN E.CODTIPCONCB3 IS NOT NULL THEN E.CODTIPCONCB3
             WHEN E.CODTIPCONCB3 IS NULL THEN T.IND215
          END,
          CO.ESTCODTIPOPE,
          CO.ESTCODTIPNAV,
          TN.CODTIPO,
          C.TIPODECLARACION,
          ME.ESTCODMERC43,
          E.ESTCODARAN,
          CO.ESTCODPAI,
          CO.ESTCODPUE,
          E.ESTCODTIPEQMEM,
          NULL,
          0,
          SN.CODGRUPO,
          ME.CODSUBGRUPONATURALEZA,
          '1',
          'MG',
          '0',
          DECODE (E.CODTIPOCN,  '1', E.CODTIPOCN,  '2', E.CODTIPOCN,  NULL),
          E.ESTINDVACIO,
          T.IDCONSIGNATARIO,
          C.NUMESCALA,
          C.NUMDECLARACION,
          T.CODMUELLE,
          CO.ESTCODTIPOPEROPPE,
          CO.CODPAI1 || CO.CODPUE1,
          CO.CODPAI3 || CO.CODPUE3,
          CASE
             WHEN E.CODTIPCONCB3 IS NOT NULL AND E.CODTIPCONCB3 IN ('1', '2')
             THEN
                2
             WHEN E.CODTIPCONCB3 IS NOT NULL
                  AND E.CODTIPCONCB3 NOT IN ('1', '2')
             THEN
                1
             WHEN E.CODTIPCONCB3 IS NULL AND T.IND215 IN ('1', '2')
             THEN
                2
             WHEN E.CODTIPCONCB3 IS NULL AND T.IND215 NOT IN ('1', '2')
             THEN
                1
          END,
          CO.ESTCODTIPNAVOPPE,
          E.ESTTUCAOPPE,
          'N',
          E.ESTTIPOTRANSOPPE,
          E.ESTTARA,
          (E.ESTTARA / 1000),
          E.ESTNUMEQUIPS,
          E.ESTNUMTEUS,
          SUBSTR (E.ESTTUCAOPPE, 2),
          CO.ESTCODPAI || CO.ESTCODPUE,
          DECODE (C.TIPODECLARACION,  'D', 1,  'C', 2),
          0,
          0,
          DECODE (E.ESTINDVACIO, '0', E.ESTNUMEQUIPS, 0),
          DECODE (E.ESTINDVACIO, '1', E.ESTNUMEQUIPS, 0),
          C.ESTPAIOPPEEME || C.ESTDIGPAIOPPEEME,
          CO.CODPAI1,
          CO.CODPUE1,
          CO.CODPAI3,
          CO.CODPUE3,
          BU.CODIMO,
          CO.ESTCODTIPTER,
          E.ESTCODARAN,
          BV.GT,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          ES.FECINIREAL,
          ES.FECFINREAL,
          CO.CODPAI2,
          CO.CODPUE2,
          CO.CODPAI4,
          CO.CODPUE4,
          ES.CODPAIORIGEN,
          ES.CODPUEORIGEN,
          ES.CODPAIDESTINO,
          ES.CODPUEDESTINO,
          T.INDULTIMAVERSION,
          CO.ESTINDNACIONAL,
          E.ESTCODTIPOUTI,
          TBN.CODTIPOOPPE,
          BV.CODTIPOBUQUE,
          CASE
             WHEN C.TIPODECLARACION IN ('C', 'D') THEN '1'
             WHEN C.TIPODECLARACION = 'T' THEN '0'
          END,
          '1',
          CO.CODTIPTRANSPORTE,
          NULL
     FROM G3_EQUIPAMIENTO E
          INNER JOIN G3_CABECERA C
             ON (    C.CODPUE = E.CODPUE
                 AND C.ANYO = E.ANYO
                 AND C.CODSER = E.CODSER)
          INNER JOIN G3_TRAMO T
             ON (    T.CODPUE = C.CODPUE
                 AND T.ANYO = C.ANYO
                 AND T.CODSER = C.CODSER
                 AND T.CODTRAMO = E.CODTRAMO)
          INNER JOIN G3_CONOCIMIENTO CO
             ON (    CO.CODPUE = T.CODPUE
                 AND CO.ANYO = T.ANYO
                 AND CO.CODSER = T.CODSER
                 AND CO.CODTRAMO = T.CODTRAMO
                 AND CO.NUMORDEN = E.NUMORDEN
                 AND CO.TIPOCONOC = E.TIPOCONOC)
          LEFT JOIN M_MERCANCIA ME
             ON (ME.CODARAN = E.ESTCODARAN AND ME.VERSION = E.ESTVERCODARAN)
          LEFT JOIN EST_SUBGRUPO_NATURALEZA SN
             ON (SN.CODIGO = ME.CODSUBGRUPONATURALEZA)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = CO.ESTCODTIPNAV)
          LEFT JOIN ESCALA ES
             ON (ES.CODPUE = C.CODPUE AND ES.NUMESCALA = C.NUMESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ES.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ES.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ES.FECINIREAL)
                            ELSE
                               TRUNC (ES.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ES.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ES.FECINIREAL)
                             ELSE
                                TRUNC (ES.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TBN
             ON BV.CODTIPOBUQUE = TBN.CODTIPOBUQUE
    WHERE     C.ESTINDEXENTA = '0'
          AND T.ESTINDEXENTA = '0'
          AND E.ESTCODARAN IS NOT NULL
          AND ME.ESTINDEXENTA = '0'
          AND (E.INDBAJA = '0' OR E.INDBAJA IS NULL)
          AND (   (C.TIPODECLARACION = 'D' AND ES.FECINIREAL IS NOT NULL)
               OR (C.TIPODECLARACION = 'C' AND ES.FECFINREAL IS NOT NULL)
               OR (C.TIPODECLARACION NOT IN ('C', 'D')))
   UNION ALL
   SELECT C.CODPUE,
          C.ANYO,
          C.CODSER,
          T.CODTRAMO,
          CO.NUMORDEN,
          CO.TIPOCONOC,
          P.NUMPARTIDA,
          NULL,
          CASE
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'P'
             THEN
                ES.FECINIREAL
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'O'
             THEN
                ES.FECFINREAL
             WHEN C.TIPODECLARACION = 'C'
             THEN
                ES.FECFINREAL
             ELSE
                C.FECDECLARACION
          END,
          CASE
             WHEN P.CODTIPCONCB3 IS NOT NULL THEN P.CODTIPCONCB3
             WHEN P.CODTIPCONCB3 IS NULL THEN T.IND215
          END,
          CO.ESTCODTIPOPE,
          CO.ESTCODTIPNAV,
          TN.CODTIPO,
          C.TIPODECLARACION,
          ME.ESTCODMERC43,
          P.CODARAN,
          CO.ESTCODPAI,
          CO.ESTCODPUE,
          P.ESTCODTIPEQMEM,
          P.ESTCODVEHREGMERC,
          P.NUMBULTOS,
          SN.CODGRUPO,
          ME.CODSUBGRUPONATURALEZA,
          P.ESTINDTIENEEQUIP,
          P.ESTCODFORMAPRESENT,
          P.ESTINDINSTALESPECIAL,
          P.ESTCODTIPOCN,
          '0',
          T.IDCONSIGNATARIO,
          C.NUMESCALA,
          C.NUMDECLARACION,
          T.CODMUELLE,
          CO.ESTCODTIPOPEROPPE,
          CO.CODPAI1 || CO.CODPUE1,
          CO.CODPAI3 || CO.CODPUE3,
          CASE
             WHEN P.CODTIPCONCB3 IS NOT NULL AND P.CODTIPCONCB3 IN ('1', '2')
             THEN
                2
             WHEN P.CODTIPCONCB3 IS NOT NULL
                  AND P.CODTIPCONCB3 NOT IN ('1', '2')
             THEN
                1
             WHEN P.CODTIPCONCB3 IS NULL AND T.IND215 IN ('1', '2')
             THEN
                2
             WHEN P.CODTIPCONCB3 IS NULL AND T.IND215 NOT IN ('1', '2')
             THEN
                1
          END,
          CO.ESTCODTIPNAVOPPE,
          P.ESTTUCAOPPE,
          DECODE (P.ESTINDINSTALESPECIAL,  '0', 'N',  '1', 'S'),
          P.ESTTIPOTRANSOPPE,
          P.PESO,
          (P.PESO / 1000),
          DECODE (SUBSTR (P.ESTTUCAOPPE, 2),
                  '51', P.NUMBULTOS,
                  '52', P.NUMBULTOS,
                  '53', P.NUMBULTOS,
                  '54', P.NUMBULTOS,
                  '56', P.NUMBULTOS,
                  0),
          0,
          SUBSTR (P.ESTTUCAOPPE, 2),
          CO.ESTCODPAI || CO.ESTCODPUE,
          DECODE (C.TIPODECLARACION,  'D', 1,  'C', 2),
          CASE
             WHEN P.CODARAN LIKE '%*' OR P.CODARAN LIKE '%T' THEN 0
             ELSE (P.PESO / 1000)
          END,
          DECODE (SUBSTR (P.ESTTUCAOPPE, 2),
                  '52', P.NUMBULTOS,
                  '53', P.NUMBULTOS,
                  '54', P.NUMBULTOS,
                  '56', P.NUMBULTOS,
                  '62', P.NUMBULTOS,
                  0),
          0,
          0,
          C.ESTPAIOPPEEME || C.ESTDIGPAIOPPEEME,
          CO.CODPAI1,
          CO.CODPUE1,
          CO.CODPAI3,
          CO.CODPUE3,
          BU.CODIMO,
          CO.ESTCODTIPTER,
          P.CODARAN,
          BV.GT,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          ES.FECINIREAL,
          ES.FECFINREAL,
          CO.CODPAI2,
          CO.CODPUE2,
          CO.CODPAI4,
          CO.CODPUE4,
          ES.CODPAIORIGEN,
          ES.CODPUEORIGEN,
          ES.CODPAIDESTINO,
          ES.CODPUEDESTINO,
          T.INDULTIMAVERSION,
          CO.ESTINDNACIONAL,
          NULL AS ESTCODTIPUTI,
          TBN.CODTIPOOPPE,
          BV.CODTIPOBUQUE,
          CASE
             WHEN C.TIPODECLARACION IN ('C', 'D') THEN '1'
             WHEN C.TIPODECLARACION = 'T' THEN '0'
          END,
          '0',
          CO.CODTIPTRANSPORTE,
          P.CODINSTESP
     FROM G3_PARTIDA P
          INNER JOIN G3_CABECERA C
             ON (    C.CODPUE = P.CODPUE
                 AND C.ANYO = P.ANYO
                 AND C.CODSER = P.CODSER)
          INNER JOIN G3_TRAMO T
             ON (    T.CODPUE = C.CODPUE
                 AND T.ANYO = C.ANYO
                 AND T.CODSER = C.CODSER
                 AND T.CODTRAMO = P.CODTRAMO)
          INNER JOIN G3_CONOCIMIENTO CO
             ON (    CO.CODPUE = T.CODPUE
                 AND CO.ANYO = T.ANYO
                 AND CO.CODSER = T.CODSER
                 AND CO.CODTRAMO = T.CODTRAMO
                 AND CO.NUMORDEN = P.NUMORDEN
                 AND CO.TIPOCONOC = P.TIPOCONOC)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = CO.ESTCODTIPNAV)
          LEFT JOIN M_MERCANCIA ME
             ON (ME.CODARAN = P.CODARAN AND ME.VERSION = P.VERCODARAN)
          LEFT JOIN EST_SUBGRUPO_NATURALEZA SN
             ON (SN.CODIGO = ME.CODSUBGRUPONATURALEZA)
          LEFT JOIN ESCALA ES
             ON (ES.CODPUE = C.CODPUE AND ES.NUMESCALA = C.NUMESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ES.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ES.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ES.FECINIREAL)
                            ELSE
                               TRUNC (ES.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ES.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ES.FECINIREAL)
                             ELSE
                                TRUNC (ES.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TBN
             ON BV.CODTIPOBUQUE = TBN.CODTIPOBUQUE
    WHERE     C.ESTINDEXENTA = '0'
          AND T.ESTINDEXENTA = '0'
          AND ME.ESTINDEXENTA = '0'
          AND P.CODARAN NOT IN
                 ('0004',
                  '0005',
                  '0005L',
                  '0006',
                  '0007',
                  '0008',
                  '0001',
                  '0001C',
                  '0001D',
                  '0001E',
                  '0001X')
          AND (P.INDBAJA = '0' OR P.INDBAJA IS NULL)
          AND (   (C.TIPODECLARACION = 'D' AND ES.FECINIREAL IS NOT NULL)
               OR (C.TIPODECLARACION = 'C' AND ES.FECFINREAL IS NOT NULL)
               OR (C.TIPODECLARACION NOT IN ('C', 'D')));


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_MERCANCIATI  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_MERCANCIATI
(
   CODPUE,
   ANYO,
   CODSER,
   CODPARTIDA,
   FECHAEST,
   TIPODECLARACION,
   CODARAN,
   NUMKG,
   NUMTON,
   ESTCODGRUPO43,
   ESTCODFORMAPRESENT,
   IDCLIENTE,
   NUMESCALA,
   IMOBUQUE,
   CODMUELLE
)
AS
   SELECT T.CODPUE,
          T.ANYO,
          T.CODSER,
          P.CODPARTIDA,
          T.FECSERVICIO,
          T.CODTIPO,
          P.CODARAN,
          P.NUMKG,
          (P.NUMKG / 1000),
          M.ESTCODMERC43,
          P.ESTCODFORMAPRESENT,
          T.CODUSUARIO,
          E.NUMESCALA,
          BU.CODIMO,
          T.CODMUELLE
     FROM G3_TRAFINT T
          LEFT JOIN G3_TRAFINT_PARTIDA P
             ON (    P.CODPUE = T.CODPUE
                 AND P.ANYO = T.ANYO
                 AND P.CODSER = T.CODSER)
          LEFT JOIN M_MERCANCIA M
             ON (M.CODARAN = P.CODARAN AND M.VERSION = P.VERCODARAN)
          LEFT JOIN ESCALA E
             ON (    E.CODPUE = T.CODPUEESCTI
                 AND E.ANYO = T.ANYOESCTI
                 AND E.CODESCALA = T.CODESCTI)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
    WHERE T.ESTINDEXENTA = '0' AND M.ESTINDEXENTA = '0';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_PASAJE  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_PASAJE
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   FECHAEST,
   NUMUNIDADES,
   CODARAN,
   ESTCODTIPNAV,
   ESTCODTIPNAVGLOBAL,
   ESTCODTIPOPE,
   TIPODECLARACION,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   ESTCODPAI,
   ESTCODPUE,
   ESTCODTIPOSCHENGEN,
   INDPASSERVMARITIMO,
   IDCONSIGNATARIO,
   NUMESCALA,
   NUMDECLARACION,
   CODMUELLE,
   ESTCODTIPOPEROPPE,
   ESTCODPAIPUEOROPPE,
   ESTCODPAIPUEDEOPPE,
   ESTALINOPPE,
   ESTCODTIPNAVOPPE,
   ESTTUCAOPPE,
   ESTINDINSTALOPPE,
   ESTTIPOTRANSOPPE,
   NUMKG,
   NUMTON,
   ESTNUMEQUIPS,
   ESTNUMTEUS,
   ESTTUCAOPPE2,
   ESTCODPAIPUEOPPE,
   ESTDIRTRANSOPPE,
   ESTNUMTONOPPEEME,
   ESTNUMPASAJOPPEEME,
   ESTNUMEQLLEOPPEEME,
   ESTNUMEQVACOPPEEME,
   ESTPAIREGOPPEEME,
   IMOBUQUE,
   GT,
   ESLORATOTAL,
   CALMAXIMO,
   FECINIREAL,
   FECFINREAL,
   ESTCODTIPBUQOPPE,
   ESCCODPAIORIGEN,
   ESCCODPUEORIGEN,
   ESCCODPAIDESTINO,
   ESCCODPUEDESTINO,
   ESTCODTIPBUQ,
   ESTINDOPPE
)
AS
   SELECT P.CODPUE,
          P.ANYO,
          P.CODSER,
          P.CODTRAMO,
          P.NUMORDEN,
          P.TIPOCONOC,
          CASE
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'P'
             THEN
                E.FECINIREAL
             WHEN C.TIPODECLARACION = 'D' AND CRITERIOFECHAEST () = 'O'
             THEN
                E.FECFINREAL
             WHEN C.TIPODECLARACION = 'C'
             THEN
                E.FECFINREAL
             ELSE
                C.FECDECLARACION
          END,
          P.NUMBULTOS,
          P.CODARAN,
          CO.ESTCODTIPNAV,
          TN.CODTIPO,
          CO.ESTCODTIPOPE,
          C.TIPODECLARACION,
          CO.CODPAI1,
          CO.CODPUE1,
          CO.CODPAI3,
          CO.CODPUE3,
          CO.ESTCODPAI,
          CO.ESTCODPUE,
          CO.ESTCODTIPOSCHENGEN,
          P.ESTINDPASSERVMARITIMO,
          T.IDCONSIGNATARIO,
          C.NUMESCALA,
          C.NUMDECLARACION,
          T.CODMUELLE,
          CO.ESTCODTIPOPEROPPE,
          CO.CODPAI1 || CO.CODPUE1,
          CO.CODPAI3 || CO.CODPUE3,
          '1',
          CO.ESTCODTIPNAVOPPE,
          P.ESTTUCAOPPE,
          'N',
          P.ESTTIPOTRANSOPPE,
          0,
          0,
          P.NUMBULTOS,
          0,
          SUBSTR (P.ESTTUCAOPPE, 2),
          CO.ESTCODPAI || CO.ESTCODPUE,
          DECODE (C.TIPODECLARACION,  'D', 1,  'C', 2),
          0,
          DECODE (SUBSTR (P.ESTTUCAOPPE, 2),
                  'PA', P.NUMBULTOS,
                  '52', P.NUMBULTOS,
                  '53', P.NUMBULTOS,
                  0),
          0,
          0,
          C.ESTPAIOPPEEME || C.ESTDIGPAIOPPEEME,
          BU.CODIMO,
          BV.GT,
          BV.ESLORATOTAL,
          BV.CALMAXIMO,
          E.FECINIREAL,
          E.FECFINREAL,
          TB.CODTIPOOPPE,
          E.CODPAIORIGEN,
          E.CODPUEORIGEN,
          E.CODPAIDESTINO,
          E.CODPUEDESTINO,
          BV.CODTIPOBUQUE,
          CASE
             WHEN C.TIPODECLARACION IN ('C', 'D') THEN '1'
             WHEN C.TIPODECLARACION = 'T' THEN '0'
          END
     FROM G3_PARTIDA P
          INNER JOIN G3_CABECERA C
             ON (    C.CODPUE = P.CODPUE
                 AND C.ANYO = P.ANYO
                 AND C.CODSER = P.CODSER)
          INNER JOIN G3_TRAMO T
             ON (    T.CODPUE = C.CODPUE
                 AND T.ANYO = C.ANYO
                 AND T.CODSER = C.CODSER
                 AND T.CODTRAMO = P.CODTRAMO)
          INNER JOIN G3_CONOCIMIENTO CO
             ON (    CO.CODPUE = T.CODPUE
                 AND CO.ANYO = T.ANYO
                 AND CO.CODSER = T.CODSER
                 AND CO.CODTRAMO = T.CODTRAMO
                 AND CO.NUMORDEN = P.NUMORDEN
                 AND CO.TIPOCONOC = P.TIPOCONOC)
          INNER JOIN EST_TIPO_NAVEGACION TN
             ON (TN.CODIGO = CO.ESTCODTIPNAV)
          LEFT JOIN ESCALA E
             ON (E.CODPUE = C.CODPUE AND E.NUMESCALA = C.NUMESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN E.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (E.FECINIREAL)
                            ELSE
                               TRUNC (E.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN E.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (E.FECINIREAL)
                             ELSE
                                TRUNC (E.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          LEFT JOIN M_MERCANCIA ME
             ON (ME.CODARAN = P.CODARAN AND ME.VERSION = P.VERCODARAN)
    WHERE P.CODARAN IN
             ('0004',
              '0005',
              '0005L',
              '0006',
              '0007',
              '0008',
              '0001',
              '0001C',
              '0001D',
              '0001E',
              '0001X')
          AND C.ESTINDEXENTA = '0'
          AND T.ESTINDEXENTA = '0'
          AND ME.ESTINDEXENTA = '0'
          AND (P.INDBAJA = '0' OR P.INDBAJA IS NULL)
          AND (   (C.TIPODECLARACION = 'D' AND E.FECINIREAL IS NOT NULL)
               OR (C.TIPODECLARACION = 'C' AND E.FECFINREAL IS NOT NULL)
               OR (C.TIPODECLARACION NOT IN ('C', 'D')));


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_PESCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_PESCA
(
   CODPUE,
   ANYO,
   CODSER,
   FECHAEST,
   TOTALKGCRUST,
   PRECIOVENTACRUST,
   TOTALKGMOLUSC,
   PRECIOVENTAMOLUSC,
   TOTALKGPECES,
   PRECIOVENTAPECES,
   TOTALKGMAMIFEROS,
   PRECIOVENTAMAMIFEROS,
   TOTALKG,
   TOTALTON,
   PRECIOVENTA
)
AS
   SELECT PE.CODPUE,
          EXTRACT (YEAR FROM PE.FECOPERACION),
          PE.CODSERVICIO,
          PE.FECOPERACION,
          PE.TOTALKGCRUST,
          PE.PRECIOVENTACRUST,
          PE.TOTALKGMOLUSC,
          PE.PRECIOVENTAMOLUSC,
          PE.TOTALKGPECES,
          PE.PRECIOVENTAPECES,
          PE.TOTALKGMAMIF,
          PE.PRECIOVENTAMAMIF,
            NVL (PE.TOTALKGCRUST, 0)
          + NVL (PE.TOTALKGMOLUSC, 0)
          + NVL (PE.TOTALKGPECES, 0)
          + NVL (PE.TOTALKGMAMIF, 0),
          (  NVL (PE.TOTALKGCRUST, 0)
           + NVL (PE.TOTALKGMOLUSC, 0)
           + NVL (PE.TOTALKGPECES, 0)
           + NVL (PE.TOTALKGMAMIF, 0))
          / 1000,
            NVL (PE.PRECIOVENTACRUST, 0)
          + NVL (PE.PRECIOVENTAMOLUSC, 0)
          + NVL (PE.PRECIOVENTAPECES, 0)
          + NVL (PE.PRECIOVENTAMAMIF, 0)
     FROM G4_PESCA PE;


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_PESCAESPECIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_PESCAESPECIE
(
   CODPUE,
   ANYOMANIF,
   CODMANIF,
   CODPARTIDA,
   FECHAEST,
   ANYO,
   CODESPECIE,
   CODFAMILIA,
   TOTALKG,
   TOTALTON,
   PRECIOVENTA
)
AS
   SELECT PA.CODPUE,
          PA.ANYO,
          PA.CODMANIF,
          PA.CODPARTIDA,
          MA.FECMANIFIESTO,
          EXTRACT (YEAR FROM MA.FECMANIFIESTO),
          PA.CODESPECIE,
          ES.CODTIPOCAPTURA,
          PA.NUMKG,
          PA.NUMKG / 1000,
          PA.IMPORTE
     FROM B4_PARTIDA PA
          INNER JOIN B4_MANIFIESTO MA
             ON (    MA.CODPUE = PA.CODPUE
                 AND MA.ANYO = PA.ANYO
                 AND MA.CODMANIF = PA.CODMANIF)
          LEFT JOIN B4_ESPECIE ES
             ON (ES.CODIGO = PA.CODESPECIE);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_RENDIMIENTOGRUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_RENDIMIENTOGRUA
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   SECUENCIAL,
   FECINICIO,
   FECFIN,
   FECHAEST,
   NUMHORAS,
   NUMTON,
   CODGRUA,
   NOMGRUA,
   CODTIPOTONELAJE,
   SERVOPARTIC,
   CODTIPOENGANCHE
)
AS
   SELECT R.CODPUE,
          R.ANYO,
          R.CODESCALA,
          R.CODESTADIA,
          R.CODOPERACION,
          R.SECUENCIAL,
          R.FECINICIO,
          R.FECFIN,
          R.FECINICIO,
          CEIL ( (R.FECFIN - R.FECINICIO) * 24),
          R.NUMTON,
          R.CODGRUA,
          G.DESCRIPCION,
          G.CODTIPOTONELAJE,
          DECODE (G.CODTIPOPROPIETARIO, '1', 'S', 'P'),
          G.CODTIPOENGANCHE
     FROM RENDIMIENTO_GRUA R LEFT JOIN M_GRUA G ON (G.CODIGO = R.CODGRUA);


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_SUMINAGUABUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_SUMINAGUABUQUE
(
   CODPUE,
   ANYO,
   CODIGO,
   FECHAEST,
   NUMTON
)
AS
   SELECT SU.CODPUE,
          SU.ANYO,
          SU.CODIGO,
          SU.FECINICIO,
          SU.CONSUMO
     FROM T8_SUMINBUQUE SU
    WHERE SU.CODTIPOSUMINISTRO = 'A'
   UNION
   SELECT TM.CODPUE,
          TM.ANYO,
          TM.CODIGO,
          TM.FECINI,
          TM.CONSUMO
     FROM TM_SERVICIO TM
    WHERE TM.TARIFA IN ('1', '2');


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_SUMINCOMB  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_SUMINCOMB
(
   CODPUE,
   ANYO,
   CODSER,
   FECHAEST,
   NUMKG,
   NUMTON
)
AS
   SELECT SC.CODPUE,
          SC.ANYO,
          SC.CODSER,
          SC.FECINICIO,
          SC.NUMKGTOTAL,
          (SC.NUMKGTOTAL / 1000)
     FROM T3_SUMINTRAFINT SC
    WHERE SC.ESTINDEXENTA = '0';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_SUMINHIELO  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_SUMINHIELO
(
   CODPUE,
   ANYO,
   CODIGO,
   FECHAEST,
   NUMTON
)
AS
   SELECT SU.CODPUE,
          SU.ANYO,
          SU.CODIGO,
          SU.FECINICIO,
          SU.CONSUMO
     FROM T8_SUMINBUQUE SU
    WHERE SU.CODTIPOSUMINISTRO = 'H'
   UNION
   SELECT SU.CODPUE,
          SU.ANYO,
          SU.CODIGO,
          SU.FECINICIO,
          SU.CONSUMO
     FROM T8_SUMINGENERICO SU
    WHERE SU.CODTIPOSUMINISTRO = 'H';


/* Formatted on 03/06/2016 9:02:46 (QP5 v5.139.911.3011) */
--
-- V_EST_SUMINOTROS  (View)
--

CREATE OR REPLACE FORCE VIEW V_EST_SUMINOTROS
(
   CODPUE,
   ANYO,
   CODIGO,
   FECHAEST,
   NUMTON
)
AS
   SELECT SU.CODPUE,
          SU.ANYO,
          SU.CODIGO,
          SU.FECINICIO,
          SU.CONSUMO
     FROM T8_SUMINBUQUE SU
    WHERE SU.CODTIPOSUMINISTRO = 'O'
   UNION
   SELECT SU.CODPUE,
          SU.ANYO,
          SU.CODIGO,
          SU.FECINICIO,
          SU.CONSUMO
     FROM T8_SUMINGENERICO SU
    WHERE SU.CODTIPOSUMINISTRO = 'O';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_FACTURAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_FACTURAS
(
   NOMBRE,
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   FECFACTURA,
   TASASTARIFAS,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   CODESTADO,
   ESTADO,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   CODEXPEDRDIRECTA,
   CODEXPEDRINDIRECTA,
   CODPESCALITORAL,
   CODPUEDP,
   CODDP,
   CODEXPAGUAINSTFIJA,
   CODEXPAGUANODP,
   CODAGUAEDR,
   CODEMBDEPBASENOAP,
   IDASPECTOTARIFA
)
AS
   SELECT DISTINCT
          (M_PUERTO_LOCAL.NOMBRE),
          LQ_FACTURA.CODPUEFACTURA,
          LQ_FACTURA.CODSERFACTURA,
          LQ_FACTURA.ANYOFACTURA,
          LQ_FACTURA.NUMFACTURA,
          LQ_FACTURA.FECFACTURA,
          LQ_FACTURA.TASASTARIFAS,
          LQ_FACTURA.IMPBASE,
          LQ_FACTURA.IMPIVA,
          LQ_FACTURA.IMPTOTAL,
          CASE
             WHEN DIVERSO_GENERICO.GUIDSRV IS NOT NULL
             THEN
                DIVERSO_GENERICO.GUIDSRV
             WHEN B4_MANIFIESTO.GUIDSRV IS NOT NULL
             THEN
                B4_MANIFIESTO.GUIDSRV
             WHEN OCUPSUP_RODANTE.GUIDSRV IS NOT NULL
             THEN
                OCUPSUP_RODANTE.GUIDSRV
             WHEN T8_SUMINBUQUE.GUIDSRV IS NOT NULL
             THEN
                T8_SUMINBUQUE.GUIDSRV
             WHEN G3_TRAMO.GUIDSRV IS NOT NULL
             THEN
                G3_TRAMO.GUIDSRV
             WHEN TM_SERVICIO.GUIDSRV IS NOT NULL
             THEN
                TM_SERVICIO.GUIDSRV
             WHEN G5_TRANSITO.GUIDSRV IS NOT NULL
             THEN
                G5_TRANSITO.GUIDSRV
             ELSE
                LQ_BORRADOR.GUIDSRV
          END,
          LQ_FACTURA.CODESTFACTURA,
          LQ_FACTURA_ESTADO.DESESTFACTURA,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.CODESTADIA,
          LQ_BORRADOR.CODEXPEDRDIRECTA,
          LQ_BORRADOR.CODEXPEDRINDIRECTA,
          LQ_BORRADOR.CODPESCALITORAL,
          LQ_BORRADOR.CODPUEDP,
          LQ_BORRADOR.CODDP,
          LQ_BORRADOR.CODEXPAGUAINSTFIJA,
          LQ_BORRADOR.CODEXPAGUANODP,
          LQ_BORRADOR.CODAGUAEDR,
          LQ_BORRADOR.CODEMBDEPBASENOAP,
          LQ_BORRADOR.IDASPECTOTARIFA
     FROM LQ_FACTURA
          INNER JOIN LQ_BORRADOR
             ON (    LQ_FACTURA.CODPUEFACTURA = LQ_BORRADOR.CODPUEFACEMIT
                 AND LQ_FACTURA.CODSERFACTURA = LQ_BORRADOR.CODSERFACEMIT
                 AND LQ_FACTURA.ANYOFACTURA = LQ_BORRADOR.ANYOFACEMIT
                 AND LQ_FACTURA.NUMFACTURA = LQ_BORRADOR.NUMFACEMIT)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_FACTURA.CODPUEFACTURA)
          INNER JOIN LQ_FACTURA_ESTADO
             ON (LQ_FACTURA.CODESTFACTURA = LQ_FACTURA_ESTADO.CODESTFACTURA)
          LEFT JOIN LQ_BORRADORAGRUPADO
             ON (LQ_BORRADORAGRUPADO.CODPUEBORRADOR = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOBORRADOR = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORAGRUPADO.CODBORRADOR =
                        LQ_BORRADOR.CODBORRADOR)
          LEFT JOIN DIVERSO_GENERICO
             ON (LQ_BORRADORAGRUPADO.CODSERVDIVERSO = DIVERSO_GENERICO.CODIGO)
          LEFT JOIN B4_MANIFIESTO
             ON (LQ_BORRADORAGRUPADO.CODPUEMANIFPESCA = B4_MANIFIESTO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOMANIFPESCA = B4_MANIFIESTO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODMANIFPESCA =
                        B4_MANIFIESTO.CODMANIF)
          LEFT JOIN TM_SERVICIO
             ON (LQ_BORRADORAGRUPADO.CODPUETMSERVICIO = TM_SERVICIO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOTMSERVICIO = TM_SERVICIO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODIGOTMSERVICIO =
                        TM_SERVICIO.CODIGO)
          LEFT JOIN OCUPSUP_RODANTE
             ON (LQ_BORRADORAGRUPADO.CODPUEOCUPSUPRODANTE =
                    OCUPSUP_RODANTE.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOOCUPSUPRODANTE =
                        OCUPSUP_RODANTE.ANYO
                 AND LQ_BORRADORAGRUPADO.CODSEROCUPSUPRODANTE =
                        OCUPSUP_RODANTE.CODSER)
          LEFT JOIN T8_SUMINBUQUE
             ON (LQ_BORRADORAGRUPADO.CODPUESUMINBUQUE = T8_SUMINBUQUE.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOSUMINBUQUE = T8_SUMINBUQUE.ANYO
                 AND LQ_BORRADORAGRUPADO.CODSUMINBUQUE = T8_SUMINBUQUE.CODIGO)
          LEFT JOIN G3_TRAMO
             ON (    LQ_BORRADORAGRUPADO.CODPUEMERC = G3_TRAMO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOMERC = G3_TRAMO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODMERC = G3_TRAMO.CODSER
                 AND LQ_BORRADORAGRUPADO.CODTRAMOMERC = G3_TRAMO.CODTRAMO)
          LEFT JOIN G5_TRANSITO
             ON (LQ_BORRADORAGRUPADO.CODPUEG5TRANSITO = G5_TRANSITO.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOG5TRANSITO = G5_TRANSITO.ANYO
                 AND LQ_BORRADORAGRUPADO.CODG5TRANSITO = G5_TRANSITO.CODSER)
   UNION
   SELECT DISTINCT (M_PUERTO_LOCAL.NOMBRE),
                   LQ_FACTURA.CODPUEFACTURA,
                   LQ_FACTURA.CODSERFACTURA,
                   LQ_FACTURA.ANYOFACTURA,
                   LQ_FACTURA.NUMFACTURA,
                   LQ_FACTURA.FECFACTURA,
                   LQ_FACTURA.TASASTARIFAS,
                   LQ_FACTURA.IMPBASE,
                   LQ_FACTURA.IMPIVA,
                   LQ_FACTURA.IMPTOTAL,
                   LQ_BORRADOR.GUIDSRV,
                   LQ_FACTURA.CODESTFACTURA,
                   LQ_FACTURA_ESTADO.DESESTFACTURA,
                   LQ_BORRADORAGRUPADO.CODPUEESCALA,
                   LQ_BORRADORAGRUPADO.ANYOESCALA,
                   LQ_BORRADORAGRUPADO.CODESCALA,
                   NULL,
                   LQ_BORRADOR.CODEXPEDRDIRECTA,
                   LQ_BORRADOR.CODEXPEDRINDIRECTA,
                   LQ_BORRADOR.CODPESCALITORAL,
                   LQ_BORRADOR.CODPUEDP,
                   LQ_BORRADOR.CODDP,
                   LQ_BORRADOR.CODEXPAGUAINSTFIJA,
                   LQ_BORRADOR.CODEXPAGUANODP,
                   LQ_BORRADOR.CODAGUAEDR,
                   LQ_BORRADOR.CODEMBDEPBASENOAP,
                   LQ_BORRADOR.IDASPECTOTARIFA
     FROM LQ_FACTURA
          INNER JOIN LQ_BORRADOR
             ON (    LQ_FACTURA.CODPUEFACTURA = LQ_BORRADOR.CODPUEFACEMIT
                 AND LQ_FACTURA.CODSERFACTURA = LQ_BORRADOR.CODSERFACEMIT
                 AND LQ_FACTURA.ANYOFACTURA = LQ_BORRADOR.ANYOFACEMIT
                 AND LQ_FACTURA.NUMFACTURA = LQ_BORRADOR.NUMFACEMIT)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_FACTURA.CODPUEFACTURA)
          INNER JOIN LQ_FACTURA_ESTADO
             ON (LQ_FACTURA.CODESTFACTURA = LQ_FACTURA_ESTADO.CODESTFACTURA)
          INNER JOIN LQ_BORRADORAGRUPADO
             ON (LQ_BORRADORAGRUPADO.CODPUEBORRADOR = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORAGRUPADO.ANYOBORRADOR = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORAGRUPADO.CODBORRADOR =
                        LQ_BORRADOR.CODBORRADOR)
    WHERE     LQ_BORRADORAGRUPADO.CODPUEESCALA IS NOT NULL
          AND LQ_BORRADORAGRUPADO.ANYOESCALA IS NOT NULL
          AND LQ_BORRADORAGRUPADO.CODESCALA IS NOT NULL
          AND LQ_BORRADORAGRUPADO.CODESTADIA IS NOT NULL;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_ATRAQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_ATRAQUE
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   NUMESCALA,
   CODESTADO,
   ESTADO,
   BUQUE,
   CODIMO,
   ESLORABUQUE,
   MANGABUQUE,
   GTBUQUE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CONSIGBUQUE,
   CIFCONSIGBUQUE,
   CODERPCONSIGBUQUE,
   FECSOLENTRADA,
   FECSOLSALIDA,
   FECAUTENTRADA,
   FECAUTSALIDA,
   FECREALENTRADA,
   FECREALSALIDA,
   CODMUELLESOLIC,
   MUELLESOLIC,
   CODMUELLEAUT,
   MUELLEAUT,
   CODMUELLEREAL,
   MUELLEREAL
)
AS
   SELECT ESTADIA.CODPUE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          ESCALA.NUMESCALA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          BU.NOMBRE,
          BU.CODIMO,
          BV.ESLORATOTAL,
          BV.MANGA,
          BV.GT,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          ESTADIA.CODMUELLEINIPREV,
          MP.DESCRIPCION,
          ESTADIA.CODMUELLEINIAUT,
          MIA.DESCRIPCION,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION
     FROM ESTADIA
          INNER JOIN ESCALA
             ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA.CODESCALA
                 AND ESTADIA.ANYO = ESCALA.ANYO)
          LEFT JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          INNER JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MP
             ON (ESTADIA.CODMUELLEINIPREV = MP.CODIGO)
          LEFT JOIN M_MUELLE MIA
             ON (ESTADIA.CODMUELLEINIAUT = MIA.CODIGO)
    WHERE     ESCALA.INDTRAFINT = '0'
          AND ESTADIA.INDTRAFINT = '0'
          AND ESTADIA.CODESTADO IN ('AC', 'AU', 'IN', 'FI');


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_BORRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_BORRADOR
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   CODTASA,
   CODSUBTASA,
   CODEXTENSION,
   TASA,
   FECBORRADOR,
   FECINICIO,
   FECFIN,
   NUMESCALA,
   IMPNETO,
   IMPIVA,
   IMPTOTAL,
   CLIENTE,
   CIFCLIENTE,
   CODERPCLIENTE,
   DESCBUQU
)
AS
   SELECT LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_TARIFA.DESCRIPCION,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.NOMBRECLIENTE,
          LQ_BORRADOR.CIFCLIENTE,
          LPAD (LQ_BORRADOR.CODAPSCTCLIENTE, 5, 0),
          LQ_BORRADOR.NOMBREBUQUE
     FROM LQ_BORRADOR
          LEFT JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO)
          LEFT JOIN LQ_TARIFA
             ON (    LQ_TARIFA.IDTARIFA = LQ_BORRADOR.IDASPECTOTARIFA
                 AND LQ_TARIFA.IDSUBTARIFA = LQ_BORRADOR.IDASPECTOSUBTARIFA
                 AND LQ_TARIFA.EXTENSION = LQ_BORRADOR.IDASPECTOEXTENSION)
    WHERE LQ_BORRADOR.CODESTADO NOT IN ('AN', 'FA');


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_CLIENTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_CLIENTE
(
   CODUSUARIO,
   CODERP,
   NOMBRECLIENTE,
   CODPUE,
   DESPUE,
   TIPODOC,
   CIFCLIENTE,
   INDBAJA,
   BAJA,
   FECBAJA,
   CODTIPUSU,
   NACIONALIDAD,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRPAIS,
   DIRPROVINCIA,
   DIRMUNICIPIO,
   DIRCODPOSTAL,
   DESCIDIOMA,
   CONTADO,
   NOTIFELECTRONICA
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          TIPO_DOCUMENTO.DESCRIPCION,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.INDBAJA,
          DECODE (M_USUARIO.INDBAJA, '1', 'Si', 'No'),
          M_USUARIO.FECBAJA,
          M_USUARIO.CODTIPUSU,
          M_USUARIO.NACIONALIDAD,
          M_USUARIO.DIRTIPOVIA,
          M_USUARIO.DIRNOMVIA,
          M_USUARIO.DIRNUMPORTAL,
          M_USUARIO.DIRESCALERA,
          M_USUARIO.DIRPISO,
          M_USUARIO.DIRPUERTA,
          M_USUARIO.DIRPAIS,
          M_USUARIO.DIRPROVINCIA,
          M_USUARIO.DIRMUNICIPIO,
          M_USUARIO.DIRCODPOSTAL,
          GU_IDIOMA.DESCIDIOMA,
          DECODE (M_USUARIO.INDCONTADO, '1', 'Si', 'No'),
          DECODE (M_USUARIO.INDNOTIFELECTRONICA, '1', 'Si', 'No')
     FROM M_USUARIO
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL
             ON (M_USUARIO_PUERTO.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN TIPO_DOCUMENTO
             ON (M_USUARIO.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO)
          LEFT JOIN GU_IDIOMA
             ON (M_USUARIO.IDIOMA = GU_IDIOMA.CODIDIOMA)
    WHERE M_USUARIO.INDBAJA = '0' OR M_USUARIO.INDBAJA IS NULL;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_CLIENTETIPOUSUARIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_CLIENTETIPOUSUARIO
(
   CODUSUARIO,
   CODERP,
   NOMBRECLIENTE,
   CODPUE,
   DESPUE,
   TIPODOC,
   CIFCLIENTE,
   INDBAJA,
   BAJA,
   FECBAJA,
   CODTIPUSU,
   NACIONALIDAD,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRPAIS,
   DIRPROVINCIA,
   DIRMUNICIPIO,
   DIRCODPOSTAL,
   DESCIDIOMA,
   CONTADO,
   NOTIFELECTRONICA,
   CODTIPOUSUARIO,
   TIPOUSUARIO
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          TIPO_DOCUMENTO.DESCRIPCION,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.INDBAJA,
          DECODE (M_USUARIO.INDBAJA, '1', 'Si', 'No'),
          M_USUARIO.FECBAJA,
          M_USUARIO.CODTIPUSU,
          M_USUARIO.NACIONALIDAD,
          M_USUARIO.DIRTIPOVIA,
          M_USUARIO.DIRNOMVIA,
          M_USUARIO.DIRNUMPORTAL,
          M_USUARIO.DIRESCALERA,
          M_USUARIO.DIRPISO,
          M_USUARIO.DIRPUERTA,
          M_USUARIO.DIRPAIS,
          M_USUARIO.DIRPROVINCIA,
          M_USUARIO.DIRMUNICIPIO,
          M_USUARIO.DIRCODPOSTAL,
          GU_IDIOMA.DESCIDIOMA,
          DECODE (M_USUARIO.INDCONTADO, '1', 'Si', 'No'),
          DECODE (M_USUARIO.INDNOTIFELECTRONICA, '1', 'Si', 'No'),
          M_USUARIO_TIPOUSUARIO.CODTIPUSUARIO,
          TIPO_USUARIO.DESCRIPCION
     FROM M_USUARIO
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL
             ON (M_USUARIO_PUERTO.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN TIPO_DOCUMENTO
             ON (M_USUARIO.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO)
          LEFT JOIN GU_IDIOMA
             ON (M_USUARIO.IDIOMA = GU_IDIOMA.CODIDIOMA)
          INNER JOIN M_USUARIO_TIPOUSUARIO
             ON (M_USUARIO.CODUSUARIO = M_USUARIO_TIPOUSUARIO.CODUSUARIO)
          INNER JOIN TIPO_USUARIO
             ON (TIPO_USUARIO.CODTIPUSUARIO =
                    M_USUARIO_TIPOUSUARIO.CODTIPUSUARIO)
    WHERE M_USUARIO.INDBAJA = '0' OR M_USUARIO.INDBAJA IS NULL;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_ESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_ESCALA
(
   CODPUE,
   ANYO,
   CODESCALA,
   NUMESCALA,
   CODESTADO,
   ESTADO,
   BUQUE,
   CODIMO,
   ESLORABUQUE,
   MANGABUQUE,
   GTBUQUE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CONSIGBUQUE,
   CIFCONSIGBUQUE,
   CODERPCONSIGBUQUE,
   ETA,
   ETD,
   FECINIREAL,
   FECFINREAL
)
AS
   SELECT ESCALA.CODPUE,
          ESCALA.ANYO,
          ESCALA.CODESCALA,
          ESCALA.NUMESCALA,
          ESCALA.CODESTADO,
          ESTADO_ESCALA.NOMBRE,
          BU.NOMBRE,
          BU.CODIMO,
          BV.ESLORATOTAL,
          BV.MANGA,
          BV.GT,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          ESCALA.ETA,
          ESCALA.ETD,
          ESCALA.FECINIREAL,
          ESCALA.FECFINREAL
     FROM ESCALA
          INNER JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL
             ON (ESCALA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN ESTADO_ESCALA
             ON (ESCALA.CODESTADO = ESTADO_ESCALA.CODESTADO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
    WHERE ESCALA.INDTRAFINT = '0'
          AND ESCALA.CODESTADO IN ('AC', 'AU', 'IN', 'FI', 'LD');


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_OPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_OPERACION
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   NUMESCALA,
   CODESTADO,
   ESTADO,
   BUQUE,
   CODIMO,
   ESLORABUQUE,
   MANGABUQUE,
   GTBUQUE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CONSIGBUQUE,
   CIFCONSIGBUQUE,
   CODERPCONSIGBUQUE,
   FECSOLENTRADA,
   FECSOLSALIDA,
   FECAUTENTRADA,
   FECAUTSALIDA,
   FECREALENTRADA,
   FECREALSALIDA,
   CODMUELLESOLIC,
   MUELLESOLIC,
   CODMUELLEAUT,
   MUELLEAUT,
   CODMUELLEREAL,
   MUELLEREAL,
   FECINIOP,
   FECFINOP,
   TIPOOPERACION,
   CODTIPOOPERACION,
   LUGAR,
   TERMINAL,
   CODTIPOCARGA,
   TIPOCARGA,
   CANTIDAD
)
AS
   SELECT OPERACION.CODPUE,
          OPERACION.ANYO,
          OPERACION.CODESCALA,
          OPERACION.CODESTADIA,
          OPERACION.CODOPERACION,
          ESCALA.NUMESCALA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          BU.NOMBRE,
          BU.CODIMO,
          BV.ESLORATOTAL,
          BV.MANGA,
          BV.GT,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          ESTADIA.CODMUELLEINIPREV,
          MP.DESCRIPCION,
          ESTADIA.CODMUELLEINIAUT,
          MIA.DESCRIPCION,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION,
          OPERACION.FECINI,
          OPERACION.FECFIN,
          TIPO_OPERACION.NOMBRE,
          OPERACION.CODTIPOPE,
          OPERACION.LUGAR,
          OPERACION.TERMINAL,
          OPERACION.CODTIPCARGA,
          TIPO_CARGA_OPERACION.NOMBRE,
          OPERACION.NUMUNIDADES
     FROM OPERACION
          INNER JOIN ESTADIA
             ON (    OPERACION.CODPUE = ESTADIA.CODPUE
                 AND OPERACION.ANYO = ESTADIA.ANYO
                 AND OPERACION.CODESCALA = ESTADIA.CODESCALA
                 AND OPERACION.CODESTADIA = ESTADIA.CODESTADIA)
          INNER JOIN ESCALA
             ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA.CODESCALA
                 AND ESTADIA.ANYO = ESCALA.ANYO)
          LEFT JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          INNER JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MP
             ON (ESTADIA.CODMUELLEINIPREV = MP.CODIGO)
          LEFT JOIN M_MUELLE MIA
             ON (ESTADIA.CODMUELLEINIAUT = MIA.CODIGO)
          INNER JOIN TIPO_OPERACION
             ON (TIPO_OPERACION.CODTIPOPE = OPERACION.CODTIPOPE)
          LEFT JOIN TIPO_CARGA_OPERACION
             ON (TIPO_CARGA_OPERACION.CODTIPCARGA = OPERACION.CODTIPCARGA)
    WHERE     ESCALA.INDTRAFINT = '0'
          AND ESTADIA.INDTRAFINT = '0'
          AND ESTADIA.CODESTADO IN ('AC', 'AU', 'IN', 'FI')
          AND TIPO_OPERACION.INDDUE = '1';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GEXP_TRAMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_GEXP_TRAMO
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMESCALA,
   NUMMANIFIESTO,
   CODTIPOOPERACION,
   TIPOOPERACION,
   BUQUE,
   CODIMO,
   ESLORABUQUE,
   MANGABUQUE,
   GTBUQUE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CONSIGMERCANCIA,
   CIFCONSIGMERCANCIA,
   CODERPCONSIGMERCANCIA,
   CODMUELLETRAMO,
   MUELLETRAMO,
   REGIMEN
)
AS
   SELECT G3_TRAMO.CODPUE,
          G3_TRAMO.ANYO,
          G3_TRAMO.CODSER,
          G3_TRAMO.CODTRAMO,
          ESCALA.NUMESCALA,
          G3_CABECERA.NUMDECLARACION,
          G3_CABECERA.TIPODECLARACION,
          G3_TIPOCABECERA.DESCRIPCION,
          BU.NOMBRE,
          BU.CODIMO,
          BV.ESLORATOTAL,
          BV.MANGA,
          BV.GT,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          G3_TRAMO.CODMUELLE,
          M_MUELLE.DESCRIPCION,
          DECODE (G3_TRAMO.INDREGSIMPLIF, '1', 'Simplificado', 'Grupos')
     FROM G3_TRAMO
          INNER JOIN G3_CABECERA
             ON (    G3_TRAMO.CODPUE = G3_CABECERA.CODPUE
                 AND G3_TRAMO.ANYO = G3_CABECERA.ANYO
                 AND G3_TRAMO.CODSER = G3_CABECERA.CODSER)
          INNER JOIN ESCALA
             ON (ESCALA.CODPUE = G3_CABECERA.CODPUE
                 AND ESCALA.NUMESCALA = G3_CABECERA.NUMESCALA)
          INNER JOIN M_USUARIO
             ON (G3_TRAMO.IDCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          INNER JOIN G3_TIPOCABECERA
             ON (G3_TIPOCABECERA.CODIGO = G3_CABECERA.TIPODECLARACION)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = G3_TRAMO.CODMUELLE)
    WHERE G3_CABECERA.TIPODECLARACION <> 'T';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GIS_ESCALAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_GIS_ESCALAS
(
   AUTPOR,
   SUBESC,
   ANYESC,
   CODESC,
   CODATR,
   CODPAIORG,
   NOMPAIORG,
   CODPTOORG,
   NOMPTOORG,
   CODPAIDST,
   NOMPAIDST,
   CODPTODST,
   NOMPTODST,
   TIPEST,
   ESTATR,
   NAV,
   SUBCSG,
   CODCSG,
   NOMCSG,
   GRU,
   FECATR,
   HORATR,
   FECSAL,
   HORSAL,
   CODMUE,
   NOMMUE,
   TIPATR,
   DIRATR,
   NORINI,
   NORFIN,
   CODBUQ,
   NOMBUQ,
   TIPBUQ,
   DESTIPBUQ,
   BAN,
   CALENT,
   CALREA,
   MNG,
   ESL,
   GT,
   MMPP,
   LINREG,
   LLOYDS,
   ZONFON
)
AS
   SELECT '26' AS AUTPOR,
          ATR.CODPUE AS SUBESC,
          ATR.ANYO AS ANYESC,
          ATR.CODESCALA AS CODESC,
          ATR.CODESTADIA AS CODATR,
          ESC.CODPAIORIGEN AS CODPAIORG,
          PAIS_ORIGEN.NOMBRE AS NOMPAIORG,
          ESC.CODPUEORIGEN AS CODPTOORG,
          PUERTO_ORIGEN.NOMBRE AS NOMPTOORG,
          ESC.CODPAIDESTINO AS CODPAIDST,
          PAIS_DESTINO.NOMBRE AS NOMPAIDST,
          ESC.CODPUEDESTINO AS CODPTODST,
          PUERTO_DESTINO.NOMBRE AS NOMPTODST,
          'C' AS TIPEST,                                     -- ESTANCIA CORTA
          CASE
             WHEN ATR.CODESTADO = 'AC' THEN 'S'                  -- SOLICITADO
             WHEN ATR.CODESTADO = 'AU' THEN 'C'                   -- CONCEDIDO
             WHEN ATR.CODESTADO = 'IN' THEN 'I'                    -- INICIADO
             WHEN ATR.CODESTADO = 'FI' THEN 'F'                  -- FINALIZADO
             WHEN ATR.CODESTADO = 'AN' THEN 'A'                     -- ANULADO
             ELSE ''
          END
             AS ESTATR,
          CASE WHEN ESC.INDNAVINT = '1' THEN 'E' ELSE 'C' END,
          ATR.CODPUE AS SUBCSG,
          ESC.CODCONSIGNATARIO AS CODCSG,
          CSG.NOMBRECOMPLETO AS NOMCSG,
          NULL AS GRU,
          CASE
             WHEN ATR.CODESTADO = 'AC'
             THEN
                TO_CHAR (ATR.FECATRAQUEPREV, 'dd/mm/yyyy')
             WHEN ATR.CODESTADO = 'AU'
             THEN
                TO_CHAR (ATR.FECINIAUT, 'dd/mm/yyyy')
             ELSE
                TO_CHAR (ATR.FECATRAQUEREAL, 'dd/mm/yyyy')
          END
             AS FECATR,
          CASE
             WHEN ATR.CODESTADO = 'AC'
             THEN
                TO_CHAR (ATR.FECATRAQUEPREV, 'hh24:mi')
             WHEN ATR.CODESTADO = 'AU'
             THEN
                TO_CHAR (ATR.FECINIAUT, 'hh24:mi')
             ELSE
                TO_CHAR (ATR.FECATRAQUEREAL, 'hh24:mi')
          END
             AS HORATR,
          CASE
             WHEN ATR.CODESTADO = 'AC'
             THEN
                TO_CHAR (ATR.FECDESATRAQUEPREV, 'dd/mm/yyyy')
             WHEN ATR.CODESTADO = 'AU'
             THEN
                TO_CHAR (ATR.FECFINAUT, 'dd/mm/yyyy')
             ELSE
                TO_CHAR (ATR.FECDESATRAQUEREAL, 'dd/mm/yyyy')
          END
             AS FECSAL,
          CASE
             WHEN ATR.CODESTADO = 'AC'
             THEN
                TO_CHAR (ATR.FECDESATRAQUEPREV, 'hh24:mi')
             WHEN ATR.CODESTADO = 'AU'
             THEN
                TO_CHAR (ATR.FECFINAUT, 'hh24:mi')
             ELSE
                TO_CHAR (ATR.FECDESATRAQUEREAL, 'hh24:mi')
          END
             AS HORSAL,
          CASE
             WHEN ATR.CODESTADO = 'AC' THEN ATR.CODMUELLEINIPREV
             WHEN ATR.CODESTADO = 'AU' THEN ATR.CODMUELLEINIAUT
             ELSE ATR.CODMUELLEINIREAL
          END
             AS CODMUE,
          MUE.DESCRIPCION AS NOMMUE,
          CASE
             WHEN FATR.INDCOSTADOB1 = '1' THEN 'C'               -- DE COSTADO
             WHEN FATR.INDFONDEO = '1' THEN 'F'                    -- FONDEADO
             WHEN FATR.CODTIPATRAQUE LIKE 'A%' THEN 'A'           -- ABARLOADO
             WHEN FATR.CODTIPATRAQUE LIKE 'Y%' THEN 'B'              -- A BOYA
             ELSE 'O'                                                 -- OTROS
          END
             AS TIPATR,
          CASE
             WHEN FATR.INDCOSTADOB1 = '1' THEN FATR.BABORESTRIBOR
             ELSE NULL
          END
             AS DIRATR,
          CASE
             WHEN ATR.CODESTADO = 'AC' THEN ATR.NORAYINIPREV
             WHEN ATR.CODESTADO = 'AU' THEN ATR.NORAYINIAUT
             ELSE ATR.NORAYINIREAL
          END
             AS NORINI,
          CASE
             WHEN ATR.CODESTADO = 'AC' THEN ATR.NORAYFINPREV
             WHEN ATR.CODESTADO = 'AU' THEN ATR.NORAYFINAUT
             ELSE ATR.NORAYFINREAL
          END
             AS NORFIN,
          BU.CODIMO AS CODBUQ,
          BU.NOMBRE AS NOMBUQ,
          TBG.CODTIPOBUQUEGIS AS TIPBUQ,
          TB.DESCRIPCION AS DESTIPBUQ,
          PAIS_BANDERA.NOMBRE AS BAN,
          ATR.CALADOENTRADA AS CALENT,
          BV.CALMAXIMO AS CALREA,
          BV.MANGA AS MNG,
          BV.ESLORATOTAL AS ESL,
          BV.GT AS GT,
          ESC.INDMMPPABORDO AS MMPP,
          CASE WHEN SRV.INDREGULAR = '1' THEN 'S' ELSE 'N' END AS LINREG,
          BV.CALLSIGN AS LLOYDS,
          MUE.CODZONAAGUA AS ZONFON
     FROM ESTADIA ATR
          LEFT JOIN ESCALA ESC
             ON     ATR.CODPUE = ESC.CODPUE
                AND ATR.ANYO = ESC.ANYO
                AND ATR.CODESCALA = ESC.CODESCALA
          LEFT JOIN M_PUERTO PUERTO_ORIGEN
             ON ESC.CODPAIORIGEN = PUERTO_ORIGEN.CODPAIS
                AND ESC.CODPUEORIGEN = PUERTO_ORIGEN.CODPUE
          LEFT JOIN M_PAIS PAIS_ORIGEN
             ON PUERTO_ORIGEN.CODPAIS = PAIS_ORIGEN.CODPAIS
          LEFT JOIN M_PUERTO PUERTO_DESTINO
             ON ESC.CODPAIDESTINO = PUERTO_DESTINO.CODPAIS
                AND ESC.CODPUEDESTINO = PUERTO_DESTINO.CODPUE
          LEFT JOIN M_PAIS PAIS_DESTINO
             ON PUERTO_DESTINO.CODPAIS = PAIS_DESTINO.CODPAIS
          LEFT JOIN TIPO_ACTIV_ESTADIA ACT
             ON (ATR.CODESTADO = 'AU' AND ATR.CODTIPACTIVIDAD = ACT.CODIGO)
                OR (ATR.CODESTADO IN ('IN', 'FI')
                    AND ATR.CODTIPACTIVREAL = ACT.CODIGO)
          LEFT JOIN TIPO_PRESTACIONBUQUE PREST
             ON ACT.CODTIPOPREST = PREST.CODIGO
          LEFT JOIN M_USUARIO CSG
             ON ESC.CODCONSIGNATARIO = CSG.CODUSUARIO
          LEFT JOIN M_MUELLE MUE
             ON (ATR.CODESTADO = 'AU' AND ATR.CODMUELLEINIAUT = MUE.CODIGO)
                OR (ATR.CODMUELLEINIREAL = MUE.CODIGO)
          LEFT JOIN FORMA_ATRAQUE FATR
             ON (ATR.CODESTADO = 'AU'
                 AND ATR.CODTIPATRAQUEAUT = FATR.CODTIPATRAQUE)
                OR (ATR.CODTIPATRAQUEREAL = FATR.CODTIPATRAQUE)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESC.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESC.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESC.FECINIREAL)
                            ELSE
                               TRUNC (ESC.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESC.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESC.FECINIREAL)
                             ELSE
                                TRUNC (ESC.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          LEFT JOIN TIPO_BUQUE_GIS TBG
             ON TB.CODTIPOBUQUE = TBG.CODTIPOBUQUE
          LEFT JOIN M_PAIS PAIS_BANDERA
             ON BV.BANDERA = PAIS_BANDERA.CODPAIS
          LEFT JOIN M_SERVICIOMARITIMO SRV
             ON ESC.CODSERVMARIT = SRV.CODSERVICIO
    WHERE     ATR.CODESTADO IN ('AU', 'IN', 'FI', 'AN')
          AND (MUE.CODIGO NOT BETWEEN '201' AND '299')
          AND BV.CODTIPOBUQUE NOT IN ('AF', 'BG', 'OB', 'PA', 'PL', 'OA');


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GIS_OPERACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_GIS_OPERACIONES
(
   AUTPOR,
   SUBESC,
   ANYESC,
   CODESC,
   CODATR,
   NUMOPE,
   CODOPE,
   NOMOPE,
   SUBEST,
   CODEST,
   NOMEST,
   MER,
   TON
)
AS
   SELECT '26' AS AUTPOR,
          OPE.CODPUE AS SUBESC,
          OPE.ANYO AS ANYESC,
          OPE.CODESCALA AS CODESC,
          OPE.CODESTADIA AS CODATR,
          OPE.CODOPERACION AS NUMOPE,
          OPE.CODOPERACION AS CODOPE,
          TOPE.NOMBRE AS NOMOPE,
          OPE.CODPUE AS SUBEST,
          NULL AS CODEST,
          OPE.TERMINAL AS NOMEST,
          TCOPE.NOMBRE AS MER,
          OPE.NUMUNIDADES AS TON
     FROM OPERACION OPE
          LEFT JOIN TIPO_OPERACION TOPE
             ON OPE.CODTIPOPE = TOPE.CODTIPOPE
          LEFT JOIN TIPO_CARGA_OPERACION TCOPE
             ON OPE.CODTIPCARGA = TCOPE.CODTIPCARGA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GP_ESTADIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_GP_ESTADIA
(
   CODPUE,
   ANYO,
   CODESCALA,
   BUQUE,
   TIPOBUQUE,
   IMO,
   BANDERA,
   GT,
   MANGA,
   ESLORATOTAL,
   NUMESCALA,
   PUERTO,
   CODESTADIA,
   CODESTADO,
   ESTADO,
   CODAPSCT,
   CIF,
   CONSIGNATARIO,
   PAISORIGEN,
   PUERTOORIGEN,
   PAISDESTINO,
   PUERTODESTINO,
   CALADOLLEGADA,
   CALADOSALIDA,
   FECATRAQUESOL,
   FECDESATRAQUESOL,
   CODTIPOATRAQUESOL,
   TIPOATRAQUESOL,
   CODMUELLESOL,
   MUELLESOL,
   FECATRAQUEPLA,
   FECDESTRAQUEPLA,
   CODTIPOATRAQUEPLA,
   TIPOATRAQUEPLA,
   CODMUELLEPLA,
   MUELLEPLA,
   NORAYINIPLA,
   NORAYFINPLA,
   FECATRAQUEAUT,
   FECDESATRAQUEAUT,
   CODTIPOATRAQUEAUT,
   TIPOATRAQUEAUT,
   CODMUELLEAUT,
   MUELLEAUT,
   NORAYINIAUT,
   NORAYFINAUT,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   CODTIPOATRAQUEREAL,
   TIPOATRAQUEREAL,
   CODMUELLEREAL,
   MUELLEREAL,
   NORAYINIREAL,
   NORAYFINREAL,
   ARMADOR
)
AS
   SELECT ESTADIA.CODPUE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          BU.NOMBRE,
          TB.DESCRIPCION,
          BU.CODIMO,
          BAN.NOMBRE,
          BV.GT,
          BV.MANGA,
          BV.ESLORATOTAL,
          ESCALA.NUMESCALA,
          M_PUERTO_LOCAL.NOMBRE,
          ESTADIA.CODESTADIA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          PAO.NOMBRE,
          PO.NOMBRE,
          PAD.NOMBRE,
          PD.NOMBRE,
          ESTADIA.CALADOENTRADA,
          ESTADIA.CALADOSALIDA,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          ESTADIA.CODTIPATRAQUEPREV,
          FATRQPREV.DESCRIPCION,
          ESTADIA.CODMUELLEINIPREV,
          MINIPREV.DESCRIPCION,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          ESTADIA.CODTIPATRAQUEAUT,
          FATRQAUT.DESCRIPCION,
          ESTADIA.CODMUELLEINIAUT,
          MINIAUT.DESCRIPCION,
          ESTADIA.NORAYINIAUT,
          ESTADIA.NORAYFINAUT,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          ESTADIA.CODTIPATRAQUEREAL,
          FATRQREAL.DESCRIPCION,
          ESTADIA.CODMUELLEINIREAL,
          MINIREAL.DESCRIPCION,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          AR.NOMBRECOMPLETO
     FROM ESTADIA
          LEFT JOIN FORMA_ATRAQUE FATRQPREV
             ON (ESTADIA.CODTIPATRAQUEPREV = FATRQPREV.CODTIPATRAQUE)
          LEFT JOIN FORMA_ATRAQUE FATRQREAL
             ON (ESTADIA.CODTIPATRAQUEREAL = FATRQREAL.CODTIPATRAQUE)
          LEFT JOIN FORMA_ATRAQUE FATRQAUT
             ON (ESTADIA.CODTIPATRAQUEAUT = FATRQAUT.CODTIPATRAQUE)
          LEFT JOIN M_MUELLE MINIREAL
             ON (ESTADIA.CODMUELLEINIREAL = MINIREAL.CODIGO)
          LEFT JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MINIPREV
             ON (ESTADIA.CODMUELLEINIPREV = MINIPREV.CODIGO)
          LEFT JOIN M_MUELLE MINIAUT
             ON (ESTADIA.CODMUELLEINIAUT = MINIAUT.CODIGO)
          INNER JOIN ESCALA
             ON (    ESCALA.CODPUE = ESTADIA.CODPUE
                 AND ESCALA.ANYO = ESTADIA.ANYO
                 AND ESCALA.CODESCALA = ESTADIA.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          LEFT JOIN M_USUARIO AR
             ON (AR.CODUSUARIO = BV.CODARMADOR)
          LEFT JOIN M_PAIS BAN
             ON (BV.BANDERA = BAN.CODPAIS)
          INNER JOIN M_PUERTO_LOCAL
             ON (ESTADIA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_PAIS PAO
             ON (PAO.CODPAIS = ESCALA.CODPAIORIGENDEC)
          LEFT JOIN M_PUERTO PO
             ON (PO.CODPAIS = ESCALA.CODPAIORIGENDEC
                 AND PO.CODPUE = ESCALA.CODPUEORIGENDEC)
          LEFT JOIN M_PAIS PAD
             ON (PAD.CODPAIS = ESCALA.CODPAIDESTINODEC)
          LEFT JOIN M_PUERTO PD
             ON (PD.CODPAIS = ESCALA.CODPAIDESTINODEC
                 AND PD.CODPUE = ESCALA.CODPUEDESTINODEC);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_GP_OPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_GP_OPERACION
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODOPERACION,
   BUQUE,
   TIPOBUQUE,
   IMO,
   BANDERA,
   GT,
   MANGA,
   ESLORATOTAL,
   NUMESCALA,
   PUERTO,
   CODESTADIA,
   CODESTADO,
   ESTADO,
   CODAPSCT,
   CIF,
   CONSIGNATARIO,
   PAISORIGEN,
   PUERTOORIGEN,
   PAISDESTINO,
   PUERTODESTINO,
   CALADOLLEGADA,
   CALADOSALIDA,
   FECATRAQUESOL,
   FECDESATRAQUESOL,
   TIPOATRAQUESOL,
   MUELLESOL,
   FECATRAQUEPLA,
   FECDESTRAQUEPLA,
   TIPOATRAQUEPLA,
   MUELLEPLA,
   NORAYINIPLA,
   NORAYFINPLA,
   FECATRAQUEAUT,
   FECDESATRAQUEAUT,
   TIPOATRAQUEAUT,
   MUELLEAUT,
   NORAYINIAUT,
   NORAYFINAUT,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   TIPOATRAQUEREAL,
   MUELLEREAL,
   NORAYINIREAL,
   NORAYFINREAL,
   FECINIOPE,
   FECFINOPE,
   TIPOOPERACION,
   TIPOCARGA,
   CANTIDAD,
   MEDIO,
   TIPOUNIDAD,
   ARMADOR
)
AS
   SELECT OPERACION.CODPUE,
          OPERACION.ANYO,
          OPERACION.CODESCALA,
          OPERACION.CODOPERACION,
          ESCALA_FTBUQUE.NOMBRE,
          TIPO_BUQUE.DESCRIPCION,
          ESCALA_FTBUQUE.CODIMO,
          BAN.NOMBRE,
          ESCALA_FTBUQUE.GT,
          ESCALA_FTBUQUE.MANGA,
          ESCALA_FTBUQUE.ESLORATOTAL,
          ESCALA.NUMESCALA,
          M_PUERTO_LOCAL.NOMBRE,
          ESTADIA.CODESTADIA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          PAO.NOMBRE,
          PO.NOMBRE,
          PAD.NOMBRE,
          PD.NOMBRE,
          ESTADIA.CALADOENTRADA,
          ESTADIA.CALADOSALIDA,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          FATRQPREV.DESCRIPCION,
          MINIPREV.DESCRIPCION,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          NULL,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          NULL,
          MINIAUT.DESCRIPCION,
          ESTADIA.NORAYINIAUT,
          ESTADIA.NORAYFINAUT,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          FATRQREAL.DESCRIPCION,
          MINIREAL.DESCRIPCION,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          OPERACION.FECINI,
          OPERACION.FECFIN,
          TIPO_OPERACION.NOMBRE,
          TIPO_CARGA_OPERACION.NOMBRE,
          OPERACION.NUMUNIDADES,
          TIPO_MEDIO_MANIPULACION.NOMBRE,
          TIPO_UNIDAD_OPERACION.NOMBRE,
          ESCALA_FTBUQUE.NOMBREARMADOR
     FROM OPERACION
          INNER JOIN ESTADIA
             ON (    OPERACION.CODPUE = ESTADIA.CODPUE
                 AND OPERACION.ANYO = ESTADIA.ANYO
                 AND OPERACION.CODESCALA = ESTADIA.CODESCALA
                 AND OPERACION.CODESTADIA = ESTADIA.CODESTADIA)
          LEFT JOIN FORMA_ATRAQUE FATRQPREV
             ON (ESTADIA.CODTIPATRAQUEPREV = FATRQPREV.CODTIPATRAQUE)
          LEFT JOIN FORMA_ATRAQUE FATRQREAL
             ON (ESTADIA.CODTIPATRAQUEREAL = FATRQREAL.CODTIPATRAQUE)
          LEFT JOIN M_MUELLE MINIREAL
             ON (ESTADIA.CODMUELLEINIREAL = MINIREAL.CODIGO)
          LEFT JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MINIPREV
             ON (ESTADIA.CODMUELLEINIPREV = MINIPREV.CODIGO)
          LEFT JOIN M_MUELLE MINIAUT
             ON (ESTADIA.CODMUELLEINIAUT = MINIAUT.CODIGO)
          INNER JOIN ESCALA
             ON (    ESCALA.CODPUE = ESTADIA.CODPUE
                 AND ESCALA.ANYO = ESTADIA.ANYO
                 AND ESCALA.CODESCALA = ESTADIA.CODESCALA)
          INNER JOIN ESCALA_FTBUQUE
             ON (    ESCALA.CODPUE = ESCALA_FTBUQUE.CODPUE
                 AND ESCALA.ANYO = ESCALA_FTBUQUE.ANYO
                 AND ESCALA.CODESCALA = ESCALA_FTBUQUE.CODESCALA)
          INNER JOIN TIPO_BUQUE
             ON (ESCALA_FTBUQUE.CODTIPBUQUE = TIPO_BUQUE.CODTIPOBUQUE)
          LEFT JOIN M_PAIS BAN
             ON (ESCALA_FTBUQUE.BANDERA = BAN.CODPAIS)
          INNER JOIN M_PUERTO_LOCAL
             ON (ESTADIA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_PAIS PAO
             ON (PAO.CODPAIS = ESCALA.CODPAIORIGENDEC)
          LEFT JOIN M_PUERTO PO
             ON (PO.CODPAIS = ESCALA.CODPAIORIGENDEC
                 AND PO.CODPUE = ESCALA.CODPUEORIGENDEC)
          LEFT JOIN M_PAIS PAD
             ON (PAD.CODPAIS = ESCALA.CODPAIDESTINODEC)
          LEFT JOIN M_PUERTO PD
             ON (PD.CODPAIS = ESCALA.CODPAIDESTINODEC
                 AND PD.CODPUE = ESCALA.CODPUEDESTINODEC)
          INNER JOIN TIPO_OPERACION
             ON OPERACION.CODTIPOPE = TIPO_OPERACION.CODTIPOPE
          LEFT JOIN TIPO_CARGA_OPERACION
             ON OPERACION.CODTIPCARGA = TIPO_CARGA_OPERACION.CODTIPCARGA
          LEFT JOIN TIPO_MEDIO_MANIPULACION
             ON OPERACION.CODTIPMEDIOMANIP =
                   TIPO_MEDIO_MANIPULACION.CODTIPMEDIO
          LEFT JOIN TIPO_UNIDAD_OPERACION
             ON OPERACION.CODTIPUNIDAD = TIPO_UNIDAD_OPERACION.CODTIPUNIDAD
    WHERE TIPO_OPERACION.INDDUE = '1';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_INT_BORRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_INT_BORRADOR
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   IDCLIENTE,
   CODTIPO,
   FECLIQ,
   FECINISER,
   FECFINSER,
   NOMBRECLIENTE,
   CIFCLIENTE,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   CODTIPIMPUESTO,
   CONCEPTO,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODPUEMERC,
   ANYOMERC,
   CODMERC,
   CODTRAMOMERC,
   OBSERVACIONES,
   GUIDSRV,
   FECALTA,
   FECMODIF,
   USRALTA,
   USRMODIF,
   INDMANUAL,
   INDPASADOAE,
   NUMEROAE,
   INDRECEPCIONAE,
   INDRECHAZOAE,
   MOTRECHAZOAE,
   FECRECEPCIONAE,
   CODAPSCTCLIENTE,
   NOMBREBUQUE,
   GTBUQUE,
   IMOBUQUE,
   NUMESCALA,
   NUMDECLARACION,
   TIPOOPERACION,
   IDPROCESO,
   IDPROCESOFACT,
   ESLORABUQUE,
   CODESTADIA,
   INDDESGLOSECOEF,
   INDIMPORTECERO,
   NUMREVESCALA,
   NUMVERSIONTRAMO,
   INDIGICMODIFICADO,
   CODEXPEDRDIRECTA,
   CODEXPEDRINDIRECTA,
   CODPUEDP,
   CODDP,
   CODPESCALITORAL,
   MATRICULAEMB,
   NOMBREEMB,
   EXPEDIENTEDP,
   NUMCONTADOR,
   CODEXPAGUAINSTFIJA,
   INDBLOQPORAE,
   CODEXPAGUANODP,
   M3AGUACONSUMO,
   M3AGUAFACTURADOS,
   CODAGUAEDR,
   OBJETODP,
   CODEMBDEPBASENOAP,
   CODESTADO,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   IDASPECTO,
   CODPUELOTE,
   CODLOTE,
   CODPUEFACEMIT,
   ANYOFACEMIT,
   CODSERFACEMIT,
   NUMFACEMIT,
   CODPUEFACANUL,
   ANYOFACANUL,
   CODSERFACANUL,
   NUMFACANUL,
   ANUM1C,
   ANUM2C,
   ANUM3C,
   ANUM4C,
   ANUM5C,
   ANUM6C,
   ANUM7C,
   ANUM8C,
   ANUM9C,
   ANUM10C,
   NUM1C,
   NUM2C,
   NUM3C,
   NUM4C,
   NUM5C,
   NUM6C,
   NUM7C,
   NUM8C,
   NUM9C,
   NUM10C,
   CODSERFACTURA,
   IDIOMACLIENTE,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRPAIS,
   DIRPROVINCIA,
   DIRMUNICIPIO,
   DIRCODPOSTAL,
   INDCONTADO,
   INDNOTIFELECTRONICA,
   CODTIPOSUJETO,
   INDMULTIIVA,
   CODPUEBIENPUBLICO,
   CODBIENPUBLICO,
   CODPUEAPAC,
   FACANULSERIETXT,
   FACANULANYOTXT,
   FACANULNUMTXT,
   INDMODIFMANUAL,
   USUARIOMODIFMANUAL,
   FECMODIFMANUAL,
   CODLIQSIGMA,
   INDBLOQUEADO,
   MATBUQUEPESQUERO,
   NOMBUQUEPESQUERO,
   IDTARIFAERP,
   IDSUBTARIFAERP,
   EXTENSIONERP
)
AS
     SELECT T.CODPUE,
            T.ANYO,
            T.CODBORRADOR,
            T.IDCLIENTE,
            T.CODTIPO,
            T.FECLIQ,
            T.FECINISER,
            T.FECFINSER,
            T.NOMBRECLIENTE,
            T.CIFCLIENTE,
            T.IMPNET,
            T.IMPIMPUESTO,
            T.IMPTOT,
            T.CODTIPIMPUESTO,
            T.CONCEPTO,
            T.CODPUEESC,
            T.ANYOESC,
            T.CODESC,
            T.CODPUEMERC,
            T.ANYOMERC,
            T.CODMERC,
            T.CODTRAMOMERC,
            T.OBSERVACIONES,
            T.GUIDSRV,
            T.FECALTA,
            T.FECMODIF,
            T.USRALTA,
            T.USRMODIF,
            T.INDMANUAL,
            T.INDPASADOAE,
            T.NUMEROAE,
            T.INDRECEPCIONAE,
            T.INDRECHAZOAE,
            T.MOTRECHAZOAE,
            T.FECRECEPCIONAE,
            T.CODAPSCTCLIENTE,
            T.NOMBREBUQUE,
            T.GTBUQUE,
            T.IMOBUQUE,
            T.NUMESCALA,
            T.NUMDECLARACION,
            T.TIPOOPERACION,
            T.IDPROCESO,
            T.IDPROCESOFACT,
            T.ESLORABUQUE,
            T.CODESTADIA,
            T.INDDESGLOSECOEF,
            T.INDIMPORTECERO,
            T.NUMREVESCALA,
            T.NUMVERSIONTRAMO,
            T.INDIGICMODIFICADO,
            T.CODEXPEDRDIRECTA,
            T.CODEXPEDRINDIRECTA,
            T.CODPUEDP,
            T.CODDP,
            T.CODPESCALITORAL,
            T.MATRICULAEMB,
            T.NOMBREEMB,
            T.EXPEDIENTEDP,
            T.NUMCONTADOR,
            T.CODEXPAGUAINSTFIJA,
            T.INDBLOQPORAE,
            T.CODEXPAGUANODP,
            T.M3AGUACONSUMO,
            T.M3AGUAFACTURADOS,
            T.CODAGUAEDR,
            T.OBJETODP,
            T.CODEMBDEPBASENOAP,
            T.CODESTADO,
            T.IDASPECTOTARIFA,
            T.IDASPECTOSUBTARIFA,
            T.IDASPECTOEXTENSION,
            T.IDASPECTO,
            T.CODPUELOTE,
            T.CODLOTE,
            T.CODPUEFACEMIT,
            T.ANYOFACEMIT,
            T.CODSERFACEMIT,
            T.NUMFACEMIT,
            T.CODPUEFACANUL,
            T.ANYOFACANUL,
            T.CODSERFACANUL,
            T.NUMFACANUL,
            T.ANUM1C,
            T.ANUM2C,
            T.ANUM3C,
            T.ANUM4C,
            T.ANUM5C,
            T.ANUM6C,
            T.ANUM7C,
            T.ANUM8C,
            T.ANUM9C,
            T.ANUM10C,
            T.NUM1C,
            T.NUM2C,
            T.NUM3C,
            T.NUM4C,
            T.NUM5C,
            T.NUM6C,
            T.NUM7C,
            T.NUM8C,
            T.NUM9C,
            T.NUM10C,
            T.CODSERFACTURA,
            T.IDIOMACLIENTE,
            T.DIRTIPOVIA,
            T.DIRNOMVIA,
            T.DIRNUMPORTAL,
            T.DIRESCALERA,
            T.DIRPISO,
            T.DIRPUERTA,
            T.DIRPAIS,
            T.DIRPROVINCIA,
            T.DIRMUNICIPIO,
            T.DIRCODPOSTAL,
            T.INDCONTADO,
            T.INDNOTIFELECTRONICA,
            T.CODTIPOSUJETO,
            T.INDMULTIIVA,
            T.CODPUEBIENPUBLICO,
            T.CODBIENPUBLICO,
            T.CODPUEAPAC,
            T.FACANULSERIETXT,
            T.FACANULANYOTXT,
            T.FACANULNUMTXT,
            T.INDMODIFMANUAL,
            T.USUARIOMODIFMANUAL,
            T.FECMODIFMANUAL,
            T.CODLIQSIGMA,
            T.INDBLOQUEADO,
            T.MATBUQUEPESQUERO,
            T.NOMBUQUEPESQUERO,
            E.IDTARIFAERP,
            E.IDSUBTARIFAERP,
            E.EXTENSIONERP
       FROM LQ_BORRADOR T, LQ_TARIFA_ERP E
      WHERE     T.IDASPECTOTARIFA = E.IDTARIFA
            AND T.IDASPECTOSUBTARIFA = E.IDSUBTARIFA
            AND T.IDASPECTOEXTENSION = E.EXTENSION
   ORDER BY IDASPECTOTARIFA, IDASPECTOSUBTARIFA, IDASPECTOEXTENSION;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_INT_CLIENTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_INT_CLIENTES
(
   CODUSUARIO,
   NOMBRECOMPLETO,
   CODTIPODOCUMENTO,
   NUMDOC,
   CODTIPONOTIF,
   CODTIPOCOBRO,
   CODERP
)
AS
   SELECT CODUSUARIO,
          NOMBRECOMPLETO,
          CODTIPODOCUMENTO,
          NUMDOC || LETRANIF AS NUMDOC,
          CODTIPONOTIF,
          CODTIPOCOBRO,
          CODAPSCT
     FROM M_USUARIO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_INT_FACTURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_INT_FACTURA
(
   CODPUEFACTURA,
   ANYOFACTURA,
   CODSERFACTURA,
   NUMFACTURA,
   FECFACTURA,
   CODCLIENTE,
   NOMCLIENTE,
   DIRECCION,
   CODPOSTAL,
   POBLACION,
   PROVINCIA,
   PAIS,
   NIF,
   IMPBASE,
   IMPIVA,
   IMPTOTAL,
   CODPUELOTE,
   CODLOTE,
   CODESTFACTURA,
   CODMOTANULACION,
   CODPUEFACANULADA,
   CODSERFACANULADA,
   ANYOFACANULADA,
   NUMFACANULADA,
   CODPUEFACANULACION,
   CODSERFACANULACION,
   ANYOFACANULACION,
   NUMFACANULACION,
   PDFFACTURA,
   CODPUENOTIF,
   ANYONOTIF,
   NUMNOTIF,
   CODTIPNOTIF,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF,
   INDPRECIOPUBLICO,
   XMLFACTURAE,
   INDTRASPASARSEDE,
   INDTRASPASOSEDE,
   FECTRASPASOSEDE,
   XMLFACTURAEFIRMADO,
   ESTADOFACTURA,
   TASASTARIFAS,
   REFERENCIA,
   IDTARIFA,
   IDSUBTARIFA,
   IDEXTENSION,
   FACANULSERIETXT,
   FACANULANYOTXT,
   FACANULNUMTXT,
   INDFACTURAFACE,
   INDNONOTIF,
   IDTARIFAERP,
   IDSUBTARIFAERP,
   EXTENSIONERP
)
AS
     SELECT T.CODPUEFACTURA,
            T.ANYOFACTURA,
            T.CODSERFACTURA,
            T.NUMFACTURA,
            T.FECFACTURA,
            T.CODCLIENTE,
            T.NOMCLIENTE,
            T.DIRECCION,
            T.CODPOSTAL,
            T.POBLACION,
            T.PROVINCIA,
            T.PAIS,
            T.NIF,
            T.IMPBASE,
            T.IMPIVA,
            T.IMPTOTAL,
            T.CODPUELOTE,
            T.CODLOTE,
            T.CODESTFACTURA,
            T.CODMOTANULACION,
            T.CODPUEFACANULADA,
            T.CODSERFACANULADA,
            T.ANYOFACANULADA,
            T.NUMFACANULADA,
            T.CODPUEFACANULACION,
            T.CODSERFACANULACION,
            T.ANYOFACANULACION,
            T.NUMFACANULACION,
            T.PDFFACTURA,
            T.CODPUENOTIF,
            T.ANYONOTIF,
            T.NUMNOTIF,
            T.CODTIPNOTIF,
            T.USRALTA,
            T.USRMODIF,
            T.FECALTA,
            T.FECMODIF,
            T.INDPRECIOPUBLICO,
            T.XMLFACTURAE,
            T.INDTRASPASARSEDE,
            T.INDTRASPASOSEDE,
            T.FECTRASPASOSEDE,
            T.XMLFACTURAEFIRMADO,
            T.ESTADOFACTURA,
            T.TASASTARIFAS,
            T.REFERENCIA,
            T.IDTARIFA,
            T.IDSUBTARIFA,
            T.IDEXTENSION,
            T.FACANULSERIETXT,
            T.FACANULANYOTXT,
            T.FACANULNUMTXT,
            T.INDFACTURAFACE,
            T.INDNONOTIF,
            E.IDTARIFAERP,
            E.IDSUBTARIFAERP,
            E.EXTENSIONERP
       FROM LQ_FACTURA T, LQ_TARIFA_ERP E
      WHERE     T.IDTARIFA = E.IDTARIFA
            AND T.IDSUBTARIFA = E.IDSUBTARIFA
            AND T.IDEXTENSION = E.EXTENSION
   ORDER BY T.IDTARIFA, T.IDSUBTARIFA, T.IDEXTENSION;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LIQ_BORRADORESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LIQ_BORRADORESCALA
(
   TASA,
   SUJPASIVO,
   TIPO,
   IMPNET,
   CODBORRADOR,
   FACTURA,
   CODPUEESC,
   ANYOESC,
   CODESC,
   FECLIQ,
   CODESTADO,
   ESTADO,
   IMPIMPUESTO,
   IMPTOT
)
AS
   SELECT S.DESCRIPCION,
          U.NOMBRECOMPLETO,
          T.DESCRIPCION,
          B.IMPNET,
          B.CODBORRADOR,
          '',
          B.CODPUEESC,
          B.ANYOESC,
          B.CODESC,
          B.FECLIQ,
          B.CODESTADO,
          E.DESCRIPCION,
          B.IMPIMPUESTO,
          B.IMPTOT
     FROM LQ_BORRADOR B
          INNER JOIN ESCALA ES
             ON (    ES.CODPUE = B.CODPUEESC
                 AND ES.ANYO = B.ANYOESC
                 AND ES.CODESCALA = B.CODESC)
          INNER JOIN M_USUARIO U
             ON (U.CODUSUARIO = B.IDCLIENTE)
          INNER JOIN LQ_TARIFA S
             ON (    S.IDTARIFA = B.IDASPECTOTARIFA
                 AND S.IDSUBTARIFA = B.IDASPECTOSUBTARIFA
                 AND S.EXTENSION = B.IDASPECTOEXTENSION)
          INNER JOIN LQ_TIPOBORRADOR T
             ON (T.CODIGO = B.CODTIPO)
          INNER JOIN LQ_ESTADOBORRADOR E
             ON (E.CODIGO = B.CODESTADO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LIST_ASP_CAMPO_PREFORMATO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LIST_ASP_CAMPO_PREFORMATO
(
   IDTARIFA,
   IDSUBTARIFA,
   IDEXTENSION,
   IDASPECTO,
   IDPDFCAMPO,
   CAMPOS,
   FORMATO,
   NIVEL,
   CODIDIOMA,
   LITERAL
)
AS
   SELECT LQACP.IDTARIFA,
          LQACP.IDSUBTARIFA,
          LQACP.IDEXTENSION,
          LQACP.IDASPECTO,
          LQACP.IDPDFCAMPO,
          LQACP.CAMPOS,
          LQACP.FORMATO,
          LQACP.NIVEL,
          IDIOMA.CODIDIOMA,
          LQACPI.LITERAL
     FROM LQ_ASPECTO_CAMPO_PREFORMATO LQACP
          JOIN GU_IDIOMA IDIOMA
             ON 1 = 1
          LEFT JOIN LQ_ASPECTO_CAMPO_PREF_IDIOMA LQACPI
             ON     LQACPI.IDTARIFA = LQACP.IDTARIFA
                AND LQACPI.IDSUBTARIFA = LQACP.IDSUBTARIFA
                AND LQACPI.IDEXTENSION = LQACP.IDEXTENSION
                AND LQACPI.IDASPECTO = LQACP.IDASPECTO
                AND LQACPI.IDPDFCAMPO = LQACP.IDPDFCAMPO
                AND LQACPI.CODIDIOMA = IDIOMA.CODIDIOMA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LIST_LQBORRADOR_FACT  (View)
--

CREATE OR REPLACE FORCE VIEW V_LIST_LQBORRADOR_FACT
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   IDCLIENTE,
   CODAPSCTCLIENTE,
   CODTIPO,
   FECLIQ,
   FECINISER,
   FECFINSER,
   NOMBRECLIENTE,
   CIFCLIENTE,
   IMPNET,
   IMPIMPUESTO,
   CODTIPIMPUESTO,
   PORCIMPUESTO,
   IMPTOT,
   CODPUELOTE,
   CODLOTE,
   CODSERFACTURA,
   IDIOMACLIENT,
   GUIDSRV,
   CODSERFACANULADA,
   NUMFACANULADA,
   ANYOFACANULADA,
   CODPUEFACANULADA,
   EXTENSIO,
   IDTARIFA,
   IDSUBTARIFA,
   INDPRECIOPUBLICO,
   INDRECALCULOIVA,
   ESTANDAR,
   DESCTARIFA,
   CODSUBCUENTA,
   DESCSUBCUENTA,
   CENTROCOSTE,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRCODPOSTAL,
   DIRMUNICIPIO,
   DIRPROVINCIA,
   DIRPAIS,
   FACANULSERIETXT,
   FACANULANYOTXT,
   FACANULNUMTXT,
   NUMESCALA,
   ANUM1C,
   ANUM2C,
   ANUM3C,
   ANUM4C,
   ANUM5C,
   ANUM6C,
   ANUM7C,
   ANUM8C,
   ANUM9C,
   ANUM10C
)
AS
   SELECT LQB.CODPUE,
          LQB.ANYO,
          LQB.CODBORRADOR,
          LQB.IDCLIENTE,
          LQB.CODAPSCTCLIENTE,
          LQB.CODTIPO,
          LQB.FECLIQ,
          LQB.FECINISER,
          LQB.FECFINSER,
          LQB.NOMBRECLIENTE,
          LQB.CIFCLIENTE,
          LQB.IMPNET,
          LQB.IMPIMPUESTO,
          LQB.CODTIPIMPUESTO,
          LQTI.VALOR,
          LQB.IMPTOT,
          LQB.CODPUELOTE,
          LQB.CODLOTE,
          LQB.CODSERFACTURA,
          MU.IDIOMA,
          LQB.GUIDSRV,
          LQB.CODSERFACANUL,
          LQB.NUMFACANUL,
          LQB.ANYOFACANUL,
          LQB.CODPUEFACANUL,
          LQB.IDASPECTOEXTENSION,
          LQB.IDASPECTOTARIFA,
          LQB.IDASPECTOSUBTARIFA,
          LQT.INDPRECIOPUBLICO,
          LQT.INDRECALCULOIVA,
          LQB.INDMANUAL,
          LQT.DESCRIPCION,
          LQT.CODSUBCUENTA,
          LQS.DESCRIPCION,
          LQT.CENTROCOSTE,
          LQB.DIRTIPOVIA,
          LQB.DIRNOMVIA,
          LQB.DIRNUMPORTAL,
          LQB.DIRESCALERA,
          LQB.DIRPISO,
          LQB.DIRPUERTA,
          LQB.DIRCODPOSTAL,
          LQB.DIRMUNICIPIO,
          LQB.DIRPROVINCIA,
          LQB.DIRPAIS,
          LQB.FACANULSERIETXT,
          LQB.FACANULANYOTXT,
          LQB.FACANULNUMTXT,
          LQB.NUMESCALA,
          LQB.ANUM1C,
          LQB.ANUM2C,
          LQB.ANUM3C,
          LQB.ANUM4C,
          LQB.ANUM5C,
          LQB.ANUM6C,
          LQB.ANUM7C,
          LQB.ANUM8C,
          LQB.ANUM9C,
          LQB.ANUM10C
     FROM LQ_BORRADOR LQB
          JOIN M_USUARIO MU
             ON MU.CODUSUARIO = LQB.IDCLIENTE
          LEFT JOIN LQ_TARIFA LQT
             ON     LQT.IDTARIFA = LQB.IDASPECTOTARIFA
                AND LQT.IDSUBTARIFA = LQB.IDASPECTOSUBTARIFA
                AND LQT.EXTENSION = LQB.IDASPECTOEXTENSION
          LEFT JOIN LQ_SUBCUENTA LQS
             ON LQS.CODIGO = LQT.CODSUBCUENTA
          LEFT JOIN LQ_TIPO_IMPUESTO LQTI
             ON LQTI.CODIGO = LQB.CODTIPIMPUESTO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LIST_LQFACT_TIPAGRLOTE_TARIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_LIST_LQFACT_TIPAGRLOTE_TARIF
(
   CODTIPGRUPOLOTE,
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   PRINCIPAL,
   CAMPOSAGRUPACION,
   CODPUELOTE,
   CODLOTE
)
AS
   SELECT a.CODTIPGRUPOLOTE,
          a.IDTARIFA,
          a.IDSUBTARIFA,
          a.EXTENSION,
          a.PRINCIPAL,
          b.CAMPOSAGRUPACION,
          c.CODPUELOTE,
          c.CODLOTE
     FROM LQ_FACTURA_TIPAGRLOTE_TARIFA a
          JOIN LQ_FACTURA_TIPO_AGRUPA_LOTE b
             ON a.CODTIPGRUPOLOTE = b.CODTIPGRUPOLOTE
          JOIN LQ_FACTURA_LOTE_AGRUPA c
             ON c.CODTIPGRUPOLOTE = b.CODTIPGRUPOLOTE
    WHERE b.BAJA = '0' OR b.BAJA IS NULL;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_AMARRE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_AMARRE
(
   CODAMARRE,
   CODPAN,
   CODAPSCTPAN,
   CODINS,
   CODAPSCTINS,
   INSTALACION,
   CODPUE,
   CODAPSCT,
   TIPOAMARRE,
   DESCTIPOAMARRE
)
AS
   SELECT A.CODAMARRE,
          TO_CHAR (A.CODPAN),
          P.CODAPSCT,
          A.CODINS,
          I.CODAPSCT,
          I.NOMBRE,
          A.CODPUE,
          A.CODAPSCT,
          A.TIPOAMARRE,
          TA.DESCRIPCION
     FROM M_AMARRE A
          INNER JOIN M_INSTALACION I
             ON A.CODINS = I.CODINS
          LEFT JOIN M_PANTALAN P
             ON A.CODPAN = P.CODPAN
          INNER JOIN TIPO_AMARRE TA
             ON A.TIPOAMARRE = TA.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ARMADORCONTENEDOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ARMADORCONTENEDOR (CODIGO, NOMBRE)
AS
     SELECT M_ARMADORCONTENEDOR.CODIGO, M_ARMADORCONTENEDOR.NOMBRE
       FROM M_ARMADORCONTENEDOR
   ORDER BY CODIGO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4ARTEPESCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4ARTEPESCA (CODIGO, DESCRIPCION)
AS
   SELECT A.CODIGO, A.DESCRIPCION
     FROM B4_ARTEPESCA A;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4BUQUEPESQUERO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4BUQUEPESQUERO
(
   CODIGO,
   NOMBRE,
   CODZONAPESCA,
   ZONAPESCA,
   CODARTEPESCA,
   ARTEPESCA,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCTCONSIGNATARIO,
   LISTA,
   MATRICULA,
   FOLIO
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODZONAPESCA,
          Z.DESCRIPCION,
          E.CODARTEPESCA,
          A.DESCRIPCION,
          E.CODCONSIGNATARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          E.LISTA,
          E.MATRICULA,
          E.FOLIO
     FROM B4_BUQUEPESQUERO E
          LEFT JOIN M_USUARIO U
             ON E.CODCONSIGNATARIO = U.CODUSUARIO
          LEFT JOIN B4_ARTEPESCA A
             ON A.CODIGO = E.CODARTEPESCA
          LEFT JOIN B4_ZONAPESCA Z
             ON Z.CODIGO = E.CODZONAPESCA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4COMPRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4COMPRADOR
(
   CODIGO,
   DESCRIPCION,
   NUMDOCUMENTO
)
AS
   SELECT E.CODIGO, E.DESCRIPCION, E.NUMDOCUMENTO
     FROM B4_COMPRADOR E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4ESPECIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4ESPECIE
(
   CODIGO,
   NOMBRE,
   CODFAO,
   CODFAMILIA,
   FAMILIA,
   CODTIPOCAPTURA,
   TIPOCAPTURA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODFAO,
          E.CODFAMILIA,
          F.NOMBRE,
          E.CODTIPOCAPTURA,
          C.DESCRIPCION
     FROM B4_ESPECIE E
          LEFT JOIN B4_TIPOCAPTURA C
             ON (E.CODTIPOCAPTURA = C.CODIGO)
          LEFT JOIN B4_FAMILIA F
             ON (E.CODFAMILIA = F.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4FAMILIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4FAMILIA (CODIGO, NOMBRE)
AS
   SELECT E.CODIGO, E.NOMBRE
     FROM B4_FAMILIA E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4TIPOOPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4TIPOOPERACION
(
   CODIGO,
   NOMBRE,
   CODTIPOVENTA,
   INDGENERAB0,
   INDEXENTOB4,
   CODTIPOIVA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODTIPOVENTA,
          E.INDGENERAB0,
          E.INDEXENTOB4,
          E.CODTIPOIVA
     FROM B4_TIPOOPERACION E
    WHERE E.BAJA = '0';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_B4ZONAPESCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_B4ZONAPESCA (CODIGO, DESCRIPCION)
AS
   SELECT Z.CODIGO, Z.DESCRIPCION
     FROM B4_ZONAPESCA Z;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BANCOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BANCOS (CODBANCO, NOMBANCO)
AS
   SELECT "CODBANCO", "NOMBRE" FROM M_BANCO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BANCO_SUCURSAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BANCO_SUCURSAL
(
   CODBANCO,
   NOMBANCO,
   CODSUCURSAL,
   NOMSUCURSAL
)
AS
   SELECT B.CODBANCO,
          B.NOMBRE,
          S.CODSUCURSAL,
          S.NOMBRE
     FROM M_BANCO B, M_SUCURSAL S
    WHERE S.CODBANCO = B.CODBANCO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BARCAZA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BARCAZA (CODIGO, DESCRIPCION)
AS
     SELECT CODIGO, NOMBRE
       FROM m_barcaza
   ORDER BY CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BONIFICACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BONIFICACION
(
   CODIGO,
   CODBONIFICACION,
   DESCRIPCION,
   FECINIVIG,
   FECFINVIG,
   PORCENTAJEBONIFICACION,
   TASATARIFA,
   INDVALORDEFECTO,
   TIPO245,
   INDAPLICAMUELLE,
   INDAPLICABUQUE,
   CODPUE
)
AS
     SELECT CODIGO,
            CODBONIFICACION,
            DESCRIPCION,
            FECINIVIG,
            FECFINVIG,
            PORCENTAJEBONIFICACION,
            TASATARIFA,
            INDVALORDEFECTO,
            TIPO245,
            INDAPLICAMUELLE,
            INDAPLICABUQUE,
            CODPUE
       FROM M_BONIFICACION
   ORDER BY FECINIVIG DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BUQUE (CODIGO, DESCRIPCION, CODIMO)
AS
     SELECT B.CODBUQUE, B.NOMBRE, B.CODIMO
       FROM M_BUQUE B
   ORDER BY B.NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_BUQUESCERT10C  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_BUQUESCERT10C
(
   CODINTERNO,
   DESCRIPCION,
   FECINICIO,
   FECFIN,
   CODBUQUE,
   BUQUE,
   CODTIPOCERT,
   TIPOCERT,
   NUMMEDPUERTO,
   CODPAIS,
   CODPUERTO,
   DESPAIS,
   DESPUERTO,
   CODPLANRESIDUO,
   DESPLANRESIDUO
)
AS
   SELECT M_BUQUECERT.CODINTERNO,
          M_BUQUECERT.CODINTERNO,
          M_BUQUECERT.FECINICIO,
          M_BUQUECERT.FECFIN,
          M_BUQUECERT.CODBUQUE,
          M_BUQUE.NOMBRE,
          TIPOCERT_BUQUE.CODIGO,
          TIPOCERT_BUQUE.DESCRIPCION,
          M_BUQUECERT.NUMMEDPUERTO,
          M_BUQUECERT.CODPAILOCODE,
          M_BUQUECERT.CODPUELOCODE,
          M_PAIS.NOMBRE,
          M_PUERTO.NOMBRE,
          M_BUQUECERT.CODPLANRESIDUO,
          TIPO_PLANRESIDUO.DESCRIPCION
     FROM M_BUQUECERT
          INNER JOIN M_BUQUE
             ON M_BUQUECERT.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN TIPOCERT_BUQUE
             ON M_BUQUECERT.CODTIPOCERT = TIPOCERT_BUQUE.CODIGO
          LEFT JOIN M_PUERTO
             ON M_PUERTO.CODPAIS = M_BUQUECERT.CODPAILOCODE
                AND M_PUERTO.CODPUE = M_BUQUECERT.CODPUELOCODE
          LEFT JOIN M_PAIS
             ON M_PAIS.CODPAIS = M_BUQUECERT.CODPAILOCODE
          LEFT JOIN TIPO_PLANRESIDUO
             ON TIPO_PLANRESIDUO.CODIGO = M_BUQUECERT.CODPLANRESIDUO
    WHERE CODTIPOCERT = '005';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CAMION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CAMION
(
   CODIGO,
   MATRICULA,
   DESCRIPCION,
   FECINICIO,
   FECFIN,
   LARGO,
   ANCHO,
   SUPERFICIE,
   CODUSUARIO,
   NIF,
   CODAPSCT,
   NOMBRECOMPLETO,
   CODPUE
)
AS
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
   UNION
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO2,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO2 = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
   UNION
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO3,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO3 = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
   UNION
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO4,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO4 = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
   UNION
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO5,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO5 = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO
   UNION
   SELECT M_CAMION.CODIGO,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.CODUSUARIO6,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO_PUERTO.CODPUE
     FROM M_CAMION
          INNER JOIN M_USUARIO
             ON (M_CAMION.CODUSUARIO6 = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_USUARIO_PUERTO
             ON M_USUARIO_PUERTO.CODUSUARIO = M_USUARIO.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CLIENTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CLIENTE
(
   CODUSUARIO,
   CODAPSCT,
   NOMBRECOMPLETO,
   CODPUE,
   PUERTO,
   NUMERODOC
)
AS
   SELECT A.CODUSUARIO,
          A.CODAPSCT,
          A.NOMBRECOMPLETO,
          UP.CODPUE,
          P.NOMBRE AS PUERTO,
          A.NUMDOC || A.LETRANIF AS NUMERODOC
     FROM M_USUARIO A
          LEFT JOIN M_USUARIO_PUERTO UP
             ON (A.CODUSUARIO = UP.CODUSUARIO)
          LEFT JOIN M_PUERTO_LOCAL P
             ON (UP.CODPUE = P.CODPUE)
    WHERE A.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CONTADOR
(
   CODPUE,
   CODIGO,
   NUMSERIE,
   DESCRIPCION,
   MOVILFIJO,
   DESCMOVILFIJO,
   TIPO,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC
)
AS
     SELECT M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            M_CONTADOR.DESCRIPCION,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.MOVILFIJO,
            DECODE (M_CONTADOR.MOVILFIJO, 'M', 'Movil', 'Fija'),
            M_CONTADOR.CODTIPOSUMINISTRO,
            M_CONTADOR.CODTIPOSUMINAGUA,
            A.DESCRIPCION,
            M_CONTADOR.CODTIPOSUMINELEC,
            E.DESCRIPCION
       FROM M_CONTADOR
            LEFT JOIN T8_TIPOSUMINAGUA A
               ON (A.CODIGO = M_CONTADOR.CODTIPOSUMINAGUA)
            LEFT JOIN T8_TIPOSUMINELEC E
               ON (E.CODIGO = M_CONTADOR.CODTIPOSUMINELEC)
      WHERE INDBAJA = '0'
            AND (M_CONTADOR.MOVILFIJO = 'M'
                 OR M_CONTADOR.INDFIJOPARASUMINBUQUE = '1')
   ORDER BY M_CONTADOR.NUMCON;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CONTADORAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CONTADORAGUA
(
   CODPUE,
   CODIGO,
   DESCRIPCION,
   NUMSERIE
)
AS
     SELECT M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.DESCRIPCION
       FROM M_CONTADOR
      WHERE     INDBAJA = '0'
            AND CODTIPOSUMINISTRO = 'A'
            AND MOVILFIJO = 'F'
            AND M_CONTADOR.INDFIJOPARASUMINBUQUE = '0'
   ORDER BY M_CONTADOR.NUMCON;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CONTADORINSTFIJA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CONTADORINSTFIJA
(
   CODPUE,
   CODIGO,
   DESCRIPCION,
   NUMSERIE,
   TIPO,
   CODTIPOCANON,
   INDAGUASALADA,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC
)
AS
     SELECT M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.DESCRIPCION,
            M_CONTADOR.CODTIPOSUMINISTRO,
            M_CONTADOR.CODTIPOCANON,
            M_CONTADOR.INDAGUASALADA,
            M_CONTADOR.CODTIPOSUMINAGUA,
            A.DESCRIPCION,
            M_CONTADOR.CODTIPOSUMINELEC,
            E.DESCRIPCION
       FROM M_CONTADOR
            LEFT JOIN T8_TIPOSUMINAGUA A
               ON (A.CODIGO = M_CONTADOR.CODTIPOSUMINAGUA)
            LEFT JOIN T8_TIPOSUMINELEC E
               ON (E.CODIGO = M_CONTADOR.CODTIPOSUMINELEC)
      WHERE     INDBAJA = '0'
            AND MOVILFIJO = 'F'
            AND M_CONTADOR.INDFIJOPARASUMINBUQUE = '0'
   ORDER BY M_CONTADOR.NUMCON;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_CONTADORMALLA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_CONTADORMALLA
(
   CODPUE,
   CODIGO,
   DESCRIPCION,
   NUMSERIE
)
AS
     SELECT M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.DESCRIPCION
       FROM M_CONTADOR
      WHERE INDBAJA = '0' AND CODTIPOSUMINISTRO = 'A' AND MOVILFIJO = 'F'
   ORDER BY M_CONTADOR.NUMCON;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPBIENPUBLICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPBIENPUBLICO
(
   CODPUE,
   CODIGO,
   DESCRIPCION,
   INDUSOINSTALACION,
   FECINIVIG,
   FECFINVIG,
   CODTIPOBIEN,
   TIPOBIEN,
   TOTALM2,
   TOTALM2STRING
)
AS
     SELECT B.CODPUE,
            B.CODIGO,
            B.DESCRIPCION,
            B.INDUSOINSTALACION,
            B.FECINIVIG,
            B.FECFINVIG,
            B.CODTIPOBIEN,
            T.DESCRIPCION,
            B.TOTALM2,
            REPLACE (B.TOTALM2, '.', ',')
       FROM    DP_BIENPUBLICO B
            INNER JOIN
               DP_TIPOBIENPUBLICO T
            ON (T.CODIGO = B.CODTIPOBIEN)
   ORDER BY B.DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPCANONACTIV  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPCANONACTIV
(
   CODPUEEXP,
   DESPUE,
   CODEXP,
   CODCANON,
   FECINICIO,
   FECFIN,
   TIPOACTIV,
   DESTIPOACTIV,
   SUBTIPOACTIV,
   DESCSUBTIPOACTIV,
   DESCRIPCION,
   EXPEDIENTE,
   OBJETO
)
AS
   SELECT C.CODPUEEXP,
          P.NOMBRE,
          C.CODEXP,
          C.CODCANON,
          TO_CHAR (C.FECINICIO, 'dd/MM/rrrr'),
          TO_CHAR (C.FECFIN, 'dd/MM/rrrr'),
          C.TIPOACTIV,
          TAC.DESCRIPCION,
          C.SUBTIPOACTIV,
          SUBTAC.DESCRIPCION,
          C.DESCRIPCION,
          E.EXPEDIENTE,
          E.OBJETO
     FROM DP_CANONACTIV C
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = C.CODPUEEXP)
          INNER JOIN DP_TIPOACTIVIDAD TAC
             ON (TAC.CODIGO = C.TIPOACTIV)
          INNER JOIN DP_SUBTIPOACTIVIDAD SUBTAC
             ON (SUBTAC.CODIGO = C.SUBTIPOACTIV)
          INNER JOIN DP_EXPEDIENTE E
             ON (E.CODPUE = C.CODPUEEXP AND E.CODIGO = C.CODEXP);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPCANONOCUPACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPCANONOCUPACION
(
   CODPUEEXP,
   DESPUE,
   CODEXP,
   CODCANON,
   FECINICIO,
   FECFIN,
   TIPOOCUP,
   DESTIPOOCUP,
   TIPOACTIV,
   DESCTIPOACTIV,
   DESCOCUPACTIV,
   EXPEDIENTE,
   OBJETO
)
AS
   SELECT C.CODPUEEXP,
          P.NOMBRE,
          C.CODEXP,
          C.CODCANON,
          TO_CHAR (C.FECINICIO, 'dd/MM/rrrr'),
          TO_CHAR (C.FECFIN, 'dd/MM/rrrr'),
          C.TIPOOCUP,
          TOC.DESCRIPCION,
          C.TIPOACTIV,
          TAC.DESCRIPCION,
          C.DESCOCUPACTIV,
          E.EXPEDIENTE,
          E.OBJETO
     FROM DP_CANONOCUPACION C
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = C.CODPUEEXP)
          INNER JOIN DP_TIPOOCUPACION TOC
             ON (TOC.CODIGO = C.TIPOOCUP)
          INNER JOIN DP_TIPOACTIVOCUPACION TAC
             ON (TAC.CODIGO = C.TIPOACTIV)
          INNER JOIN DP_EXPEDIENTE E
             ON (E.CODPUE = C.CODPUEEXP AND E.CODIGO = C.CODEXP);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPEXPCONTADORAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPEXPCONTADORAGUA
(
   CODIGO,
   CODPUE,
   DESPUE,
   CODEXP,
   EXPEDIENTE,
   OBJETO,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT,
   CODCONTADOR,
   CONTADOR
)
AS
   SELECT CE.CODIGO,
          CE.CODPUEEXP,
          P.NOMBRE,
          E.CODIGO,
          E.EXPEDIENTE,
          E.OBJETO,
          TO_CHAR (CE.FECINICIO, 'dd/MM/RRRR'),
          TO_CHAR (CE.FECFIN, 'dd/MM/RRRR'),
          CE.IDUSUARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          CE.CODCONTADOR,
          C.DESCRIPCION
     FROM DP_EXPCONTADORAGUA CE
          INNER JOIN DP_EXPEDIENTE E
             ON (CE.CODPUEEXP = E.CODPUE AND CE.CODEXP = E.CODIGO)
          LEFT JOIN M_CONTADOR C
             ON (C.CODPUE = CE.CODPUECONTADOR AND C.NUMCON = CE.CODCONTADOR)
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = CE.CODPUEEXP)
          INNER JOIN M_USUARIO U
             ON (CE.IDUSUARIO = U.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPEXPEDIENTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPEXPEDIENTE
(
   CODPUE,
   DESPUE,
   CODIGO,
   EXPEDIENTE,
   OBJETO,
   NOMBRECONCESIONARIO,
   CIFCONCESIONARIO,
   CONCESIONARIO,
   CODAPSCT
)
AS
   SELECT E.CODPUE,
          P.NOMBRE,
          E.CODIGO,
          E.EXPEDIENTE,
          E.OBJETO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          E.CONCESIONARIO,
          U.CODAPSCT
     FROM DP_EXPEDIENTE E
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = E.CODPUE)
          LEFT JOIN M_USUARIO U
             ON U.CODUSUARIO = E.CONCESIONARIO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPEXPEDIENTEAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPEXPEDIENTEAGUA
(
   CODPUE,
   DESPUE,
   CODIGO,
   EXPEDIENTE,
   OBJETO,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT
)
AS
   SELECT E.CODPUE,
          P.NOMBRE,
          E.CODIGO,
          E.EXPEDIENTE,
          E.OBJETO,
          TO_CHAR (E.FECNOTIFICACION, 'dd/MM/RRRR'),
          CASE
             WHEN E.FECEXTINCION IS NOT NULL
             THEN
                TO_CHAR (E.FECEXTINCION, 'dd/MM/RRRR')
             WHEN E.FECPRORROGA IS NOT NULL
             THEN
                TO_CHAR (E.FECPRORROGA, 'dd/MM/RRRR')
             ELSE
                TO_CHAR (E.FECVENCIMIENTO, 'dd/MM/RRRR')
          END,
          E.CONCESIONARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT
     FROM DP_EXPEDIENTE E
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = E.CODPUE)
          INNER JOIN M_USUARIO U
             ON (E.CONCESIONARIO = U.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPPINSTALACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPPINSTALACION
(
   CODPUE,
   CODINSTALACION,
   NOMBRE
)
AS
     SELECT CODPUE, CODINSTALACION, NOMBRE
       FROM DPP_INSTALACION
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPPZONAVALOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPPZONAVALOR
(
   CODPUE,
   CODZONA,
   NOMBRE,
   FECINIVIG,
   FECFINVIG,
   FECINIVIGSTR,
   FECFINVIGSTR
)
AS
     SELECT CODPUE,
            CODZONA,
            NOMBRE,
            FECINIVIG,
            FECFINVIG,
            TO_CHAR (FECINIVIG, 'dd/MM/rrrr'),
            TO_CHAR (FECFINVIG, 'dd/MM/rrrr')
       FROM DPP_ZONAVALOR
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPTIPOBIENPUBLICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPTIPOBIENPUBLICO
(
   CODIGO,
   DESCRIPCION,
   INDINSTALACION
)
AS
   SELECT CODIGO, DESCRIPCION, INDINSTALACION FROM DP_TIPOBIENPUBLICO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPTIPOINCIDENCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPTIPOINCIDENCIA (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM DP_TIPOINCIDENCIA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPTIPOUNIDADIMPFIJO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPTIPOUNIDADIMPFIJO
(
   CODIGO,
   DESCRIPCION,
   VALOR
)
AS
   SELECT T.CODIGO,
          T.DESCRIPCION,
          CASE
             WHEN T.VALOR < 1 THEN '0' || REPLACE (T.VALOR, '.', ',')
             ELSE REPLACE (T.VALOR, '.', ',')
          END
     FROM DP_TIPOUNIDADIMPFIJO T;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_DPUNIDADMAX  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_DPUNIDADMAX (CODIGO, DESCRIPCION)
AS
     SELECT CODIGO, DESCRIPCION
       FROM dp_unidadmax
   ORDER BY CODIGO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EMBARCACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EMBARCACION
(
   CODIGO,
   NOMBRE,
   MATRICULA,
   PROPIETARIO,
   DESCPROPIETARIO,
   CIFPROPIETARIO,
   CODAPSCTPROPIETARIO,
   ESLORA,
   TIPOPROPULSION,
   DESCTIPOPROPULSION
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.MATRICULA,
          E.PROPIETARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          E.ESLORA,
          E.TIPOPROPULSION,
          P.DESCRIPCION
     FROM M_EMBARCACION E
          INNER JOIN M_USUARIO U
             ON E.PROPIETARIO = U.CODUSUARIO
          LEFT JOIN TIPO_PROPULSION P
             ON P.CODIGO = E.TIPOPROPULSION;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EMBPESCALITORAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EMBPESCALITORAL
(
   CODIGO,
   NOMBRE,
   MATRICULA,
   ESLORA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.MATRICULA,
          E.ESLORA
     FROM M_EMBPESCALITORAL E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EMPRESA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EMPRESA (CODIGO, NOMBRECOMPLETO)
AS
     SELECT E.CODEMPRESA, E.NOMBRECOMPLETO
       FROM CEN_EMPRESA E
   ORDER BY E.NOMBRECOMPLETO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EMPRESA_SUMIN  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EMPRESA_SUMIN
(
   CODIGO,
   CIF,
   NOMBRE,
   TELEFONO,
   EMAIL
)
AS
   SELECT CODIGO,
          CIF,
          NOMBRE,
          TELEFONO,
          EMAIL
     FROM M_EMPRESA_SUMIN;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALA
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   CODAPSCT,
   BUQUE,
   CODIMO,
   FECINIREAL,
   FECINI,
   HORAINI,
   FECFINREAL,
   FECFIN,
   HORAFIN,
   CODESTADO,
   CODTIPOIVAT1
)
AS
     SELECT ESCALA.CODPUE,
            ESCALA.ANYO,
            ESCALA.CODESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT,
            M_BUQUE.NOMBRE,
            M_BUQUE.CODIMO,
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECINIREAL, 'HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECFINREAL, 'HH24:mi'),
            ESCALA.CODESTADO,
            ESCALA.CODTIPOIVAT1
       FROM ESCALA
            LEFT JOIN M_USUARIO
               ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
            LEFT JOIN M_BUQUE
               ON (M_BUQUE.CODBUQUE = ESCALA.CODBUQUE)
      WHERE ESCALA.INDTRAFINT = '0'
   ORDER BY ESCALA.FECINIREAL DESC NULLS LAST;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALABOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALABOR
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   CODAPSCT,
   BUQUE,
   CODIMO,
   FECINIREAL,
   FECINI,
   HORAINI,
   FECFINREAL,
   FECFIN,
   HORAFIN,
   INDTRAFINT,
   CODESTADO,
   CODTIPOIVAT1,
   ESLORA,
   GT,
   CALADO,
   SERVICIOMARITIMO,
   IMOYBUQUE,
   NAVENT,
   NAVSAL
)
AS
     SELECT E.CODPUE,
            E.ANYO,
            E.CODESCALA,
            E.NUMESCALA,
            E.NUMESCALA,
            E.NUMESCALA,
            U.NOMBRECOMPLETO,
            U.NUMDOC || U.LETRANIF,
            U.CODUSUARIO,
            U.CODAPSCT,
            B.NOMBRE,
            B.CODIMO,
            TO_CHAR (E.FECINIREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (E.FECINIREAL, 'dd/MM/yyyy'),
            TO_CHAR (E.FECINIREAL, 'HH24:mi'),
            TO_CHAR (E.FECFINREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (E.FECFINREAL, 'dd/MM/yyyy'),
            TO_CHAR (E.FECFINREAL, 'HH24:mi'),
            E.INDTRAFINT,
            E.CODESTADO,
            E.CODTIPOIVAT1,
            BV.ESLORATOTAL,
            BV.GT,
            BV.CALMAXIMO,
            SM.NOMBRE,
            CASE
               WHEN B.NOMBRE IS NOT NULL THEN B.CODIMO || '/' || B.NOMBRE
               ELSE B.CODIMO
            END,
            NE.DESCRIPCION,
            NS.DESCRIPCION
       FROM ESCALA E
            LEFT JOIN M_USUARIO U
               ON (E.CODCONSIGNATARIO = U.CODUSUARIO)
            LEFT JOIN M_BUQUE B
               ON (E.CODBUQUE = B.CODBUQUE)
            LEFT JOIN M_BUQUEVERSION BV
               ON (BV.CODBUQUE = B.CODBUQUE
                   AND BV.FECINIVIG <=
                          (CASE
                              WHEN E.FECINIREAL IS NOT NULL
                              THEN
                                 TRUNC (E.FECINIREAL)
                              ELSE
                                 TRUNC (E.ETA)
                           END)
                   AND (BV.FECFINVIG >=
                           (CASE
                               WHEN E.FECINIREAL IS NOT NULL
                               THEN
                                  TRUNC (E.FECINIREAL)
                               ELSE
                                  TRUNC (E.ETA)
                            END)
                        OR BV.FECFINVIG IS NULL))
            LEFT JOIN M_SERVICIOMARITIMO SM
               ON (SM.CODSERVICIO = E.CODSERVMARIT)
            LEFT JOIN EST_TIPO_NAVEGACION NE
               ON (NE.CODIGO = E.ESTCODTIPNAVENT)
            LEFT JOIN EST_TIPO_NAVEGACION NS
               ON (NS.CODIGO = E.ESTCODTIPNAVSAL)
   ORDER BY E.FECINIREAL DESC NULLS LAST;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALASERVBAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALASERVBAS
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   CODAPSCT,
   BUQUE,
   CODIMO,
   FECINIREAL,
   FECINI,
   HORAINI,
   FECFINREAL,
   FECFIN,
   HORAFIN,
   INDTRAFINT,
   CODESTADO,
   FECINIREALDATE,
   FECFINREALDATE
)
AS
     SELECT ESCALA.CODPUE,
            ESCALA.ANYO,
            ESCALA.CODESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT,
            BU.NOMBRE,
            BU.CODIMO,
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECINIREAL, 'HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECFINREAL, 'HH24:mi'),
            ESCALA.INDTRAFINT,
            ESCALA.CODESTADO,
            ESCALA.FECINIREAL,
            ESCALA.FECFINREAL
       FROM ESCALA
            LEFT JOIN M_USUARIO
               ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
            LEFT JOIN M_BUQUE BU
               ON (BU.CODBUQUE = ESCALA.CODBUQUE)
   ORDER BY ESCALA.NUMESCALA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALASUMIN  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALASUMIN
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   CODAPSCT,
   BUQUE,
   CODIMO,
   FECINIREAL,
   FECINI,
   HORAINI,
   FECFINREAL,
   FECFIN,
   HORAFIN,
   INDTRAFINT
)
AS
     SELECT ESCALA.CODPUE,
            ESCALA.ANYO,
            ESCALA.CODESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT,
            BU.NOMBRE,
            BU.CODIMO,
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECINIREAL, 'HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECFINREAL, 'HH24:mi'),
            ESCALA.INDTRAFINT
       FROM ESCALA
            LEFT JOIN M_USUARIO
               ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
            LEFT JOIN M_BUQUE BU
               ON (BU.CODBUQUE = ESCALA.CODBUQUE)
      WHERE ESCALA.CODESTADO IN ('IN', 'FI', 'LD')
   ORDER BY ESCALA.NUMESCALA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALATI  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALATI
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   CODAPSCT,
   BUQUE,
   CODIMO,
   FECINIREAL,
   FECINI,
   HORAINI,
   FECFINREAL,
   FECFIN,
   HORAFIN,
   CODTIPOTRAFINT,
   TIPOTRAFINT,
   FECINIREALDATE,
   FECFINREALDATE
)
AS
     SELECT ESCALA.CODPUE,
            ESCALA.ANYO,
            ESCALA.CODESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            ESCALA.NUMESCALA,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT,
            BU.NOMBRE,
            BU.CODIMO,
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECINIREAL, 'HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy HH24:mi'),
            TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/yyyy'),
            TO_CHAR (ESCALA.FECFINREAL, 'HH24:mi'),
            ESCALA.CODTIPOTRAFINT,
            TTI.DESCRIPCION,
            ESCALA.FECINIREAL,
            ESCALA.FECFINREAL
       FROM ESCALA
            LEFT JOIN M_USUARIO
               ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
            LEFT JOIN M_BUQUE BU
               ON (BU.CODBUQUE = ESCALA.CODBUQUE)
            LEFT JOIN TIPO_TRAFINTERIOR TTI
               ON (ESCALA.CODTIPOTRAFINT = TTI.CODIGO)
      WHERE ESCALA.INDTRAFINT = '1' AND ESCALA.CODESTADO <> 'AN'
   ORDER BY ESCALA.NUMESCALA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESCALA_PCS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESCALA_PCS
(
   CODPUE,
   ANYO,
   CODESCALA,
   NUMESCALA,
   ETA,
   ETD,
   ESTADO,
   CIF,
   CONSIGNATARIO,
   IMO,
   BUQUE,
   TIPOBUQUE,
   ESLORA,
   MANGA,
   CALADO,
   GT,
   MMPP
)
AS
     SELECT ESC.CODPUE,
            ESC.ANYO,
            ESC.CODESCALA,
            ESC.NUMESCALA,
            ESC.ETA,
            ESC.ETD,
            ESC.CODESTADO,
            USU.NUMDOC || USU.LETRANIF,
            USU.NOMBRECOMPLETO,
            BU.CODIMO,
            BU.NOMBRE,
            TB.DESCRIPCION,
            BV.ESLORATOTAL,
            BV.MANGA,
            BV.CALMAXIMO,
            BV.GT,
            ESC.INDMMPPABORDO
       FROM ESCALA ESC
            LEFT JOIN M_USUARIO USU
               ON (ESC.CODCONSIGNATARIO = USU.CODUSUARIO)
            LEFT JOIN M_BUQUE BU
               ON (BU.CODBUQUE = ESC.CODBUQUE)
            LEFT JOIN M_BUQUEVERSION BV
               ON (BV.CODBUQUE = BU.CODBUQUE
                   AND BV.FECINIVIG <=
                          (CASE
                              WHEN ESC.FECINIREAL IS NOT NULL
                              THEN
                                 TRUNC (ESC.FECINIREAL)
                              ELSE
                                 TRUNC (ESC.ETA)
                           END)
                   AND (BV.FECFINVIG >=
                           (CASE
                               WHEN ESC.FECINIREAL IS NOT NULL
                               THEN
                                  TRUNC (ESC.FECINIREAL)
                               ELSE
                                  TRUNC (ESC.ETA)
                            END)
                        OR BV.FECFINVIG IS NULL))
            LEFT JOIN TIPO_BUQUE TB
               ON (BV.CODTIPOBUQUE = TB.CODTIPOBUQUE)
   ORDER BY ESC.NUMESCALA DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESTADIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESTADIA
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   DESCRIPCION,
   FECATRAQUEREAL,
   FECATRAQUEREALSTRING,
   HORAATRAQUEREAL,
   FECDESATRAQUEREAL,
   FECDESATRAQUEREALSTRING,
   HORADESATRAQUEREAL,
   CODESTADO,
   NOMBRESUJETO,
   CIFSUJETO,
   IDSUJPASIVO,
   CODAPSCT,
   CODMUELLEINIREAL,
   MUELLEINIREAL
)
AS
     SELECT ESTADIA.CODPUE,
            ESTADIA.ANYO,
            ESTADIA.CODESCALA,
            ESTADIA.CODESTADIA,
            ESTADIA.CODESTADIA,
            ESTADIA.FECATRAQUEREAL,
            TO_CHAR (ESTADIA.FECATRAQUEREAL, 'dd/MM/RRRR HH24:mi')
               AS FECATRAQUEREALSTRING,
            TO_CHAR (ESTADIA.FECATRAQUEREAL, 'HH24:mi') AS HORAATRAQUEREAL,
            ESTADIA.FECDESATRAQUEREAL,
            TO_CHAR (ESTADIA.FECDESATRAQUEREAL, 'dd/MM/RRRR HH24:mi')
               AS FECDESATRAQUEREALSTRING,
            TO_CHAR (ESTADIA.FECDESATRAQUEREAL, 'HH24:mi')
               AS HORADESATRAQUEREAL,
            ESTADIA.CODESTADO,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT,
            ESTADIA.CODMUELLEINIREAL,
            M_MUELLE.DESCRIPCION
       FROM ESTADIA
            LEFT JOIN M_USUARIO
               ON (ESTADIA.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
            LEFT JOIN M_MUELLE
               ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
   ORDER BY ESTADIA.CODESTADIA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESTADIA_PCS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESTADIA_PCS
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   NUMESCALA,
   ETA,
   ETD,
   ESTADO,
   CIF,
   CONSIGNATARIO,
   IMO,
   BUQUE,
   CODMUELLE,
   MUELLE
)
AS
     SELECT EST.CODPUE,
            EST.ANYO,
            EST.CODESCALA,
            EST.CODESTADIA,
            ESC.NUMESCALA,
            ESC.ETA,
            ESC.ETD,
            EST.CODESTADO,
            USU.NUMDOC || USU.LETRANIF,
            USU.NOMBRECOMPLETO,
            BU.CODIMO,
            BU.NOMBRE,
            MUE.CODIGO,
            MUE.DESCRIPCION
       FROM ESTADIA EST
            LEFT JOIN ESCALA ESC
               ON (    ESC.CODPUE = EST.CODPUE
                   AND ESC.ANYO = EST.ANYO
                   AND ESC.CODESCALA = EST.CODESCALA)
            LEFT JOIN M_USUARIO USU
               ON (ESC.CODCONSIGNATARIO = USU.CODUSUARIO)
            LEFT JOIN M_BUQUE BU
               ON (BU.CODBUQUE = ESC.CODBUQUE)
            LEFT JOIN M_MUELLE MUE
               ON (   MUE.CODIGO = EST.CODMUELLEINIPREV
                   OR MUE.CODIGO = EST.CODMUELLEINIAUT
                   OR MUE.CODIGO = EST.CODMUELLEINIREAL)
   ORDER BY ESC.NUMESCALA DESC, EST.CODESTADIA DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ESTTIPOMERC43  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ESTTIPOMERC43 (CODIGO, DESCRIPCION)
AS
     SELECT EST_TIPOMERC43.CODIGO, EST_TIPOMERC43.DESCRIPCION
       FROM EST_TIPOMERC43
   ORDER BY EST_TIPOMERC43.DESCRIPCION;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EXPAGUANODP  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EXPAGUANODP
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT
)
AS
   SELECT CE.CODIGO,
          CE.CODPUE,
          P.NOMBRE,
          CE.DESCRIPCION,
          TO_CHAR (CE.FECINICIO, 'dd/MM/RRRR'),
          TO_CHAR (CE.FECFIN, 'dd/MM/RRRR'),
          CE.USUARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT
     FROM EXPAGUA_NODP CE
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = CE.CODPUE)
          INNER JOIN M_USUARIO U
             ON (CE.USUARIO = U.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_EXPAGUANODPCONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_EXPAGUANODPCONTADOR
(
   CODIGO,
   CODPUE,
   DESPUE,
   CODEXP,
   EXPEDIENTE,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT,
   CODCONTADOR,
   CONTADOR
)
AS
   SELECT CE.CODIGO,
          CE.CODPUECONTADOR,
          P.NOMBRE,
          E.CODIGO,
          E.DESCRIPCION,
          TO_CHAR (CE.FECINICIO, 'dd/MM/RRRR'),
          TO_CHAR (CE.FECFIN, 'dd/MM/RRRR'),
          CE.IDUSUARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          CE.CODCONTADOR,
          C.DESCRIPCION
     FROM EXPAGUA_NODP_CONTADOR CE
          INNER JOIN EXPAGUA_NODP E
             ON (CE.CODEXP = E.CODIGO)
          INNER JOIN M_CONTADOR C
             ON (C.CODPUE = CE.CODPUECONTADOR AND C.NUMCON = CE.CODCONTADOR)
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = CE.CODPUECONTADOR)
          INNER JOIN M_USUARIO U
             ON (CE.IDUSUARIO = U.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G0PESCALITORAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G0PESCALITORAL
(
   CODIGO,
   CODPUE,
   ANYO,
   IDEMBARCACION,
   EMBARCACION,
   MATRICULA,
   INDFACTDIRECTA
)
AS
   SELECT E.CODIGO,
          E.CODPUE,
          E.ANYO,
          E.IDEMBARCACION,
          EM.NOMBRE,
          EM.MATRICULA,
          E.INDFACTDIRECTA
     FROM    G0_PESCALITORAL E
          INNER JOIN
             M_EMBPESCALITORAL EM
          ON (E.IDEMBARCACION = EM.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3CABECERA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3CABECERA
(
   CODPUE,
   ANYO,
   CODSER,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   NUMDECLARACION,
   CODTIPDECLARACION,
   TIPODECLARACION,
   PUERTO,
   NOMBREBUQUE,
   IMOBUQUE,
   CODMUELLE,
   MUELLE
)
AS
   SELECT G3_CABECERA.CODPUE,
          G3_CABECERA.ANYO,
          G3_CABECERA.CODSER,
          G3_CABECERA.NUMDECLARACION,
          G3_CABECERA.NUMESCALA,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODUSUARIO,
          G3_CABECERA.NUMDECLARACION,
          G3_CABECERA.TIPODECLARACION,
          G3_TIPOCABECERA.DESCRIPCION,
          M_PUERTO_LOCAL.NOMBRE,
          G3_CABECERA.NOMBUQUE,
          G3_CABECERA.IDENTBUQUE,
          G3_CABECERA.CODMUELLE,
          M_MUELLE.DESCRIPCION
     FROM G3_CABECERA
          INNER JOIN G3_TIPOCABECERA
             ON G3_TIPOCABECERA.CODIGO = G3_CABECERA.TIPODECLARACION
          INNER JOIN M_USUARIO
             ON (G3_CABECERA.IDCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL
             ON (G3_CABECERA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_MUELLE
             ON (G3_CABECERA.CODPUE = M_MUELLE.CODPUE
                 AND G3_CABECERA.CODMUELLE = M_MUELLE.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3CONOCIMIENTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3CONOCIMIENTO
(
   CODPUE,
   ANYO,
   CODSER,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NUMDECLARACION,
   CODTIPDECLARACION,
   TIPODECLARACION,
   TIPOCONOCIMIENTO,
   CONOCIMIENTO,
   NUMORDEN
)
AS
   SELECT G3_CONOCIMIENTO.CODPUE,
          G3_CONOCIMIENTO.ANYO,
          G3_CONOCIMIENTO.CODSER,
          G3_CONOCIMIENTO.CODTRAMO,
          G3_CABECERA.NUMDECLARACION,
          G3_CABECERA.NUMESCALA,
          G3_CABECERA.NUMDECLARACION,
          G3_CABECERA.TIPODECLARACION,
          DECODE (G3_CABECERA.TIPODECLARACION,
                  'C', 'Manifiesto Carga',
                  'D', 'Declaracion Sumaria'),
          G3_CONOCIMIENTO.TIPOCONOC,
          G3_TIPOCONOCIMIENTO.DESCRIPCION,
          G3_CONOCIMIENTO.NUMORDEN
     FROM G3_CONOCIMIENTO
          INNER JOIN G3_CABECERA
             ON (    G3_CABECERA.CODPUE = G3_CONOCIMIENTO.CODPUE
                 AND G3_CABECERA.ANYO = G3_CONOCIMIENTO.ANYO
                 AND G3_CABECERA.CODSER = G3_CONOCIMIENTO.CODSER)
          INNER JOIN G3_TIPOCONOCIMIENTO
             ON (G3_CONOCIMIENTO.TIPOCONOC = G3_TIPOCONOCIMIENTO.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3EQUIPAMIENTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3EQUIPAMIENTO
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   CODEQUIP,
   MATRICULA,
   CODESTADO
)
AS
     SELECT CODPUE,
            ANYO,
            CODSER,
            CODTRAMO,
            NUMORDEN,
            TIPOCONOC,
            CODEQUIP,
            MATRICULA,
            CODESTADO
       FROM G3_EQUIPAMIENTO
   ORDER BY CODEQUIP ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3FICHEROCARGA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3FICHEROCARGA
(
   CODIGO,
   DESCRIPCION,
   FICHERO,
   FECHA,
   BUQUE,
   DOCUMENTO,
   OPERACION,
   ESTADO,
   DESCESTADO
)
AS
   SELECT FC.IDPROCESO,
          FC.FICHERO,
          FC.FICHERO,
          FC.FECHA,
          FC.BUQUE,
          FC.DOCUMENTO,
          TO_CHAR (FC.OPERACION, 'dd/MM/rrrr'),
          FC.ESTADO,
          DECODE (FC.ESTADO, 'ACE', 'Aceptado', 'Rechazado')
     FROM G3_FICHEROCARGA FC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3INSTMARCAJE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3INSTMARCAJE (CODIGO, DESCRIPCION)
AS
   SELECT A.CODIGO, A.DESCRIPCION
     FROM G3_INSTMARCAJE A
    WHERE A.BAJA = '0';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G3TRAMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G3TRAMO
(
   CODPUE,
   ANYO,
   CODSER,
   CODIGO,
   DESCRIPCION,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODCONSIGNATARIO,
   NUMDECLARACION,
   CODTIPDECLARACION,
   TIPODECLARACION,
   NUMTRAMOSIME,
   NUMVERSION,
   CODPUEESC,
   ANYOESC,
   CODESCALA
)
AS
     SELECT G3_TRAMO.CODPUE,
            G3_TRAMO.ANYO,
            G3_TRAMO.CODSER,
            G3_TRAMO.CODTRAMO,
            G3_CABECERA.NUMDECLARACION,
            G3_CABECERA.NUMESCALA,
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            G3_CABECERA.NUMDECLARACION,
            G3_CABECERA.TIPODECLARACION,
            DECODE (G3_CABECERA.TIPODECLARACION,
                    'C', 'Manifiesto Carga',
                    'D', 'Declaracion Sumaria'),
            G3_TRAMO.NUMTRAMOSIME,
            G3_TRAMO.NUMVERSION,
            ESCALA.CODPUE,
            ESCALA.ANYO,
            ESCALA.CODESCALA
       FROM G3_TRAMO
            INNER JOIN M_USUARIO
               ON (G3_TRAMO.IDCONSIGNATARIO = M_USUARIO.CODUSUARIO)
            INNER JOIN G3_CABECERA
               ON (    G3_CABECERA.CODPUE = G3_TRAMO.CODPUE
                   AND G3_CABECERA.ANYO = G3_TRAMO.ANYO
                   AND G3_CABECERA.CODSER = G3_TRAMO.CODSER)
            LEFT JOIN ESCALA
               ON (ESCALA.CODPUE = G3_CABECERA.CODPUE
                   AND ESCALA.NUMESCALA = G3_CABECERA.NUMESCALA)
      WHERE G3_TRAMO.INDULTIMAVERSION = '1'
   ORDER BY G3_TRAMO.CODSER, G3_TRAMO.CODTRAMO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G4ESPECIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G4ESPECIE
(
   CODESPECIE,
   NOMBRE,
   PRECIOKG,
   CODFAMILIA,
   FAMILIA,
   CODCLASE,
   CLASE,
   FECHAINICIO,
   FECHAFIN
)
AS
   SELECT E.CODESPECIE,
          E.NOMBRE,
          EE.PRECIO,
          E.CODFAMILIA,
          F.DESCRIPCION,
          E.CODCLASE,
          C.DESCRIPCION,
          EE.FECINICIO,
          EE.FECFIN
     FROM G4_ESPECIE E
          LEFT JOIN G4_ESPECIEPRECIO EE
             ON (E.CODESPECIE = EE.CODESPECIE)
          INNER JOIN G4_CLASE C
             ON (E.CODCLASE = C.CODIGO)
          INNER JOIN G4_FAMILIA F
             ON (E.CODFAMILIA = F.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G4ESPECIEPRUEBA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G4ESPECIEPRUEBA
(
   CODESPECIE,
   NOMBRE,
   PRECIOKG,
   CODFAMILIA,
   FAMILIA,
   CODCLASE,
   CLASE,
   FECHAINICIO,
   FECHAFIN
)
AS
   SELECT E.CODESPECIE,
          E.NOMBRE,
          TO_CHAR (EE.PRECIO),
          E.CODFAMILIA,
          F.DESCRIPCION,
          E.CODCLASE,
          C.DESCRIPCION,
          EE.FECINICIO,
          EE.FECFIN
     FROM G4_ESPECIE E
          INNER JOIN G4_ESPECIEPRECIO EE
             ON (E.CODESPECIE = EE.CODESPECIE)
          INNER JOIN G4_CLASE C
             ON (E.CODCLASE = C.CODIGO)
          INNER JOIN G4_FAMILIA F
             ON (E.CODFAMILIA = F.CODIGO)
   UNION
   SELECT E.CODESPECIE,
          E.NOMBRE,
          '',
          E.CODFAMILIA,
          F.DESCRIPCION,
          E.CODCLASE,
          C.DESCRIPCION,
          NULL,
          NULL
     FROM G4_ESPECIE E
          INNER JOIN G4_CLASE C
             ON (E.CODCLASE = C.CODIGO)
          INNER JOIN G4_FAMILIA F
             ON (E.CODFAMILIA = F.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G5AUTBASE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G5AUTBASE
(
   CODIGO,
   CODPUE,
   IDEMBARCACION,
   IDAMARRE,
   EMBARCACION,
   MATRICULA,
   CODAPSCTAMARRE,
   INDTRANSITOCONTADO,
   REFERENCIA,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT
)
AS
   SELECT E.CODEXP,
          E.CODPUE,
          E.IDEMBARCACION,
          E.CODAMARRE,
          EM.NOMBRE,
          EM.MATRICULA,
          A.CODAPSCT,
          E.INDTRANSITOCONTADO,
          CASE
             WHEN E.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NULL
             THEN
                E.NUMREGISTRO
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NOT NULL
             THEN
                   E.NUMREGISTRO
                || ' - '
                || TO_CHAR (E.FECREGISTRO, 'dd/MM/rrrr')
          END,
          TO_CHAR (E.FECINICIO, 'dd/MM/RRRR'),
          TO_CHAR (E.FECFIN, 'dd/MM/RRRR'),
          E.TITULAR,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT END
     FROM G5_EXPGESTDIRECTA E
          INNER JOIN M_EMBARCACION EM
             ON (E.IDEMBARCACION = EM.CODIGO)
          INNER JOIN M_AMARRE A
             ON (E.CODAMARRE = A.CODAMARRE)
          INNER JOIN M_USUARIO U
             ON (E.TITULAR = U.CODUSUARIO)
    WHERE E.INDTRANSITO = '0';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G5BASECONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G5BASECONTADOR
(
   CODIGO,
   CODPUE,
   CODEXP,
   REFERENCIA,
   FECINICIO,
   FECFIN,
   IDUSUARIO,
   NOMBRECLIENTE,
   CIF,
   CODAPSCT,
   CODCONTADOR,
   CONTADOR
)
AS
   SELECT E.CODEXP,
          EM.CODPUE,
          EM.CODEXP,
          CASE
             WHEN EM.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN EM.NUMREGISTRO IS NOT NULL AND EM.FECREGISTRO IS NULL
             THEN
                EM.NUMREGISTRO
             WHEN EM.NUMREGISTRO IS NOT NULL AND EM.FECREGISTRO IS NOT NULL
             THEN
                   EM.NUMREGISTRO
                || ' - '
                || TO_CHAR (EM.FECREGISTRO, 'dd/MM/rrrr')
          END,
          TO_CHAR (E.FECINICIO, 'dd/MM/RRRR'),
          TO_CHAR (E.FECFIN, 'dd/MM/RRRR'),
          E.IDUSUARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT END,
          E.CODCONTADOR,
          C.DESCRIPCION
     FROM G5_BASE_CONTADOR E
          INNER JOIN G5_EXPGESTDIRECTA EM
             ON (E.CODEXP = EM.CODEXP)
          INNER JOIN M_USUARIO U
             ON (E.IDUSUARIO = U.CODUSUARIO)
          INNER JOIN M_CONTADOR C
             ON (C.CODPUE = E.CODPUECONTADOR AND C.NUMCON = E.CODCONTADOR);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G5EXPGESTDIRECTA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G5EXPGESTDIRECTA
(
   CODEXP,
   CODPUE,
   IDEMBARCACION,
   IDAMARRE,
   EMBARCACION,
   CODAPSCTAMARRE,
   INDTRANSITO,
   INDTRANSITOCONTADO,
   REFERENCIA
)
AS
   SELECT E.CODEXP,
          E.CODPUE,
          E.IDEMBARCACION,
          E.CODAMARRE,
          EM.NOMBRE,
          A.CODAPSCT,
          E.INDTRANSITO,
          E.INDTRANSITOCONTADO,
          CASE
             WHEN E.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NULL
             THEN
                E.NUMREGISTRO
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NOT NULL
             THEN
                   E.NUMREGISTRO
                || ' - '
                || TO_CHAR (E.FECREGISTRO, 'dd/MM/rrrr')
          END
     FROM G5_EXPGESTDIRECTA E
          INNER JOIN M_EMBARCACION EM
             ON (E.IDEMBARCACION = EM.CODIGO)
          INNER JOIN M_AMARRE A
             ON (E.CODAMARRE = A.CODAMARRE);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_G5MARINA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_G5MARINA
(
   CODEXP,
   CODPUE,
   CONCESIONARIO,
   DESCRIPCION,
   INDZONA2
)
AS
   SELECT M.CODEXP,
          M.CODPUE,
          M.CONCESIONARIO,
          M.DESCRIPCION,
          M.INDZONA2
     FROM G5_MARINA M;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_GE_TIPO_DOCUMENTO_ASOC  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_GE_TIPO_DOCUMENTO_ASOC
(
   IDTIPO,
   DESCRIPCION
)
AS
     SELECT GE_TIPO_DOCUMENTO_ASOC.IDTIPO, GE_TIPO_DOCUMENTO_ASOC.DESCRIPCION
       FROM GE_TIPO_DOCUMENTO_ASOC
   ORDER BY DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_GRUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_GRUA (CODIGO, CODPUE, DESCRIPCION)
AS
     SELECT CODIGO, CODPUE, DESCRIPCION
       FROM m_grua
   ORDER BY CODPUE, CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_INSTALACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_INSTALACION
(
   CODINS,
   CODPUE,
   DESPUE,
   CODAPSCT,
   NOMBRE,
   INDAGUA,
   INDELECTRICIDAD
)
AS
   SELECT I.CODINS,
          I.CODPUE,
          P.NOMBRE,
          I.CODAPSCT,
          I.NOMBRE,
          I.INDAGUA,
          I.INDELECTRICIDAD
     FROM M_INSTALACION I INNER JOIN M_PUERTO_LOCAL P ON I.CODPUE = P.CODPUE;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQASPECTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQASPECTO
(
   IDTARIFA,
   IDSUBTARIFA,
   IDEXTENSION,
   IDASPECTO,
   FECINIVIGENCIA,
   FECFINVIGENCIA,
   INDHAYESCALA,
   PREFORMATO
)
AS
   SELECT LQA.IDTARIFA,
          LQA.IDSUBTARIFA,
          LQA.IDEXTENSION,
          LQA.IDASPECTO,
          LQA.FECINIVIGENCIA,
          LQA.FECFINVIGENCIA,
          LQA.INDHAYESCALA,
          LQA.PREFORMATO
     FROM LQ_ASPECTO LQA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQBAREMOAP  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQBAREMOAP
(
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   CODIGO,
   CODBAREMO,
   FECINIVIG,
   FECFINVIG,
   DESCRIPCION,
   VALOR,
   CODPUE,
   LITUNIDADES1,
   LITUNIDADES2
)
AS
     SELECT IDTARIFA,
            IDSUBTARIFA,
            EXTENSION,
            CODIGO,
            CODBAREMO,
            FECINIVIG,
            FECFINVIG,
            DESCRIPCION,
            CASE
               WHEN valor < 1 THEN '0' || REPLACE (VALOR, '.', ',')
               ELSE REPLACE (VALOR, '.', ',')
            END,
            CODPUE,
            LITUNIDADES1,
            LITUNIDADES2
       FROM LQ_BAREMOAP
   ORDER BY FECINIVIG DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQBORRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQBORRADOR
(
   PUERTO,
   CODPUE,
   ANYO,
   CODBORRADOR,
   DESCRIPCION,
   FECLIQ,
   CONCEPTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   GUIDSRV,
   NUMESCALA,
   IDPROCESO,
   FECINISER,
   FECFINSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   IDCLIENTE,
   CIFCLIENTE,
   NOMBRECLIENTE,
   CODAPSCTCLIENTE,
   CODTIPO,
   TIPO
)
AS
   SELECT M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.GUIDSRV,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDPROCESO,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.IDCLIENTE,
          LQ_BORRADOR.CIFCLIENTE,
          LQ_BORRADOR.NOMBRECLIENTE,
          LQ_BORRADOR.CODAPSCTCLIENTE,
          LQ_BORRADOR.CODTIPO,
          LQ_TIPOBORRADOR.DESCRIPCION
     FROM LQ_BORRADOR
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_BORRADOR.CODPUE)
          INNER JOIN LQ_TIPOBORRADOR
             ON (LQ_BORRADOR.CODTIPO = LQ_TIPOBORRADOR.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQCENTROCOSTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQCENTROCOSTE (CODIGO, DESCRIPCION)
AS
   SELECT C.CODIGO, C.DESCRIPCION
     FROM LQ_CENTROCOSTE C;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQSUBCUENTA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQSUBCUENTA (CODIGO, DESCRIPCION)
AS
   SELECT S.CODIGO, S.DESCRIPCION
     FROM LQ_SUBCUENTA S;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_LQ_FACTURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_LQ_FACTURA
(
   NOMBRE,
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   FECFACTURA,
   CODCLIENTE,
   NOMCLIENTE,
   TASASTARIFAS,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   CODESTADO,
   ESTADO,
   REFERENCIA
)
AS
   SELECT DISTINCT (M_PUERTO_LOCAL.NOMBRE),
                   LQ_FACTURA.CODPUEFACTURA,
                   LQ_FACTURA.CODSERFACTURA,
                   LQ_FACTURA.ANYOFACTURA,
                   LQ_FACTURA.NUMFACTURA,
                   LQ_FACTURA.FECFACTURA,
                   LQ_FACTURA.CODCLIENTE,
                   LQ_FACTURA.NOMCLIENTE,
                   LQ_FACTURA.TASASTARIFAS,
                   LQ_FACTURA.IMPBASE,
                   LQ_FACTURA.IMPIVA,
                   LQ_FACTURA.IMPTOTAL,
                   LQ_FACTURA.CODESTFACTURA,
                   LQ_FACTURA_ESTADO.DESESTFACTURA,
                   LQ_FACTURA.REFERENCIA
     FROM LQ_FACTURA
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LQ_FACTURA.CODPUEFACTURA)
          INNER JOIN LQ_FACTURA_ESTADO
             ON (LQ_FACTURA.CODESTFACTURA = LQ_FACTURA_ESTADO.CODESTFACTURA);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MENCOARRI  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MENCOARRI (CODIGO, CODSIME, CODPUE)
AS
     SELECT CODIGO, CODSIME, CODPUE
       FROM MEN_COARRI
      WHERE INDBAJA = '0'
   ORDER BY CODPUE, CODIGO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MENCOARRIDETALLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MENCOARRIDETALLE
(
   CODMENSAJE,
   CODIGO,
   MATRICULA
)
AS
     SELECT CODMENSAJE, CODIGO, MATRICULA
       FROM MEN_COARRIDETALLE
   ORDER BY CODMENSAJE, CODIGO, MATRICULA ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MERCANCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MERCANCIA
(
   CODARAN,
   DESCRIPCION,
   INDACEITETRAFINT,
   VERSION,
   FECINIVIG,
   FECFINVIG
)
AS
     SELECT CODARAN,
            DESCRIPCION,
            INDACEITETRAFINT,
            VERSION,
            FECINIVIG,
            FECFINVIG
       FROM M_MERCANCIA
   ORDER BY DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MINSTALESPECIAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MINSTALESPECIAL (CODIGO, DESCRIPCION)
AS
     SELECT A.CODIGO, A.DESCRIPCION
       FROM M_INSTALESPECIAL A
   ORDER BY A.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MMAQUINARIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MMAQUINARIA
(
   IDMAQUINA,
   CODPUE,
   REFERENCIA,
   DESCMAQUINA,
   CODCENTROCOSTE,
   IDTIPOMAQUINARIA,
   DESCTIPOMAQUINARIA
)
AS
   SELECT MAQ.IDMAQUINA,
          MAQ.CODPUE,
          MAQ.REFERENCIA,
          MAQ.DESCMAQUINA,
          MAQ.CODCENTROCOSTE,
          MAQ.IDTIPOMAQUINARIA,
          SMT.DESCTIPOMAQUINARIA
     FROM    M_MAQUINARIA MAQ
          JOIN
             SGC_MAQUINARIA_TIPO SMT
          ON SMT.IDTIPOMAQUINARIA = MAQ.IDTIPOMAQUINARIA
    WHERE MAQ.INDBAJA IS NULL OR MAQ.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MMUELLETRAMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MMUELLETRAMO
(
   CODPUE,
   DESPUE,
   CODMUELLE,
   MUELLE,
   CODTRAMO,
   DESCRIPCION
)
AS
   SELECT M_MUELLE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_MUELLE.CODIGO,
          M_MUELLE.DESCRIPCION,
          M_MUELLETRAMO.CODTRAMO,
          M_MUELLETRAMO.DESCRIPCION
     FROM M_MUELLETRAMO
          INNER JOIN M_MUELLE
             ON M_MUELLE.CODIGO = M_MUELLETRAMO.CODMUELLE
          INNER JOIN M_PUERTO_LOCAL
             ON M_PUERTO_LOCAL.CODPUE = M_MUELLE.CODPUE;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MPOBLACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MPOBLACION
(
   CODPOB,
   NOMBRE,
   CODPROVINCIA,
   PROVINCIA
)
AS
     SELECT M_POBLACION.CODPOB,
            M_POBLACION.NOMBRE,
            M_POBLACION.CODPROVINCIA,
            M_PROVINCIA.NOMBRE
       FROM    M_POBLACION
            LEFT JOIN
               M_PROVINCIA
            ON (M_POBLACION.CODPROVINCIA = M_PROVINCIA.CODPROVINCIA)
   ORDER BY M_POBLACION.NOMBRE;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MUELLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MUELLE
(
   CODIGO,
   DESCRIPCION,
   CODPUE,
   DESPUE,
   CODZONA,
   INDFONDEO
)
AS
     SELECT M_MUELLE.CODIGO,
            M_MUELLE.DESCRIPCION,
            M_MUELLE.CODPUE,
            M_PUERTO_LOCAL.NOMBRE,
            M_MUELLE.CODZONAAGUA,
            M_MUELLE.INDFONDEO
       FROM    M_MUELLE
            INNER JOIN
               M_PUERTO_LOCAL
            ON (M_MUELLE.CODPUE = M_PUERTO_LOCAL.CODPUE)
   ORDER BY CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_MZONAMUELLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_MZONAMUELLE
(
   CODIGO,
   DESCRIPCION,
   CODPUE,
   DESPUE
)
AS
   SELECT E.CODIGO,
          E.DESCRIPCION,
          E.CODPUE,
          P.NOMBRE
     FROM M_ZONAMUELLE E INNER JOIN M_PUERTO_LOCAL P ON (E.CODPUE = P.CODPUE);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_M_USUARIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_M_USUARIO
(
   CODUSUARIO,
   NOMBRE,
   APELLIDOS,
   NOMBRECOMPLETO,
   CODTIPODOCUMENTO,
   DESCRIPCION,
   NUMDOC,
   PAGINAWEB
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.NOMBRE,
          M_USUARIO.APELLIDOS,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.CODTIPODOCUMENTO,
          TIPO_DOCUMENTO.DESCRIPCION,
          NUMDOC,
          PAGINAWEB
     FROM M_USUARIO, TIPO_DOCUMENTO
    WHERE M_USUARIO.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_NAVIERA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_NAVIERA (CODIGO, CIF, NOMBRE)
AS
   SELECT CODIGO, CIF, NOMBRE FROM M_NAVIERA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_OPERACIONAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_OPERACIONAGUA
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   NUMESCALA,
   BUQUE,
   CODIMO,
   FECINI,
   FECINISTRING,
   FECFIN,
   FECFINSTRING,
   NOMBRESUJETO,
   CIFSUJETO,
   IDSUJPASIVO,
   CODAPSCT
)
AS
     SELECT OPERACION.CODPUE,
            OPERACION.ANYO,
            OPERACION.CODESCALA,
            OPERACION.CODESTADIA,
            OPERACION.CODOPERACION,
            ESCALA.NUMESCALA,
            M_BUQUE.NOMBRE,
            M_BUQUE.CODIMO,
            OPERACION.FECINI,
            TO_CHAR (OPERACION.FECINI, 'dd/MM/rrrr HH24:mi'),
            OPERACION.FECFIN,
            TO_CHAR (OPERACION.FECFIN, 'dd/MM/rrrr HH24:mi'),
            M_USUARIO.NOMBRECOMPLETO,
            M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
            M_USUARIO.CODUSUARIO,
            M_USUARIO.CODAPSCT
       FROM OPERACION
            INNER JOIN ESTADIA
               ON (    OPERACION.CODPUE = ESTADIA.CODPUE
                   AND OPERACION.ANYO = ESTADIA.ANYO
                   AND OPERACION.CODESCALA = ESTADIA.CODESCALA
                   AND OPERACION.CODESTADIA = ESTADIA.CODESTADIA)
            INNER JOIN ESCALA
               ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                   AND ESTADIA.ANYO = ESCALA.ANYO
                   AND ESTADIA.CODESCALA = ESCALA.CODESCALA)
            INNER JOIN M_USUARIO
               ON (OPERACION.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
            INNER JOIN M_BUQUE
               ON (M_BUQUE.CODBUQUE = ESCALA.CODBUQUE)
      WHERE OPERACION.CODTIPOPE = '02'
   ORDER BY ESCALA.NUMESCALA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PAIS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PAIS (CODPAIS, NOMBRE)
AS
     SELECT CODPAIS, NOMBRE
       FROM M_PAIS
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PANTALAN  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PANTALAN
(
   CODPAN,
   CODINS,
   CODPUE,
   DESPUE,
   CODAPSCT
)
AS
   SELECT P.CODPAN,
          P.CODINS,
          P.CODPUE,
          PU.NOMBRE,
          P.CODAPSCT
     FROM M_PANTALAN P INNER JOIN M_PUERTO_LOCAL PU ON P.CODPUE = PU.CODPUE;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PASARELA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PASARELA (CODIGO, CODPUE, DESCRIPCION)
AS
     SELECT CODIGO, CODPUE, DESCRIPCION
       FROM m_pasarela
   ORDER BY CODPUE, CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PRACTICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PRACTICO
(
   CODUSUARIO,
   CODAPSCT,
   NOMBRECOMPLETO,
   CODPUE,
   PUERTO,
   NUMERODOC
)
AS
   SELECT A.CODUSUARIO,
          A.CODAPSCT,
          A.NOMBRECOMPLETO,
          P.CODPUE,
          B.NOMBRE AS PUERTO,
          A.NUMDOC || A.LETRANIF AS NUMERODOC
     FROM M_USUARIO A
          LEFT JOIN M_USUARIO_TIPOUSUARIO C
             ON A.CODUSUARIO = C.CODUSUARIO
          LEFT JOIN M_USUARIO_PUERTO P
             ON P.CODUSUARIO = A.CODUSUARIO
          LEFT JOIN M_PUERTO_LOCAL B
             ON P.CODPUE = B.CODPUE
    WHERE C.CODTIPUSUARIO = 'PR';


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PROPIETARIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PROPIETARIO
(
   CODUSUARIO,
   CODAPSCT,
   NOMBRECOMPLETO,
   CODPUE,
   PUERTO,
   NUMERODOC
)
AS
   SELECT U.CODUSUARIO,
          U.CODAPSCT,
          U.NOMBRECOMPLETO,
          PU.CODPUE,
          P.NOMBRE,
          U.NUMDOC || U.LETRANIF
     FROM M_USUARIO U
          LEFT JOIN M_USUARIO_PUERTO PU
             ON PU.CODUSUARIO = U.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL P
             ON (PU.CODPUE = P.CODPUE);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_PUERTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_PUERTO
(
   CODPAI,
   PAIS,
   CODPUE,
   PUERTO
)
AS
     SELECT M_PAIS.CODPAIS AS CODPAI,
            M_PAIS.NOMBRE AS PAIS,
            M_PUERTO.CODPUE,
            M_PUERTO.NOMBRE AS PUERTO
       FROM M_PUERTO, M_PAIS
      WHERE M_PUERTO.CODPAIS = M_PAIS.CODPAIS
   ORDER BY PAIS ASC, PUERTO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_RECEPTORMERCANCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_RECEPTORMERCANCIA (CODIGO, NOMBRE)
AS
     SELECT CODIGO, NOMBRE
       FROM M_RECEPTOR_MERCANCIA
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_RUTACONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_RUTACONTADOR
(
   CODIGO,
   CODPUE,
   DESCRIPCION,
   CODZONA,
   ZONA
)
AS
   SELECT R.CODIGO,
          R.CODPUE,
          R.DESCRIPCION,
          R.CODZONA,
          Z.DESCRIPCION
     FROM    M_RUTACONTADOR R
          LEFT JOIN
             M_ZONACONTAGUA Z
          ON (Z.CODIGO = R.CODZONA);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SAN_APARTADO_ARTICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SAN_APARTADO_ARTICULO
(
   CODARTICULO,
   DESARTICULO,
   CODAPARTADO,
   DESAPARTADO
)
AS
     SELECT APA.CODARTICULO,
            ART.DESARTICULO,
            CODAPARTADO,
            DESAPARTADO
       FROM    SAN_APARTADO_ARTICULO APA
            LEFT JOIN
               SAN_ARTICULO ART
            ON APA.CODARTICULO = ART.CODARTICULO
   ORDER BY CODARTICULO ASC, CODAPARTADO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SAN_ARTICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SAN_ARTICULO (CODARTICULO, DESARTICULO)
AS
     SELECT CODARTICULO, DESARTICULO
       FROM SAN_ARTICULO
   ORDER BY CODARTICULO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SAN_DENUNCIADO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SAN_DENUNCIADO
(
   IDDENUNCIADO,
   NUMDOCUMENTO,
   NOMBRE
)
AS
     SELECT IDDENUNCIADO, NUMDOCUMENTO, NOMBRE
       FROM SAN_DENUNCIADO
   ORDER BY NOMBRE DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SAN_PARTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SAN_PARTE
(
   CODPUE,
   ANYO,
   NUMPARTE,
   FECPARTE
)
AS
     SELECT CODPUE,
            ANYO,
            NUMPARTE,
            FECPARTE
       FROM SAN_PARTE
   ORDER BY ANYO DESC, NUMPARTE DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SAN_VEHICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SAN_VEHICULO
(
   IDVEHICULO,
   MATRICULA,
   MARCAMODELO,
   IDDENUNCIADO,
   NUMDOCUMENTO,
   NOMBRE
)
AS
     SELECT V.IDVEHICULO,
            V.MATRICULA,
            V.MARCAMODELO,
            D.IDDENUNCIADO,
            D.NUMDOCUMENTO,
            D.NOMBRE
       FROM    SAN_VEHICULO V
            LEFT JOIN
               SAN_DENUNCIADO D
            ON V.IDDENUNCIADO = D.IDDENUNCIADO
   ORDER BY V.MATRICULA ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SERVICIOMARITIMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SERVICIOMARITIMO
(
   CODSERVICIO,
   NOMBRE,
   CODPUE
)
AS
     SELECT CODSERVICIO, NOMBRE, CODPUE
       FROM M_SERVICIOMARITIMO
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SERVMARITBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SERVMARITBUQUE
(
   CODSERVICIO,
   NOMBRE,
   CODPUE,
   CODBUQUE,
   FECINICIO,
   FECFIN
)
AS
     SELECT B.CODSERVICIO,
            S.NOMBRE,
            S.CODPUE,
            B.CODBUQUE,
            B.FECINICIO,
            B.FECFIN
       FROM    M_SERVMARIT_BUQUE B
            INNER JOIN
               M_SERVICIOMARITIMO S
            ON S.CODSERVICIO = B.CODSERVICIO
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_SUBGRUPONATURALEZA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_SUBGRUPONATURALEZA
(
   CODIGO,
   DESCRIPCION,
   CODGRUPO,
   DESGRUPO
)
AS
     SELECT EST_SUBGRUPO_NATURALEZA.CODIGO,
            EST_SUBGRUPO_NATURALEZA.DESCRIPCION,
            EST_GRUPO_NATURALEZA.CODIGO,
            EST_GRUPO_NATURALEZA.DESCRIPCION
       FROM    EST_SUBGRUPO_NATURALEZA
            INNER JOIN
               EST_GRUPO_NATURALEZA
            ON (EST_SUBGRUPO_NATURALEZA.CODGRUPO = EST_GRUPO_NATURALEZA.CODIGO)
   ORDER BY EST_GRUPO_NATURALEZA.DESCRIPCION;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_T0EMBDEPBASENOAP  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_T0EMBDEPBASENOAP
(
   CODIGO,
   CODPUE,
   ANYO,
   CODEMBARCACION,
   EMBARCACION,
   MATRICULA
)
AS
   SELECT E.CODIGO,
          E.CODPUE,
          E.ANYO,
          E.CODEMBARCACION,
          EM.NOMBRE,
          EM.MATRICULA
     FROM    T0_EMBDEPBASENOAP E
          INNER JOIN
             M_EMBARCACION EM
          ON (E.CODEMBARCACION = EM.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_T8TIPOSUMINAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_T8TIPOSUMINAGUA
(
   CODIGO,
   DESCRIPCION,
   FECINIVIG,
   FECFINVIG,
   CODPUE,
   DESPUE,
   INDAPLICABUQUE,
   INDAPLICAINSTFIJA,
   INDAPLICAOTROS
)
AS
     SELECT CODIGO,
            DESCRIPCION,
            FECINIVIG,
            FECFINVIG,
            T8_TIPOSUMINAGUA.CODPUE,
            M_PUERTO_LOCAL.NOMBRE,
            INDAPLICABUQUE,
            INDAPLICAINSTFIJA,
            INDAPLICAOTROS
       FROM    T8_TIPOSUMINAGUA
            INNER JOIN
               M_PUERTO_LOCAL
            ON M_PUERTO_LOCAL.CODPUE = T8_TIPOSUMINAGUA.CODPUE
   ORDER BY FECINIVIG DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_T8TIPOSUMINELEC  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_T8TIPOSUMINELEC
(
   CODIGO,
   DESCRIPCION,
   INDAPLICABUQUE,
   INDAPLICAINSTFIJA,
   INDAPLICAOTROS,
   FECINIVIG,
   FECFINVIG,
   CODPUE,
   DESPUE
)
AS
     SELECT CODIGO,
            DESCRIPCION,
            INDAPLICABUQUE,
            INDAPLICAINSTFIJA,
            INDAPLICAOTROS,
            FECINIVIG,
            FECFINVIG,
            T8_TIPOSUMINELEC.CODPUE,
            M_PUERTO_LOCAL.NOMBRE
       FROM    T8_TIPOSUMINELEC
            INNER JOIN
               M_PUERTO_LOCAL
            ON M_PUERTO_LOCAL.CODPUE = T8_TIPOSUMINELEC.CODPUE
   ORDER BY FECINIVIG DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_T8TIPOSUMINOTROS  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_T8TIPOSUMINOTROS
(
   CODIGO,
   DESCRIPCION,
   CODTIPOSUMIN,
   FECINIVIG,
   FECFINVIG,
   CODPUE,
   DESPUE
)
AS
     SELECT CODIGO,
            DESCRIPCION,
            CODTIPOSUMIN,
            FECINIVIG,
            FECFINVIG,
            T8_TIPOSUMINOTROS.CODPUE,
            M_PUERTO_LOCAL.NOMBRE
       FROM    T8_TIPOSUMINOTROS
            INNER JOIN
               M_PUERTO_LOCAL
            ON M_PUERTO_LOCAL.CODPUE = T8_TIPOSUMINOTROS.CODPUE
   ORDER BY FECINIVIG DESC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TARIFA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TARIFA
(
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   DESCRIPCION,
   INDPRECIOPUBLICO,
   OBSERVACIONES,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF,
   CODSUBCUENTA,
   CENTROCOSTE,
   CODIDIOMA,
   INDAPLICADIVERSOS
)
AS
   SELECT LQT.IDTARIFA,
          LQT.IDSUBTARIFA,
          LQT.EXTENSION,
          LQT.DESCRIPCION,
          LQT.INDPRECIOPUBLICO,
          LQT.OBSERVACIONES,
          LQT.USRALTA,
          LQT.USRMODIF,
          LQT.FECALTA,
          LQT.FECMODIF,
          LQT.CODSUBCUENTA,
          LQT.CENTROCOSTE,
          'ES',
          LQT.INDAPLICADIVERSOS
     FROM LQ_TARIFA LQT;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TERMINAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TERMINAL
(
   CODTERMINAL,
   CODPUE,
   DESCRIPCION
)
AS
     SELECT CODTERMINAL, CODPUE, DESCRIPCION
       FROM M_TERMINAL
   ORDER BY DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TIPOBULTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TIPOBULTO (CODIGO, DESCRIPCION)
AS
     SELECT CODIGO, DESCRIPCION
       FROM G3_TIPOBULTO
   ORDER BY DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TIPOBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TIPOBUQUE
(
   CODTIPOBUQUE,
   DESCRIPCION,
   CODTIPOOPPE,
   TIPOOPPE
)
AS
     SELECT T.CODTIPOBUQUE,
            T.DESCRIPCION,
            T.CODTIPOOPPE,
            TOP.DESCRIPCION
       FROM    TIPO_BUQUE T
            LEFT JOIN
               TIPO_BUQUEOPPE TOP
            ON (T.CODTIPOOPPE = TOP.CODIGO)
   ORDER BY T.DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TIPOBUQUEEDI  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TIPOBUQUEEDI (CODIGO, DESCRIPCION)
AS
     SELECT T.CODIGO, T.DESCRIPCION
       FROM TIPO_BUQUE_EDI T
   ORDER BY T.CODIGO ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TIPOTAMEQUIP  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TIPOTAMEQUIP (CODIGO, DESCRIPCION)
AS
     SELECT CODIGO, DESCRIPCION
       FROM G3_TIPOTAMEQUIP
   ORDER BY DESCRIPCION ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TIPO_CARGA_OPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TIPO_CARGA_OPERACION (CODIGO, DESCRIPCION)
AS
     SELECT CODTIPCARGA, NOMBRE
       FROM TIPO_CARGA_OPERACION
      WHERE BAJA = '0'
   ORDER BY NOMBRE ASC;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_TOMACONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_TOMACONTADOR
(
   CODIGO,
   CODPUE,
   DESCRIPCION,
   ZONA,
   DESZONA,
   RUTA,
   DESRUTA,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO
)
AS
   SELECT T.CODIGO,
          T.CODPUE,
          T.DESCRIPCION,
          T.ZONA,
          Z.DESCRIPCION,
          T.RUTA,
          R.DESCRIPCION,
          t.codtiposuministro,
          ts.descripcion
     FROM M_TOMACONTADOR T
          LEFT JOIN M_ZONACONTAGUA Z
             ON (Z.CODIGO = T.ZONA)
          LEFT JOIN M_RUTACONTADOR R
             ON (R.CODIGO = T.RUTA)
          INNER JOIN t8_tiposuministro tS
             ON (TS.CODIGO = t.codtiposuministro);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ZONACONTAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ZONACONTAGUA (CODIGO, CODPUE, DESCRIPCION)
AS
   SELECT CODIGO, CODPUE, DESCRIPCION FROM M_ZONACONTAGUA;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_LUP_ZONAOCUP  (View)
--

CREATE OR REPLACE FORCE VIEW V_LUP_ZONAOCUP
(
   CODPUE,
   CODZONA,
   CODTIPOZONA,
   TIPOZONA,
   DESCRIPCION
)
AS
   SELECT M_ZONAOCUP.CODPUE,
          M_ZONAOCUP.CODZONA,
          M_ZONAOCUP.CODTIPOZONA,
          OCUPSUP_TIPOOPE.DESCRIPCION,
          M_ZONAOCUP.DESCRIPCION
     FROM    M_ZONAOCUP
          LEFT JOIN
             OCUPSUP_TIPOOPE
          ON (OCUPSUP_TIPOOPE.CODIGO = M_ZONAOCUP.CODTIPOZONA);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_AGUAMOTIVEXENCION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_AGUAMOTIVEXENCION (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM AGUA_MOTIVEXENCION E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_ALARMAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ALARMAS
(
   IDALARMA,
   IDCAMPO,
   IDINFORME,
   USR,
   NOMUSU,
   FECVENC,
   NUMDIAS,
   FECAVISO,
   TIPOAVISO,
   TEXTOALARMA,
   ETIQUETA,
   INDGENERICA,
   GENERICA,
   GUIDSRV,
   INDAVISAR,
   AVISAR
)
AS
   SELECT GE_ALARMA.IDALARMA,
          GE_ALARMA.IDCAMPO,
          GE_ALARMA.IDINFORME,
          GE_ALARMA.USR,
          GU_USUARIO_APLICACION.NOMBRE,
          GE_ALARMA.FECVENC,
          GE_ALARMA.NUMDIAS,
          GE_ALARMA.FECAVISO,
          GE_ALARMA.TIPOAVISO,
          GE_ALARMA.TEXTOALARMA,
          GE_ALARMA.ETIQUETA,
          GE_ALARMA.INDGENERICA,
          DECODE (INDGENERICA, '0', 'No', 'Si') AS GENERICA,
          GE_ALARMA.GUIDSRV,
          GE_ALARMA.INDAVISAR,
          DECODE (GE_ALARMA.INDAVISAR, '0', 'No', 'Si')
     FROM GE_ALARMA, GU_USUARIO_APLICACION
    WHERE GE_ALARMA.USR = GU_USUARIO_APLICACION.USR;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_ALERTAAEBORRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ALERTAAEBORRADOR
(
   CODALERTA,
   FECCREACION,
   CODPUE,
   DESPUE,
   CLIENTE,
   NOMBRECLIENTE,
   CIFCLIENTE,
   CODAPSCTCLIENTE,
   DESCRIPCION,
   NUMBORRADORAE,
   TIPOTASA,
   DESTIPOTASA,
   ESTADO,
   DESESTADO,
   NUMESCALA,
   TIPOOPERACION,
   DESTIPOOPERACION,
   OBSERVACIONES,
   IMPNET
)
AS
   SELECT A.CODALERTA,
          A.FECCREACION,
          A.CODPUE,
          PU.NOMBRE,
          A.CLIENTE,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          A.DESCRIPCION,
          A.NUMBORRADORAE,
          A.TIPOTASA,
          T.DESCRIPCION,
          A.ESTADO,
          E.DESCRIPCION,
          A.NUMESCALA,
          A.TIPOOPERACION,
          DECODE (A.TIPOOPERACION,
                  'D', 'Declaracion sumaria',
                  'C', 'Manifiesto carga'),
          A.OBSERVACIONES,
          A.IMPNET
     FROM ALERTA_AEBORRADOR A
          LEFT JOIN M_PUERTO_LOCAL PU
             ON (A.CODPUE = PU.CODPUE)
          LEFT JOIN M_USUARIO U
             ON (A.CLIENTE = U.CODUSUARIO)
          LEFT JOIN LQ_TIPO_SERVICIO T
             ON (A.TIPOTASA = T.CODIGO)
          LEFT JOIN LQ_ESTADOALERTA_AE E
             ON (A.ESTADO = E.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_ALERTARODANTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ALERTARODANTES
(
   CODIGO,
   DESCRIPCION,
   MATRICULA,
   FECHA
)
AS
   SELECT A.CODIGO,
          A.DESCRIPCION,
          A.MATRICULA,
          A.FECHA
     FROM ALERTA_RODANTE A;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_AMARRES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_AMARRES
(
   CODAMARRE,
   CODPAN,
   CODINS,
   CODPUE,
   DESPUE,
   CODAPSCT,
   CODAPSCTPAN,
   CODAPSCTINS,
   NOMBRE,
   TIPOAMARRE,
   DESCTIPOAMARRE,
   ZONA,
   DESCZONA,
   ESLORAMAX,
   MANGAMAX,
   CALMAX
)
AS
   SELECT A.CODAMARRE,
          A.CODPAN,
          A.CODINS,
          A.CODPUE,
          PU.NOMBRE,
          A.CODAPSCT,
          P.CODAPSCT,
          I.CODAPSCT,
          I.NOMBRE,
          A.TIPOAMARRE,
          TA.DESCRIPCION,
          A.ZONA,
          ZA.DESCRIPCION,
          A.ESLORAMAX,
          A.MANGAMAX,
          A.CALMAX
     FROM M_AMARRE A
          LEFT JOIN M_PANTALAN P
             ON A.CODPAN = P.CODPAN
          INNER JOIN M_INSTALACION I
             ON I.CODINS = A.CODINS
          INNER JOIN M_PUERTO_LOCAL PU
             ON A.CODPUE = PU.CODPUE
          INNER JOIN TIPO_AMARRE TA
             ON A.TIPOAMARRE = TA.CODIGO
          INNER JOIN M_ZONA_AGUA ZA
             ON A.ZONA = ZA.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_ARMADORCONTENEDOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ARMADORCONTENEDOR
(
   CODIGO,
   NOMBRE,
   IDCONSIGNATARIO,
   CIFCONSIGNATARIO,
   CONSIGNATARIO,
   CODAPSCTCONSIGNATARIO,
   IDTIPOTRAFICO,
   TIPOTRAFICO,
   IDAREAGEOGRAFICA,
   AREAGEOGRAFICA,
   IDTERMINAL,
   TERMINAL
)
AS
   SELECT A.CODIGO,
          A.NOMBRE,
          A.IDCONSIGNATARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          A.IDTIPOTRAFICO,
          TT.DESCRIPCION,
          A.IDAREAGEOGRAFICA,
          AG.DESCRIPCION,
          A.IDTERMINAL,
          T.DESCRIPCION
     FROM M_ARMADORCONTENEDOR A
          LEFT JOIN M_USUARIO U
             ON (U.CODUSUARIO = A.IDCONSIGNATARIO)
          LEFT JOIN M_TIPO_TRAFICO TT
             ON (TT.CODIGO = A.IDTIPOTRAFICO)
          LEFT JOIN M_AREA_GEOGRAFICA AG
             ON (AG.CODIGO = A.IDAREAGEOGRAFICA)
          LEFT JOIN M_TERMINAL T
             ON (T.CODTERMINAL = A.IDTERMINAL);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4ARTEPESCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4ARTEPESCA (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_ARTEPESCA E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4BUQUEPESQUERO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4BUQUEPESQUERO
(
   CODIGO,
   NOMBRE,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CODARTEPESCA,
   ARTEPESCA,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCTCONSIGNATARIO,
   CODARMADOR,
   ARMADOR,
   CIFARMADOR,
   CODIGOAPSCTARMADOR,
   LISTA,
   MATRICULA,
   FOLIO,
   IDBUQUEMERCANTE,
   BUQUEMERCANTE,
   GT,
   ESLORA,
   MANGA,
   CALADO,
   CODBANDERA,
   BANDERA,
   INDBASE,
   BASE,
   INDNACIONAL,
   NACIONAL,
   INDB0MANUAL,
   B0MANUAL,
   FECULTLIQB0,
   INDBAJA,
   BAJA,
   FECBAJA,
   IDBUQUEAPLICANTERIOR,
   CONSIGAPLICANTERIOR,
   ARMADORAPLICANTERIOR,
   GUIDSRV,
   IDSUJPASIVO2,
   SUJPASIVO2,
   CIFSUJPASIVO2,
   CODIGOAPSCTSUJPASIVO2,
   IDSUJPASIVO3,
   SUJPASIVO3,
   CIFSUJPASIVO3,
   CODIGOAPSCTSUJPASIVO3
)
AS
   SELECT BP.CODIGO,
          BP.NOMBRE,
          BP.CODTIPOBUQUE,
          TB.NOMBRE,
          BP.CODARTEPESCA,
          A.DESCRIPCION,
          BP.CODCONSIGNATARIO,
          CON.NOMBRECOMPLETO,
          CON.NUMDOC || CON.LETRANIF,
          CON.CODAPSCT,
          BP.CODARMADOR,
          AR.NOMBRECOMPLETO,
          AR.NUMDOC || CON.LETRANIF,
          AR.CODAPSCT,
          BP.LISTA,
          BP.MATRICULA,
          BP.FOLIO,
          BP.IDBUQUEMERCANTE,
          B.NOMBRE,
          BP.GT,
          BP.ESLORA,
          BP.MANGA,
          BP.CALADO,
          BP.BANDERA,
          P.NOMBRE,
          BP.INDBASE,
          DECODE (BP.INDBASE, '1', 'Si', 'No'),
          BP.INDNACIONAL,
          DECODE (BP.INDNACIONAL, '1', 'Si', 'No'),
          BP.INDB0MANUAL,
          DECODE (BP.INDB0MANUAL, '1', 'Si', 'No'),
          BP.FECULTLIQB0,
          BP.INDBAJA,
          DECODE (BP.INDBAJA, '1', 'Si', 'No'),
          BP.FECBAJA,
          BP.IDBUQUEAPLICANTERIOR,
          BP.CONSIGAPLICANTERIOR,
          BP.ARMADORAPLICANTERIOR,
          BP.GUIDSRV,
          BP.IDSUJPASIVO2,
          S2.NOMBRECOMPLETO,
          S2.NUMDOC || S2.LETRANIF,
          S2.CODAPSCT,
          BP.IDSUJPASIVO3,
          S3.NOMBRECOMPLETO,
          S3.NUMDOC || S3.LETRANIF,
          S3.CODAPSCT
     FROM B4_BUQUEPESQUERO BP
          INNER JOIN B4_TIPOBUQUE TB
             ON BP.CODTIPOBUQUE = TB.CODIGO
          LEFT JOIN B4_ARTEPESCA A
             ON BP.CODARTEPESCA = A.CODIGO
          INNER JOIN M_PAIS P
             ON BP.BANDERA = P.CODPAIS
          LEFT JOIN M_USUARIO CON
             ON BP.CODCONSIGNATARIO = CON.CODUSUARIO
          LEFT JOIN M_USUARIO AR
             ON BP.CODARMADOR = AR.CODUSUARIO
          LEFT JOIN M_BUQUE B
             ON BP.IDBUQUEMERCANTE = B.CODBUQUE
          LEFT JOIN M_USUARIO S2
             ON BP.IDSUJPASIVO2 = S2.CODUSUARIO
          LEFT JOIN M_USUARIO S3
             ON BP.IDSUJPASIVO3 = S3.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4COMPRADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4COMPRADOR
(
   CODIGO,
   DESCRIPCION,
   NUMDOCUMENTO
)
AS
   SELECT E.CODIGO, E.DESCRIPCION, E.NUMDOCUMENTO
     FROM B4_COMPRADOR E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4DESTINO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4DESTINO (CODIGO, NOMBRE)
AS
   SELECT E.CODIGO, E.NOMBRE
     FROM B4_DESTINO E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4ESPECIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4ESPECIE
(
   CODIGO,
   CODFAO,
   NOMBRE,
   CODTIPOCAPTURA,
   TIPOCAPTURA
)
AS
   SELECT E.CODIGO,
          E.CODFAO,
          E.NOMBRE,
          E.CODTIPOCAPTURA,
          T.DESCRIPCION
     FROM    B4_ESPECIE E
          INNER JOIN
             B4_TIPOCAPTURA T
          ON E.CODTIPOCAPTURA = T.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4ESPECIEFAO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4ESPECIEFAO
(
   SECUENCIAL,
   CODPOSIDONIA,
   CODFAO
)
AS
   SELECT T.SECUENCIAL, T.CODPOSIDONIA, T.CODFAO
     FROM B4_ESPECIE_FAO T;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4FAMILIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4FAMILIA
(
   CODIGO,
   NOMBRE,
   CODGRUPO,
   GRUPO
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODGRUPO,
          F.DESCRIPCION
     FROM B4_FAMILIA E INNER JOIN B4_GRUPOFAMILIA F ON E.CODGRUPO = F.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4GRUPOFAMILIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4GRUPOFAMILIA (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_GRUPOFAMILIA E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4MANIFIESTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4MANIFIESTO
(
   CODPUE,
   DESPUE,
   ANYO,
   CODMANIF,
   FECMANIFIESTO,
   CODTIPOOPERACION,
   TIPOOPERACION,
   CODTIPOVENTA,
   TIPOVENTA,
   CODTIPOIVA,
   TIPOIVA,
   CODTIPOMANIFIESTO,
   TIPOMANIFIESTO,
   REFERENCIA,
   IDSUJPASIVO,
   SUJPASIVO,
   CIFSUJPASIVO,
   CODIGOAPSCTSUJPASIVO,
   CODBUQUEPESQUERO,
   BUQUEPESQUERO,
   CODMUELLE,
   MUELLE,
   IMPORTEMANIF,
   NUMKGMANIF,
   CODZONAPESCA,
   ZONAPESCA,
   CODARTEPESCA,
   ARTEPESCA,
   CODTIPODOC1,
   TIPODOC1,
   NUMDOC1,
   CODTIPODOC2,
   TIPODOC2,
   NUMDOC2,
   CODTIPODOC3,
   TIPODOC3,
   NUMDOC3,
   INDVIAFICHERO,
   VIAFICHERO,
   NOMFICHERO,
   INDGENERAB0,
   GENERAB0,
   INDLIQB4,
   LIQB4,
   INDEXENTOLIQB4,
   EXENTOLIQB4,
   MOTEXENTOLIQB4,
   ESTINDEXENTA,
   INDRETIRADA,
   RETIRADA,
   NUMDOCRETIRADA,
   NUMKGRETIRADA,
   FECDESCARGAORIGEN,
   PUERTOORIGEN,
   ORDEN,
   FECCARGAFICHERO,
   MATRICFICHERO,
   ARMADORFICHERO,
   VENDEDORFICHERO,
   TIPOPEFICHERO,
   FECDOCRETIRADA,
   NUEVOARMADORFICHERO,
   OBSERVACIONES
)
AS
   SELECT M.CODPUE,
          P.NOMBRE,
          M.ANYO,
          M.CODMANIF,
          M.FECMANIFIESTO,
          M.CODTIPOOPERACION,
          O.NOMBRE,
          M.CODTIPOVENTA,
          V.DESCRIPCION,
          M.CODTIPOIVA,
          I.DESCRIPCION,
          M.CODTIPOMANIFIESTO,
          TM.NOMBRE,
             M.CODTIPOMANIFIESTO
          || M.CODSUBTIPOMANIFIESTO
          || LPAD (M.REFERENCIA, 5, 0),
          M.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          M.CODBUQUEPESQUERO,
          B.NOMBRE,
          M.CODMUELLE,
          MU.DESCRIPCION,
          M.IMPORTEMANIF,
          M.NUMKGMANIF,
          M.CODZONAPESCA,
          Z.DESCRIPCION,
          M.CODARTEPESCA,
          A.DESCRIPCION,
          M.CODTIPODOC1,
          TD1.DESCRIPCION,
          M.NUMDOC1,
          M.CODTIPODOC2,
          TD2.DESCRIPCION,
          M.NUMDOC2,
          M.CODTIPODOC3,
          TD3.DESCRIPCION,
          M.NUMDOC3,
          M.INDVIAFICHERO,
          DECODE (M.INDVIAFICHERO, '1', 'Si', 'No'),
          M.NOMFICHERO,
          M.INDGENERAB0,
          DECODE (M.INDGENERAB0, '1', 'Si', 'No'),
          M.INDLIQB4,
          DECODE (M.INDLIQB4, '1', 'Si', 'No'),
          M.INDEXENTOLIQB4,
          DECODE (M.INDEXENTOLIQB4, '1', 'Si', 'No'),
          M.MOTEXENTOLIQB4,
          DECODE (M.ESTINDEXENTA, '1', 'Si', 'No'),
          M.INDRETIRADA,
          DECODE (M.INDRETIRADA, '1', 'Si', 'No'),
          M.NUMDOCRETIRADA,
          M.NUMKGRETIRADA,
          M.FECDESCARGAORIGEN,
          M.PUERTOORIGEN,
          M.ORDEN,
          M.FECCARGAFICHERO,
          M.MATRICFICHERO,
          M.ARMADORFICHERO,
          M.VENDEDORFICHERO,
          M.TIPOPEFICHERO,
          M.FECDOCRETIRADA,
          M.NUEVOARMADORFICHERO,
          M.OBSERVACIONES
     FROM B4_MANIFIESTO M
          INNER JOIN M_PUERTO_LOCAL P
             ON M.CODPUE = P.CODPUE
          INNER JOIN B4_TIPOOPERACION O
             ON M.CODTIPOOPERACION = O.CODIGO
          INNER JOIN B4_TIPOVENTA V
             ON M.CODTIPOVENTA = V.CODIGO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON M.CODTIPOIVA = I.CODIGO
          LEFT JOIN B4_TIPOMANIFIESTO TM
             ON M.CODTIPOMANIFIESTO = TM.CODIGO
          INNER JOIN M_USUARIO U
             ON M.IDSUJPASIVO = U.CODUSUARIO
          INNER JOIN B4_BUQUEPESQUERO B
             ON M.CODBUQUEPESQUERO = B.CODIGO
          LEFT JOIN M_MUELLE MU
             ON M.CODMUELLE = MU.CODIGO
          LEFT JOIN B4_ZONAPESCA Z
             ON M.CODZONAPESCA = Z.CODIGO
          LEFT JOIN B4_ARTEPESCA A
             ON M.CODARTEPESCA = A.CODIGO
          LEFT JOIN B4_TIPODOCUMENTO TD1
             ON M.CODTIPODOC1 = TD1.CODIGO
          LEFT JOIN B4_TIPODOCUMENTO TD2
             ON M.CODTIPODOC2 = TD2.CODIGO
          LEFT JOIN B4_TIPODOCUMENTO TD3
             ON M.CODTIPODOC3 = TD3.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4PARTIDA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4PARTIDA
(
   CODPUE,
   ANYO,
   CODMANIF,
   CODPARTIDA,
   CODESPECIE,
   ESPECIE,
   NUMKG,
   IMPORTE,
   CODPRESENTACION,
   PRESENTACION,
   CODCOMPRADOR,
   COMPRADOR,
   CODDESTINO,
   DESTINO,
   CODTIPOFRESCURA,
   TIPOFRESCURA,
   CODTIPOTAMANYO,
   TIPOTAMANYO,
   PRECIO
)
AS
   SELECT P.CODPUE,
          P.ANYO,
          P.CODMANIF,
          P.CODPARTIDA,
          P.CODESPECIE,
          E.NOMBRE,
          P.NUMKG,
          P.IMPORTE,
          P.CODPRESENTACION,
          PRE.DESCRIPCION,
          P.CODCOMPRADOR,
          C.DESCRIPCION,
          P.CODDESTINO,
          D.NOMBRE,
          P.CODTIPOFRESCURA,
          TF.DESCRIPCION,
          P.CODTIPOTAMANYO,
          TT.DESCRIPCION,
          P.PRECIO
     FROM B4_PARTIDA P
          INNER JOIN B4_ESPECIE E
             ON P.CODESPECIE = E.CODIGO
          LEFT JOIN B4_PRESENTACION PRE
             ON P.CODPRESENTACION = PRE.CODIGO
          LEFT JOIN B4_COMPRADOR C
             ON P.CODCOMPRADOR = C.CODIGO
          LEFT JOIN B4_DESTINO D
             ON P.CODDESTINO = D.CODIGO
          LEFT JOIN B4_TIPOFRESCURA TF
             ON P.CODTIPOFRESCURA = TF.CODIGO
          LEFT JOIN B4_TIPOTAMANYO TT
             ON P.CODTIPOTAMANYO = TT.CODIGO;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4PRESENTACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4PRESENTACION (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_PRESENTACION E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4SUBTIPOMANIFIESTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4SUBTIPOMANIFIESTO
(
   CODIGO,
   NOMBRE,
   CODTIPOMANIFIESTO,
   TIPOMANIFIESTO
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODTIPOMANIFIESTO,
          F.NOMBRE
     FROM    B4_SUBTIPOMANIFIESTO E
          INNER JOIN
             B4_TIPOMANIFIESTO F
          ON (E.CODTIPOMANIFIESTO = F.CODIGO);


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOCAPTURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOCAPTURA (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_TIPOCAPTURA E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPODOCUMENTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPODOCUMENTO (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_TIPODOCUMENTO E;


/* Formatted on 03/06/2016 9:02:47 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOFRESCURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOFRESCURA (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_TIPOFRESCURA E;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOMANIFIESTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOMANIFIESTO
(
   CODIGO,
   NOMBRE,
   CODMUELLE,
   MUELLE,
   ESTINDEXENTA,
   ESTEXENTA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.CODMUELLE,
          M.DESCRIPCION,
          E.ESTINDEXENTA,
          CASE WHEN E.ESTINDEXENTA = '1' THEN 'Si' ELSE 'No' END
     FROM    B4_TIPOMANIFIESTO E
          LEFT JOIN
             M_MUELLE M
          ON (E.CODMUELLE = M.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOOPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOOPERACION
(
   CODIGO,
   NOMBRE,
   INDGENERAB0,
   GENERAB0,
   CODTIPOVENTA,
   TIPOVENTA,
   CODBAREMOB4,
   INDEXENTOB4,
   EXENTOB4,
   CODTIPOIVA,
   TIPOIVA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.INDGENERAB0,
          DECODE (E.INDGENERAB0, '1', 'Si', 'No'),
          E.CODTIPOVENTA,
          F.DESCRIPCION,
          E.CODBAREMOB4,
          E.INDEXENTOB4,
          DECODE (E.INDEXENTOB4, '1', 'Si', 'No'),
          E.CODTIPOIVA,
          I.DESCRIPCION
     FROM B4_TIPOOPERACION E
          LEFT JOIN B4_TIPOVENTA F
             ON (E.CODTIPOVENTA = F.CODIGO)
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON E.CODTIPOIVA = I.CODIGO
    WHERE E.BAJA = '0';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOTAMANYO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOTAMANYO (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_TIPOTAMANYO E;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B4TIPOVENTA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4TIPOVENTA
(
   CODIGO,
   DESCRIPCION,
   CODTIPOIVA,
   TIPOIVA
)
AS
   SELECT E.CODIGO,
          E.DESCRIPCION,
          E.CODTIPOIVA,
          F.DESCRIPCION
     FROM    B4_TIPOVENTA E
          LEFT JOIN
             LQ_TIPO_IMPUESTOGLOBAL F
          ON E.CODTIPOIVA = F.CODIGO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B4ZONAPESCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B4ZONAPESCA (CODIGO, DESCRIPCION)
AS
   SELECT E.CODIGO, E.DESCRIPCION
     FROM B4_ZONAPESCA E;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_B5MINSTALACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_B5MINSTALACION
(
   IDINSTALACION,
   CODPUE,
   CODINSTALACION,
   REFINSTALACION,
   FECDISPOSICION,
   DESCRIPCION,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF,
   INDBAJA,
   FECBAJA
)
AS
   SELECT INST.IDINSTALACION,
          INST.CODPUE,
          INST.CODINSTALACION,
          INST.REFINSTALACION,
          INST.FECDISPOSICION,
          INST.DESCRIPCION,
          INST.FECALTA,
          INST.USRALTA,
          INST.FECMODIF,
          INST.USRMODIF,
          INST.INDBAJA,
          INST.FECBAJA
     FROM B5_M_INSTALACION INST;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BANCOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BANCOS (CODBANCO, NOMBRE)
AS
   SELECT "CODBANCO", "NOMBRE" FROM M_BANCO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BANCO_SUCURSAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BANCO_SUCURSAL
(
   CODBANCO,
   NOMBANCO,
   CODSUCURSAL,
   NOMSUCURSAL
)
AS
   SELECT B.CODBANCO,
          B.NOMBRE,
          S.CODSUCURSAL,
          S.NOMBRE
     FROM M_BANCO B, M_SUCURSAL S
    WHERE S.CODBANCO = B.CODBANCO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BARCAZAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BARCAZAS (CODIGO, NOMBRE, MATRICULA)
AS
   SELECT CODIGO, NOMBRE, MATRICULA FROM M_BARCAZA;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BUQUES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BUQUES
(
   CODIGO,
   IMO,
   NOMBRE,
   GT,
   ARMADOR,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CALMAXIMO,
   MANGA,
   ESLORATOTAL,
   POTENCIA,
   TPM,
   TBR,
   CODBANDERA,
   BANDERA,
   INDMERCANTE,
   MERCANTE,
   ESTCODTIPBUQOPPE,
   ESTTIPBUQOPPE,
   INDRORO,
   RORO,
   INDPDTEREV,
   FECINIVIG,
   FECFINVIG,
   VERSION,
   INDGNL,
   OBSERVACIONES,
   CALLSIGN,
   INDNOOPEAIS,
   NOOPEAIS,
   CODMMSI
)
AS
   SELECT M_BUQUE.CODBUQUE,
          M_BUQUE.CODIMO,
          M_BUQUE.NOMBRE,
          M_BUQUEVERSION.GT,
          M_USUARIO.NOMBRECOMPLETO,
          M_BUQUEVERSION.CODTIPOBUQUE,
          TIPO_BUQUE.DESCRIPCION,
          M_BUQUEVERSION.CALMAXIMO,
          M_BUQUEVERSION.MANGA,
          M_BUQUEVERSION.ESLORATOTAL,
          M_BUQUEVERSION.POTENCIA,
          M_BUQUEVERSION.TPM,
          M_BUQUEVERSION.TRB,
          M_BUQUEVERSION.BANDERA,
          M_PAIS.NOMBRE,
          TIPO_BUQUEOPPE.INDMERCANTE,
          DECODE (TIPO_BUQUEOPPE.INDMERCANTE, '1', 'Si', 'No'),
          TIPO_BUQUE.CODTIPOOPPE,
          TIPO_BUQUEOPPE.DESCRIPCION,
          TIPO_BUQUEOPPE.INDRORO,
          DECODE (TIPO_BUQUEOPPE.INDRORO, '1', 'Si', 'No'),
          DECODE (M_BUQUE.INDPDTEREV, '1', 'Si', 'No'),
          M_BUQUEVERSION.FECINIVIG,
          M_BUQUEVERSION.FECFINVIG,
          M_BUQUEVERSION.VERSION,
          DECODE (M_BUQUEVERSION.INDGNL, '1', 'Si', 'No'),
          M_BUQUEVERSION.OBSERVACIONES,
          M_BUQUEVERSION.CALLSIGN,
          M_BUQUEVERSION.INDNOOPEAIS,
          DECODE (M_BUQUEVERSION.INDNOOPEAIS, '1', 'Si', 'No'),
          M_BUQUEVERSION.CODMMSI
     FROM M_BUQUE
          INNER JOIN M_BUQUEVERSION
             ON M_BUQUEVERSION.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN TIPO_BUQUE
             ON (M_BUQUEVERSION.CODTIPOBUQUE = TIPO_BUQUE.CODTIPOBUQUE)
          LEFT JOIN M_PAIS
             ON (M_BUQUEVERSION.BANDERA = M_PAIS.CODPAIS)
          LEFT JOIN M_USUARIO
             ON (M_BUQUEVERSION.CODARMADOR = M_USUARIO.CODUSUARIO)
          INNER JOIN TIPO_BUQUEOPPE
             ON (TIPO_BUQUEOPPE.CODIGO = TIPO_BUQUE.CODTIPOOPPE)
    WHERE M_BUQUEVERSION.FECFINVIG IS NULL;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BUQUESCERT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BUQUESCERT
(
   CODINTERNO,
   FECINICIO,
   FECFIN,
   CODBUQUE,
   BUQUE,
   CODTIPOCERT,
   TIPOCERT,
   NUMMEDPUERTO,
   CODPAIS,
   CODPUERTO,
   DESPAIS,
   DESPUERTO,
   CODPLANRESIDUO,
   DESPLANRESIDUO,
   CODPAIS2,
   CODPUERTO2,
   CODPAIS3,
   CODPUERTO3,
   CODPAIS4,
   CODPUERTO4
)
AS
   SELECT M_BUQUECERT.CODINTERNO,
          M_BUQUECERT.FECINICIO,
          M_BUQUECERT.FECFIN,
          M_BUQUECERT.CODBUQUE,
          M_BUQUE.NOMBRE,
          TIPOCERT_BUQUE.CODIGO,
          TIPOCERT_BUQUE.DESCRIPCION,
          M_BUQUECERT.NUMMEDPUERTO,
          M_BUQUECERT.CODPAILOCODE,
          M_BUQUECERT.CODPUELOCODE,
          M_PAIS.NOMBRE,
          M_PUERTO.NOMBRE,
          M_BUQUECERT.CODPLANRESIDUO,
          TIPO_PLANRESIDUO.DESCRIPCION,
          M_BUQUECERT.CODPAILOCODE2,
          M_BUQUECERT.CODPUELOCODE2,
          M_BUQUECERT.CODPAILOCODE3,
          M_BUQUECERT.CODPUELOCODE3,
          M_BUQUECERT.CODPAILOCODE4,
          M_BUQUECERT.CODPUELOCODE4
     FROM M_BUQUECERT
          INNER JOIN M_BUQUE
             ON M_BUQUECERT.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN TIPOCERT_BUQUE
             ON M_BUQUECERT.CODTIPOCERT = TIPOCERT_BUQUE.CODIGO
          LEFT JOIN M_PUERTO
             ON M_PUERTO.CODPAIS = M_BUQUECERT.CODPAILOCODE
                AND M_PUERTO.CODPUE = M_BUQUECERT.CODPUELOCODE
          LEFT JOIN M_PAIS
             ON M_PAIS.CODPAIS = M_BUQUECERT.CODPAILOCODE
          LEFT JOIN TIPO_PLANRESIDUO
             ON TIPO_PLANRESIDUO.CODIGO = M_BUQUECERT.CODPLANRESIDUO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_BUQUESCERTGLOBAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_BUQUESCERTGLOBAL
(
   CODINTERNO,
   FECINICIO,
   FECFIN,
   CODBUQUE,
   BUQUE,
   IMO,
   CODTIPOCERT,
   TIPOCERT,
   NUMMEDPUERTO,
   CODPAIS,
   CODPUERTO,
   DESPAIS,
   DESPUERTO,
   CODPLANRESIDUO,
   DESPLANRESIDUO,
   CODPAIS2,
   CODPUERTO2,
   CODPAIS3,
   CODPUERTO3,
   CODPAIS4,
   CODPUERTO4
)
AS
   SELECT M_BUQUECERT.CODINTERNO,
          M_BUQUECERT.FECINICIO,
          M_BUQUECERT.FECFIN,
          M_BUQUECERT.CODBUQUE,
          M_BUQUE.NOMBRE,
          M_BUQUE.CODIMO,
          TIPOCERT_BUQUE.CODIGO,
          TIPOCERT_BUQUE.DESCRIPCION,
          M_BUQUECERT.NUMMEDPUERTO,
          M_BUQUECERT.CODPAILOCODE,
          M_BUQUECERT.CODPUELOCODE,
          M_PAIS.NOMBRE,
          M_PUERTO.NOMBRE,
          M_BUQUECERT.CODPLANRESIDUO,
          TIPO_PLANRESIDUO.DESCRIPCION,
          M_BUQUECERT.CODPAILOCODE2,
          M_BUQUECERT.CODPUELOCODE2,
          M_BUQUECERT.CODPAILOCODE3,
          M_BUQUECERT.CODPUELOCODE3,
          M_BUQUECERT.CODPAILOCODE4,
          M_BUQUECERT.CODPUELOCODE4
     FROM M_BUQUECERT
          INNER JOIN M_BUQUE
             ON M_BUQUECERT.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN TIPOCERT_BUQUE
             ON M_BUQUECERT.CODTIPOCERT = TIPOCERT_BUQUE.CODIGO
          LEFT JOIN M_PUERTO
             ON M_PUERTO.CODPAIS = M_BUQUECERT.CODPAILOCODE
                AND M_PUERTO.CODPUE = M_BUQUECERT.CODPUELOCODE
          LEFT JOIN M_PAIS
             ON M_PAIS.CODPAIS = M_BUQUECERT.CODPAILOCODE
          LEFT JOIN TIPO_PLANRESIDUO
             ON TIPO_PLANRESIDUO.CODIGO = M_BUQUECERT.CODPLANRESIDUO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CAMIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CAMIONES
(
   CODIGO,
   FECINICIO,
   FECFIN,
   CODUSUARIO,
   CIF,
   NOMBRECOMPLETO,
   CODAPSCT,
   MATRICULA,
   DESCRIPCION,
   LARGO,
   ANCHO,
   SUPERFICIE,
   INDMEDDESCONOCIDA,
   MEDDESCONOCIDA,
   CODTIPOELEM,
   TIPOELEM,
   CODUSUARIO2,
   CIF2,
   NOMBRECOMPLETO2,
   CODAPSCT2,
   CODUSUARIO3,
   CIF3,
   NOMBRECOMPLETO3,
   CODAPSCT3,
   CODUSUARIO4,
   CIF4,
   NOMBRECOMPLETO4,
   CODAPSCT4,
   CODUSUARIO5,
   CIF5,
   NOMBRECOMPLETO5,
   CODAPSCT5,
   CODUSUARIO6,
   CIF6,
   NOMBRECOMPLETO6,
   CODAPSCT6
)
AS
   SELECT M_CAMION.CODIGO,
          M_CAMION.FECINICIO,
          M_CAMION.FECFIN,
          M_CAMION.CODUSUARIO,
          USU.NUMDOC || USU.LETRANIF,
          USU.NOMBRECOMPLETO,
          USU.CODAPSCT,
          M_CAMION.MATRICULA,
          M_CAMION.DESCRIPCION,
          M_CAMION.LARGO,
          M_CAMION.ANCHO,
          M_CAMION.SUPERFICIE,
          M_CAMION.INDMEDDESCONOCIDA,
          DECODE (M_CAMION.INDMEDDESCONOCIDA, '1', 'Si', 'No'),
          M_CAMION.CODTIPOELEM,
          TIPO_ELEM_RODANTE.DESCRIPCION,
          M_CAMION.CODUSUARIO2,
          USU2.NUMDOC || USU2.LETRANIF,
          USU2.NOMBRECOMPLETO,
          USU2.CODAPSCT,
          M_CAMION.CODUSUARIO3,
          USU3.NUMDOC || USU3.LETRANIF,
          USU3.NOMBRECOMPLETO,
          USU3.CODAPSCT,
          M_CAMION.CODUSUARIO4,
          USU4.NUMDOC || USU4.LETRANIF,
          USU4.NOMBRECOMPLETO,
          USU4.CODAPSCT,
          M_CAMION.CODUSUARIO5,
          USU5.NUMDOC || USU5.LETRANIF,
          USU5.NOMBRECOMPLETO,
          USU5.CODAPSCT,
          M_CAMION.CODUSUARIO6,
          USU6.NUMDOC || USU6.LETRANIF,
          USU6.NOMBRECOMPLETO,
          USU6.CODAPSCT
     FROM M_CAMION
          LEFT JOIN M_USUARIO USU
             ON (M_CAMION.CODUSUARIO = USU.CODUSUARIO)
          LEFT JOIN M_USUARIO USU2
             ON (M_CAMION.CODUSUARIO2 = USU2.CODUSUARIO)
          LEFT JOIN M_USUARIO USU3
             ON (M_CAMION.CODUSUARIO3 = USU3.CODUSUARIO)
          LEFT JOIN M_USUARIO USU4
             ON (M_CAMION.CODUSUARIO4 = USU4.CODUSUARIO)
          LEFT JOIN M_USUARIO USU5
             ON (M_CAMION.CODUSUARIO5 = USU5.CODUSUARIO)
          LEFT JOIN M_USUARIO USU6
             ON (M_CAMION.CODUSUARIO6 = USU6.CODUSUARIO)
          LEFT JOIN TIPO_ELEM_RODANTE
             ON (M_CAMION.CODTIPOELEM = TIPO_ELEM_RODANTE.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_CONSEJO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_CONSEJO
(
   IDCONSEJO,
   ANYOCONSEJO,
   NUMCONSEJO,
   FECCONSEJO,
   OBSERVACIONES
)
AS
   SELECT MR.IDCONSEJO,
          MR.ANYOCONSEJO,
          MR.NUMCONSEJO,
          MR.FECCONSEJO,
          MR.OBSERVACIONES
     FROM CEN_CONSEJO MR;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_EMPLEADO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_EMPLEADO
(
   CODEMPRESA,
   NOMBRECOMPLETO,
   CODEMPLEADO,
   CODPUE,
   NOMPUE,
   CODTIPODOCUMENTO,
   DESCRIPCION,
   DOCUMENTO,
   NOMBRE,
   NUMCARNET,
   OBSERVACIONES,
   BAJA,
   FECBAJA
)
AS
   SELECT CE.CODEMPRESA,
          CEN_EMPRESA.NOMBRECOMPLETO,
          CE.CODEMPLEADO,
          CE.CODPUE,
          TP.NOMBRE,
          CE.CODTIPODOCUMENTO,
          TIPO_DOCUMENTO.DESCRIPCION,
          CE.NUMDOCUMENTO || CE.LETRANIF,
          CE.NOMBRE,
          CE.NUMCARNET,
          CE.OBSERVACIONES,
          DECODE (CE.INDBAJA, '1', 'Si', 'No'),
          CE.FECBAJA
     FROM CEN_EMPLEADO CE
          INNER JOIN CEN_EMPRESA
             ON (CE.CODEMPRESA = CEN_EMPRESA.CODEMPRESA)
          LEFT JOIN M_PUERTO_LOCAL TP
             ON TP.CODPUE = CE.CODPUE
          INNER JOIN TIPO_DOCUMENTO
             ON (CE.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_EMPRESA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_EMPRESA
(
   CODEMPRESA,
   RAZONSOCIAL,
   TIPODOC,
   NUMDOC,
   INDBAJA,
   BAJA,
   OBSERVACIONES,
   INDCENSADA,
   CENSADA,
   CODCLIENTE
)
AS
   SELECT CE.CODEMPRESA,
          CE.NOMBRECOMPLETO,
          TIPO_DOCUMENTO.DESCRIPCION,
          CE.NUMDOC || CE.LETRANIF,
          CE.INDBAJA,
          DECODE (CE.INDBAJA, '1', 'Si', 'No'),
          CE.OBSERVACIONES,
          CE.CENSADA,
          DECODE (CE.CENSADA, '1', 'Si', 'No'),
          CE.CODCLIENTE
     FROM    CEN_EMPRESA CE
          INNER JOIN
             TIPO_DOCUMENTO
          ON (CE.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_EPIGRAFE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_EPIGRAFE
(
   IDEPIGRAFE,
   CODTIPOUSUARIO,
   DESCRIPCIONTIPOUSU,
   CODEPIGRAFRE,
   DESEPIGRAFE
)
AS
   SELECT MR.IDEPIGRAFE,
          MR.CODTIPOUSUARIO,
          TE.DESCRIPCION,
          MR.CODEPIGRAFRE,
          MR.DESEPIGRAFE
     FROM    CEN_EPIGRAFE MR
          LEFT JOIN
             TIPO_USUARIO TE
          ON TE.CODTIPUSUARIO = MR.CODTIPOUSUARIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_EXPEDIENTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_EXPEDIENTE
(
   ANYOCONSEJO,
   NUMCONSEJO,
   NUMEXPEDIENTE,
   NUMGEN,
   CODESTEXPEDIENTE,
   DESESTESPEDIENTE,
   CODTIPOUSUARIO,
   DESCUSUARIO,
   CODEPIGRAFE,
   DESEPIGRAFE,
   NUMREGISTRO,
   FECREGISTRO,
   CODEMPRESA,
   NOMBRECOMPLETO,
   CODPUE,
   NUMCARNET,
   INDBAJA,
   BAJA,
   FECBAJA
)
AS
   SELECT MR.ANYOCONSEJO,
          MR.NUMCONSEJO,
          MR.NUMEXPEDIENTE,
          MR.CODPUE || MR.ANYOCONSEJO || MR.NUMCONSEJO || MR.NUMEXPEDIENTE,
          MR.CODESTEXPEDIENTE,
          TC.DESESTESPEDIENTE,
          MR.CODTIPOUSUARIO,
          TE.DESCRIPCION,
          MR.CODEPIGRAFE,
          TF.DESEPIGRAFE,
          MR.NUMREGISTRO,
          MR.FECREGISTRO,
          MR.CODEMPRESA,
          CE.NOMBRECOMPLETO,
          MR.CODPUE,
          MR.NUMCARNET,
          MR.INDBAJA,
          DECODE (MR.INDBAJA, '1', 'Si', 'No'),
          MR.FECBAJA
     FROM CEN_EXPEDIENTE MR
          LEFT JOIN CEN_EXPEDIENTE_ESTADO TC
             ON TC.CODESTEXPEDIENTE = MR.CODESTEXPEDIENTE
          LEFT JOIN TIPO_USUARIO TE
             ON TE.CODTIPUSUARIO = MR.CODTIPOUSUARIO
          LEFT JOIN CEN_EPIGRAFE TF
             ON TF.CODEPIGRAFRE = MR.CODEPIGRAFE
                AND TF.CODTIPOUSUARIO = MR.CODTIPOUSUARIO
          LEFT JOIN M_PUERTO_LOCAL TP
             ON TP.CODPUE = MR.CODPUE
          LEFT JOIN CEN_EMPRESA CE
             ON CE.CODEMPRESA = MR.CODEMPRESA;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CEN_VEHICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CEN_VEHICULO
(
   CODEMPRESA,
   NOMBRECOMPLETO,
   CODVEHICULO,
   CODTIPVEHICULO,
   DESTIPVEHICULO,
   MATRICULA,
   MARCA,
   MODELO,
   COLOR,
   NUMCARNET,
   OBSERVACIONES,
   BAJA,
   FECBAJA
)
AS
   SELECT CE.CODEMPRESA,
          CEN_EMPRESA.NOMBRECOMPLETO,
          CE.CODVEHICULO,
          CE.CODTIPVEHICULO,
          CEN_TIPO_VEHICULO.DESTIPVEHICULO,
          CE.MATRICULA,
          CE.MARCA,
          CE.MODELO,
          CE.COLOR,
          CE.NUMCARNET,
          CE.OBSERVACIONES,
          DECODE (CE.INDBAJA, '1', 'Si', 'No'),
          CE.FECBAJA
     FROM CEN_VEHICULO CE
          INNER JOIN CEN_TIPO_VEHICULO
             ON (CE.CODTIPVEHICULO = CEN_TIPO_VEHICULO.CODTIPVEHICULO)
          INNER JOIN CEN_EMPRESA
             ON (CE.CODEMPRESA = CEN_EMPRESA.CODEMPRESA);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CLIENTESERP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CLIENTESERP
(
   CODUSUARIO,
   CODAPSCT,
   NOMBRE,
   TIPODOC,
   NUMDOC,
   INDBAJA,
   BAJA,
   CODTIPUSU,
   NACIONALIDAD,
   IDIOMA,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRPAIS,
   DIRPROVINCIA,
   DIRMUNICIPIO,
   DIRCODPOSTAL,
   OBSERVACIONES,
   DESCIDIOMA,
   INDCONTADO,
   CONTADO,
   INDNOTIFELECTRONICA,
   NOTIFELECTRONICA
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NOMBRECOMPLETO,
          TIPO_DOCUMENTO.DESCRIPCION,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.INDBAJA,
          DECODE (M_USUARIO.INDBAJA, '1', 'Si', 'No'),
          M_USUARIO.CODTIPUSU,
          M_USUARIO.NACIONALIDAD,
          M_USUARIO.IDIOMA,
          M_USUARIO.DIRTIPOVIA,
          M_USUARIO.DIRNOMVIA,
          M_USUARIO.DIRNUMPORTAL,
          M_USUARIO.DIRESCALERA,
          M_USUARIO.DIRPISO,
          M_USUARIO.DIRPUERTA,
          M_USUARIO.DIRPAIS,
          M_USUARIO.DIRPROVINCIA,
          M_USUARIO.DIRMUNICIPIO,
          M_USUARIO.DIRCODPOSTAL,
          M_USUARIO.OBSERVACIONES,
          GU_IDIOMA.DESCIDIOMA,
          M_USUARIO.INDCONTADO,
          DECODE (M_USUARIO.INDCONTADO, '1', 'Si', 'No'),
          M_USUARIO.INDNOTIFELECTRONICA,
          DECODE (M_USUARIO.INDNOTIFELECTRONICA, '1', 'Si', 'No')
     FROM M_USUARIO
          INNER JOIN TIPO_DOCUMENTO
             ON (M_USUARIO.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO)
          LEFT JOIN GU_IDIOMA
             ON (M_USUARIO.IDIOMA = GU_IDIOMA.CODIDIOMA);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CLIENTESPOSIDONIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CLIENTESPOSIDONIA
(
   CODUSUARIO,
   NOMBRE,
   TIPODOC,
   NUMDOC,
   INDBAJA,
   BAJA,
   IDIOMA,
   OBSERVACIONES,
   DESCIDIOMA,
   INDCONTADO,
   CONTADO,
   CODTIPNOTIF,
   DESTIPNOTIF,
   CODTIPCOBRO,
   DESTIPCOBRO,
   IDAPLICANTERIOR,
   INDAPREMIO,
   APREMIO,
   INDFACTURAEFACE,
   FACTURAEFACE,
   CODOFICINACONTABLE,
   CODORGANOGESTOR,
   CODUNIDADTRAMITADORA
)
AS
   SELECT M_USUARIO.CODUSUARIO,
          M_USUARIO.NOMBRECOMPLETO,
          TIPO_DOCUMENTO.DESCRIPCION,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.INDBAJA,
          DECODE (M_USUARIO.INDBAJA, '1', 'Si', 'No'),
          M_USUARIO.IDIOMA,
          M_USUARIO.OBSERVACIONES,
          GU_IDIOMA.DESCIDIOMA,
          M_USUARIO.INDCONTADO,
          DECODE (M_USUARIO.INDCONTADO, '1', 'Si', 'No'),
          M_USUARIO.CODTIPONOTIF,
          LQ_TIPO_NOTIFICACION.DESTIPNOTIF,
          M_USUARIO.CODTIPOCOBRO,
          LQ_TIPO_COBRO.DESTIPCOBRO,
          M_USUARIO.IDAPLICANTERIOR,
          M_USUARIO.INDAPREMIO,
          DECODE (M_USUARIO.INDAPREMIO, '1', 'Si', 'No'),
          M_USUARIO.INDFACTURAEFACE,
          DECODE (M_USUARIO.INDFACTURAEFACE, '1', 'Si', 'No'),
          M_USUARIO_FACTURAEFACE.CODOFICINACONTABLE,
          M_USUARIO_FACTURAEFACE.CODORGANOGESTOR,
          M_USUARIO_FACTURAEFACE.CODUNIDADTRAMITADORA
     FROM M_USUARIO
          INNER JOIN TIPO_DOCUMENTO
             ON (M_USUARIO.CODTIPODOCUMENTO = TIPO_DOCUMENTO.CODIGO)
          LEFT JOIN GU_IDIOMA
             ON (M_USUARIO.IDIOMA = GU_IDIOMA.CODIDIOMA)
          LEFT JOIN LQ_TIPO_NOTIFICACION
             ON (M_USUARIO.CODTIPONOTIF = LQ_TIPO_NOTIFICACION.CODTIPNOTIF)
          LEFT JOIN LQ_TIPO_COBRO
             ON (M_USUARIO.CODTIPOCOBRO = LQ_TIPO_COBRO.CODTIPCOBRO)
          LEFT JOIN M_USUARIO_FACTURAEFACE
             ON (M_USUARIO.CODUSUARIO = M_USUARIO_FACTURAEFACE.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADORES
(
   CODPUE,
   DESPUE,
   NUMCON,
   MOVILFIJO,
   DESCMOVILFIJO,
   DESCRIPCION,
   CODTOMA,
   TOMA,
   CODRUTA,
   RUTA,
   INDBAJA,
   BAJA,
   FECBAJA,
   CODZONA,
   ZONA,
   SUBTIPOCONTFIJO,
   DESCSUBTIPOCONTFIJO,
   INDFIJOPARASUMINBUQUE,
   FIJOPARASUMINBUQUE,
   FECFABRICACION,
   FECPREVCADUCIDAD,
   DESCRIP,
   ORDENTABLET,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO,
   INDAGUASALADA,
   AGUASALADA,
   FECULTIMALECTURA,
   VALORULTIMALECTURA,
   CODSIGMA,
   CODTIPOCANON,
   TIPOCANON,
   FECULTLIQ,
   UBICACION,
   GUIDSRV,
   INDEXENTOLIQ,
   EXENTOLIQ,
   LECMAXIMA,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC
)
AS
   SELECT M_CONTADOR.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_CONTADOR.NUMCON,
          M_CONTADOR.MOVILFIJO,
          DECODE (M_CONTADOR.MOVILFIJO, 'M', 'Mvil', 'Fijo'),
          M_CONTADOR.DESCRIPCION,
          M_CONTADOR.CODTOMA,
          M_TOMACONTADOR.DESCRIPCION,
          M_CONTADOR.CODRUTA,
          M_RUTACONTADOR.DESCRIPCION,
          M_CONTADOR.INDBAJA,
          DECODE (M_CONTADOR.INDBAJA, '1', 'Si', 'No'),
          M_CONTADOR.FECBAJA,
          M_CONTADOR.CODZONA,
          M_ZONACONTAGUA.DESCRIPCION,
          M_CONTADOR.SUBTIPOCONTFIJO,
          SUBTIPO_CONTADORFIJO.DESCRIPCION,
          M_CONTADOR.INDFIJOPARASUMINBUQUE,
          DECODE (M_CONTADOR.INDFIJOPARASUMINBUQUE, '1', 'Si', 'No'),
          M_CONTADOR.FECFABRICACION,
          M_CONTADOR.FECPREVCADUCIDAD,
          M_CONTADOR.DESCRIP,
          M_CONTADOR.ORDENTABLET,
          M_CONTADOR.CODTIPOSUMINISTRO,
          T8_TIPOSUMINISTRO.DESCRIPCION,
          M_CONTADOR.INDAGUASALADA,
          DECODE (M_CONTADOR.INDAGUASALADA, '1', 'Si', 'No'),
          M_CONTADOR.FECULTIMALECTURA,
          M_CONTADOR.VALORULTIMALECTURA,
          M_CONTADOR.CODSIGMA,
          M_CONTADOR.CODTIPOCANON,
          T8_TIPOCANONXUNTA.DESCRIPCION,
          M_CONTADOR.FECULTLIQ,
          M_CONTADOR.UBICACION,
          M_CONTADOR.GUIDSRV,
          M_CONTADOR.INDEXENTOLIQ,
          DECODE (M_CONTADOR.INDEXENTOLIQ, '1', 'Si', 'No'),
          M_CONTADOR.LECMAXIMA,
          M_CONTADOR.CODTIPOSUMINAGUA,
          T8_TIPOSUMINAGUA.DESCRIPCION,
          M_CONTADOR.CODTIPOSUMINELEC,
          T8_TIPOSUMINELEC.DESCRIPCION
     FROM M_CONTADOR
          INNER JOIN M_PUERTO_LOCAL
             ON (M_CONTADOR.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_TOMACONTADOR
             ON (M_CONTADOR.CODTOMA = M_TOMACONTADOR.CODIGO)
          LEFT JOIN M_RUTACONTADOR
             ON (M_CONTADOR.CODRUTA = M_RUTACONTADOR.CODIGO)
          LEFT JOIN M_ZONACONTAGUA
             ON (M_CONTADOR.CODZONA = M_ZONACONTAGUA.CODIGO)
          LEFT JOIN SUBTIPO_CONTADORFIJO
             ON (M_CONTADOR.SUBTIPOCONTFIJO = SUBTIPO_CONTADORFIJO.CODIGO)
          INNER JOIN T8_TIPOSUMINISTRO
             ON (M_CONTADOR.CODTIPOSUMINISTRO = T8_TIPOSUMINISTRO.CODIGO)
          LEFT JOIN T8_TIPOCANONXUNTA
             ON (T8_TIPOCANONXUNTA.CODIGO = M_CONTADOR.CODTIPOCANON)
          LEFT JOIN T8_TIPOSUMINAGUA
             ON (T8_TIPOSUMINAGUA.CODIGO = M_CONTADOR.CODTIPOSUMINAGUA)
          LEFT JOIN T8_TIPOSUMINELEC
             ON (T8_TIPOSUMINELEC.CODIGO = M_CONTADOR.CODTIPOSUMINAGUA);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADORESLECTURAPERIODO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADORESLECTURAPERIODO
(
   IDLECTURA,
   CODPUECONT,
   NUMCONT,
   DESCRIPCION,
   DESCRIP,
   FECLECT,
   NUMUNIDADES,
   DESPUE,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO
)
AS
   SELECT M_CONTADOR_LECTURA.IDLECTURA,
          M_CONTADOR_LECTURA.CODPUECONT,
          M_CONTADOR_LECTURA.NUMCONT,
          M_CONTADOR.DESCRIPCION,
          M_CONTADOR.DESCRIP,
          M_CONTADOR_LECTURA.FECLECT,
          M_CONTADOR_LECTURA.NUMUNIDADES,
          M_PUERTO_LOCAL.NOMBRE,
          M_CONTADOR.CODTIPOSUMINISTRO,
          T8_TIPOSUMINISTRO.DESCRIPCION
     FROM M_CONTADOR_LECTURA
          INNER JOIN M_CONTADOR
             ON (M_CONTADOR_LECTURA.CODPUECONT = M_CONTADOR.CODPUE
                 AND M_CONTADOR_LECTURA.NUMCONT = M_CONTADOR.NUMCON)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_CONTADOR_LECTURA.CODPUECONT = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN T8_TIPOSUMINISTRO
             ON (M_CONTADOR.CODTIPOSUMINISTRO = T8_TIPOSUMINISTRO.CODIGO)
    WHERE M_CONTADOR.MOVILFIJO = 'F'
          OR M_CONTADOR.INDFIJOPARASUMINBUQUE = '1';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADORES_LECTURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADORES_LECTURA
(
   IDLECTURA,
   CODPUECONT,
   NUMCONT,
   FECLECT,
   NUMUNIDADES,
   CODTIPOLECTURA,
   TIPOLECTURA,
   INDTABLET,
   TABLET,
   FECLECTABLET,
   FECREALTABLET,
   INDLECTURADOBLADA,
   LECTURADOBLADA
)
AS
   SELECT M_CONTADOR_LECTURA.IDLECTURA,
          M_CONTADOR_LECTURA.CODPUECONT,
          M_CONTADOR_LECTURA.NUMCONT,
          M_CONTADOR_LECTURA.FECLECT,
          M_CONTADOR_LECTURA.NUMUNIDADES,
          M_CONTADOR_LECTURA.CODTIPOLECTURA,
          TIPO_LECTURA_CONTADORAGUA.DESCRIPCION,
          M_CONTADOR_LECTURA.INDTABLET,
          DECODE (M_CONTADOR_LECTURA.INDTABLET, '1', 'Si', 'No'),
          M_CONTADOR_LECTURA.FECLECTABLET,
          M_CONTADOR_LECTURA.FECREALTABLET,
          M_CONTADOR_LECTURA.INDLECTURADOBLADA,
          DECODE (M_CONTADOR_LECTURA.INDLECTURADOBLADA, '1', 'Si', 'No')
     FROM M_CONTADOR_LECTURA
          INNER JOIN M_CONTADOR
             ON (M_CONTADOR_LECTURA.CODPUECONT = M_CONTADOR.CODPUE
                 AND M_CONTADOR_LECTURA.NUMCONT = M_CONTADOR.NUMCON)
          LEFT JOIN TIPO_LECTURA_CONTADORAGUA
             ON (M_CONTADOR_LECTURA.CODTIPOLECTURA =
                    TIPO_LECTURA_CONTADORAGUA.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADORES_LECTURA_ULTIMO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADORES_LECTURA_ULTIMO
(
   IDLECTURA,
   CODPUECONT,
   NUMCONT,
   FECLECT,
   NUMUNIDADES,
   DESCRIP,
   DESCRIPCION,
   CODTIPOSUMINISTRO
)
AS
     SELECT M_CONTADOR_LECTURA.IDLECTURA,
            M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            MAX (M_CONTADOR_LECTURA.FECLECT) AS FELECT,
            M_CONTADOR_LECTURA.NUMUNIDADES,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.DESCRIPCION,
            M_CONTADOR.CODTIPOSUMINISTRO
       FROM    M_CONTADOR
            LEFT JOIN
               M_CONTADOR_LECTURA
            ON (M_CONTADOR_LECTURA.CODPUECONT = M_CONTADOR.CODPUE
                AND M_CONTADOR_LECTURA.NUMCONT = M_CONTADOR.NUMCON)
      WHERE M_CONTADOR.MOVILFIJO = 'F'
            AND (M_CONTADOR.INDFIJOPARASUMINBUQUE IS NULL
                 OR M_CONTADOR.INDFIJOPARASUMINBUQUE = '0')
            AND (M_CONTADOR_LECTURA.FECLECT =
                    ( (  SELECT MAX (SUBCONSULTA.FECLECT) AS MAX
                           FROM M_CONTADOR_LECTURA SUBCONSULTA
                          WHERE M_CONTADOR.NUMCON = SUBCONSULTA.NUMCONT
                       GROUP BY SUBCONSULTA.NUMCONT))
                 OR ( (  SELECT MAX (SUBCONSULTA.FECLECT) AS MAX
                           FROM M_CONTADOR_LECTURA SUBCONSULTA
                          WHERE M_CONTADOR.NUMCON = SUBCONSULTA.NUMCONT
                       GROUP BY SUBCONSULTA.NUMCONT))
                       IS NULL)
   GROUP BY M_CONTADOR_LECTURA.IDLECTURA,
            M_CONTADOR.CODPUE,
            M_CONTADOR.NUMCON,
            M_CONTADOR_LECTURA.NUMUNIDADES,
            M_CONTADOR.DESCRIP,
            M_CONTADOR.DESCRIPCION,
            M_CONTADOR.CODTIPOSUMINISTRO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADOR_BUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADOR_BUQUE
(
   CODBUQUE,
   ANYO,
   CODPUE,
   PUERTO,
   CONTADOR
)
AS
   SELECT CONTADOR_BUQUE.CODBUQUE,
          CONTADOR_BUQUE.ANYO,
          CONTADOR_BUQUE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          CONTADOR_BUQUE.CONTADOR
     FROM    CONTADOR_BUQUE
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (CONTADOR_BUQUE.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTADOR_SERVMARITS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTADOR_SERVMARITS
(
   CODSERV,
   CODPUE,
   PUERTO,
   ANYO,
   CONTADOR
)
AS
   SELECT CONTADOR_SERVMARIT.CODSERv,
          CONTADOR_SERVMARIT.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          CONTADOR_SERVMARIT.ANYO,
          CONTADOR_SERVMARIT.CONTADOR
     FROM    CONTADOR_SERVMARIT
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (CONTADOR_SERVMARIT.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_CONTRASTESBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_CONTRASTESBUQUE
(
   CODCONTRASTE,
   DESCRIPCION,
   ANYO,
   CODESCALA,
   CODPUE,
   NUMESCALA,
   CODBUQUE,
   BUQUE,
   CODIMO,
   CODARMADOR,
   ARMADOR,
   CIFARMADOR,
   CODESTADO,
   ESTADO,
   PUERTO,
   CODTIPCONTRASTE,
   TIPCONTRASTE,
   FECCREACION,
   FECETAESCALA,
   CODSERVMARITIMO,
   CODNAVIERAPORTEL
)
AS
   SELECT ESCALA_CONTRASTEBUQUE.CODCONTRASTE,
          ESCALA_CONTRASTEBUQUE.DESCRIPCION,
          ESCALA.ANYO,
          ESCALA.CODESCALA,
          ESCALA.CODPUE,
          ESCALA.NUMESCALA,
          M_BUQUE.CODBUQUE,
          M_BUQUE.NOMBRE,
          M_BUQUE.CODIMO,
          M_USUARIO.CODUSUARIO,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          ESTADO_CONTRASTE.CODESTADO,
          ESTADO_CONTRASTE.NOMBRE,
          M_PUERTO_LOCAL.NOMBRE,
          ESCALA_CONTRASTEBUQUE.CODTIPCONTRASTE,
          TIPO_CONTRASTEBUQUE.DESCRIPCION,
          ESCALA_CONTRASTEBUQUE.FECCREACION,
          ESCALA_CONTRASTEBUQUE.FECETAESCALA,
          ESCALA_CONTRASTEBUQUE.CODSERVMARITIMO,
          ESCALA_CONTRASTEBUQUE.CODNAVIERAPORTEL
     FROM ESCALA_CONTRASTEBUQUE
          INNER JOIN ESCALA
             ON     ESCALA_CONTRASTEBUQUE.ANYO = ESCALA.ANYO
                AND ESCALA_CONTRASTEBUQUE.CODESCALA = ESCALA.CODESCALA
                AND ESCALA_CONTRASTEBUQUE.CODPUE = ESCALA.CODPUE
          LEFT JOIN M_BUQUE
             ON ESCALA.CODBUQUE = M_BUQUE.CODBUQUE
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN M_USUARIO
             ON BV.CODARMADOR = M_USUARIO.CODUSUARIO
          INNER JOIN ESTADO_CONTRASTE
             ON ESCALA_CONTRASTEBUQUE.CODESTADO = ESTADO_CONTRASTE.CODESTADO
          INNER JOIN M_PUERTO_LOCAL
             ON ESCALA_CONTRASTEBUQUE.CODPUE = M_PUERTO_LOCAL.CODPUE
          INNER JOIN TIPO_CONTRASTEBUQUE
             ON ESCALA_CONTRASTEBUQUE.CODTIPCONTRASTE =
                   TIPO_CONTRASTEBUQUE.CODTIPCONTRASTE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DIVERSOGENERICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DIVERSOGENERICO
(
   CODIGO,
   CODPUE,
   DESPUE,
   FECINICIO,
   FECFIN,
   CODTIPOIVA,
   TIPOIVA,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODTARBAREMO,
   CODSUBTARBAREMO,
   EXTENSIONBAREMO,
   CODBAREMO,
   BAREMO,
   VALORBAREMO,
   UNIDADES1,
   UNIDADES2,
   INDLIQUIDADO,
   LIQUIDADO,
   INDEXENTOLIQ,
   EXENTOLIQ,
   MOTEXENTOLIQ,
   IDSUJPASIVO,
   SUJETOPASIVO,
   CODAPSCT,
   CIFSUJETOPASIVO,
   CODBAREMOLIN2,
   BAREMOLIN2,
   VALORBAREMOLIN2,
   UNIDADES1LIN2,
   UNIDADES2LIN2,
   CODBAREMOLIN3,
   BAREMOLIN3,
   VALORBAREMOLIN3,
   UNIDADES1LIN3,
   UNIDADES2LIN3,
   CODBAREMOLIN4,
   BAREMOLIN4,
   VALORBAREMOLIN4,
   UNIDADES1LIN4,
   UNIDADES2LIN4,
   CODBAREMOLIN5,
   BAREMOLIN5,
   VALORBAREMOLIN5,
   UNIDADES1LIN5,
   UNIDADES2LIN5,
   IMO,
   BUQUE,
   REF1LIN1,
   REF2LIN1,
   REF1LIN2,
   REF2LIN2,
   REF1LIN3,
   REF2LIN3,
   REF1LIN4,
   REF2LIN4,
   REF1LIN5,
   REF2LIN5,
   INDCOBRADOMANUAL
)
AS
   SELECT D.CODIGO,
          D.CODPUE,
          PU.NOMBRE,
          D.FECINICIO,
          D.FECFIN,
          D.CODTIPOIVA,
          I.DESCRIPCION,
          D.CODPUEESC,
          D.ANYOESC,
          D.CODESC,
          E.NUMESCALA,
          D.CODTARBAREMO,
          D.CODSUBTARBAREMO,
          D.EXTENSIONBAREMO,
          D.CODBAREMO,
          B.DESCRIPCION,
          B.VALOR,
          D.UNIDADES1,
          D.UNIDADES2,
          D.INDLIQUIDADO,
          DECODE (D.INDLIQUIDADO, '1', 'Si', 'No'),
          D.INDEXENTOLIQ,
          DECODE (D.INDEXENTOLIQ, '1', 'Si', 'No'),
          D.MOTEXENTOLIQ,
          D.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          D.CODBAREMOLIN2,
          B2.DESCRIPCION,
          B2.VALOR,
          D.UNIDADES1LIN2,
          D.UNIDADES2LIN2,
          D.CODBAREMOLIN3,
          B3.DESCRIPCION,
          B3.VALOR,
          D.UNIDADES1LIN3,
          D.UNIDADES2LIN3,
          D.CODBAREMOLIN4,
          B4.DESCRIPCION,
          B4.VALOR,
          D.UNIDADES1LIN4,
          D.UNIDADES2LIN4,
          D.CODBAREMOLIN5,
          B5.DESCRIPCION,
          B5.VALOR,
          D.UNIDADES1LIN5,
          D.UNIDADES2LIN5,
          BU.CODIMO,
          BU.NOMBRE,
          D.REF1LIN1,
          D.REF2LIN1,
          D.REF1LIN2,
          D.REF2LIN2,
          D.REF1LIN3,
          D.REF2LIN3,
          D.REF1LIN4,
          D.REF2LIN4,
          D.REF1LIN5,
          D.REF2LIN5,
          DECODE (D.INDCOBRADOMANUAL, '1', 'Si', 'No')
     FROM DIVERSO_GENERICO D
          INNER JOIN M_PUERTO_LOCAL PU
             ON D.CODPUE = PU.CODPUE
          INNER JOIN LQ_BAREMOAP B
             ON     D.CODTARBAREMO = B.IDTARIFA
                AND D.CODSUBTARBAREMO = B.IDSUBTARIFA
                AND D.EXTENSIONBAREMO = B.EXTENSION
                AND D.CODBAREMO = B.CODIGO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON D.CODTIPOIVA = I.CODIGO
          INNER JOIN M_USUARIO U
             ON D.IDSUJPASIVO = U.CODUSUARIO
          LEFT JOIN ESCALA E
             ON     D.CODPUEESC = E.CODPUE
                AND D.ANYOESC = E.ANYO
                AND D.CODESC = E.CODESCALA
          LEFT JOIN M_BUQUE BU
             ON BU.CODBUQUE = E.CODBUQUE
          LEFT JOIN LQ_BAREMOAP B2
             ON     D.CODTARBAREMOLIN2 = B2.IDTARIFA
                AND D.CODSUBTARBAREMOLIN2 = B2.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN2 = B2.EXTENSION
                AND D.CODBAREMOLIN2 = B2.CODIGO
          LEFT JOIN LQ_BAREMOAP B3
             ON     D.CODTARBAREMOLIN3 = B3.IDTARIFA
                AND D.CODSUBTARBAREMOLIN3 = B3.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN3 = B3.EXTENSION
                AND D.CODBAREMOLIN3 = B3.CODIGO
          LEFT JOIN LQ_BAREMOAP B4
             ON     D.CODTARBAREMOLIN4 = B4.IDTARIFA
                AND D.CODSUBTARBAREMOLIN4 = B4.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN4 = B4.EXTENSION
                AND D.CODBAREMOLIN4 = B4.CODIGO
          LEFT JOIN LQ_BAREMOAP B5
             ON     D.CODTARBAREMOLIN5 = B5.IDTARIFA
                AND D.CODSUBTARBAREMOLIN5 = B5.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN5 = B5.EXTENSION
                AND D.CODBAREMOLIN5 = B5.CODIGO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DIVERSOPERIODICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DIVERSOPERIODICO
(
   CODIGO,
   CODPUE,
   DESPUE,
   FECINICIO,
   FECFIN,
   CODTIPOIVA,
   TIPOIVA,
   CODPUEDP,
   CODDP,
   EXPEDIENTE,
   OBJETO,
   CODTARBAREMO,
   CODSUBTARBAREMO,
   EXTENSIONBAREMO,
   CODBAREMO,
   BAREMO,
   VALORBAREMO,
   UNIDADES1,
   UNIDADES2,
   INDEXENTOLIQ,
   EXENTOLIQ,
   MOTEXENTOLIQ,
   IDSUJPASIVO,
   SUJETOPASIVO,
   CODAPSCT,
   CIFSUJETOPASIVO,
   CODBAREMOLIN2,
   BAREMOLIN2,
   VALORBAREMOLIN2,
   UNIDADES1LIN2,
   UNIDADES2LIN2,
   CODBAREMOLIN3,
   BAREMOLIN3,
   VALORBAREMOLIN3,
   UNIDADES1LIN3,
   UNIDADES2LIN3,
   CODBAREMOLIN4,
   BAREMOLIN4,
   VALORBAREMOLIN4,
   UNIDADES1LIN4,
   UNIDADES2LIN4,
   CODBAREMOLIN5,
   BAREMOLIN5,
   VALORBAREMOLIN5,
   UNIDADES1LIN5,
   UNIDADES2LIN5,
   FECULTLIQ,
   PERIODOLIQ,
   DESCPERIODOLIQ,
   FORMALIQ,
   DESCFORMALIQ,
   INDLIQMESES,
   LIQMESES,
   GUIDSRV,
   REF1LIN1,
   REF2LIN1,
   REF1LIN2,
   REF2LIN2,
   REF1LIN3,
   REF2LIN3,
   REF1LIN4,
   REF2LIN4,
   REF1LIN5,
   REF2LIN5,
   INDCOBRADOMANUAL
)
AS
   SELECT D.CODIGO,
          D.CODPUE,
          PU.NOMBRE,
          D.FECINICIO,
          D.FECFIN,
          D.CODTIPOIVA,
          I.DESCRIPCION,
          D.CODPUEDP,
          D.CODDP,
          E.EXPEDIENTE,
          E.OBJETO,
          D.CODTARBAREMO,
          D.CODSUBTARBAREMO,
          D.EXTENSIONBAREMO,
          D.CODBAREMO,
          B.DESCRIPCION,
          B.VALOR,
          D.UNIDADES1,
          D.UNIDADES2,
          D.INDEXENTOLIQ,
          DECODE (D.INDEXENTOLIQ, '1', 'Si', 'No'),
          D.MOTEXENTOLIQ,
          D.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          D.CODBAREMOLIN2,
          B2.DESCRIPCION,
          B2.VALOR,
          D.UNIDADES1LIN2,
          D.UNIDADES2LIN2,
          D.CODBAREMOLIN3,
          B3.DESCRIPCION,
          B3.VALOR,
          D.UNIDADES1LIN3,
          D.UNIDADES2LIN3,
          D.CODBAREMOLIN4,
          B4.DESCRIPCION,
          B4.VALOR,
          D.UNIDADES1LIN4,
          D.UNIDADES2LIN4,
          D.CODBAREMOLIN5,
          B5.DESCRIPCION,
          B5.VALOR,
          D.UNIDADES1LIN5,
          D.UNIDADES2LIN5,
          D.FECULTLIQ,
          D.PERIODOLIQ,
          PL.DESCRIPCION,
          D.FORMALIQ,
          FL.DESCRIPCION,
          D.INDLIQMESES,
          DECODE (D.INDLIQMESES, '1', 'Si', 'No'),
          D.GUIDSRV,
          D.REF1LIN1,
          D.REF2LIN1,
          D.REF1LIN2,
          D.REF2LIN2,
          D.REF1LIN3,
          D.REF2LIN3,
          D.REF1LIN4,
          D.REF2LIN4,
          D.REF1LIN5,
          D.REF2LIN5,
          DECODE (D.INDCOBRADOMANUAL, '1', 'Si', 'No')
     FROM DIVERSO_PERIODICO D
          INNER JOIN M_PUERTO_LOCAL PU
             ON D.CODPUE = PU.CODPUE
          INNER JOIN LQ_BAREMOAP B
             ON     D.CODTARBAREMO = B.IDTARIFA
                AND D.CODSUBTARBAREMO = B.IDSUBTARIFA
                AND D.EXTENSIONBAREMO = B.EXTENSION
                AND D.CODBAREMO = B.CODIGO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON D.CODTIPOIVA = I.CODIGO
          INNER JOIN M_USUARIO U
             ON D.IDSUJPASIVO = U.CODUSUARIO
          LEFT JOIN DP_EXPEDIENTE E
             ON D.CODPUEDP = E.CODPUE AND D.CODDP = E.CODIGO
          LEFT JOIN LQ_BAREMOAP B2
             ON     D.CODTARBAREMOLIN2 = B2.IDTARIFA
                AND D.CODSUBTARBAREMOLIN2 = B2.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN2 = B2.EXTENSION
                AND D.CODBAREMOLIN2 = B2.CODIGO
          LEFT JOIN LQ_BAREMOAP B3
             ON     D.CODTARBAREMOLIN3 = B3.IDTARIFA
                AND D.CODSUBTARBAREMOLIN3 = B3.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN3 = B3.EXTENSION
                AND D.CODBAREMOLIN3 = B3.CODIGO
          LEFT JOIN LQ_BAREMOAP B4
             ON     D.CODTARBAREMOLIN4 = B4.IDTARIFA
                AND D.CODSUBTARBAREMOLIN4 = B4.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN4 = B4.EXTENSION
                AND D.CODBAREMOLIN4 = B4.CODIGO
          LEFT JOIN LQ_BAREMOAP B5
             ON     D.CODTARBAREMOLIN5 = B5.IDTARIFA
                AND D.CODSUBTARBAREMOLIN5 = B5.IDSUBTARIFA
                AND D.EXTENSIONBAREMOLIN5 = B5.EXTENSION
                AND D.CODBAREMOLIN5 = B5.CODIGO
          INNER JOIN DP_PERIODOLIQ PL
             ON PL.CODIGO = D.PERIODOLIQ
          LEFT JOIN LQ_FORMALIQ FL
             ON FL.CODIGO = D.FORMALIQ;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPBANCOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPBANCOS (CODIGO, NOMBRE)
AS
   SELECT B.CODIGO, B.NOMBRE
     FROM DP_BANCO B;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPBIENPUBLICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPBIENPUBLICO
(
   CODPUE,
   CODIGO,
   CODTIPOBIEN,
   TIPOBIEN,
   INDUSOINSTALACION,
   USOINSTALACION,
   DESCRIPCION,
   FECINIVIG,
   FECFINVIG,
   CODPUEINST,
   CODINST,
   INSTALACION,
   PORCUSOINST,
   DESPUE,
   TOTALM2,
   CODCENTROCOSTE,
   CENTROCOSTE,
   FECINICIO,
   FECFIN,
   EXPEDIENTE,
   OBJETO,
   CONCESIONARIO,
   NOMBRECONCESIONARIO,
   NIFCONCESIONARIO
)
AS
   SELECT B.CODPUE,
          B.CODIGO,
          B.CODTIPOBIEN,
          T.DESCRIPCION,
          B.INDUSOINSTALACION,
          DECODE (B.INDUSOINSTALACION, '1', 'Si', 'No'),
          B.DESCRIPCION,
          B.FECINIVIG,
          B.FECFINVIG,
          B.CODPUEINST,
          B.CODINST,
          I.NOMBRE,
          B.PORCUSOINST,
          P.NOMBRE,
          TOTALM2,
          B.CODCENTROCOSTE,
          C.DESCRIPCION,
          O.FECINICIO,
          O.FECFIN,
          E.EXPEDIENTE,
          E.OBJETO,
          E.CONCESIONARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC
     FROM DP_BIENPUBLICO B
          INNER JOIN M_PUERTO_LOCAL P
             ON (B.CODPUE = P.CODPUE)
          INNER JOIN DP_TIPOBIENPUBLICO T
             ON (B.CODTIPOBIEN = T.CODIGO)
          LEFT JOIN DPP_INSTALACION I
             ON (B.CODPUEINST = I.CODPUE AND B.CODINST = I.CODINSTALACION)
          LEFT JOIN LQ_CENTROCOSTE C
             ON (B.CODCENTROCOSTE = C.CODIGO)
          LEFT JOIN DP_CANONOCUPACION O
             ON (    O.CODPUEBIENPUBLICO = B.CODPUE
                 AND O.CODBIENPUBLICO = B.CODIGO
                 AND O.FECINICIO <= SYSDATE
                 AND O.FECFIN > SYSDATE)
          LEFT JOIN DP_EXPEDIENTE E
             ON (E.CODPUE = O.CODPUEEXP AND E.CODIGO = O.CODEXP)
          LEFT JOIN M_USUARIO U
             ON (U.CODUSUARIO = E.CONCESIONARIO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPCANONACTIVRANGOUNID  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPCANONACTIVRANGOUNID
(
   CODPUEEXP,
   CODEXP,
   CODCANON,
   ANYO,
   CODIGO,
   PRECIO,
   RANGOINI,
   RANGOFIN
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODCANON,
          C.ANYO,
          C.CODIGO,
          C.PRECIO,
          C.RANGOINI,
          C.RANGOFIN
     FROM DP_CANONACTIV_RANGOUNID C;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPCANONESACTIVHISTUNIDAD  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPCANONESACTIVHISTUNIDAD
(
   CODPUEEXP,
   CODEXP,
   CODCANON,
   ANYO,
   PRECIO
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODCANON,
          C.ANYO,
          C.PRECIO
     FROM DP_CANONACTIV_HISTUNIDAD C;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPCANONESACTIVIDAD  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPCANONESACTIVIDAD
(
   CODPUEEXP,
   CODEXP,
   CODCANON,
   FECINICIO,
   FECFIN,
   TIPOACTIV,
   DESCTIPOACTIV,
   SUBTIPOACTIV,
   DESCSUBTIPOACTIV,
   DESCRIPCION,
   ULTVALORUNIDAD,
   ANYOULTVALORUNIDAD,
   TIPOUNIDADMAXMIN,
   UNIDADMAXMIN,
   GRAVAMENCIFRANEG,
   INDOCUPACION,
   OCUPACION,
   CODFORMAVALORACION,
   FORMAVALORACION,
   CODINTERNO,
   OBSERVACIONES,
   EXPEDIENTE,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   OBJETO,
   ESTADO,
   DESCESTADO,
   DESPUE,
   PORCOCUPACION,
   FECNOTIFICACION,
   INDREVMANUAL,
   REVMANUAL,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CODPUE,
   FECPRORROGA,
   FECEXTINCION,
   TIPOEXPEDIENTE,
   DESCTIPOEXPEDIENTE,
   MOTIVEXENTOLIQ,
   IMPORTEFIJOANUAL,
   IMPORTEFIJOVIGENCIA,
   INDTRAFICOMINIMO,
   TRAFICOMINIMO,
   TRAFICOMINIMOANUAL,
   INDPENALIZACION,
   PENALIZACION,
   GRAVPENALIZACION,
   CODTIPORANGOUNID,
   TIPORANGOUNID
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODCANON,
          C.FECINICIO,
          C.FECFIN,
          C.TIPOACTIV,
          TA.DESCRIPCION,
          C.SUBTIPOACTIV,
          STA.DESCRIPCION,
          C.DESCRIPCION,
          PRE.PRECIO,
          PRE.ANYO,
          C.TIPOUNIDADMAXMIN,
          U.DESCRIPCION,
          C.GRAVAMENCIFRANEG,
          C.INDOCUPACION,
          DECODE (C.INDOCUPACION, '1', 'Si', 'No'),
          STA.FORMAVALORACION,
          FV.DESCRIPCION,
          C.CODINTERNO,
          C.OBSERVACIONES,
          E.EXPEDIENTE,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.CONCESIONARIO,
          USU.NUMDOC || USU.LETRANIF,
          USU.NOMBRECOMPLETO,
          USU.CODAPSCT,
          E.OBJETO,
          E.ESTADO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          C.PORCOCUPACION,
          E.FECNOTIFICACION,
          C.INDREVMANUAL,
          DECODE (C.INDREVMANUAL, '1', 'Si', 'No'),
          C.INDEXENTOLIQ,
          DECODE (C.INDEXENTOLIQ, '1', 'Si', 'No'),
          C.CODPUEEXP,
          E.FECPRORROGA,
          E.FECEXTINCION,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION,
          C.MOTIVEXENTOLIQ,
          C.IMPORTEFIJOANUAL,
          C.IMPORTEFIJOVIGENCIA,
          C.INDTRAFICOMINIMO,
          DECODE (C.INDTRAFICOMINIMO, '1', 'Si', 'No'),
          C.TRAFICOMINIMOANUAL,
          C.INDPENALIZACION,
          DECODE (C.INDPENALIZACION, '1', 'Si', 'No'),
          C.GRAVPENALIZACION,
          C.CODTIPORANGOUNID,
          TR.DESCRIPCION
     FROM DP_CANONACTIV C
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUEEXP = PU.CODPUE
          INNER JOIN DP_TIPOACTIVIDAD TA
             ON TA.CODIGO = C.TIPOACTIV
          INNER JOIN DP_SUBTIPOACTIVIDAD STA
             ON STA.CODIGO = C.SUBTIPOACTIV
          INNER JOIN DP_FORMAVALORACION FV
             ON (STA.FORMAVALORACION = FV.CODIGO)
          LEFT JOIN DP_UNIDADMAX U
             ON U.CODIGO = C.TIPOUNIDADMAXMIN
          LEFT JOIN (SELECT *
                       FROM DP_CANONACTIV_HISTUNIDAD PRE2
                      WHERE NOT EXISTS
                                   (SELECT 1
                                      FROM DP_CANONACTIV_HISTUNIDAD PRE1
                                     WHERE PRE2.CODPUEEXP = PRE1.CODPUEEXP
                                           AND PRE2.CODEXP = PRE1.CODEXP
                                           AND PRE2.CODCANON = PRE1.CODCANON
                                           AND PRE1.ANYO > PRE2.ANYO)) PRE
             ON (    C.CODPUEEXP = PRE.CODPUEEXP
                 AND C.CODEXP = PRE.CODEXP
                 AND C.CODCANON = PRE.CODCANON)
          INNER JOIN DP_EXPEDIENTE E
             ON C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON EST.CODIGO = E.ESTADO
          INNER JOIN M_USUARIO USU
             ON E.CONCESIONARIO = USU.CODUSUARIO
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON TE.CODIGO = E.TIPOEXPEDIENTE
          LEFT JOIN DP_TIPORANGOUNIDADES TR
             ON TR.CODIGO = C.CODTIPORANGOUNID;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPCANONESOCUPACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPCANONESOCUPACION
(
   CODPUEEXP,
   CODEXP,
   CODCANON,
   FECINICIO,
   FECFIN,
   TIPOOCUP,
   DESCTIPOOCUP,
   TIPOACTIV,
   DESCTIPOACTIV,
   DESCOCUPACTIV,
   INDVT,
   VT,
   INDLA,
   LA,
   INDIN,
   INS,
   INDDP,
   DP,
   NUMM2,
   CODPUEZONA,
   CODZONA,
   ZONA,
   CODPUEINST,
   CODINST,
   INSTALACION,
   ANYOPRECIO,
   PRECIO,
   CODINTERNO,
   OBSERVACIONES,
   INDEXENTODEPREC,
   EXENTODEPREC,
   EXPEDIENTE,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   OBJETO,
   ESTADO,
   DESCESTADO,
   DESPUE,
   FACTORFVT,
   FACTORFLA,
   INDEXENTOVTLA,
   EXENTOVTLA,
   FECNOTIFICACION,
   INDEXENTOVALORIN,
   EXENTOVALORIN,
   CODPUE,
   FACTORFINDP,
   FECPRORROGA,
   FECEXTINCION,
   TIPOEXPEDIENTE,
   DESCTIPOEXPEDIENTE,
   MOTIVEXENTOLIQ,
   CODPUEBIENPUBLICO,
   CODBIENPUBLICO,
   BIENPUBLICO
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODCANON,
          C.FECINICIO,
          C.FECFIN,
          C.TIPOOCUP,
          TOC.DESCRIPCION,
          C.TIPOACTIV,
          TAO.DESCRIPCION,
          C.DESCOCUPACTIV,
          C.INDVT,
          DECODE (C.INDVT, '1', 'Si', 'No'),
          C.INDLA,
          DECODE (C.INDLA, '1', 'Si', 'No'),
          C.INDIN,
          DECODE (C.INDIN, '1', 'Si', 'No'),
          C.INDDP,
          DECODE (C.INDDP, '1', 'Si', 'No'),
          DECODE (C.NUMM2, NULL, BP.TOTALM2, C.NUMM2),
          DECODE (C.CODPUEZONA, NULL, BP.CODPUEZONAVAL, C.CODPUEZONA),
          DECODE (C.CODZONA, NULL, BP.CODZONAVAL, C.CODZONA),
          DECODE (ZV.NOMBRE, NULL, ZVBP.NOMBRE, ZV.NOMBRE),
          BP.CODPUEINST,
          BP.CODINST,
          IBP.NOMBRE,
          DECODE (PRE.ANYO, NULL, PRE6.ANYO, PRE.ANYO),
          DECODE (PRE.PRECIO, NULL, PRE6.PRECIO, PRE.PRECIO),
          C.CODINTERNO,
          C.OBSERVACIONES,
          C.INDEXENTODEPREC,
          DECODE (C.INDEXENTODEPREC, '1', 'Si', 'No'),
          E.EXPEDIENTE,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.CONCESIONARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.OBJETO,
          E.ESTADO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          C.FACTORFVT,
          C.FACTORFLA,
          C.INDEXENTOVTLA,
          DECODE (C.INDEXENTOVTLA, '1', 'Si', 'No'),
          E.FECNOTIFICACION,
          C.INDEXENTOVALORIN,
          DECODE (C.INDEXENTOVALORIN, '1', 'Si', 'No'),
          C.CODPUEEXP,
          C.FACTORFINDP,
          E.FECPRORROGA,
          E.FECEXTINCION,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION,
          C.MOTIVEXENTOLIQ,
          C.CODPUEBIENPUBLICO,
          C.CODBIENPUBLICO,
          BP.DESCRIPCION
     FROM DP_CANONOCUPACION C
          INNER JOIN M_PUERTO_LOCAL PU
             ON (C.CODPUEEXP = PU.CODPUE)
          INNER JOIN DP_EXPEDIENTE E
             ON (C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO)
          INNER JOIN DP_TIPOOCUPACION TOC
             ON (TOC.CODIGO = C.TIPOOCUP)
          INNER JOIN DP_TIPOACTIVOCUPACION TAO
             ON (TAO.CODIGO = C.TIPOACTIV)
          LEFT JOIN DPP_ZONAVALOR ZV
             ON (ZV.CODPUE = C.CODPUEZONA AND ZV.CODZONA = C.CODZONA)
          LEFT JOIN (SELECT *
                       FROM DPP_ZONAVALORPRECIO PRE2
                      WHERE NOT EXISTS
                                   (SELECT 1
                                      FROM DPP_ZONAVALORPRECIO PRE1
                                     WHERE     PRE2.CODPUE = PRE1.CODPUE
                                           AND PRE2.CODZONA = PRE1.CODZONA
                                           AND PRE1.ANYO > PRE2.ANYO)) PRE
             ON (ZV.CODPUE = PRE.CODPUE AND ZV.CODZONA = PRE.CODZONA)
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON (EST.CODIGO = E.ESTADO)
          INNER JOIN M_USUARIO U
             ON (E.CONCESIONARIO = U.CODUSUARIO)
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON (TE.CODIGO = E.TIPOEXPEDIENTE)
          LEFT JOIN DP_BIENPUBLICO BP
             ON (C.CODPUEBIENPUBLICO = BP.CODPUE
                 AND C.CODBIENPUBLICO = BP.CODIGO)
          LEFT JOIN DPP_ZONAVALOR ZVBP
             ON (ZVBP.CODPUE = BP.CODPUEZONAVAL
                 AND ZVBP.CODZONA = BP.CODZONAVAL)
          LEFT JOIN (SELECT *
                       FROM DPP_ZONAVALORPRECIO PRE3
                      WHERE NOT EXISTS
                                   (SELECT 1
                                      FROM DPP_ZONAVALORPRECIO PRE4
                                     WHERE     PRE3.CODPUE = PRE4.CODPUE
                                           AND PRE3.CODZONA = PRE4.CODZONA
                                           AND PRE4.ANYO > PRE3.ANYO)) PRE6
             ON (ZVBP.CODPUE = PRE6.CODPUE AND ZVBP.CODZONA = PRE6.CODZONA)
          LEFT JOIN DPP_INSTALACION IBP
             ON (IBP.CODPUE = BP.CODPUE AND IBP.CODINSTALACION = BP.CODINST);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPCIFRASNEGOCIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPCIFRASNEGOCIO
(
   CODPUEEXP,
   CODEXP,
   CODCIFRA,
   FECINICIO,
   FECFIN,
   CIFRANEGOCIO,
   EXPEDIENTE,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   OBJETO,
   ESTADO,
   DESCESTADO,
   DESPUE,
   FECNOTIFICACION,
   CODPUE,
   ANYO,
   FECPRORROGA,
   FECEXTINCION,
   TIPOEXPEDIENTE,
   DESCTIPOEXPEDIENTE
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODCIFRA,
          C.FECINICIO,
          C.FECFIN,
          C.CIFRANEGOCIO,
          E.EXPEDIENTE,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.CONCESIONARIO,
          USU.NUMDOC || USU.LETRANIF,
          USU.NOMBRECOMPLETO,
          USU.CODAPSCT,
          E.OBJETO,
          E.ESTADO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          E.FECNOTIFICACION,
          C.CODPUEEXP,
          C.ANYO,
          E.FECPRORROGA,
          E.FECEXTINCION,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION
     FROM DP_CIFRANEGOCIO C
          INNER JOIN DP_EXPEDIENTE E
             ON C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON EST.CODIGO = E.ESTADO
          INNER JOIN M_USUARIO USU
             ON E.CONCESIONARIO = USU.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUEEXP = PU.CODPUE
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON TE.CODIGO = E.TIPOEXPEDIENTE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPAGUAPDTELIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPAGUAPDTELIQ
(
   CODIGO,
   CODEXPCONTADOR,
   FECINICIO,
   FECFIN
)
AS
   SELECT DP_EXPAGUA_PDTELIQ.CODIGO,
          DP_EXPAGUA_PDTELIQ.CODEXPCONTADOR,
          DP_EXPAGUA_PDTELIQ.FECINICIO,
          DP_EXPAGUA_PDTELIQ.FECFIN
     FROM DP_EXPAGUA_PDTELIQ;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPCONTAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPCONTAGUA
(
   CODIGO,
   CODPUEEXP,
   CODEXP,
   CODPUECONTADOR,
   CODCONTADOR,
   FECINICIO,
   FECFIN,
   EXPEDIENTE,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   OBJETO,
   ESTADO,
   DESCESTADO,
   DESPUE,
   FECNOTIFICACION,
   CODPUE,
   FECULTLIQ,
   INDREVANULACION,
   REVANULACION,
   TIPOIGIC,
   DESCTIPOIGIC,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CONTADOR,
   INDPRORROGA,
   PRORROGA,
   FECPRORROGA,
   FECEXTINCION,
   CODMOTIVEXENTOLIQ,
   MOTIVEXENTOLIQ
)
AS
   SELECT C.CODIGO,
          C.CODPUEEXP,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          E.EXPEDIENTE,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.CONCESIONARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.OBJETO,
          E.ESTADO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          E.FECNOTIFICACION,
          C.CODPUEEXP,
          C.FECULTLIQ,
          C.INDREVANULACION,
          DECODE (C.INDREVANULACION, '1', 'Si', 'No'),
          C.TIPOIGIC,
          TI.DESCRIPCION,
          C.INDEXENTOLIQ,
          DECODE (C.INDEXENTOLIQ, '1', 'Si', 'No'),
          CO.DESCRIPCION,
          E.INDPRORROGA,
          DECODE (E.INDPRORROGA, '1', 'Si', 'No'),
          E.FECPRORROGA,
          E.FECEXTINCION,
          C.CODMOTIVEXENTOLIQ,
          M.DESCRIPCION
     FROM DP_EXPCONTADORAGUA C
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUEEXP = PU.CODPUE
          INNER JOIN DP_EXPEDIENTE E
             ON C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON EST.CODIGO = E.ESTADO
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON TI.CODIGO = C.TIPOIGIC
          LEFT JOIN M_CONTADOR CO
             ON C.CODPUECONTADOR = CO.CODPUE AND C.CODCONTADOR = CO.NUMCON
          LEFT JOIN AGUA_MOTIVEXENCION M
             ON (M.CODIGO = C.CODMOTIVEXENTOLIQ);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPEDIENTECOMPLEM  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPEDIENTECOMPLEM
(
   CODIGO,
   CODPUEEXP,
   CODEXP,
   FECINICIO,
   FECFIN,
   TIPOTASA,
   TASA,
   TIPOREVISION,
   REVISION,
   NUMRESOLUCION,
   FACTRECTIF,
   FECREGSALIDA,
   DOCSUSTRECT,
   OBSERVACIONES,
   FECLIQ
)
AS
   SELECT C.CODIGO,
          C.CODPUEEXP,
          C.CODEXP,
          C.FECINICIO,
          C.FECFIN,
          C.TIPOTASA,
          T.DESCRIPCION,
          C.TIPOREVISION,
          TC.DESCRIPCION,
          C.NUMRESOLUCION,
          C.FACTRECTIF,
          C.FECREGSALIDA,
          C.DOCSUSTRECT,
          C.OBSERVACIONES,
          C.FECLIQ
     FROM DP_EXPEDIENTE_COMPLEM C
          INNER JOIN LQ_TIPO_SERVICIO T
             ON T.CODIGO = C.TIPOTASA
          INNER JOIN DP_TIPOCOMPLEM TC
             ON TC.CODIGO = C.TIPOREVISION;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPEDIENTERELACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPEDIENTERELACION
(
   CODPUEEXP1,
   CODEXP1,
   CODPUEEXP2,
   CODEXP2,
   OBSERVACIONES,
   EXPEDIENTE1,
   FECOTORGAMIENTO1,
   FECVENCIMIENTO1,
   CONCESIONARIO1,
   CIFCONCESIONARIO1,
   NOMBRECOMPLETO1,
   CODAPSCT1,
   OBJETO1,
   FECNOTIFICACION1,
   FECPRORROGA1,
   FECEXTINCION1,
   EXPEDIENTE2,
   FECOTORGAMIENTO2,
   FECVENCIMIENTO2,
   CONCESIONARIO2,
   CIFCONCESIONARIO2,
   NOMBRECOMPLETO2,
   CODAPSCT2,
   OBJETO2,
   FECNOTIFICACION2,
   FECPRORROGA2,
   FECEXTINCION2
)
AS
   SELECT C.CODPUEEXP1,
          C.CODEXP1,
          C.CODPUEEXP2,
          C.CODEXP2,
          C.OBSERVACIONES,
          E1.EXPEDIENTE,
          E1.FECOTORGAMIENTO,
          E1.FECVENCIMIENTO,
          E1.CONCESIONARIO,
          U1.NUMDOC || U1.LETRANIF,
          U1.NOMBRECOMPLETO,
          U1.CODAPSCT,
          E1.OBJETO,
          E1.FECNOTIFICACION,
          E1.FECPRORROGA,
          E1.FECEXTINCION,
          E2.EXPEDIENTE,
          E2.FECOTORGAMIENTO,
          E2.FECVENCIMIENTO,
          E2.CONCESIONARIO,
          U2.NUMDOC || U2.LETRANIF,
          U2.NOMBRECOMPLETO,
          U2.CODAPSCT,
          E2.OBJETO,
          E2.FECNOTIFICACION,
          E2.FECPRORROGA,
          E2.FECEXTINCION
     FROM DP_EXPEDIENTERELACION C
          INNER JOIN DP_EXPEDIENTE E1
             ON (C.CODPUEEXP1 = E1.CODPUE AND C.CODEXP1 = E1.CODIGO)
          LEFT JOIN M_USUARIO U1
             ON (E1.CONCESIONARIO = U1.CODUSUARIO)
          INNER JOIN DP_EXPEDIENTE E2
             ON (C.CODPUEEXP2 = E2.CODPUE AND C.CODEXP2 = E2.CODIGO)
          LEFT JOIN M_USUARIO U2
             ON (E2.CONCESIONARIO = U2.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPEDIENTEREVACTIV  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPEDIENTEREVACTIV
(
   CODPUEEXP,
   CODEXP,
   CODIGO,
   RESULTADO,
   EXPEDIENTE,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   OBJETO,
   ESTADO,
   DESCESTADO,
   DESPUE,
   FECNOTIFICACION,
   CODPUE,
   ANYO,
   FECPRORROGA,
   FECEXTINCION,
   TIPOEXPEDIENTE,
   DESCTIPOEXPEDIENTE
)
AS
   SELECT C.CODPUEEXP,
          C.CODEXP,
          C.CODIGO,
          C.RESULTADO,
          E.EXPEDIENTE,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.CONCESIONARIO,
          USU.NUMDOC || USU.LETRANIF,
          USU.NOMBRECOMPLETO,
          USU.CODAPSCT,
          E.OBJETO,
          E.ESTADO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          E.FECNOTIFICACION,
          C.CODPUEEXP,
          C.ANYO,
          E.FECPRORROGA,
          E.FECEXTINCION,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION
     FROM DP_EXPEDIENTEREVACTIV C
          INNER JOIN DP_EXPEDIENTE E
             ON C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON EST.CODIGO = E.ESTADO
          INNER JOIN M_USUARIO USU
             ON E.CONCESIONARIO = USU.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUEEXP = PU.CODPUE
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON TE.CODIGO = E.TIPOEXPEDIENTE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPEXPEDIENTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPEXPEDIENTES
(
   CODPUE,
   DESPUE,
   CODIGO,
   REFERENCIAAE,
   CODMIGRACION,
   EXPEDIENTE,
   TIPOEXPEDIENTE,
   DESCTIPOEXPEDIENTE,
   ESTADO,
   DESCESTADO,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   TIPOIGICOCUP,
   DESCTIPOIGICOCUP,
   TIPOIGICACT,
   DESCTIPOIGICACT,
   PERIODOLIQOCUP,
   DESCPERIODOLIQOCUP,
   PERIODOLIQACTIV,
   DESCPERIODOLIQACTIV,
   INDLIQMESES,
   LIQMESES,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   INDLUZ,
   LUZ,
   INDOCUPACION,
   OCUPACION,
   INDACTIVIDAD,
   ACTIVIDAD,
   OBJETO,
   CLAVE,
   OBSERVACIONES,
   FORMALIQOCUP,
   DESCFORMALIQOCUP,
   FORMALIQACT,
   DESCFORMALIQACT,
   FECNOTIFICACION,
   FECEXTINCION,
   MOTIVEXTINCION,
   FECPRORROGA,
   FECULTLIQOCUP,
   FECULTLIQACTIV,
   FECULTLIQAGUA,
   INDREVAGUA,
   REVAGUA,
   INDDISPFACT,
   DISPFACT,
   CONAUT,
   CONCESIONAUTORIZACION,
   INDPRORROGA,
   PRORROGADO,
   CODMOTIVAMPPERLIQ,
   MOTIVAMPPERLIQ,
   OBSERDISPFACT,
   FECALTA,
   GUIDSRV,
   INDNOLIQMASIVO,
   NOLIQMASIVO,
   CODPUEAPAC,
   PUEAPAC,
   FECNOTIF,
   FECINILIQACTIV,
   CODTIPACTIVPRINCIPAL,
   TIPACTIVPRINCIPAL,
   OBSERVACIONESFACT
)
AS
   SELECT E.CODPUE,
          PU.NOMBRE,
          E.CODIGO,
          E.REFERENCIAAE,
          E.CODMIGRACION,
          E.EXPEDIENTE,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION,
          E.ESTADO,
          EE.DESCRIPCION,
          E.CONCESIONARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.TIPOIGICOCUP,
          TIO.DESCRIPCION,
          E.TIPOIGICACT,
          TIA.DESCRIPCION,
          E.PERIODOLIQOCUP,
          PLO.DESCRIPCION,
          E.PERIODOLIQACTIV,
          PLA.DESCRIPCION,
          E.INDLIQMESES,
          DECODE (E.INDLIQMESES, '1', 'Si', 'No'),
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          E.INDLUZ,
          DECODE (E.INDLUZ, '1', 'Si', 'No'),
          E.INDOCUPACION,
          DECODE (E.INDOCUPACION, '1', 'Si', 'No'),
          E.INDACTIVIDAD,
          DECODE (E.INDACTIVIDAD, '1', 'Si', 'No'),
          E.OBJETO,
          E.CLAVE,
          E.OBSERVACIONES,
          E.FORMALIQOCUP,
          FO.DESCRIPCION,
          E.FORMALIQACT,
          FA.DESCRIPCION,
          E.FECNOTIFICACION,
          E.FECEXTINCION,
          E.MOTIVEXTINCION,
          E.FECPRORROGA,
          E.FECULTLIQOCUP,
          E.FECULTLIQACTIV,
          E.FECULTLIQAGUA,
          E.INDREVAGUA,
          DECODE (E.INDREVAGUA, '1', 'Si', 'No'),
          E.INDDISPFACT,
          DECODE (E.INDDISPFACT, '1', 'Si', 'No'),
          TE.CONAUT,
          TEG.DESCRIPCION,
          E.INDPRORROGA,
          DECODE (E.INDPRORROGA, '1', 'Si', 'No'),
          E.CODMOTIVAMPPERLIQ,
          MA.DESCRIPCION,
          E.OBSERDISPFACT,
          E.FECALTA,
          E.GUIDSRV,
          E.INDNOLIQMASIVO,
          DECODE (E.INDNOLIQMASIVO, '1', 'Si', 'No'),
          E.CODPUEAPAC,
          A.DESCRIPCION,
          E.FECNOTIF,
          E.FECINILIQACTIV,
          E.CODTIPACTIVPRINCIPAL,
          TAP.DESCRIPCION,
          E.OBSERVACIONESFACT
     FROM DP_EXPEDIENTE E
          INNER JOIN M_PUERTO_LOCAL PU
             ON E.CODPUE = PU.CODPUE
          LEFT JOIN M_USUARIO U
             ON E.CONCESIONARIO = U.CODUSUARIO
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON TE.CODIGO = E.TIPOEXPEDIENTE
          INNER JOIN DP_ESTADOEXPEDIENTE EE
             ON EE.CODIGO = E.ESTADO
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIO
             ON TIO.CODIGO = E.TIPOIGICOCUP
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIA
             ON TIA.CODIGO = E.TIPOIGICACT
          LEFT JOIN DP_PERIODOLIQ PLO
             ON PLO.CODIGO = E.PERIODOLIQOCUP
          LEFT JOIN DP_PERIODOLIQ PLA
             ON PLA.CODIGO = E.PERIODOLIQACTIV
          LEFT JOIN LQ_FORMALIQ FO
             ON FO.CODIGO = E.FORMALIQOCUP
          LEFT JOIN LQ_FORMALIQ FA
             ON FA.CODIGO = E.FORMALIQACT
          LEFT JOIN DP_MOTIVAMPPERLIQ MA
             ON E.CODMOTIVAMPPERLIQ = MA.CODIGO
          LEFT JOIN APAC_TIPOPUERTO A
             ON A.CODIGO = E.CODPUEAPAC
          LEFT JOIN DP_TIPOACTIVPRINCIPAL TAP
             ON TAP.CODIGO = E.CODTIPACTIVPRINCIPAL
          LEFT JOIN DP_TIPOEXPEDIENTEGLOBAL TEG
             ON TEG.CODIGO = TE.CONAUT;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPFIANZA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPFIANZA
(
   CODPUEEXP,
   CODEXP,
   CODFIANZA,
   IMPORTE,
   CODTIPO,
   DESCTIPO,
   CODFORMA,
   DESCFORMA,
   FECCONSTITUCION,
   FECDEV,
   FECSOLDEV,
   NUMRESGUARDO,
   OBSERVACIONES,
   IMPORTEDEVUELTO
)
AS
   SELECT F.CODPUEXP,
          F.CODEXP,
          F.CODFIANZA,
          F.IMPORTE,
          F.CODTIPO,
          TP.DESCRIPCION,
          F.CODFORMA,
          FM.DESCRIPCION,
          F.FECCONSTITUCION,
          F.FECDEV,
          F.FECSOLDEV,
          F.NUMRESGUARDO,
          F.OBSERVACIONES,
          F.IMPORTEDEVUELTO
     FROM DP_FIANZA F
          JOIN DP_TIPOFIANZA TP
             ON TP.CODIGO = F.CODTIPO
          JOIN DP_FORMAFIANZA FM
             ON FM.CODIGO = F.CODFORMA;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPHISTORICOBIENEXP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPHISTORICOBIENEXP
(
   CODCANON,
   FECINICIO,
   FECFIN,
   CODPUEBIENPUBLICO,
   CODBIENPUBLICO,
   CODPUEEXP,
   CODEXP,
   EXPEDIENTE,
   OBJETO
)
AS
   SELECT O.CODCANON,
          O.FECINICIO,
          O.FECFIN,
          O.CODPUEBIENPUBLICO,
          O.CODBIENPUBLICO,
          E.CODPUE,
          E.CODIGO,
          E.EXPEDIENTE,
          E.OBJETO
     FROM    DP_CANONOCUPACION O
          LEFT JOIN
             DP_EXPEDIENTE E
          ON E.CODPUE = O.CODPUEEXP AND E.CODIGO = O.CODEXP;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPINCIDENCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPINCIDENCIA
(
   CODPUEEXP,
   CODEXP,
   CODINCIDENCIA,
   FECHA,
   CODTIPO,
   DESCTIPO,
   DESCRIPCION,
   OBSERVACIONES
)
AS
   SELECT I.CODPUEXP,
          I.CODEXP,
          I.CODINCIDENCIA,
          I.FECHA,
          I.CODTIPO,
          TI.DESCRIPCION,
          I.DESCRIPCION,
          I.OBSERVACIONES
     FROM DP_INCIDENCIA I JOIN DP_TIPOINCIDENCIA TI ON TI.CODIGO = I.CODTIPO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPLOGFECULTLIQEXPED  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPLOGFECULTLIQEXPED
(
   CODIGO,
   CODPUEEXP,
   CODEXP,
   FECMODIF,
   USRMODIF,
   TIPOFECHA,
   VALORANTESMODIF,
   VALORDESPUESMODIF,
   OBSERVACIONES
)
AS
   SELECT E.CODIGO,
          E.CODPUEEXP,
          E.CODEXP,
          E.FECMODIF,
          E.USRMODIF,
          DECODE (E.TIPOFECHA,  'O', 'Ocupacin',  'A', 'Actividad'),
          E.VALORANTESMODIF,
          E.VALORDESPUESMODIF,
          E.OBSERVACIONES
     FROM DP_LOGFECULTLIQEXPED E;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPMEJORACONCURSO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPMEJORACONCURSO
(
   CODPUE,
   ANYO,
   CODMEJORA,
   CODPUEXP,
   CODEXP,
   EXPEDIENTE,
   OBJETO,
   FECOTORGAMIENTO,
   FECVENCIMIENTO,
   IDCLIENTE,
   CIFCLIENTE,
   CLIENTE,
   FECINICIO,
   FECFIN,
   IMPORTEPERIODO,
   INDLIQUIDADO,
   LIQUIDADO,
   ESTADO,
   DESESTADOEXP,
   FECNOTIFICACION,
   FECPRORROGA,
   FECEXTINCION,
   TIPOEXPEDIENTE,
   DESTIPOEXP,
   DESPUE
)
AS
   SELECT M.CODPUE,
          M.ANYO,
          M.CODMEJORA,
          M.CODPUEXP,
          M.CODEXP,
          E.EXPEDIENTE,
          E.OBJETO,
          E.FECOTORGAMIENTO,
          E.FECVENCIMIENTO,
          M.IDCLIENTE,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO AS CLIENTE,
          M.FECINICIO,
          M.FECFIN,
          M.IMPORTEPERIODO,
          M.INDLIQUIDADO,
          DECODE (M.INDLIQUIDADO, '1', 'Si', 'No'),
          E.ESTADO,
          EST.DESCRIPCION AS DESESTADOEXP,
          E.FECNOTIFICACION,
          E.FECPRORROGA,
          E.FECEXTINCION,
          E.TIPOEXPEDIENTE,
          TE.DESCRIPCION AS DESTIPOEXP,
          P.NOMBRE
     FROM DP_MEJORACONCURSO M
          INNER JOIN DP_EXPEDIENTE E
             ON M.CODPUEXP = E.CODPUE AND M.CODEXP = E.CODIGO
          LEFT JOIN DP_ESTADOEXPEDIENTE EST
             ON EST.CODIGO = E.ESTADO
          INNER JOIN DP_TIPOEXPEDIENTE TE
             ON TE.CODIGO = E.TIPOEXPEDIENTE
          INNER JOIN M_USUARIO U
             ON M.IDCLIENTE = U.CODUSUARIO
          INNER JOIN M_PUERTO_LOCAL P
             ON (M.CODPUE = P.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPMOTIVAMPPERLIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPMOTIVAMPPERLIQ (CODIGO, DESCRIPCION)
AS
   SELECT M.CODIGO, M.DESCRIPCION
     FROM DP_MOTIVAMPPERLIQ M;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPMOTIVEXENCION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPMOTIVEXENCION (CODIGO, DESCRIPCION)
AS
   SELECT M.CODIGO, M.DESCRIPCION
     FROM DP_MOTIVEXENCION M;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPMOTIVEXTINCION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPMOTIVEXTINCION (CODIGO, NOMBRE)
AS
   SELECT M.CODIGO, M.NOMBRE
     FROM DP_MOTIVEXTINCION M;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPPINSTALACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPPINSTALACIONES
(
   CODPUE,
   CODINSTALACION,
   NOMBRE,
   PUERTO,
   OBSERVACIONES,
   CODTIPOUSO,
   TIPOUSO,
   CODTASACION,
   FECINIVIG,
   FECFINVIG,
   VALOR,
   ANYOSVIDAUTIL,
   INDVALOREUROM2,
   VALOREUROM2,
   INDTASADA,
   TASADA,
   NUMM2
)
AS
   (SELECT I.CODPUE,
           I.CODINSTALACION,
           I.NOMBRE,
           P.NOMBRE,
           I.OBSERVACIONES,
           I.CODTIPOUSO,
           U.NOMBRE,
           TAS.CODTASACION,
           TAS.FECINIVIG,
           TAS.FECFINVIG,
           TAS.VALOR,
           TAS.ANYOSVIDAUTIL,
           I.INDVALOREUROM2,
           DECODE (I.INDVALOREUROM2, '1', 'Si', 'No'),
           DECODE (TAS.CODTASACION, NULL, '0', '1'),
           DECODE (TAS.CODTASACION, NULL, 'No', 'Si'),
           I.NUMM2
      FROM DPP_INSTALACION I
           INNER JOIN M_PUERTO_LOCAL P
              ON (I.CODPUE = P.CODPUE)
           LEFT JOIN DP_TIPOUSO U
              ON (U.CODIGO = I.CODTIPOUSO)
           LEFT JOIN (SELECT *
                        FROM DP_TASACION TAS
                       WHERE TRUNC (SYSDATE) BETWEEN FECINIVIG AND FECFINVIG) TAS
              ON (I.CODPUE = TAS.CODPUEINST
                  AND I.CODINSTALACION = TAS.CODINST));


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPPVOLUMENACTIVIDADES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPPVOLUMENACTIVIDADES
(
   CODPUE,
   DESPUE,
   CODIGO,
   CODTASA,
   CODVOLUMEN,
   FECINICIO,
   FECFIN,
   NUMUNIDADES,
   ANYO
)
AS
   SELECT DPP_VOLUMENACTIVIDAD.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          DPP_VOLUMENACTIVIDAD.CODIGO,
          DPP_VOLUMENACTIVIDAD.CODTASA,
          DPP_VOLUMENACTIVIDAD.CODVOLUMEN,
          DPP_VOLUMENACTIVIDAD.FECINICIO,
          DPP_VOLUMENACTIVIDAD.FECFIN,
          DPP_VOLUMENACTIVIDAD.NUMUNIDADES,
          DPP_VOLUMENACTIVIDAD.ANYO
     FROM    DPP_VOLUMENACTIVIDAD
          INNER JOIN
             M_PUERTO_LOCAL
          ON (DPP_VOLUMENACTIVIDAD.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPPZONAVALORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPPZONAVALORES
(
   CODPUE,
   CODZONA,
   NOMBRE,
   PUERTO,
   ANYO,
   PRECIO,
   OBSERVACIONES,
   CODTIPOUSO,
   TIPOUSO,
   INDACTMANUALPRECIO,
   ACTMANUALPRECIO,
   FECINIVIG,
   FECFINVIG
)
AS
   (SELECT Z.CODPUE,
           Z.CODZONA,
           Z.NOMBRE,
           M_PUERTO_LOCAL.NOMBRE,
           PRE.ANYO,
           PRE.PRECIO,
           Z.OBSERVACIONES,
           Z.CODTIPOUSO,
           U.NOMBRE,
           Z.INDACTMANUALPRECIO,
           DECODE (Z.INDACTMANUALPRECIO, '1', 'Si', 'No'),
           Z.FECINIVIG,
           Z.FECFINVIG
      FROM DPP_ZONAVALOR Z
           INNER JOIN M_PUERTO_LOCAL
              ON (Z.CODPUE = M_PUERTO_LOCAL.CODPUE)
           LEFT JOIN (SELECT *
                        FROM DPP_ZONAVALORPRECIO PRE2
                       WHERE NOT EXISTS
                                    (SELECT 1
                                       FROM DPP_ZONAVALORPRECIO PRE1
                                      WHERE     PRE2.CODPUE = PRE1.CODPUE
                                            AND PRE2.CODZONA = PRE1.CODZONA
                                            AND PRE1.ANYO > PRE2.ANYO)) PRE
              ON (Z.CODPUE = PRE.CODPUE AND Z.CODZONA = PRE.CODZONA)
           LEFT JOIN DP_TIPOUSO U
              ON (U.CODIGO = Z.CODTIPOUSO));


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPPZONAVALORPRECIOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPPZONAVALORPRECIOS
(
   CODPUE,
   CODZONA,
   ANYO,
   PRECIO
)
AS
   (SELECT DPP_ZONAVALORPRECIO.CODPUE,
           DPP_ZONAVALORPRECIO.CODZONA,
           DPP_ZONAVALORPRECIO.ANYO,
           DPP_ZONAVALORPRECIO.PRECIO
      FROM DPP_ZONAVALORPRECIO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPTASACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPTASACION
(
   CODPUEINST,
   CODINST,
   CODTASACION,
   FECINIVIG,
   FECFINVIG,
   VALOR,
   ANYOSVIDAUTIL,
   INSTALACION,
   CODPUE,
   DESPUE
)
AS
   SELECT T.CODPUEINST,
          T.CODINST,
          T.CODTASACION,
          T.FECINIVIG,
          T.FECFINVIG,
          T.VALOR,
          T.ANYOSVIDAUTIL,
          I.NOMBRE,
          CODPUEINST,
          P.NOMBRE
     FROM DP_TASACION T
          INNER JOIN M_PUERTO_LOCAL P
             ON (T.CODPUEINST = P.CODPUE)
          INNER JOIN DPP_INSTALACION I
             ON (T.CODPUEINST = I.CODPUE AND T.CODINST = I.CODINSTALACION);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPTIPOACTIVPRINCIPAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPTIPOACTIVPRINCIPAL (CODIGO, DESCRIPCION)
AS
   SELECT T.CODIGO, T.DESCRIPCION
     FROM DP_TIPOACTIVPRINCIPAL T;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPTIPOINCIDENCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPTIPOINCIDENCIA (CODIGO, DESCRIPCION)
AS
   SELECT TI.CODIGO, TI.DESCRIPCION
     FROM DP_TIPOINCIDENCIA TI;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPTIPOSUSO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPTIPOSUSO (CODIGO, NOMBRE)
AS
   SELECT T.CODIGO, T.NOMBRE
     FROM DP_TIPOUSO T;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPTIPOUNIDADIMPFIJOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPTIPOUNIDADIMPFIJOS
(
   CODIGO,
   DESCRIPCION,
   VALOR,
   OBSERVACIONES
)
AS
   SELECT T.CODIGO,
          T.DESCRIPCION,
          T.VALOR,
          T.OBSERVACIONES
     FROM DP_TIPOUNIDADIMPFIJO T;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPUNIDADESMAX  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPUNIDADESMAX
(
   CODIGO,
   DESCRIPCION,
   ANYO,
   PRECIO
)
AS
   SELECT U.CODIGO,
          U.DESCRIPCION,
          PRE.ANYO,
          PRE.PRECIO
     FROM    DP_UNIDADMAX U
          LEFT JOIN
             (SELECT *
                FROM DP_UNIDADMAXPRECIO PRE2
               WHERE NOT EXISTS
                            (SELECT 1
                               FROM DP_UNIDADMAXPRECIO PRE1
                              WHERE PRE2.CODIGO = PRE1.CODIGO
                                    AND PRE1.ANYO > PRE2.ANYO)) PRE
          ON (U.CODIGO = PRE.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPUNIDADESMAXPRECIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPUNIDADESMAXPRECIO
(
   CODIGO,
   ANYO,
   DESCRIPCION,
   PRECIO
)
AS
   SELECT P.CODIGO,
          P.ANYO,
          U.DESCRIPCION,
          P.PRECIO
     FROM    DP_UNIDADMAXPRECIO P
          INNER JOIN
             DP_UNIDADMAX U
          ON U.CODIGO = P.CODIGO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DPUSOCONSUNTIVOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DPUSOCONSUNTIVOS
(
   CODPUEEXP,
   CODEXP,
   CODCANON,
   CODUSO,
   FECINICIO,
   FECFIN,
   VALOR
)
AS
   SELECT U.CODPUEEXP,
          U.CODEXP,
          U.CODCANON,
          U.CODUSO,
          U.FECINICIO,
          U.FECFIN,
          U.VALOR
     FROM DP_USOCONSUNTIVO U;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_DP_TIPOBIENPUBLICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_DP_TIPOBIENPUBLICO
(
   CODIGO,
   DESCRIPCION,
   INDINSTALACION
)
AS
   SELECT T.CODIGO, T.DESCRIPCION, DECODE (T.INDINSTALACION, '1', 'Si', 'No')
     FROM DP_TIPOBIENPUBLICO T;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_AUDITORIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_AUDITORIA
(
   IDAUDITORIA,
   IDMENSAJE,
   IDESTADO,
   DESESTADO,
   FECREGISTRO,
   USRALTA,
   FECALTA,
   USRMODIF,
   FECMODIF,
   FECBAJA
)
AS
   SELECT EA.IDAUDITORIA,
          EA.IDMENSAJE,
          EA.IDESTADO,
          EE.DESESTADO,
          EA.FECREGISTRO,
          EA.USRALTA,
          EA.FECALTA,
          EA.USRMODIF,
          EA.FECMODIF,
          EA.FECBAJA
     FROM    EDI_AUDITORIA EA
          LEFT JOIN
             EDI_ESTADO EE
          ON EE.IDESTADO = EA.IDESTADO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_BUZON  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_BUZON
(
   IDBUZON,
   CODUSUARIO,
   USUARIO,
   IDCIRCUITO,
   CIRCUITO,
   BUZON,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF
)
AS
   SELECT EB.IDBUZON,
          EB.CODUSUARIO,
          MU.NOMBRECOMPLETO,
          EB.IDCIRCUITO,
          EC.DESCIRCUITO,
          EB.BUZON,
          EB.USRALTA,
          EB.USRMODIF,
          EB.FECALTA,
          EB.FECMODIF
     FROM EDI_BUZON EB
          LEFT JOIN M_USUARIO MU
             ON MU.CODUSUARIO = EB.CODUSUARIO
          LEFT JOIN EDI_CIRCUITO EC
             ON EC.IDCIRCUITO = EB.IDCIRCUITO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_CIRCUITO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_CIRCUITO
(
   IDCIRCUITO,
   DESCIRCUITO,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF
)
AS
   SELECT EC.IDCIRCUITO,
          EC.DESCIRCUITO,
          EC.USRALTA,
          EC.USRMODIF,
          EC.FECALTA,
          EC.FECMODIF
     FROM EDI_CIRCUITO EC;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_MENSAJE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_MENSAJE
(
   IDMENSAJE,
   IDTIPOMENSAJE,
   DESTIPOMENSAJE,
   CLASEMENSAJE,
   SENTIDO,
   NUMFUNCION,
   BUZONEMISOR,
   BUZONRECEPTOR,
   IDESTADO,
   DESESTADO,
   FECREGISTRO,
   NUMREFMENSAJE,
   NUMREFTRANSMISOR,
   NUMREFEMISOR,
   FECMENSAJE,
   NUMREFORIGEN,
   TIPODOCUMENTO,
   NUMMENSAJEORIGEN,
   RESPONDIDO,
   CODUSUARIO,
   NOMBREUSUARIO,
   FECALTA,
   FECMODIF,
   USRALTA,
   USRMODIF,
   FECBAJA,
   NOMFICHERO,
   ESCALA,
   DESERROR,
   REVISADO,
   CODPUE,
   NOMPUERTO,
   DESNUMFUNCION
)
AS
   SELECT EM.IDMENSAJE,
          EM.IDTIPOMENSAJE,
          TM.DESTIPOMENSAJE,
          CM.DESCLASEMENSAJE,
          DECODE (EM.SENTIDO, 'E', 'Entrada', 'Salida'),
          EM.NUMFUNCION,
          EM.BUZONEMISOR,
          EM.BUZONRECEPTOR,
          EM.IDESTADO,
          EE.DESESTADO,
          EM.FECREGISTRO,
          EM.NUMREFMENSAJE,
          EM.NUMREFTRANSMISOR,
          EM.NUMREFEMISOR,
          EM.FECMENSAJE,
          EM.NUMREFORIGEN,
          EM.TIPODOCUMENTO,
          EM.NUMMENSAJEORIGEN,
          DECODE (EM.RESPONDIDO, '1', 'Si', 'No'),
          EM.CODUSUARIO,
          MU.NOMBRECOMPLETO,
          EM.FECALTA,
          EM.FECMODIF,
          EM.USRALTA,
          EM.USRMODIF,
          EM.FECBAJA,
          EM.NOMFICHERO,
          EM.ESCALA,
          EM.DESERROR,
          DECODE (EM.REVISADO, '1', 'Si', 'No'),
          EM.CODPUE,
          MPL.NOMBRE,
          DECODE (EM.IDTIPOMENSAJE || '|' || EM.NUMFUNCION,
                  '1|47', 'Alta de una solicitud de escala',          --BERMAN
                  '1|13', 'Alta atraque/fondeo',                      --BERMAN
                  '1|33', 'Modificacin en la seccin de cabecera', --BERMAN
                  '1|54', 'Modificacin del ETA',                    --BERMAN
                  '1|1', 'Cancelacin, baja de una solicitud de escala', --BERMAN
                  '1|40', 'Borrado, cancelacin de atraque/fondeo',  --BERMAN
                  '1|21', 'Reemplazo de un atraque/fondeo',           --BERMAN
                  '2|27', 'No aceptado',                              --APERAK
                  '2|30', 'Aceptado',                                 --APERAK
                  '2|45', 'Aceptado con reservas',                    --APERAK
                  '2|51', 'Autorizacin de Atraque',                 --APERAK
                  '3|27', 'Denegacin',                              --APEDGM
                  '3|51', 'Autorizacin',                            --APEDGM
                  '3|55', 'Notificacin. (Acuse de recibo)',         --APEDGM
                  '4|61', 'Notificacin Hora Real de Entrada (ATA)', --BERATA
                  '5|62', 'Notificacin Hora Real de Salida (ATD)',  --BERATD
                  '6|99', 'Notificacin de Peticin de Prctico',  --CUSPR2
                  '7|1', 'Baja de una Declaracin Sumaria',          --IFCSUM
                  '7|13', 'Borrado de la Declaracin Sumaria',       --IFCSUM
                  '7|33', 'Cambio en la seccin de cabecera',        --IFCSUM
                  '7|4', 'Cambio nivel de Conocimiento',              --IFCSUM
                  '7|40', 'Baja de Conocimiento',                     --IFCSUM
                  '7|2', 'Adicin de partida',                       --IFCSUM
                  '7|3', 'Borrado de partida',                        --IFCSUM
                  '7|36', 'Cambio a nivel de partida',                --IFCSUM
                  '7|47', 'Alta de declaracin',                     --IFCSUM
                  '7|ZN', 'Negativa'                                  --IFCSUM
                                    )
     FROM EDI_MENSAJE EM
          LEFT JOIN EDI_TIPO_MENSAJE TM
             ON TM.IDTIPOMENSAJE = EM.IDTIPOMENSAJE
          LEFT JOIN EDI_CLASE_MENSAJE CM
             ON CM.IDCLASEMENSAJE = TM.IDCLASEMENSAJE
          LEFT JOIN EDI_ESTADO EE
             ON EE.IDESTADO = EM.IDESTADO
          LEFT JOIN M_USUARIO MU
             ON MU.CODUSUARIO = EM.CODUSUARIO
          LEFT JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = EM.CODPUE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_MENSAJE_ERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_MENSAJE_ERROR
(
   IDERROR,
   CODERROR,
   ERROR,
   IDTIPOERROR,
   DESTIPOERROR,
   IDMENSAJE
)
AS
   SELECT MR.IDERROR,
          MR.CODERROR,
          MR.ERROR,
          MR.IDTIPOERROR,
          TE.DESTIPOERROR,
          MR.IDMENSAJE
     FROM    EDI_MENSAJE_ERROR MR
          LEFT JOIN
             EDI_TIPO_ERROR TE
          ON TE.IDTIPOERROR = MR.IDTIPOERROR;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_MENSAJE_ESCALA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_MENSAJE_ESCALA
(
   IDMENSAJEESCALA,
   IDMENSAJE,
   IDTIPOMENSAJE,
   DESTIPOMENSAJE,
   CLASEMENSAJE,
   SENTIDO,
   NUMFUNCION,
   BUZONEMISOR,
   BUZONRECEPTOR,
   IDESTADO,
   DESESTADO,
   FECREGISTRO,
   NUMREFMENSAJE,
   NUMREFTRANSMISOR,
   NUMREFEMISOR,
   FECMENSAJE,
   NUMREFORIGEN,
   TIPODOCUMENTO,
   NUMMENSAJEORIGEN,
   RESPONDIDO,
   CODUSUARIO,
   NOMBREUSUARIO,
   FECALTA,
   FECMODIF,
   USRALTA,
   USRMODIF,
   FECBAJA,
   NOMFICHERO,
   ESCALA,
   DESERROR,
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA
)
AS
   SELECT EME.IDMENSAJEESCALA,
          EM.IDMENSAJE,
          EM.IDTIPOMENSAJE,
          TM.DESTIPOMENSAJE,
          CM.DESCLASEMENSAJE,
          DECODE (EM.SENTIDO, 'E', 'Entrada', 'Salida'),
          EM.NUMFUNCION,
          EM.BUZONEMISOR,
          EM.BUZONRECEPTOR,
          EM.IDESTADO,
          EE.DESESTADO,
          EM.FECREGISTRO,
          EM.NUMREFMENSAJE,
          EM.NUMREFTRANSMISOR,
          EM.NUMREFEMISOR,
          EM.FECMENSAJE,
          EM.NUMREFORIGEN,
          EM.TIPODOCUMENTO,
          EM.NUMMENSAJEORIGEN,
          DECODE (EM.RESPONDIDO, '1', 'Si', 'No'),
          EM.CODUSUARIO,
          MU.NOMBRECOMPLETO,
          EM.FECALTA,
          EM.FECMODIF,
          EM.USRALTA,
          EM.USRMODIF,
          EM.FECBAJA,
          EM.NOMFICHERO,
          EM.ESCALA,
          EM.DESERROR,
          EME.CODPUE,
          EME.ANYO,
          EME.CODESCALA,
          EME.CODESTADIA
     FROM EDI_MENSAJE_ESCALA EME
          LEFT JOIN EDI_MENSAJE EM
             ON (EME.IDMENSAJE = EM.IDMENSAJE)
          LEFT JOIN EDI_TIPO_MENSAJE TM
             ON TM.IDTIPOMENSAJE = EM.IDTIPOMENSAJE
          LEFT JOIN EDI_CLASE_MENSAJE CM
             ON CM.IDCLASEMENSAJE = TM.IDCLASEMENSAJE
          LEFT JOIN EDI_ESTADO EE
             ON EE.IDESTADO = EM.IDESTADO
          LEFT JOIN M_USUARIO MU
             ON MU.CODUSUARIO = EM.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EDI_MENSAJE_MANIFIESTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EDI_MENSAJE_MANIFIESTO
(
   IDMENSAJEMANIFIESTO,
   IDMENSAJE,
   IDTIPOMENSAJE,
   DESTIPOMENSAJE,
   CLASEMENSAJE,
   SENTIDO,
   NUMFUNCION,
   BUZONEMISOR,
   BUZONRECEPTOR,
   IDESTADO,
   DESESTADO,
   FECREGISTRO,
   NUMREFMENSAJE,
   NUMREFTRANSMISOR,
   NUMREFEMISOR,
   FECMENSAJE,
   NUMREFORIGEN,
   TIPODOCUMENTO,
   NUMMENSAJEORIGEN,
   RESPONDIDO,
   CODUSUARIO,
   NOMBREUSUARIO,
   FECALTA,
   FECMODIF,
   USRALTA,
   USRMODIF,
   FECBAJA,
   NOMFICHERO,
   ESCALA,
   DESERROR,
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO
)
AS
   SELECT EMM.IDMENSAJEMANIFIESTO,
          EM.IDMENSAJE,
          EM.IDTIPOMENSAJE,
          TM.DESTIPOMENSAJE,
          CM.DESCLASEMENSAJE,
          DECODE (EM.SENTIDO, 'E', 'Entrada', 'Salida'),
          EM.NUMFUNCION,
          EM.BUZONEMISOR,
          EM.BUZONRECEPTOR,
          EM.IDESTADO,
          EE.DESESTADO,
          EM.FECREGISTRO,
          EM.NUMREFMENSAJE,
          EM.NUMREFTRANSMISOR,
          EM.NUMREFEMISOR,
          EM.FECMENSAJE,
          EM.NUMREFORIGEN,
          EM.TIPODOCUMENTO,
          EM.NUMMENSAJEORIGEN,
          DECODE (EM.RESPONDIDO, '1', 'Si', 'No'),
          EM.CODUSUARIO,
          MU.NOMBRECOMPLETO,
          EM.FECALTA,
          EM.FECMODIF,
          EM.USRALTA,
          EM.USRMODIF,
          EM.FECBAJA,
          EM.NOMFICHERO,
          EM.ESCALA,
          EM.DESERROR,
          EMM.CODPUE,
          EMM.ANYO,
          EMM.CODSER,
          EMM.CODTRAMO
     FROM EDI_MENSAJE_MANIFIESTO EMM
          LEFT JOIN EDI_MENSAJE EM
             ON (EMM.IDMENSAJE = EM.IDMENSAJE)
          LEFT JOIN EDI_TIPO_MENSAJE TM
             ON TM.IDTIPOMENSAJE = EM.IDTIPOMENSAJE
          LEFT JOIN EDI_CLASE_MENSAJE CM
             ON CM.IDCLASEMENSAJE = TM.IDCLASEMENSAJE
          LEFT JOIN EDI_ESTADO EE
             ON EE.IDESTADO = EM.IDESTADO
          LEFT JOIN M_USUARIO MU
             ON MU.CODUSUARIO = EM.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EMBARCACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EMBARCACIONES
(
   CODIGO,
   NOMBRE,
   MATRICULA,
   PROPIETARIO,
   TIPO,
   ESLORA,
   MANGA,
   CALADO,
   TIPOPROPULSION,
   DESCPROPIETARIO,
   CIFPROPIETARIO,
   CODAPSCTPROPIETARIO,
   DESCTIPO,
   DESCTIPOPROPULSION,
   FECPAGOINDEFT0,
   JUSTIFEXENTOT0
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.MATRICULA,
          E.PROPIETARIO,
          E.TIPO,
          E.ESLORA,
          E.MANGA,
          E.CALADO,
          E.TIPOPROPULSION,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          TE.DESCRIPCION,
          TP.DESCRIPCION,
          E.FECPAGOINDEFT0,
          E.JUSTIFEXENTOT0
     FROM M_EMBARCACION E
          INNER JOIN TIPO_EMBARCACION TE
             ON E.TIPO = TE.CODIGO
          INNER JOIN TIPO_PROPULSION TP
             ON E.TIPOPROPULSION = TP.CODIGO
          INNER JOIN M_USUARIO U
             ON E.PROPIETARIO = U.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EMBPESCALITORAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EMBPESCALITORAL
(
   CODIGO,
   NOMBRE,
   MATRICULA,
   ESLORA,
   MANGA
)
AS
   SELECT E.CODIGO,
          E.NOMBRE,
          E.MATRICULA,
          E.ESLORA,
          E.MANGA
     FROM M_EMBPESCALITORAL E;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EMPRESA_SUMIN  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EMPRESA_SUMIN
(
   CODIGO,
   CIF,
   NOMBRE,
   TELEFONO,
   EMAIL
)
AS
   SELECT CODIGO,
          CIF,
          NOMBRE,
          TELEFONO,
          EMAIL
     FROM M_EMPRESA_SUMIN;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALACONTROLSOLAPADA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALACONTROLSOLAPADA
(
   FECCONTROL,
   CODPUE,
   ANYO,
   CODESCALA,
   CONSIGNATARIO,
   NOMBUQUE,
   IMOBUQUE,
   ESTADOESCALA,
   ETA,
   ETD,
   NUMESCALA
)
AS
   SELECT ECS.FECCONTROL,
          ECS.CODPUEESCALA,
          ECS.ANYOESCALA,
          ECS.CODESCALA,
          U.NOMBRECOMPLETO,
          B.NOMBRE,
          B.CODIMO,
          EE.NOMBRE,
          E.ETA,
          E.ETD,
          E.NUMESCALA
     FROM ESCALA_CONTROLSOLAPADA ECS
          JOIN ESCALA E
             ON     ECS.CODPUEESCALA = E.CODPUE
                AND ECS.ANYOESCALA = E.ANYO
                AND ECS.CODESCALA = E.CODESCALA
          JOIN M_USUARIO U
             ON E.CODCONSIGNATARIO = U.CODUSUARIO
          JOIN M_PUERTO_LOCAL P
             ON E.CODPUE = P.CODPUE
          JOIN ESTADO_ESCALA EE
             ON E.CODESTADO = EE.CODESTADO
          JOIN M_BUQUE B
             ON E.CODBUQUE = B.CODBUQUE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALAPLANIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALAPLANIF
(
   CODPLANIFICACION,
   DESCRIPCION,
   CODPUE,
   PUERTO,
   FECINICIO,
   FECFIN,
   OBSERVACIONES
)
AS
   SELECT EP.CODPLANIFICACION,
          EP.DESCRIPCION,
          EP.CODPUE,
          P.NOMBRE,
          EP.FECINICIO,
          EP.FECFIN,
          EP.OBSERVACIONES
     FROM ESCALA_PLANIF EP JOIN M_PUERTO_LOCAL P ON EP.CODPUE = P.CODPUE;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALAS
(
   NUMESCALA,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCT,
   CODPUE,
   DESPUE,
   CODESTADO,
   ESTADO,
   ETA,
   ETD,
   FECINIREAL,
   FECFINREAL,
   ANYO,
   CODESCALA,
   INDLIQT0,
   INDLIQT7,
   LIQUIDADOT0,
   LIQUIDADOT7,
   LIQUIDADOT1,
   INDLIQT1,
   CODIMO,
   GT,
   ESLORATOTAL,
   NOMBRE,
   CODTIPBUQUE,
   DESTIPBUQUE,
   CODSERVMARIT,
   CONTENTRADABUQUE,
   CONTENTRADASERVMARIT,
   FECSOLICITUD,
   CODPAIORIGENDEC,
   CODPUEORIGENDEC,
   CODPAIDESTINODEC,
   CODPUEDESTINODEC,
   FECAUTORIZACION,
   FECAUTCAPITANIA,
   INDNOLIQUIDABLE,
   NOLIQUIDABLE,
   INDRESNOAPLIC10C,
   INDENTDESULTPUERTO,
   INDRESIDUOSZONA2,
   INDEXENTOT0,
   EXENTOT0,
   INDMANUAL,
   MANUAL,
   TIPTRAFICO,
   DESCTIPTRAFICO,
   IDSUJPASIVOT0,
   SUJPASIVOT0,
   CIFSUJPASIVOT0,
   CODIGOAPSCTSUJPASIVOT0,
   DIAETA,
   HORAETA,
   DIAETD,
   HORAETD,
   DIAAUTORIZACION,
   HORAAUTORIZACION,
   DIAAUTCAPITANIA,
   HORAAUTCAPITANIA,
   DIAINIREAL,
   HORAINIREAL,
   DIAFINREAL,
   HORAFINREAL,
   ESTINDEXENTA,
   ESTEXENTA,
   INDPERIODOMANUAL,
   PERIODOMANUAL,
   IND2453,
   DESC2453,
   PORC2453,
   PORC24532,
   PORC24533,
   PORC24534,
   IDSUJPASIVOT7,
   SUJPASIVOT7,
   CIFSUJPASIVOT7,
   CODIGOAPSCTSUJPASIVOT7,
   PAIORIGENDEC,
   PUEORIGENDEC,
   PAIDESTINODEC,
   PUEDESTINODEC,
   SERVICIOMARITIMO,
   SERVMARITREGULAR,
   SERVMARITTMCD,
   SERVMARITRORO,
   INDLIQPORATRAQUES,
   LIQPORATRAQUES,
   SERVMARITIMOEDI,
   CODTIPOIVAT1,
   TIPOIVAT1,
   CODTIPOIVAT7,
   TIPOIVAT7,
   BANDERA,
   JUSTIFEXENTOT7,
   INDREVISAUTORIZACION,
   REVISAUTORIZACION,
   CALMAXIMO,
   CODBUQUE,
   MANGA,
   OBSERVACIONES,
   OBSERVACIONESFACT,
   JUSTIFEXENTOT0
)
AS
   SELECT ESCALA.NUMESCALA,
          ESCALA.CODCONSIGNATARIO,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_PUERTO_LOCAL.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          ESCALA.CODESTADO,
          ESTADO_ESCALA.NOMBRE,
          ESCALA.ETA,
          ESCALA.ETD,
          ESCALA.FECINIREAL,
          ESCALA.FECFINREAL,
          ESCALA.ANYO,
          ESCALA.CODESCALA,
          ESCALA.INDLIQT0,
          ESCALA.INDLIQT7,
          DECODE (ESCALA.INDLIQT0, '1', 'Si', 'No'),
          DECODE (ESCALA.INDLIQT7, '1', 'Si', 'No'),
          DECODE (ESCALA.INDLIQT1, '1', 'Si', 'No') AS liquidadot1,
          ESCALA.INDLIQT1,
          M_BUQUE.CODIMO,
          BV.GT,
          BV.ESLORATOTAL,
          M_BUQUE.NOMBRE,
          BV.CODTIPOBUQUE,
          TIPO_BUQUE.DESCRIPCION,
          ESCALA.CODSERVMARIT,
          ESCALA.CONTENTRADABUQUE,
          ESCALA.CONTENTRADASERVMARIT,
          ESCALA.FECSOLICITUD,
          ESCALA.CODPAIORIGENDEC,
          ESCALA.CODPUEORIGENDEC,
          ESCALA.CODPAIDESTINODEC,
          ESCALA.CODPUEDESTINODEC,
          ESCALA.FECAUTORIZACION,
          ESCALA.FECAUTCAPITANIA,
          ESCALA.INDNOLIQUIDABLE,
          DECODE (ESCALA.INDNOLIQUIDABLE, '1', 'Si', 'No'),
          DECODE (ESCALA.INDRESNOAPLIC10C, '1', 'Si', 'No'),
          DECODE (ESCALA.INDENTDESULTPUERTO, '1', 'Si', 'No'),
          DECODE (ESCALA.INDRESIDUOSZONA2, '1', 'Si', 'No'),
          ESCALA.INDEXENTOT0,
          DECODE (ESCALA.INDEXENTOT0, '1', 'Si', 'No'),
          ESCALA.INDMANUAL,
          DECODE (ESCALA.INDMANUAL, '1', 'Si', 'No'),
          ESCALA.TIPTRAFICO,
          M_TIPO_TRAFICO.DESCRIPCION,
          ESCALA.IDSUJPASIVOT0,
          UT0.NOMBRECOMPLETO,
          UT0.NUMDOC || UT0.LETRANIF,
          UT0.CODAPSCT,
          TO_CHAR (ESCALA.ETA, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.ETA, 'HH24:mi'),
          TO_CHAR (ESCALA.ETD, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.ETD, 'HH24:mi'),
          TO_CHAR (ESCALA.FECAUTORIZACION, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.FECAUTORIZACION, 'HH24:mi'),
          TO_CHAR (ESCALA.FECAUTCAPITANIA, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.FECAUTCAPITANIA, 'HH24:mi'),
          TO_CHAR (ESCALA.FECINIREAL, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.FECINIREAL, 'HH24:mi'),
          TO_CHAR (ESCALA.FECFINREAL, 'dd/MM/rrrr'),
          TO_CHAR (ESCALA.FECFINREAL, 'HH24:mi'),
          ESCALA.ESTINDEXENTA,
          DECODE (ESCALA.ESTINDEXENTA, '1', 'Si', 'No'),
          ESCALA.INDPERIODOMANUAL,
          DECODE (ESCALA.INDPERIODOMANUAL, '1', 'Si', 'No'),
          ESCALA.IND2453,
          DECODE (ESCALA.IND2453, '1', 'Si', 'No'),
          ESCALA.PORC2453,
          ESCALA.PORC24532,
          ESCALA.PORC24533,
          ESCALA.PORC24534,
          ESCALA.IDSUJPASIVOT7,
          UT7.NOMBRECOMPLETO,
          UT7.NUMDOC || UT7.LETRANIF,
          UT7.CODAPSCT,
          PA1.NOMBRE,
          PU1.NOMBRE,
          PA2.NOMBRE,
          PU2.NOMBRE,
          SM.NOMBRE,
          DECODE (SM.INDREGULAR,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDTMCD,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDRORO,  '1', 'Si',  '0', 'No',  NULL),
          ESCALA.INDLIQPORATRAQUES,
          DECODE (ESCALA.INDLIQPORATRAQUES, '1', 'Si', 'No'),
          ESCALA.SERVMARITIMOEDI,
          ESCALA.CODTIPOIVAT1,
          TIT1.DESCRIPCION,
          ESCALA.CODTIPOIVAT7,
          TIT7.DESCRIPCION,
          BV.BANDERA,
          ESCALA.JUSTIFEXENTOT7,
          ESCALA.INDREVISAUTORIZACION,
          DECODE (ESCALA.INDREVISAUTORIZACION, '1', 'Si', 'No'),
          BV.CALMAXIMO,
          ESCALA.CODBUQUE,
          BV.MANGA,
          ESCALA.OBSERVACIONES,
          ESCALA.OBSERVACIONESFACT,
          ESCALA.JUSTIFEXENTOT0
     FROM ESCALA
          INNER JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL
             ON (ESCALA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN ESTADO_ESCALA
             ON (ESCALA.CODESTADO = ESTADO_ESCALA.CODESTADO)
          INNER JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE
             ON (TIPO_BUQUE.CODTIPOBUQUE = BV.CODTIPOBUQUE)
          LEFT JOIN M_TIPO_TRAFICO
             ON (M_TIPO_TRAFICO.CODIGO = ESCALA.TIPTRAFICO)
          LEFT JOIN M_USUARIO UT0
             ON (ESCALA.IDSUJPASIVOT0 = UT0.CODUSUARIO)
          LEFT JOIN M_USUARIO UT7
             ON (ESCALA.IDSUJPASIVOT7 = UT7.CODUSUARIO)
          LEFT JOIN M_PAIS PA1
             ON (ESCALA.CODPAIORIGENDEC = PA1.CODPAIS)
          LEFT JOIN M_PUERTO PU1
             ON (ESCALA.CODPAIORIGENDEC = PU1.CODPAIS
                 AND ESCALA.CODPUEORIGENDEC = PU1.CODPUE)
          LEFT JOIN M_PAIS PA2
             ON (ESCALA.CODPAIDESTINODEC = PA2.CODPAIS)
          LEFT JOIN M_PUERTO PU2
             ON (ESCALA.CODPAIDESTINODEC = PU2.CODPAIS
                 AND ESCALA.CODPUEDESTINODEC = PU2.CODPUE)
          LEFT JOIN M_SERVICIOMARITIMO SM
             ON ESCALA.CODSERVMARIT = SM.CODSERVICIO
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIT1
             ON TIT1.CODIGO = ESCALA.CODTIPOIVAT1
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIT7
             ON TIT7.CODIGO = ESCALA.CODTIPOIVAT7
    WHERE ESCALA.INDTRAFINT = '0';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALASTRAFINT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALASTRAFINT
(
   NUMESCALA,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCT,
   CODPUE,
   DESPUE,
   CODESTADO,
   ESTADO,
   ETA,
   ETD,
   FECINIREAL,
   FECFINREAL,
   ANYO,
   CODESCALA,
   INDLIQT0,
   LIQUIDADOT0,
   CODIMO,
   GT,
   ESLORATOTAL,
   NOMBRE,
   NOMBREARMADOR,
   CIFARMADOR,
   CODTIPBUQUE,
   DESTIPBUQUE,
   FECSOLICITUD,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   INDEXENTOT0,
   EXENTOT0,
   INDMANUAL,
   MANUAL,
   CODTIPOTRAFINT,
   TIPOTRAFINT,
   ESTINDEXENTA,
   ESTEXENTA,
   TIPTRAFICO,
   DESCTIPTRAFICO,
   INDAPLIC2453PESCA,
   APLIC2453PESCA,
   INDAPLIC2453CABL,
   APLIC2453CABL,
   INDAPLIC2453INACT,
   APLIC2453INACT,
   INDLIQT0PROLONGADA,
   LIQT0PROLONGADA,
   OBSERVACIONES,
   OBSERVACIONESFACT
)
AS
   SELECT ESCALA.NUMESCALA,
          ESCALA.CODCONSIGNATARIO,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.CODAPSCT,
          M_PUERTO_LOCAL.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          ESCALA.CODESTADO,
          ESTADO_ESCALA.NOMBRE,
          ESCALA.ETA,
          ESCALA.ETD,
          ESCALA.FECINIREAL,
          ESCALA.FECFINREAL,
          ESCALA.ANYO,
          ESCALA.CODESCALA,
          ESCALA.INDLIQT0,
          DECODE (ESCALA.INDLIQT0, '1', 'Si', 'No'),
          BU.CODIMO,
          BV.GT,
          BV.ESLORATOTAL,
          BU.NOMBRE,
          AR.NOMBRECOMPLETO,
          AR.NUMDOC || AR.LETRANIF,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          ESCALA.FECSOLICITUD,
          ESCALA.CODPAIORIGEN,
          ESCALA.CODPUEORIGEN,
          ESCALA.CODPAIDESTINO,
          ESCALA.CODPUEDESTINO,
          ESCALA.INDEXENTOT0,
          DECODE (ESCALA.INDEXENTOT0, '1', 'Si', 'No'),
          ESCALA.INDMANUAL,
          DECODE (ESCALA.INDMANUAL, '1', 'Si', 'No'),
          ESCALA.CODTIPOTRAFINT,
          TT.DESCRIPCION,
          ESCALA.ESTINDEXENTA,
          DECODE (ESCALA.ESTINDEXENTA, '1', 'Si', 'No'),
          ESCALA.TIPTRAFICO,
          M_TIPO_TRAFICO.DESCRIPCION,
          ESCALA.INDAPLIC2453PESCA,
          DECODE (ESCALA.INDAPLIC2453PESCA, '1', 'Si', 'No'),
          ESCALA.INDAPLIC2453CABL,
          DECODE (ESCALA.INDAPLIC2453CABL, '1', 'Si', 'No'),
          ESCALA.INDAPLIC2453INACT,
          DECODE (ESCALA.INDAPLIC2453INACT, '1', 'Si', 'No'),
          ESCALA.INDLIQT0PROLONGADA,
          DECODE (ESCALA.INDLIQT0PROLONGADA, '1', 'Si', 'No'),
          ESCALA.OBSERVACIONES,
          ESCALA.OBSERVACIONESFACT
     FROM ESCALA
          INNER JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL
             ON (ESCALA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN ESTADO_ESCALA
             ON (ESCALA.CODESTADO = ESTADO_ESCALA.CODESTADO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON BV.CODTIPOBUQUE = TB.CODTIPOBUQUE
          LEFT JOIN M_USUARIO AR
             ON AR.CODUSUARIO = BV.CODARMADOR
          LEFT JOIN M_TIPO_TRAFICO
             ON (M_TIPO_TRAFICO.CODIGO = ESCALA.TIPTRAFICO)
          LEFT JOIN TIPO_ACTIV_ESTADIA
             ON (TIPO_ACTIV_ESTADIA.CODIGO = ESCALA.CODTIPACTIVREALEST1)
          LEFT JOIN TIPO_TRAFINTERIOR TT
             ON (ESCALA.CODTIPOTRAFINT = TT.CODIGO)
    WHERE ESCALA.INDTRAFINT = '1';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALAS_LOGMODIFOFICIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALAS_LOGMODIFOFICIO
(
   CODPUE,
   ANYO,
   CODESCALA,
   SEQLOG,
   FECHALOG,
   USRLOG,
   CAMBIO,
   CODREVISION
)
AS
   SELECT ESCALA_LOGMODIFOFICIO.CODPUE,
          ESCALA_LOGMODIFOFICIO.ANYO,
          ESCALA_LOGMODIFOFICIO.CODESCALA,
          ESCALA_LOGMODIFOFICIO.SEQLOG,
          ESCALA_LOGMODIFOFICIO.FECHALOG,
          ESCALA_LOGMODIFOFICIO.USRLOG,
          ESCALA_LOGMODIFOFICIO.CAMBIO,
          ESCALA_LOGMODIFOFICIO.CODREVISION
     FROM ESCALA_LOGMODIFOFICIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALAS_REVISION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALAS_REVISION
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODIGO,
   MODOREVISION,
   TIPOREVISION,
   NUMRESOLUCION,
   FACTRECTIF,
   FECREGSALIDA,
   DOCSUSTRECT,
   CODMOTREVISION,
   MOTREVISION,
   FECALTA
)
AS
   SELECT ESCALA_REVISION.CODPUE,
          ESCALA_REVISION.ANYO,
          ESCALA_REVISION.CODESCALA,
          ESCALA_REVISION.CODIGO,
          DECODE (ESCALA_REVISION.MODOREVISION,
                  'A', 'Automatica',
                  'M', 'Manual'),
          DECODE (ESCALA_REVISION.TIPOREVISION,
                  'I', 'Instancia de parte',
                  'O', 'Oficio'),
          ESCALA_REVISION.NUMRESOLUCION,
          ESCALA_REVISION.FACTRECTIF,
          ESCALA_REVISION.FECREGSALIDA,
          ESCALA_REVISION.DOCSUSTRECT,
          ESCALA_REVISION.CODMOTREVISION,
          M_MOTIVOVERSION.DESCRIPCION,
          ESCALA_REVISION.FECALTA
     FROM    ESCALA_REVISION
          LEFT JOIN
             M_MOTIVOVERSION
          ON (ESCALA_REVISION.CODMOTREVISION = M_MOTIVOVERSION.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALA_ENTREGAMARPOL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALA_ENTREGAMARPOL
(
   CODPUE,
   DESPUE,
   ANYO,
   CODESC,
   NUMTONMARPOLI,
   NUMTONMARPOLV,
   FECREGISTRO,
   NUMREGISTRO,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCT,
   NOMBREBUQUE,
   GT,
   IMO,
   OBSERVACIONES
)
AS
   SELECT M.CODPUE,
          M.NOMBRE,
          E.ANYO,
          E.CODESC,
          E.NUMTONMARPOLI,
          E.NUMTONMARPOLV,
          E.FECREGISTRO,
          E.NUMREGISTRO,
          ESC_USU.NUMESCALA,
          ESC_USU.NOMBRECOMPLETO,
          ESC_USU.NUMDOC || ESC_USU.LETRANIF,
          ESC_USU.CODAPSCT,
          BU.NOMBRE,
          BV.GT,
          BU.CODIMO,
          E.OBSERVACIONES
     FROM ESCALA_ENTREGAMARPOL E
          LEFT JOIN M_PUERTO_LOCAL M
             ON (E.CODPUE = M.CODPUE)
          LEFT JOIN (SELECT M_USUARIO.NUMDOC,
                            M_USUARIO.LETRANIF,
                            M_USUARIO.NOMBRECOMPLETO,
                            M_USUARIO.CODAPSCT,
                            ESCALA.CODPUE,
                            ESCALA.CODESCALA,
                            ESCALA.ANYO,
                            ESCALA.NUMESCALA,
                            ESCALA.CODBUQUE,
                            ESCALA.FECINIREAL,
                            ESCALA.ETA
                       FROM    ESCALA
                            LEFT JOIN
                               M_USUARIO
                            ON ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO) ESC_USU
             ON (    E.CODPUE = ESC_USU.CODPUE
                 AND E.ANYO = ESC_USU.ANYO
                 AND E.CODESC = ESC_USU.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESC_USU.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESC_USU.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESC_USU.FECINIREAL)
                            ELSE
                               TRUNC (ESC_USU.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESC_USU.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESC_USU.FECINIREAL)
                             ELSE
                                TRUNC (ESC_USU.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL));


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESCALA_PLANENTMARPOL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESCALA_PLANENTMARPOL
(
   CODPUE,
   DESPUE,
   ANYO,
   CODESC,
   NUMTONMARPOLI,
   NUMTONMARPOLV,
   FECPREVISTA,
   NUMESCALA,
   NOMBRECONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCT,
   NOMBREBUQUE,
   GT,
   IMO,
   OBSERVACIONES,
   INDVALIDADA,
   VALIDADA
)
AS
   SELECT M.CODPUE,
          M.NOMBRE,
          E.ANYO,
          E.CODESC,
          E.NUMTONMARPOLI,
          E.NUMTONMARPOLV,
          E.FECPREVISTA,
          ESC_USU.NUMESCALA,
          ESC_USU.NOMBRECOMPLETO,
          ESC_USU.NUMDOC || ESC_USU.LETRANIF,
          ESC_USU.CODAPSCT,
          BU.NOMBRE,
          BV.GT,
          BU.CODIMO,
          E.OBSERVACIONES,
          E.INDVALIDADA,
          DECODE (E.INDVALIDADA, '1', 'Si', 'No')
     FROM ESCALA_PLANENTMARPOL E
          LEFT JOIN M_PUERTO_LOCAL M
             ON (E.CODPUE = M.CODPUE)
          LEFT JOIN (SELECT M_USUARIO.NUMDOC,
                            M_USUARIO.LETRANIF,
                            M_USUARIO.NOMBRECOMPLETO,
                            M_USUARIO.CODAPSCT,
                            ESCALA.CODPUE,
                            ESCALA.CODESCALA,
                            ESCALA.ANYO,
                            ESCALA.NUMESCALA,
                            ESCALA.CODBUQUE,
                            ESCALA.FECINIREAL,
                            ESCALA.ETA
                       FROM    ESCALA
                            LEFT JOIN
                               M_USUARIO
                            ON ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO) ESC_USU
             ON (    E.CODPUE = ESC_USU.CODPUE
                 AND E.ANYO = ESC_USU.ANYO
                 AND E.CODESC = ESC_USU.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESC_USU.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESC_USU.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESC_USU.FECINIREAL)
                            ELSE
                               TRUNC (ESC_USU.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESC_USU.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESC_USU.FECINIREAL)
                             ELSE
                                TRUNC (ESC_USU.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL));


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTADIAGLOBAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTADIAGLOBAL
(
   CODPUE,
   DESPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   NUMESCALA,
   CIF,
   NOMBRECOMPLETO,
   CODIGOAPSCT,
   GT,
   NOMBREBUQUE,
   IMO,
   CODTIPBUQUE,
   DESTIPBUQUE,
   CODSERVMARIT,
   NOMBRESERVMARIT,
   FECINIPREV,
   FECFINPREV,
   FECINIREAL,
   FECFINREAL,
   FORMAATRAQUE,
   TIPOPRESTACIONBUQUE,
   CODMUELLEINIREAL,
   MUELLE,
   CODZONAAGUA,
   TIPOACTVESTADIA,
   INDLIQT1,
   CONTENTRADABUQUE,
   CONTENTRADASERVMARIT,
   CODESTADO,
   DESESTADO,
   CODPAIORIGENDEC,
   CODPUEORIGENDEC,
   CODPAIDESTINODEC,
   CODPUEDESTINODEC,
   NORAYINIREAL,
   NORAYFINREAL,
   NORAYINIPREV,
   NORAYFINPREV,
   CODMUELLEINIPREV,
   MUELLEINIPREV,
   NORAYINIAUT,
   NORAYFINAUT,
   CODMUELLEINIAUT,
   MUELLEINIAUT,
   INDMANUAL,
   MANUAL,
   INDMANUALESCALA,
   MANUALESCALA,
   INDAPLICAVI193,
   APLICAVI193,
   TIPTRAFICO,
   TIPOTRAFICO,
   CONSIGNATARIO,
   FECINIAUT,
   FECFINAUT,
   CODTIPACTIVIDAD,
   TIPOACTIVIDAD,
   CODTIPACTIVREAL,
   DIAINIPREV,
   HORAINIPREV,
   DIAFINPREV,
   HORAFINPREV,
   DIAINIAUT,
   HORAINIAUT,
   DIAFINAUT,
   HORAFINAUT,
   DIAINIREAL,
   HORAINIREAL,
   DIAFINREAL,
   HORAFINREAL,
   INDPERIODOMANUAL,
   PERIODOMANUAL,
   NUMPERIODOMANUAL,
   INDEXENTAT1,
   PAIORIGENDEC,
   PUEORIGENDEC,
   PAIDESTINODEC,
   PUEDESTINODEC,
   ESLORA,
   INDNOAPLICSERVMARIT,
   INDLIQPORATRAQUES,
   SERVMARITIMOEDI,
   BANDERA,
   CALMAXIMO,
   CALADOSOLICITADO,
   CALADOAUTORIZADO,
   CALADOREAL,
   INDOPCOMZONA1FEST,
   INDINICIOVIAAPLICEXT,
   INDFINVIAAPLICEXT,
   INDINISINESTARAUT,
   MANGA,
   INDGNL,
   ESTINDEXENTA
)
AS
   SELECT ESTADIA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          ESCALA.NUMESCALA,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.CODAPSCT,
          BV.GT,
          M_BUQUE.NOMBRE,
          M_BUQUE.CODIMO,
          BV.CODTIPOBUQUE,
          TIPO_BUQUE.DESCRIPCION,
          ESCALA.CODSERVMARIT,
          ESCALA_SERVICIOM.NOMBRE,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          FORMA_ATRAQUE.DESCRIPCION,
          TIPO_PRESTACIONBUQUE.DESCRIPCION,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION,
          M_MUELLE.CODZONAAGUA,
          TIPO_ACTIV_ESTADIA.DESCRIPCION,
          DECODE (ESTADIA.INDLIQT1, '1', 'Si', 'No'),
          ESCALA.CONTENTRADABUQUE,
          ESCALA.CONTENTRADASERVMARIT,
          ESTADO_ESTADIA.CODIGO,
          ESTADO_ESTADIA.NOMBRE,
          ESCALA.CODPAIORIGENDEC,
          ESCALA.CODPUEORIGENDEC,
          ESCALA.CODPAIDESTINODEC,
          ESCALA.CODPUEDESTINODEC,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          ESTADIA.NORAYINIPREV,
          ESTADIA.NORAYFINPREV,
          ESTADIA.CODMUELLEINIPREV,
          MP.DESCRIPCION,
          ESTADIA.NORAYINIAUT,
          ESTADIA.NORAYFINAUT,
          ESTADIA.CODMUELLEINIAUT,
          MIA.DESCRIPCION,
          ESTADIA.INDMANUAL,
          DECODE (ESTADIA.INDMANUAL, '1', 'Si', 'No'),
          ESCALA.INDMANUAL,
          DECODE (ESCALA.INDMANUAL, '1', 'Si', 'No'),
          ESTADIA.INDAPLICAVI193,
          DECODE (ESTADIA.INDAPLICAVI193, '1', 'Si', 'No'),
          ESCALA.TIPTRAFICO,
          M_TIPO_TRAFICO.DESCRIPCION,
          CON.NOMBRECOMPLETO,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          ESTADIA.CODTIPACTIVIDAD,
          ACTIVPREV.DESCRIPCION,
          ESTADIA.CODTIPACTIVREAL,
          TO_CHAR (ESTADIA.FECATRAQUEPREV, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECATRAQUEPREV, 'HH24:mi'),
          TO_CHAR (ESTADIA.FECDESATRAQUEPREV, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECDESATRAQUEPREV, 'HH24:mi'),
          TO_CHAR (ESTADIA.FECINIAUT, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECINIAUT, 'HH24:mi'),
          TO_CHAR (ESTADIA.FECFINAUT, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECFINAUT, 'HH24:mi'),
          TO_CHAR (ESTADIA.FECATRAQUEREAL, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECATRAQUEREAL, 'HH24:mi'),
          TO_CHAR (ESTADIA.FECDESATRAQUEREAL, 'dd/MM/rrrr'),
          TO_CHAR (ESTADIA.FECDESATRAQUEREAL, 'HH24:mi'),
          ESCALA.INDPERIODOMANUAL,
          DECODE (ESCALA.INDPERIODOMANUAL, '1', 'Si', 'No'),
          ESTADIA.PERIODOMANUAL,
          DECODE (ESTADIA.INDEXENTAT1, '1', 'Si', 'No'),
          PA1.NOMBRE,
          PU1.NOMBRE,
          PA2.NOMBRE,
          PU2.NOMBRE,
          BV.ESLORATOTAL,
          DECODE (ESTADIA.INDNOAPLICSERVMARIT, '1', 'Si', 'No'),
          DECODE (ESCALA.INDLIQPORATRAQUES, '1', 'Si', 'No'),
          ESCALA.SERVMARITIMOEDI,
          BV.BANDERA,
          BV.CALMAXIMO,
          MP.CALADO,
          MIA.CALADO,
          M_MUELLE.CALADO,
          DECODE (ESTADIA.INDOPCOMZONA1FEST, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDINICIOVIAAPLICEXT, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDFINVIAAPLICEXT, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDINISINESTARAUT, '1', 'Si', 'No'),
          BV.MANGA,
          DECODE (ESTADIA.INDGNL, '1', 'Si', 'No'),
          DECODE (ESTADIA.ESTINDEXENTA, '1', 'Si', 'No')
     FROM ESTADIA
          LEFT JOIN M_PUERTO_LOCAL
             ON (ESTADIA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_USUARIO
             ON (ESTADIA.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
          LEFT JOIN FORMA_ATRAQUE
             ON (ESTADIA.CODTIPATRAQUEREAL = FORMA_ATRAQUE.CODTIPATRAQUE)
          LEFT JOIN TIPO_PRESTACIONBUQUE
             ON (ESTADIA.CODTIPPRESTREAL = TIPO_PRESTACIONBUQUE.CODIGO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN TIPO_ACTIV_ESTADIA
             ON (ESTADIA.CODTIPACTIVREAL = TIPO_ACTIV_ESTADIA.CODIGO)
          LEFT JOIN TIPO_ACTIV_ESTADIA ACTIVPREV
             ON (ESTADIA.CODTIPACTIVIDAD = ACTIVPREV.CODIGO)
          INNER JOIN ESCALA
             ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA.CODESCALA
                 AND ESTADIA.ANYO = ESCALA.ANYO)
          INNER JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE
             ON (TIPO_BUQUE.CODTIPOBUQUE = BV.CODTIPOBUQUE)
          LEFT JOIN (SELECT ESCALA.CODPUE,
                            ESCALA.CODESCALA,
                            ESCALA.ANYO,
                            ESCALA.CODSERVMARIT,
                            M_SERVICIOMARITIMO.NOMBRE
                       FROM    ESCALA
                            LEFT JOIN
                               M_SERVICIOMARITIMO
                            ON ESCALA.CODSERVMARIT =
                                  M_SERVICIOMARITIMO.CODSERVICIO) ESCALA_SERVICIOM
             ON (    ESTADIA.CODPUE = ESCALA_SERVICIOM.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA_SERVICIOM.CODESCALA
                 AND ESTADIA.ANYO = ESCALA_SERVICIOM.ANYO)
          INNER JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MP
             ON (ESTADIA.CODMUELLEINIPREV = MP.CODIGO)
          LEFT JOIN M_MUELLE MIA
             ON (ESTADIA.CODMUELLEINIAUT = MIA.CODIGO)
          LEFT JOIN M_TIPO_TRAFICO
             ON (ESCALA.TIPTRAFICO = M_TIPO_TRAFICO.CODIGO)
          LEFT JOIN M_PAIS PA1
             ON (ESCALA.CODPAIORIGENDEC = PA1.CODPAIS)
          LEFT JOIN M_PUERTO PU1
             ON (ESCALA.CODPAIORIGENDEC = PU1.CODPAIS
                 AND ESCALA.CODPUEORIGENDEC = PU1.CODPUE)
          LEFT JOIN M_PAIS PA2
             ON (ESCALA.CODPAIDESTINODEC = PA2.CODPAIS)
          LEFT JOIN M_PUERTO PU2
             ON (ESCALA.CODPAIDESTINODEC = PU2.CODPAIS
                 AND ESCALA.CODPUEDESTINODEC = PU2.CODPUE)
          LEFT JOIN M_USUARIO CON
             ON (ESCALA.CODCONSIGNATARIO = CON.CODUSUARIO)
    WHERE ESCALA.INDTRAFINT = '0';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTADIAOTROSACT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTADIAOTROSACT
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   NOMBRECOMPLETO,
   MUELLE,
   NORAY,
   NUMESCALA,
   BUQUE,
   BANDERA,
   ESLORA,
   TRB,
   GT,
   CALADO,
   FECINIAUT,
   FECFINAUT,
   DESCOPERACIONES,
   PUERTOORIGEN,
   PUERTODESTINO
)
AS
   SELECT ESTADIA.CODPUE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          M_USUARIO.NOMBRECOMPLETO,
          M_MUELLE.DESCRIPCION,
          DECODE (ESTADIA.NORAYINIAUT,
                  NULL, '',
                  ESTADIA.NORAYINIAUT || '-' || ESTADIA.NORAYFINAUT),
          ESCALA.NUMESCALA,
          BU.NOMBRE,
          M_PAIS.NOMBRE,
          BV.ESLORATOTAL,
          BV.TRB,
          BV.GT,
          BV.CALMAXIMO,
          ESTADIA.FECINIAUT,
          ESTADIA.FECFINAUT,
          ESTADIA.DESCOPERACIONES,
          ORIGEN.NOMBRE,
          DESTINO.NOMBRE
     FROM ESTADIA
          INNER JOIN ESCALA
             ON (    ESCALA.CODPUE = ESTADIA.CODPUE
                 AND ESCALA.ANYO = ESTADIA.ANYO
                 AND ESCALA.CODESCALA = ESTADIA.CODESCALA)
          INNER JOIN M_USUARIO
             ON (ESCALA.CODCONSIGNATARIO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          INNER JOIN M_PAIS
             ON (BV.BANDERA = M_PAIS.CODPAIS)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIAUT = M_MUELLE.CODIGO)
          LEFT JOIN M_PUERTO ORIGEN
             ON (ORIGEN.CODPAIS = ESCALA.CODPAIORIGENDEC
                 AND ORIGEN.CODPUE = ESCALA.CODPUEORIGENDEC)
          LEFT JOIN M_PUERTO DESTINO
             ON (DESTINO.CODPAIS = ESCALA.CODPAIDESTINODEC
                 AND DESTINO.CODPUE = ESCALA.CODPUEDESTINODEC)
    WHERE ESTADIA.CODESTADO NOT IN ('AN', 'DE');


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTADIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTADIAS
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODESTADO,
   ESTADO,
   ACTIVIDAD,
   FECATRAQUEPREV,
   FECDESATRAQUEPREV,
   FATRQPREV,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   FATRQREAL,
   INDMANUAL,
   INDLIQT1,
   ACTIVIDADREAL,
   IDSUJPASIVO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   CODMUELLEINIREAL,
   MUELLEINIREAL,
   CODMUELLEINIAUT,
   NORAYINIREAL,
   NORAYFINREAL,
   NORAYINIPREV,
   NORAYFINPREV,
   CODMUELLEINIPREV,
   MUELLEINIPREV,
   NORAYINIAUT,
   NORAYFINAUT,
   MUELLEINIAUT,
   CODESTADIADUE,
   CODSUBTIPOACTIVIDAD,
   SUBTIPOACTIVIDAD,
   PERIODOMANUAL,
   INDEXENTAT1,
   PAIORIGENDEC,
   PUEORIGENDEC,
   PAIDESTINODEC,
   PUEDESTINODEC,
   ESLORA,
   INDNOAPLICSERVMARIT,
   INDLIQPORATRAQUES,
   LIQPORATRAQUES,
   BANDERA,
   CALMAXIMO,
   CALADOSOLICITADO,
   CALADOAUTORIZADO,
   CALADOREAL,
   INDOPCOMZONA1FEST,
   INDINICIOVIAAPLICEXT,
   INDFINVIAAPLICEXT,
   INDINISINESTARAUT,
   MANGA,
   INDGNL,
   ESTINDEXENTA
)
AS
   SELECT ESTADIA.CODPUE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          TIPO_ACTIV_ESTADIA.DESCRIPCION,
          ESTADIA.FECATRAQUEPREV,
          ESTADIA.FECDESATRAQUEPREV,
          FATRQPREV.DESCRIPCION,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          FATRQREAL.DESCRIPCION,
          ESTADIA.INDMANUAL,
          ESTADIA.INDLIQT1,
          TAR.DESCRIPCION,
          ESTADIA.IDSUJPASIVO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION,
          ESTADIA.CODMUELLEINIAUT,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          ESTADIA.NORAYINIPREV,
          ESTADIA.NORAYFINPREV,
          ESTADIA.CODMUELLEINIPREV,
          MINIPREV.DESCRIPCION,
          ESTADIA.NORAYINIAUT,
          ESTADIA.NORAYFINAUT,
          MINIAUT.DESCRIPCION,
          ESTADIA.CODESTADIADUE,
          ESTADIA.CODSUBTIPOACTIVIDAD,
          SUBTIPO_ACTIVIDAD.DESCRIPCION,
          ESTADIA.PERIODOMANUAL,
          DECODE (ESTADIA.INDEXENTAT1, '1', 'Si', 'No'),
          PA1.NOMBRE,
          PU1.NOMBRE,
          PA2.NOMBRE,
          PU2.NOMBRE,
          BV.ESLORATOTAL,
          DECODE (ESTADIA.INDNOAPLICSERVMARIT, '1', 'Si', 'No'),
          ESCALA.INDLIQPORATRAQUES,
          DECODE (ESCALA.INDLIQPORATRAQUES, '1', 'Si', 'No'),
          BV.BANDERA,
          BV.CALMAXIMO,
          MINIPREV.CALADO,
          MINIAUT.CALADO,
          M_MUELLE.CALADO,
          DECODE (ESTADIA.INDOPCOMZONA1FEST, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDINICIOVIAAPLICEXT, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDFINVIAAPLICEXT, '1', 'Si', 'No'),
          DECODE (ESTADIA.INDINISINESTARAUT, '1', 'Si', 'No'),
          BV.MANGA,
          DECODE (ESTADIA.INDGNL, '1', 'Si', 'No'),
          DECODE (ESTADIA.ESTINDEXENTA, '1', 'Si', 'No')
     FROM ESTADIA
          LEFT JOIN FORMA_ATRAQUE FATRQPREV
             ON (ESTADIA.CODTIPATRAQUEPREV = FATRQPREV.CODTIPATRAQUE)
          LEFT JOIN FORMA_ATRAQUE FATRQREAL
             ON (ESTADIA.CODTIPATRAQUEREAL = FATRQREAL.CODTIPATRAQUE)
          LEFT JOIN TIPO_ACTIV_ESTADIA
             ON (ESTADIA.CODTIPACTIVIDAD = TIPO_ACTIV_ESTADIA.CODIGO)
          LEFT JOIN TIPO_ACTIV_ESTADIA TAR
             ON (ESTADIA.CODTIPACTIVREAL = TAR.CODIGO)
          LEFT JOIN M_USUARIO
             ON (ESTADIA.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN M_MUELLE MINIPREV
             ON (ESTADIA.CODMUELLEINIPREV = MINIPREV.CODIGO)
          LEFT JOIN M_MUELLE MINIAUT
             ON (ESTADIA.CODMUELLEINIAUT = MINIAUT.CODIGO)
          LEFT JOIN SUBTIPO_ACTIVIDAD
             ON (ESTADIA.CODSUBTIPOACTIVIDAD = SUBTIPO_ACTIVIDAD.CODIGO)
          INNER JOIN ESCALA
             ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA.CODESCALA
                 AND ESTADIA.ANYO = ESCALA.ANYO)
          INNER JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN M_PAIS PA1
             ON (ESCALA.CODPAIORIGENDEC = PA1.CODPAIS)
          LEFT JOIN M_PUERTO PU1
             ON (ESCALA.CODPAIORIGENDEC = PU1.CODPAIS
                 AND ESCALA.CODPUEORIGENDEC = PU1.CODPUE)
          LEFT JOIN M_PAIS PA2
             ON (ESCALA.CODPAIDESTINODEC = PA2.CODPAIS)
          LEFT JOIN M_PUERTO PU2
             ON (ESCALA.CODPAIDESTINODEC = PU2.CODPAIS
                 AND ESCALA.CODPUEDESTINODEC = PU2.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTADIASTRAFINT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTADIASTRAFINT
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODESTADO,
   ESTADO,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   FATRQREAL,
   INDMANUAL,
   INDLIQT1,
   LIQT1,
   ACTIVIDADREAL,
   IDSUJPASIVO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   CODMUELLEINIREAL,
   MUELLEINIREAL,
   NORAYINIREAL,
   NORAYFINREAL,
   CODSUBTIPOACTIVIDAD,
   SUBTIPOACTIVIDAD,
   INDAPLICAVI193,
   APLICAVI193,
   INDLIQT7,
   LIQT7,
   INDEXENTAT7,
   EXENTAT7,
   INDEXENTAT1,
   EXENTAT1
)
AS
   SELECT ESTADIA.CODPUE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          FATRQREAL.DESCRIPCION,
          ESTADIA.INDMANUAL,
          ESTADIA.INDLIQT1,
          DECODE (ESTADIA.INDLIQT1, '1', 'Si', 'No'),
          TAR.DESCRIPCION,
          ESTADIA.IDSUJPASIVO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          ESTADIA.CODSUBTIPOACTIVIDAD,
          SUBTIPO_ACTIVIDAD.DESCRIPCION,
          ESTADIA.INDAPLICAVI193,
          DECODE (ESTADIA.INDAPLICAVI193, '1', 'Si', 'No'),
          ESTADIA.INDLIQT7,
          DECODE (ESTADIA.INDLIQT7, '1', 'Si', 'No'),
          ESTADIA.INDEXENTAT7,
          DECODE (ESTADIA.INDEXENTAT7, '1', 'Si', 'No'),
          ESTADIA.INDEXENTAT1,
          DECODE (ESTADIA.INDEXENTAT1, '1', 'Si', 'No')
     FROM ESTADIA
          LEFT JOIN FORMA_ATRAQUE FATRQREAL
             ON (ESTADIA.CODTIPATRAQUEREAL = FATRQREAL.CODTIPATRAQUE)
          LEFT JOIN TIPO_ACTIV_ESTADIA TAR
             ON (ESTADIA.CODTIPACTIVREAL = TAR.CODIGO)
          LEFT JOIN M_USUARIO
             ON (ESTADIA.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN SUBTIPO_ACTIVIDAD
             ON (ESTADIA.CODSUBTIPOACTIVIDAD = SUBTIPO_ACTIVIDAD.CODIGO)
    WHERE ESTADIA.INDTRAFINT = '1';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTADIATRAFINTGLOBAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTADIATRAFINTGLOBAL
(
   CODPUE,
   DESPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODESTADO,
   ESTADO,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   FATRQREAL,
   INDMANUAL,
   INDLIQT1,
   LIQT1,
   ACTIVIDADREAL,
   IDSUJPASIVO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   CODMUELLEINIREAL,
   MUELLEINIREAL,
   NORAYINIREAL,
   NORAYFINREAL,
   CODSUBTIPOACTIVIDAD,
   SUBTIPOACTIVIDAD,
   NUMESCALA,
   GT,
   NOMBREBUQUE,
   IMO,
   CODTIPBUQUE,
   DESTIPBUQUE,
   CODCONSIGNATARIO,
   CODAPSCTCONSIGNATARIO,
   CIFCONSIGNATARIO,
   NOMBRECONSIGNATARIO,
   INDEXENTAT1,
   EXENTAT1,
   INDLIQT7,
   LIQT7,
   INDEXENTAT7,
   EXENTAT7,
   TIPOPRESTACIONBUQUE
)
AS
   SELECT ESTADIA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          ESTADIA.ANYO,
          ESTADIA.CODESCALA,
          ESTADIA.CODESTADIA,
          ESTADIA.CODESTADO,
          ESTADO_ESTADIA.NOMBRE,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          FORMA_ATRAQUE.DESCRIPCION,
          ESTADIA.INDMANUAL,
          ESTADIA.INDLIQT1,
          DECODE (ESTADIA.INDLIQT1, '1', 'Si', 'No'),
          TIPO_ACTIV_ESTADIA.DESCRIPCION,
          ESTADIA.IDSUJPASIVO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION,
          ESTADIA.NORAYINIREAL,
          ESTADIA.NORAYFINREAL,
          ESTADIA.CODSUBTIPOACTIVIDAD,
          SUBTIPO_ACTIVIDAD.DESCRIPCION,
          ESCALA.NUMESCALA,
          BV.GT,
          M_BUQUE.NOMBRE,
          M_BUQUE.CODIMO,
          BV.CODTIPOBUQUE,
          TB.DESCRIPCION,
          ESCALA.CODCONSIGNATARIO,
          CON.CODAPSCT,
          CON.NUMDOC || CON.LETRANIF,
          CON.NOMBRECOMPLETO,
          ESTADIA.INDEXENTAT1,
          DECODE (ESTADIA.INDEXENTAT1, '1', 'Si', 'No'),
          ESTADIA.INDLIQT7,
          DECODE (ESTADIA.INDLIQT7, '1', 'Si', 'No'),
          ESTADIA.INDEXENTAT7,
          DECODE (ESTADIA.INDEXENTAT7, '1', 'Si', 'No'),
          TIPO_PRESTACIONBUQUE.DESCRIPCION
     FROM ESTADIA
          LEFT JOIN M_PUERTO_LOCAL
             ON (ESTADIA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN M_USUARIO
             ON (ESTADIA.IDSUJPASIVO = M_USUARIO.CODUSUARIO)
          LEFT JOIN FORMA_ATRAQUE
             ON (ESTADIA.CODTIPATRAQUEREAL = FORMA_ATRAQUE.CODTIPATRAQUE)
          LEFT JOIN TIPO_PRESTACIONBUQUE
             ON (ESTADIA.CODTIPPRESTREAL = TIPO_PRESTACIONBUQUE.CODIGO)
          LEFT JOIN M_MUELLE
             ON (ESTADIA.CODMUELLEINIREAL = M_MUELLE.CODIGO)
          LEFT JOIN TIPO_ACTIV_ESTADIA
             ON (ESTADIA.CODTIPACTIVREAL = TIPO_ACTIV_ESTADIA.CODIGO)
          LEFT JOIN ESCALA
             ON (    ESTADIA.CODPUE = ESCALA.CODPUE
                 AND ESTADIA.CODESCALA = ESCALA.CODESCALA
                 AND ESTADIA.ANYO = ESCALA.ANYO)
          LEFT JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN TIPO_BUQUE TB
             ON (TB.CODTIPOBUQUE = BV.CODTIPOBUQUE)
          INNER JOIN ESTADO_ESTADIA
             ON (ESTADIA.CODESTADO = ESTADO_ESTADIA.CODIGO)
          LEFT JOIN SUBTIPO_ACTIVIDAD
             ON (SUBTIPO_ACTIVIDAD.CODIGO = ESTADIA.CODSUBTIPOACTIVIDAD)
          LEFT JOIN M_TIPO_TRAFICO
             ON (ESCALA.TIPTRAFICO = M_TIPO_TRAFICO.CODIGO)
          INNER JOIN M_USUARIO CON
             ON (ESCALA.CODCONSIGNATARIO = CON.CODUSUARIO)
    WHERE ESCALA.INDTRAFINT = '1' AND ESTADIA.INDTRAFINT = '1';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTGRUPONATURALEZA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTGRUPONATURALEZA (CODIGO, DESCRIPCION)
AS
   SELECT G.CODIGO, G.DESCRIPCION
     FROM EST_GRUPO_NATURALEZA G;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTPARAMFPTIPOBULTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTPARAMFPTIPOBULTO
(
   CODIGO,
   CODTIPOBULTO,
   TIPOBULTO,
   FECINIVIG,
   FECFINVIG,
   FORMAPRESENT,
   DESCFORMAPRESENT
)
AS
   SELECT P.CODIGO,
          P.CODTIPOBULTO,
          T.DESCRIPCION,
          P.FECINIVIG,
          P.FECFINVIG,
          P.FORMAPRESENT,
          F.DESCRIPCION
     FROM EST_PARAMFPTIPOBULTO P
          LEFT JOIN G3_TIPOBULTO T
             ON (T.CODIGO = P.CODTIPOBULTO)
          LEFT JOIN EST_FORMAPRESENT F
             ON (F.CODIGO = P.FORMAPRESENT);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTPARAMFPTUCA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTPARAMFPTUCA
(
   CODIGO,
   CODTUCA,
   TUCA,
   FECINIVIG,
   FECFINVIG,
   FORMAPRESENT,
   DESCFORMAPRESENT
)
AS
   SELECT P.CODIGO,
          P.CODTUCA,
          T.DESCRIPCION,
          P.FECINIVIG,
          P.FECFINVIG,
          P.FORMAPRESENT,
          F.DESCRIPCION
     FROM EST_PARAMFPTUCA P
          LEFT JOIN EST_TUCAOPPE T
             ON (T.CODIGO = P.CODTUCA)
          LEFT JOIN EST_FORMAPRESENT F
             ON (F.CODIGO = P.FORMAPRESENT);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTPARAMTUCAEQNOCN  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTPARAMTUCAEQNOCN
(
   CODIGO,
   TIPOEQUIP,
   DESCTIPOEQUIP,
   FECINIVIG,
   FECFINVIG,
   TIPOTAMEQUIP,
   DESCTIPOTAMEQUIP,
   TUCAOPPE,
   DESCTUCAOPPE
)
AS
   SELECT P.CODIGO,
          P.TIPOEQUIP,
          T.DESCRIPCION,
          P.FECINIVIG,
          P.FECFINVIG,
          P.TIPOTAMEQUIP,
          TAM.DESCRIPCION,
          P.TUCAOPPE,
          TU.DESCRIPCION
     FROM EST_PARAMTUCAEQNOCN P
          LEFT JOIN G3_TIPOEQUIP T
             ON (T.CODIGO = P.TIPOEQUIP)
          LEFT JOIN G3_TIPOTAMEQUIP TAM
             ON (TAM.CODIGO = P.TIPOTAMEQUIP)
          LEFT JOIN EST_TUCAOPPE TU
             ON (TU.CODIGO = P.TUCAOPPE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTPARAMUTIEQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTPARAMUTIEQ
(
   CODIGO,
   FECINIVIG,
   FECFINVIG,
   TIPOEQUIP,
   TIPOTAMEQUIP,
   TIPOUTI,
   DESTIPOUTI
)
AS
   SELECT P.CODIGO,
          P.FECINIVIG,
          P.FECFINVIG,
          P.TIPOEQUIP,
          P.TIPOTAMEQUIP,
          P.TIPOUTI,
          R.DESCRIPCION
     FROM EST_PARAMUTIEQ P LEFT JOIN EST_TIPO_UTI R ON (R.CODIGO = P.TIPOUTI);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTSUBGRUPONATURALEZA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTSUBGRUPONATURALEZA
(
   CODIGO,
   DESCRIPCION,
   CODGRUPO,
   GRUPONATURALEZA
)
AS
   SELECT SUB.CODIGO,
          SUB.DESCRIPCION,
          SUB.CODGRUPO,
          GRUP.DESCRIPCION
     FROM    EST_SUBGRUPO_NATURALEZA SUB
          INNER JOIN
             EST_GRUPO_NATURALEZA GRUP
          ON GRUP.CODIGO = SUB.CODGRUPO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_ESTTIPOMERC43  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ESTTIPOMERC43 (CODIGO, DESCRIPCION)
AS
   SELECT M.CODIGO, M.DESCRIPCION
     FROM EST_TIPOMERC43 M;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EST_PARAMCODVEHREGMERC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EST_PARAMCODVEHREGMERC
(
   CODARAN,
   TIPOVEHREGMERC,
   DESCRIPCION,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT CE.CODARAN,
          CE.TIPOVEHREGMERC,
          TV.DESCRIPCION,
          CE.FECINIVIG,
          CE.FECFINVIG
     FROM    EST_PARAMCODVEHREGMERC CE
          LEFT JOIN
             EST_TIPO_VEHREGMERC TV
          ON (CE.TIPOVEHREGMERC = TV.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EXPAGUANODP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EXPAGUANODP
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   USUARIO,
   CIF,
   NOMBRECOMPLETO,
   CODAPSCT,
   TIPO,
   DESTIPO,
   FECINICIO,
   FECFIN
)
AS
   SELECT E.CODIGO,
          E.CODPUE,
          P.NOMBRE,
          E.DESCRIPCION,
          E.USUARIO,
          (U.NUMDOC || U.LETRANIF),
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.TIPO,
          T.DESCRIPCION,
          E.FECINICIO,
          E.FECFIN
     FROM EXPAGUA_NODP E
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = E.CODPUE)
          INNER JOIN M_USUARIO U
             ON (U.CODUSUARIO = E.USUARIO)
          INNER JOIN TIPOEXPAGUA_NODP T
             ON (T.CODIGO = E.TIPO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EXPAGUANODPCONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EXPAGUANODPCONTADOR
(
   CODIGO,
   CODEXP,
   CODPUECONTADOR,
   CODCONTADOR,
   FECINICIO,
   FECFIN,
   EXPEDIENTE,
   FECINICIOEXP,
   FECFINEXP,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   TIPO,
   DESCTIPO,
   DESPUE,
   CODPUE,
   FECULTLIQ,
   INDREVANULACION,
   REVANULACION,
   TIPOIGIC,
   DESCTIPOIGIC,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CONTADOR,
   CODMOTIVEXENTOLIQ,
   MOTIVEXENTOLIQ
)
AS
   SELECT C.CODIGO,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          E.DESCRIPCION,
          E.FECINICIO,
          E.FECFIN,
          C.IDUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.TIPO,
          EST.DESCRIPCION,
          PU.NOMBRE,
          C.CODPUECONTADOR,
          C.FECULTLIQ,
          C.INDREVANULACION,
          DECODE (C.INDREVANULACION, '1', 'Si', 'No'),
          C.TIPOIGIC,
          TI.DESCRIPCION,
          C.INDEXENTOLIQ,
          DECODE (C.INDEXENTOLIQ, '1', 'Si', 'No'),
          CO.DESCRIPCION,
          C.CODMOTIVEXENTOLIQ,
          M.DESCRIPCION
     FROM EXPAGUA_NODP_CONTADOR C
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUECONTADOR = PU.CODPUE
          INNER JOIN EXPAGUA_NODP E
             ON C.CODEXP = E.CODIGO
          INNER JOIN TIPOEXPAGUA_NODP EST
             ON EST.CODIGO = E.TIPO
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON TI.CODIGO = C.TIPOIGIC
          INNER JOIN M_CONTADOR CO
             ON C.CODPUECONTADOR = CO.CODPUE AND C.CODCONTADOR = CO.NUMCON
          LEFT JOIN AGUA_MOTIVEXENCION M
             ON (M.CODIGO = C.CODMOTIVEXENTOLIQ);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_EXPAGUANODPPDTELIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_EXPAGUANODPPDTELIQ
(
   CODIGO,
   CODEXPCONTADOR,
   FECINICIO,
   FECFIN
)
AS
   SELECT EXPAGUA_NODP_PDTELIQ.CODIGO,
          EXPAGUA_NODP_PDTELIQ.CODEXPCONTADOR,
          EXPAGUA_NODP_PDTELIQ.FECINICIO,
          EXPAGUA_NODP_PDTELIQ.FECFIN
     FROM EXPAGUA_NODP_PDTELIQ;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_FESTIVOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_FESTIVOS
(
   CODPUE,
   PUERTO,
   FECHA,
   OBSERVACIONES
)
AS
   SELECT M_FESTIVO.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_FESTIVO.FECHA,
          M_FESTIVO.OBSERVACIONES
     FROM    M_FESTIVO
          INNER JOIN
             M_PUERTO_LOCAL
          ON (M_FESTIVO.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_FESTIVOSSERVBAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_FESTIVOSSERVBAS
(
   CODPUE,
   PUERTO,
   FECHA,
   OBSERVACIONES
)
AS
   SELECT M_FESTIVO_SERVBAS.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_FESTIVO_SERVBAS.FECHA,
          M_FESTIVO_SERVBAS.OBSERVACIONES
     FROM    M_FESTIVO_SERVBAS
          INNER JOIN
             M_PUERTO_LOCAL
          ON (M_FESTIVO_SERVBAS.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G0PESCALITORAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G0PESCALITORAL
(
   CODIGO,
   ANYO,
   IDUSUARIO,
   CIFUSUARIO,
   NOMBREUSUARIO,
   CODAPSCTUSUARIO,
   IDEMBARCACION,
   EMBARCACION,
   MATRICULA,
   IDCOFRADIA,
   COFRADIA,
   INDLIQUIDADO,
   LIQUIDADO,
   INDFACTDIRECTA,
   FACTDIRECTA,
   INDREVANULACION,
   REVANULACION,
   OBSERVACIONES,
   CODPUE,
   NOMPUE,
   TIPOIGIC,
   DESCTIPOIGIC,
   ISLA,
   INDEXENTOLIQ,
   EXENTOLIQ
)
AS
   SELECT P.CODIGO,
          P.ANYO,
          P.IDUSUARIO,
          (U.NUMDOC || U.LETRANIF),
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          P.IDEMBARCACION,
          E.NOMBRE,
          E.MATRICULA,
          P.IDCOFRADIA,
          C.DESCRIPCION,
          P.INDLIQUIDADO,
          DECODE (P.INDLIQUIDADO, '1', 'Si', 'No'),
          P.INDFACTDIRECTA,
          DECODE (P.INDFACTDIRECTA, '1', 'Si', 'No'),
          P.INDREVANULACION,
          DECODE (P.INDREVANULACION, '1', 'Si', 'No'),
          P.OBSERVACIONES,
          P.CODPUE,
          PU.NOMBRE,
          P.TIPOIGIC,
          TI.DESCRIPCION,
          C.ISLA,
          P.INDEXENTOLIQ,
          DECODE (P.INDEXENTOLIQ, '1', 'Si', 'No')
     FROM G0_PESCALITORAL P
          LEFT JOIN M_USUARIO U
             ON (P.IDUSUARIO = U.CODUSUARIO)
          INNER JOIN M_EMBPESCALITORAL E
             ON (P.IDEMBARCACION = E.CODIGO)
          LEFT JOIN G4_COFRADIA C
             ON (C.CODIGO = P.IDCOFRADIA)
          LEFT JOIN M_PUERTO_LOCAL PU
             ON (P.CODPUE = PU.CODPUE)
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON TI.CODIGO = P.TIPOIGIC;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3CABECERAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3CABECERAS
(
   CODPUE,
   NOMBRE,
   ANYO,
   CODSER,
   NUMDECLARACION,
   TIPODECLARACION,
   NUMVIAJE,
   NOMBUQUE,
   IDENTBUQUE,
   CODPAIBUQUE,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   FECENTSAL,
   CODMUELLE,
   IDESTIBADOR,
   CODPAIANTERIOR,
   CODPUEANTERIOR,
   CODPAISIGUIENTE,
   CODPUESIGUIENTE,
   INDSERREGULAR,
   SERREGULAR,
   NUMSERVICIO,
   CODTIPOTRANSITO,
   CODTIPOMOVMERC,
   FECDECLARACION,
   NUMESCALA,
   CODTERMINAL,
   CODSERVMARIT,
   SERVICIOMARITIMO,
   SERVMARITREGULAR,
   SERVMARITTMCD,
   SERVMARITRORO,
   INDTERMDESCONOCIDA,
   TERMDESCONOCIDA,
   FECINIREALESCALA,
   INDMANUAL,
   MANUAL,
   FECALTA
)
AS
   SELECT CAB.CODPUE,
          PUE.NOMBRE,
          CAB.ANYO,
          CAB.CODSER,
          CAB.NUMDECLARACION,
          TCAB.DESCRIPCION,
          CAB.NUMVIAJE,
          CAB.NOMBUQUE,
          CAB.IDENTBUQUE,
          CAB.CODPAIBUQUE,
          CAB.IDCONSIGNATARIO,
          USU.NOMBRECOMPLETO,
          USU.NUMDOC,
          CAB.FECENTSAL,
          CAB.CODMUELLE,
          CAB.IDESTIBADOR,
          CAB.CODPAIANTERIOR,
          CAB.CODPUEANTERIOR,
          CAB.CODPAISIGUIENTE,
          CAB.CODPUESIGUIENTE,
          CAB.INDSERREGULAR,
          DECODE (CAB.INDSERREGULAR, '1', 'Si', 'No'),
          CAB.NUMSERVICIO,
          CAB.CODTIPOTRANSITO,
          CAB.CODTIPOMOVMERC,
          CAB.FECDECLARACION,
          CAB.NUMESCALA,
          CAB.CODTERMINAL,
          ESC.CODSERVMARIT,
          SM.NOMBRE,
          DECODE (SM.INDREGULAR,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDTMCD,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDRORO,  '1', 'Si',  '0', 'No',  NULL),
          CAB.INDTERMDESCONOCIDA,
          DECODE (CAB.INDTERMDESCONOCIDA, '1', 'Si', 'No'),
          CAB.FECINIREALESCALA,
          CAB.INDMANUAL,
          DECODE (CAB.INDMANUAL, '1', 'Si', 'No'),
          CAB.FECALTA
     FROM G3_CABECERA CAB
          INNER JOIN G3_TIPOCABECERA TCAB
             ON TCAB.CODIGO = CAB.TIPODECLARACION
          LEFT JOIN M_USUARIO USU
             ON USU.CODUSUARIO = CAB.IDCONSIGNATARIO
          LEFT JOIN M_PUERTO_LOCAL PUE
             ON PUE.CODPUE = CAB.CODPUE
          LEFT JOIN ESCALA ESC
             ON     CAB.CODPUEESCALA = ESC.CODPUE
                AND CAB.ANYOESCALA = ESC.ANYO
                AND CAB.CODESCALA = ESC.CODESCALA
          LEFT JOIN M_SERVICIOMARITIMO SM
             ON ESC.CODSERVMARIT = SM.CODSERVICIO;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3CABECERASLOG  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3CABECERASLOG
(
   CODPUE,
   ANYO,
   CODSER,
   CODIGO,
   CODTRAMO,
   FECHA,
   USR,
   OPERACION
)
AS
   SELECT G3_CABECERALOG.CODPUE,
          G3_CABECERALOG.ANYO,
          G3_CABECERALOG.CODSER,
          G3_CABECERALOG.CODIGO,
          G3_CABECERALOG.CODTRAMO,
          G3_CABECERALOG.FECHA,
          G3_CABECERALOG.USR,
          G3_CABECERALOG.OPERACION
     FROM G3_CABECERALOG;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3CONOCIMIENTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3CONOCIMIENTOS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   DESCTIPOCONOC,
   CONOCEMBARQUE,
   CODPAI1,
   CODPUE1,
   CODPAI2,
   CODPUE2,
   CODPAI3,
   CODPUE3,
   CODPAI4,
   CODPUE4,
   CODTIPTRANSPORTE,
   DESCTIPTRANSPORTE,
   SERVMERCANCIA,
   INDAH,
   AH,
   INDEM,
   EM,
   INDPE,
   PE,
   INDNOAPLICSITAD,
   NOAPLICSITAD,
   OBSERVACIONES,
   NUMDECMANASOCIADO,
   INDULTIMAVERSION,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   CODAPSCT,
   ESTCODTIPOPE,
   DESESTCODTIPOPE
)
AS
   SELECT CON.CODPUE,
          CON.ANYO,
          CON.CODSER,
          CON.CODTRAMO,
          CON.NUMORDEN,
          CON.TIPOCONOC,
          TIPCON.DESCRIPCION,
          CON.CONOCEMBARQUE,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI2,
          CON.CODPUE2,
          CON.CODPAI3,
          CON.CODPUE3,
          CON.CODPAI4,
          CON.CODPUE4,
          CON.CODTIPTRANSPORTE,
          TIPTRA.DESCRIPCION,
          CON.SERVMERCANCIA,
          CON.INDAH,
          DECODE (CON.INDAH, '1', 'Si', 'No'),
          CON.INDEM,
          DECODE (CON.INDEM, '1', 'Si', 'No'),
          CON.INDPE,
          DECODE (CON.INDPE, '1', 'Si', 'No'),
          CON.INDNOAPLICSITAD,
          DECODE (CON.INDNOAPLICSITAD, '1', 'Si', 'No'),
          CON.OBSERVACIONES,
          CON.NUMDECMANASOCIADO,
          TRA.INDULTIMAVERSION,
          TRA.IDCONSIGNATARIO,
          USU.NOMBRECOMPLETO,
          USU.NUMDOC || USU.LETRANIF,
          USU.CODAPSCT,
          CON.ESTCODTIPOPE,
          TIPOPECONOC.DESCRIPCION
     FROM G3_CONOCIMIENTO CON
          LEFT JOIN G3_TRAMO TRA
             ON     CON.codpue = tra.codpue
                AND CON.ANYO = TRA.ANYO
                AND CON.CODSER = TRA.CODSER
                AND CON.CODTRAMO = TRA.CODTRAMO
          LEFT JOIN G3_TIPOCONOCIMIENTO TIPCON
             ON TIPCON.CODIGO = CON.TIPOCONOC
          LEFT JOIN G3_TIPOTRANSPORTE TIPTRA
             ON TIPTRA.CODIGO = CON.CODTIPTRANSPORTE
          LEFT JOIN M_USUARIO USU
             ON USU.CODUSUARIO = TRA.IDCONSIGNATARIO
          LEFT JOIN EST_TIPO_OPECONOC TIPOPECONOC
             ON TIPOPECONOC.CODIGO = CON.ESTCODTIPOPE
    WHERE CON.INDBAJA IS NULL OR CON.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3EQUIPAMIENTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3EQUIPAMIENTOS
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   CODEQUIP,
   CODTIPOEQUIP,
   DESCTIPEQUIP,
   INDISO,
   ISO,
   MATRICULA,
   CODTIPOTAMANYO,
   DESCTIPTAMEQUIP,
   CODESTADO,
   DESCESTEQUIP,
   TARA,
   NUMPRECINTO,
   UNIDADESVACIOS,
   NUMBULTOS,
   CODPAI1,
   CODPUE1,
   CODPAI3,
   CODPUE3,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CODTIPOCN,
   TIPOCN,
   OBSERVACIONES,
   CODMENSAJECOARRI,
   SECEQUIPCOARRI,
   INDMATREPETIDA,
   MATREPETIDA,
   INDULTIMAVERSION,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   CODAPSCT,
   NUMPRECINTO2,
   NUMPRECINTO3,
   NUMPRECINTO4,
   NUMPRECINTO5,
   CODPAI2,
   CODPUE2,
   CODPAI4,
   CODPUE4,
   ESTTUCAOPPE,
   DESESTTUCAOPPE,
   DESCTIPOCONOC,
   CODTIPTRANSPORTE,
   DESCTIPTRANSPORTE,
   ESTCODTIPOPE,
   DESESTCODTIPOPE,
   CODTIPCONCB3,
   TIPCONCB3
)
AS
   SELECT EQUIP.CODPUE,
          EQUIP.anyo,
          EQUIP.CODSER,
          EQUIP.CODTRAMO,
          EQUIP.NUMORDEN,
          EQUIP.TIPOCONOC,
          EQUIP.CODEQUIP,
          EQUIP.CODTIPOEQUIP,
          TIPEQUIP.CODIGO || ' - ' || TIPEQUIP.DESCRIPCION AS DESCTIPEQUIP,
          EQUIP.INDISO,
          DECODE (EQUIP.INDISO, '1', 'Si', 'No'),
          EQUIP.MATRICULA,
          EQUIP.CODTIPOTAMANYO,
          TIPTAMEQUIP.DESCRIPCION AS DESCTIPTAMEQUIP,
          EQUIP.CODESTADO,
          ESTEQUIP.DESCRIPCION AS DESCESTEQUIP,
          EQUIP.TARA,
          EQUIP.NUMPRECINTO,
          EQUIP.UNIDADESVACIOS,
          EQUIP.NUMBULTOS,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI3,
          CON.CODPUE3,
          EQUIP.INDEXENTOLIQ,
          DECODE (EQUIP.INDEXENTOLIQ, '1', 'Si', 'No'),
          EQUIP.CODTIPOCN,
          TIPOCN.DESCRIPCION,
          EQUIP.OBSERVACIONES,
          EQUIP.CODMENSAJECOARRI,
          EQUIP.SECEQUIPCOARRI,
          EQUIP.INDMATREPETIDA,
          DECODE (EQUIP.INDMATREPETIDA, '1', 'Si', 'No'),
          TRA.INDULTIMAVERSION,
          TRA.IDCONSIGNATARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          EQUIP.NUMPRECINTO2,
          EQUIP.NUMPRECINTO3,
          EQUIP.NUMPRECINTO4,
          EQUIP.NUMPRECINTO5,
          CON.CODPAI2,
          CON.CODPUE2,
          CON.CODPAI4,
          CON.CODPUE4,
          EQUIP.ESTTUCAOPPE,
          ESTTUCA.DESCRIPCION,
          TIPCON.DESCRIPCION,
          CON.CODTIPTRANSPORTE,
          TIPTRA.DESCRIPCION,
          CON.ESTCODTIPOPE,
          TIPOPECONOC.DESCRIPCION,
          EQUIP.CODTIPCONCB3,
          TC3.DESCRIPCION
     FROM G3_EQUIPAMIENTO EQUIP
          LEFT JOIN G3_TRAMO TRA
             ON     TRA.codpue = EQUIP.CODPUE
                AND TRA.ANYO = EQUIP.ANYO
                AND TRA.CODSER = EQUIP.CODSER
                AND TRA.CODTRAMO = EQUIP.CODTRAMO
          LEFT JOIN G3_CONOCIMIENTO CON
             ON     CON.codpue = EQUIP.CODPUE
                AND CON.ANYO = EQUIP.ANYO
                AND CON.CODSER = EQUIP.CODSER
                AND CON.CODTRAMO = EQUIP.CODTRAMO
                AND CON.NUMORDEN = EQUIP.NUMORDEN
                AND CON.TIPOCONOC = EQUIP.TIPOCONOC
          LEFT JOIN G3_TIPOEQUIP TIPEQUIP
             ON TIPEQUIP.CODIGO = EQUIP.CODTIPOEQUIP
          LEFT JOIN G3_TIPOTAMEQUIP TIPTAMEQUIP
             ON TIPTAMEQUIP.CODIGO = EQUIP.CODTIPOTAMANYO
          LEFT JOIN G3_ESTADOEQUIP ESTEQUIP
             ON ESTEQUIP.CODIGO = EQUIP.CODESTADO
          LEFT JOIN G3_TIPOEQUIPLIQ TIPOCN
             ON TIPOCN.CODIGO = EQUIP.CODTIPOCN
          LEFT JOIN M_USUARIO U
             ON TRA.IDCONSIGNATARIO = U.CODUSUARIO
          LEFT JOIN EST_TUCAOPPE ESTTUCA
             ON ESTTUCA.CODIGO = EQUIP.ESTTUCAOPPE
          LEFT JOIN G3_TIPOCONOCIMIENTO TIPCON
             ON TIPCON.CODIGO = CON.TIPOCONOC
          LEFT JOIN G3_TIPOTRANSPORTE TIPTRA
             ON TIPTRA.CODIGO = CON.CODTIPTRANSPORTE
          LEFT JOIN EST_TIPO_OPECONOC TIPOPECONOC
             ON TIPOPECONOC.CODIGO = CON.ESTCODTIPOPE
          LEFT JOIN TIPO_CONCESIONB3 TC3
             ON TC3.CODIGO = EQUIP.CODTIPCONCB3
    WHERE EQUIP.INDBAJA IS NULL OR EQUIP.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3EXCEPCIONESCN  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3EXCEPCIONESCN
(
   CODTIPOTAMEQUIP,
   TIPOTAMEQUIP,
   CODTIPOCN,
   TIPOCN
)
AS
   SELECT G3_EXCEPCIONCN.CODTIPOTAMEQUIP,
          G3_TIPOTAMEQUIP.DESCRIPCION,
          G3_EXCEPCIONCN.CODTIPOCN,
          G3_TIPOCN.DESCRIPCION
     FROM G3_EXCEPCIONCN
          INNER JOIN G3_TIPOTAMEQUIP
             ON (G3_EXCEPCIONCN.CODTIPOTAMEQUIP = G3_TIPOTAMEQUIP.CODIGO)
          INNER JOIN G3_TIPOCN
             ON (G3_EXCEPCIONCN.CODTIPOCN = G3_TIPOCN.CODIGO);


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3MARCAVEHICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3MARCAVEHICULO (CODIGO, DESCRIPCION)
AS
   SELECT M.CODIGO, M.DESCRIPCION
     FROM G3_MARCAVEHICULO M;


/* Formatted on 03/06/2016 9:02:48 (QP5 v5.139.911.3011) */
--
-- V_TC_G3NDPEXPEQUIP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3NDPEXPEQUIP
(
   CODCABECERA,
   CODDETALLE,
   CODARAN,
   MATRICULA,
   NUMDOCUMENTO,
   CODPUETRAMO,
   ANYOTRAMO,
   CODSERTRAMO,
   CODTRAMO,
   NUMMENSAJE,
   FECRECEPCION
)
AS
   SELECT EQU.CODCABECERA,
          EQU.CODDETALLE,
          EQU.CODARAN,
          EQU.MATRICULA,
          EQU.NUMDOCUMENTO,
          EQU.CODPUETRAMO,
          EQU.ANYOTRAMO,
          EQU.CODSERTRAMO,
          EQU.CODTRAMO,
          CAB.NUMMENSAJE,
          CAB.FECRECEPCION
     FROM    G3_NDP_EXPEQUIP EQU
          INNER JOIN
             G3_NDPCAB CAB
          ON CAB.CODIGO = EQU.CODCABECERA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3NDPEXPPARTIDA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3NDPEXPPARTIDA
(
   CODCABECERA,
   CODDETALLE,
   NUMDOCUMENTO,
   CODARAN,
   CODNDP,
   PESO,
   GRUPO,
   ESTADODUA,
   DESESTADODUA,
   CODPUETRAMO,
   ANYOTRAMO,
   CODSERTRAMO,
   CODTRAMO,
   NUMMENSAJE,
   FECRECEPCION
)
AS
   SELECT PAR.CODCABECERA,
          PAR.CODDETALLE,
          PAR.NUMDOCUMENTO,
          PAR.CODARAN,
          PAR.CODNDP,
          PAR.PESO,
          PAR.GRUPO,
          PAR.ESTADODUA,
          ES.DESCRIPCION,
          PAR.CODPUETRAMO,
          PAR.ANYOTRAMO,
          PAR.CODSERTRAMO,
          PAR.CODTRAMO,
          CAB.NUMMENSAJE,
          CAB.FECRECEPCION
     FROM G3_NDP_EXPPARTIDA PAR
          INNER JOIN G3_NDP_ESTADODUA ES
             ON ES.CODIGO = PAR.ESTADODUA
          INNER JOIN G3_NDPCAB CAB
             ON CAB.CODIGO = PAR.CODCABECERA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3NDPIMPEQUIP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3NDPIMPEQUIP
(
   CODCABECERA,
   CODDETALLE,
   NUMDECLARACION,
   NUMPARTIDA,
   CODARAN,
   MATRICULA,
   NUMDOCUMENTO,
   CODPUETRAMO,
   ANYOTRAMO,
   CODSERTRAMO,
   CODTRAMO,
   NUMMENSAJE,
   FECRECEPCION
)
AS
   SELECT EQU.CODCABECERA,
          EQU.CODDETALLE,
          EQU.NUMDECLARACION,
          EQU.NUMPARTIDA,
          EQU.CODARAN,
          EQU.MATRICULA,
          EQU.NUMDOCUMENTO,
          EQU.CODPUETRAMO,
          EQU.ANYOTRAMO,
          EQU.CODSERTRAMO,
          EQU.CODTRAMO,
          CAB.NUMMENSAJE,
          CAB.FECRECEPCION
     FROM    G3_NDP_IMPEQUIP EQU
          INNER JOIN
             G3_NDPCAB CAB
          ON CAB.CODIGO = EQU.CODCABECERA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3NDPIMPPARTIDA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3NDPIMPPARTIDA
(
   CODCABECERA,
   CODDETALLE,
   NUMDECLARACION,
   NUMPARTIDA,
   CODARAN,
   CODNDP,
   PESO,
   GRUPO,
   NUMDOCUMENTO,
   ESTADODUA,
   DESESTADODUA,
   CODPUETRAMO,
   ANYOTRAMO,
   CODSERTRAMO,
   CODTRAMO,
   NUMMENSAJE,
   FECRECEPCION
)
AS
   SELECT PAR.CODCABECERA,
          PAR.CODDETALLE,
          PAR.NUMDECLARACION,
          PAR.NUMPARTIDA,
          PAR.CODARAN,
          PAR.CODNDP,
          PAR.PESO,
          PAR.GRUPO,
          PAR.NUMDOCUMENTO,
          PAR.ESTADODUA,
          ES.DESCRIPCION,
          PAR.CODPUETRAMO,
          PAR.ANYOTRAMO,
          PAR.CODSERTRAMO,
          PAR.CODTRAMO,
          CAB.NUMMENSAJE,
          CAB.FECRECEPCION
     FROM G3_NDP_IMPPARTIDA PAR
          INNER JOIN G3_NDP_ESTADODUA ES
             ON ES.CODIGO = PAR.ESTADODUA
          INNER JOIN G3_NDPCAB CAB
             ON CAB.CODIGO = PAR.CODCABECERA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3PARTIDA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3PARTIDA
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   NUMPARTIDA,
   NUMBULTOS,
   CODTIPBULTO,
   DESCTIPOBULTO,
   CODARAN,
   DESCMERCANCIA,
   DESCMERCANCIAMERC,
   MARCAS,
   CODMARCAVEH,
   PESO,
   VOLUMEN,
   SITADUANERA,
   CODMUELLE,
   IDESTIBADOR,
   NOMBRECOMPLETO,
   NUMDOC,
   CODTERMINAL,
   NUMDECLARACIONPREVISTA,
   CODCOMERCIAL,
   CODGRUPO,
   CODPAI1,
   CODPUE1,
   CODPAI3,
   CODPUE3,
   ESTCODFORMAPRESENT,
   ESTINDTIENEEQUIP,
   ESTTIENEEQUIP,
   ESTMATRICEQUIP,
   ESTINSTALESPECIAL,
   OBSERVACIONES,
   NUMBULTOSDEC,
   INDULTIMAVERSION,
   IDCONSIGNATARIO,
   NOMBRECOMPLETOCON,
   NUMDOCCON,
   CODAPSCTCON,
   CODMARCAS,
   INDENS,
   ENS,
   CODPAI2,
   CODPUE2,
   CODPAI4,
   CODPUE4,
   ESTTUCAOPPE,
   DESESTTUCAOPPE,
   DESCTIPOCONOC,
   CODTIPTRANSPORTE,
   DESCTIPTRANSPORTE,
   ESTCODTIPOPE,
   DESESTCODTIPOPE,
   INSTALESPECIAL,
   CODTIPCONCB3,
   TIPCONCB3,
   CODINSTESP
)
AS
   SELECT PAR.CODPUE,
          PAR.ANYO,
          PAR.CODSER,
          PAR.CODTRAMO,
          PAR.NUMORDEN,
          PAR.TIPOCONOC,
          PAR.NUMPARTIDA,
          PAR.NUMBULTOS,
          PAR.CODTIPBULTO,
          TIPOBULTO.DESCRIPCION,
          PAR.CODARAN,
          PAR.DESCMERCANCIA,
          MER.DESCRIPCION,
          PAR.MARCAS,
          PAR.CODMARCAVEH,
          PAR.PESO,
          PAR.VOLUMEN,
          PAR.SITADUANERA,
          PAR.CODMUELLE,
          PAR.IDESTIBADOR,
          USU.NOMBRECOMPLETO,
          USU.NUMDOC,
          PAR.CODTERMINAL,
          PAR.NUMDECLARACIONPREVISTA,
          PAR.CODCOMERCIAL,
          MER.CODGRUPO,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI3,
          CON.CODPUE3,
          PAR.ESTCODFORMAPRESENT,
          PAR.ESTINDTIENEEQUIP,
          DECODE (PAR.ESTINDTIENEEQUIP, '1', 'Si', 'No'),
          PAR.ESTMATRICEQUIP,
          DECODE (PAR.ESTINDINSTALESPECIAL, '1', 'Si', 'No'),
          PAR.OBSERVACIONES,
          PAR.NUMBULTOSDEC,
          TRA.INDULTIMAVERSION,
          TRA.IDCONSIGNATARIO,
          UC.NOMBRECOMPLETO,
          UC.NUMDOC || USU.LETRANIF,
          UC.CODAPSCT,
          PAR.CODMARCAS,
          PAR.INDENS,
          DECODE (PAR.INDENS, '1', 'Si', 'No'),
          CON.CODPAI2,
          CON.CODPUE2,
          CON.CODPAI4,
          CON.CODPUE4,
          PAR.ESTTUCAOPPE,
          ESTTUCA.DESCRIPCION,
          TIPCON.DESCRIPCION,
          CON.CODTIPTRANSPORTE,
          TIPTRA.DESCRIPCION,
          CON.ESTCODTIPOPE,
          TIPOPECONOC.DESCRIPCION,
          DECODE (PAR.INDINSTALESPECIAL, '1', 'Si', 'No'),
          PAR.CODTIPCONCB3,
          TC3.DESCRIPCION,
          PAR.CODINSTESP
     FROM G3_PARTIDA PAR
          LEFT JOIN G3_CONOCIMIENTO CON
             ON     CON.CODPUE = PAR.CODPUE
                AND CON.ANYO = PAR.ANYO
                AND CON.CODSER = PAR.CODSER
                AND CON.CODTRAMO = PAR.CODTRAMO
                AND CON.NUMORDEN = PAR.NUMORDEN
                AND CON.TIPOCONOC = PAR.TIPOCONOC
          LEFT JOIN G3_TRAMO TRA
             ON     CON.codpue = tra.codpue
                AND CON.ANYO = TRA.ANYO
                AND CON.CODSER = TRA.CODSER
                AND CON.CODTRAMO = TRA.CODTRAMO
          LEFT JOIN G3_TIPOBULTO TIPOBULTO
             ON TIPOBULTO.CODIGO = PAR.CODTIPBULTO
          LEFT JOIN M_MERCANCIA MER
             ON MER.CODARAN = PAR.CODARAN AND MER.VERSION = PAR.VERCODARAN
          LEFT JOIN M_USUARIO USU
             ON USU.CODUSUARIO = PAR.IDESTIBADOR
          LEFT JOIN M_USUARIO UC
             ON UC.CODUSUARIO = TRA.IDCONSIGNATARIO
          LEFT JOIN EST_TUCAOPPE ESTTUCA
             ON ESTTUCA.CODIGO = PAR.ESTTUCAOPPE
          LEFT JOIN G3_TIPOCONOCIMIENTO TIPCON
             ON TIPCON.CODIGO = CON.TIPOCONOC
          LEFT JOIN G3_TIPOTRANSPORTE TIPTRA
             ON TIPTRA.CODIGO = CON.CODTIPTRANSPORTE
          LEFT JOIN EST_TIPO_OPECONOC TIPOPECONOC
             ON TIPOPECONOC.CODIGO = CON.ESTCODTIPOPE
          LEFT JOIN TIPO_CONCESIONB3 TC3
             ON TC3.CODIGO = PAR.CODTIPCONCB3
    WHERE PAR.INDBAJA IS NULL OR PAR.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3PARTIDAMATRIC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3PARTIDAMATRIC
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   NUMORDEN,
   TIPOCONOC,
   DESCTIPOCONOC,
   CONOCEMBARQUE,
   CODPAI1,
   CODPUE1,
   CODPAI2,
   CODPUE2,
   CODPAI3,
   CODPUE3,
   CODPAI4,
   CODPUE4,
   CODTIPTRANSPORTE,
   DESCTIPTRANSPORTE,
   SERVMERCANCIA,
   INDAH,
   AH,
   INDEM,
   EM,
   INDPE,
   PE,
   INDNOAPLICSITAD,
   NOAPLICSITAD,
   OBSERVACIONES,
   NUMDECMANASOCIADO,
   INDULTIMAVERSION,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   CODAPSCT,
   ESTCODTIPOPE,
   DESESTCODTIPOPE,
   NUMPARTIDA,
   CODARAN,
   DESCMERCANCIA,
   MATRICULA,
   NUMBULTOS,
   CODESTTUCAOPPE,
   ESTTUCAOPPE
)
AS
   SELECT PAR.CODPUE,
          PAR.ANYO,
          PAR.CODSER,
          PAR.CODTRAMO,
          PAR.NUMORDEN,
          PAR.TIPOCONOC,
          TIPCON.DESCRIPCION,
          CON.CONOCEMBARQUE,
          CON.CODPAI1,
          CON.CODPUE1,
          CON.CODPAI2,
          CON.CODPUE2,
          CON.CODPAI3,
          CON.CODPUE3,
          CON.CODPAI4,
          CON.CODPUE4,
          CON.CODTIPTRANSPORTE,
          TIPTRA.DESCRIPCION,
          CON.SERVMERCANCIA,
          CON.INDAH,
          DECODE (CON.INDAH, '1', 'Si', 'No'),
          CON.INDEM,
          DECODE (CON.INDEM, '1', 'Si', 'No'),
          CON.INDPE,
          DECODE (CON.INDPE, '1', 'Si', 'No'),
          CON.INDNOAPLICSITAD,
          DECODE (CON.INDNOAPLICSITAD, '1', 'Si', 'No'),
          CON.OBSERVACIONES,
          CON.NUMDECMANASOCIADO,
          TRA.INDULTIMAVERSION,
          TRA.IDCONSIGNATARIO,
          USU.NOMBRECOMPLETO,
          USU.NUMDOC || USU.LETRANIF,
          USU.CODAPSCT,
          CON.ESTCODTIPOPE,
          TIPOPECONOC.DESCRIPCION,
          PAR.NUMPARTIDA,
          PAR.CODARAN,
          PAR.DESCMERCANCIA,
          EP.NUMCONTENEDOR,
          EP.NUMBULTOS,
          PAR.ESTTUCAOPPE,
          TUCA.DESCRIPCION
     FROM G3_PARTIDA PAR
          LEFT JOIN G3_CONOCIMIENTO CON
             ON     CON.CODPUE = PAR.CODPUE
                AND CON.ANYO = PAR.ANYO
                AND CON.CODSER = PAR.CODSER
                AND CON.CODTRAMO = PAR.CODTRAMO
                AND CON.NUMORDEN = PAR.NUMORDEN
                AND CON.TIPOCONOC = PAR.TIPOCONOC
          LEFT JOIN G3_TRAMO TRA
             ON     CON.codpue = tra.codpue
                AND CON.ANYO = TRA.ANYO
                AND CON.CODSER = TRA.CODSER
                AND CON.CODTRAMO = TRA.CODTRAMO
          LEFT JOIN G3_TIPOCONOCIMIENTO TIPCON
             ON TIPCON.CODIGO = CON.TIPOCONOC
          LEFT JOIN G3_TIPOTRANSPORTE TIPTRA
             ON TIPTRA.CODIGO = CON.CODTIPTRANSPORTE
          LEFT JOIN M_USUARIO USU
             ON USU.CODUSUARIO = TRA.IDCONSIGNATARIO
          LEFT JOIN EST_TIPO_OPECONOC TIPOPECONOC
             ON TIPOPECONOC.CODIGO = CON.ESTCODTIPOPE
          INNER JOIN G3_EQUIP_PARTIDA EP
             ON     EP.CODPUE = PAR.CODPUE
                AND EP.ANYO = PAR.ANYO
                AND EP.CODSER = PAR.CODSER
                AND EP.CODTRAMO = PAR.CODTRAMO
                AND EP.NUMORDEN = PAR.NUMORDEN
                AND EP.TIPOCONOC = PAR.TIPOCONOC
                AND EP.NUMPARTIDA = PAR.NUMPARTIDA
          LEFT JOIN EST_TUCAOPPE TUCA
             ON TUCA.CODIGO = PAR.ESTTUCAOPPE
    WHERE PAR.INDBAJA IS NULL OR PAR.INDBAJA = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TERMPOLIVAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TERMPOLIVAL
(
   CODIGO,
   CODMUELLE,
   MUELLE,
   CODESTIBADOR,
   ESTIBADOR,
   CIFESTIBADOR,
   CODAPSCTESTIBADOR,
   CODUSUARIO,
   USUARIO,
   CIFUSUARIO,
   CODAPSCTUSUARIO,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT TER.CODIGO,
          TER.CODMUELLE,
          MU.DESCRIPCION,
          TER.CODESTIBADOR,
          ES.NOMBRECOMPLETO,
          ES.NUMDOC || ES.LETRANIF,
          ES.CODAPSCT,
          TER.CODUSUARIO,
          US.NOMBRECOMPLETO,
          US.NUMDOC || US.LETRANIF,
          US.CODAPSCT,
          TER.FECINIVIG,
          TER.FECFINVIG
     FROM G3_TERMPOLIVAL TER
          INNER JOIN M_MUELLE MU
             ON (MU.CODIGO = TER.CODMUELLE)
          INNER JOIN M_USUARIO ES
             ON (ES.CODUSUARIO = TER.CODESTIBADOR)
          INNER JOIN M_USUARIO US
             ON (US.CODUSUARIO = TER.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TIPOBULTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TIPOBULTO (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM G3_TIPOBULTO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TIPOEQUIP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TIPOEQUIP (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM G3_TIPOEQUIP;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TRAFINT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TRAFINT
(
   CODPUE,
   PUERTO,
   ANYO,
   CODSER,
   CODPUEESCTI,
   ANYOESCTI,
   CODESCTI,
   NUMESCALATI,
   CODUSUARIO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   FECSERVICIO,
   CODMUELLE,
   MUELLE,
   CODTIPO,
   TIPO,
   BUQUE,
   IMO,
   CODCONSIGNATARIO,
   FECINIREAL,
   FECFINREAL,
   INDLIQ,
   LIQUIDADO,
   INDEXENTOLIQ,
   EXENTOLIQ,
   INDANUL,
   ANUL,
   INDREV,
   REV,
   TIPTRAFICO,
   DESCTIPTRAFICO
)
AS
   SELECT T.CODPUE,
          P.NOMBRE,
          T.ANYO,
          T.CODSER,
          T.CODPUEESCTI,
          T.ANYOESCTI,
          T.CODESCTI,
          E.NUMESCALA,
          T.CODUSUARIO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          T.FECSERVICIO,
          T.CODMUELLE,
          M.DESCRIPCION,
          T.CODTIPO,
          TT.DESCRIPCION,
          BU.NOMBRE,
          BU.CODIMO,
          E.CODCONSIGNATARIO,
          E.FECINIREAL,
          E.FECFINREAL,
          T.INDLIQ,
          DECODE (T.INDLIQ, '1', 'Si', 'No'),
          T.INDEXENTOLIQ,
          DECODE (T.INDEXENTOLIQ, '1', 'Si', 'No'),
          T.INDANUL,
          DECODE (T.INDANUL, '1', 'Si', 'No'),
          T.INDREV,
          DECODE (T.INDREV, '1', 'Si', 'No'),
          E.TIPTRAFICO,
          TTRA.DESCRIPCION
     FROM G3_TRAFINT T
          INNER JOIN M_USUARIO U
             ON (T.CODUSUARIO = U.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL P
             ON (T.CODPUE = P.CODPUE)
          INNER JOIN G3_TIPO_TRAFINT TT
             ON (T.CODTIPO = TT.CODIGO)
          LEFT JOIN M_MUELLE M
             ON (T.CODMUELLE = M.CODIGO)
          LEFT JOIN ESCALA E
             ON (    T.CODPUEESCTI = E.CODPUE
                 AND T.ANYOESCTI = E.ANYO
                 AND T.CODESCTI = E.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_TIPO_TRAFICO TTRA
             ON (TTRA.CODIGO = E.TIPTRAFICO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TRAMOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TRAMOS
(
   CODPUE,
   NOMBRE,
   ANYO,
   CODSER,
   CODTRAMO,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   NUMDECLARACION,
   TIPODECLARACION,
   INDNOLIQUIDABLE,
   INDLIQT2,
   INDLIQT2STR,
   INDLIQT3,
   INDLIQT3STR,
   IDSUJETOPASIVO,
   CIFSUJETOPASIVO,
   SUJETOPASIVO,
   NOLIQUIDABLE,
   NUMESCALA,
   BUQUE,
   IMO,
   PAISANT,
   PUERTOANT,
   PAISSIG,
   PUERTOSIG,
   CODMUELLE,
   INDREGSIMPLIF,
   REGSIMPLIF,
   FECDECLARACION,
   IDSUJETOPASIVOT2,
   CIFSUJETOPASIVOT2,
   SUJETOPASIVOT2,
   CODSERVMARIT,
   SERVICIOMARITIMO,
   SERVMARITREGULAR,
   SERVMARITTMCD,
   SERVMARITRORO,
   DECMANIF,
   FECINIREALESCALA,
   ESTTERMCONCT3,
   CODTIPOMOVMERC,
   INDMANUAL,
   MANUAL,
   FECALTA,
   ESTINDEXENTA,
   ESTEXENTA,
   OBSERVACIONES,
   NUMVERSION,
   INDULTIMAVERSION,
   ULTIMAVERSION,
   NUMTRAMOSIME,
   ESTINDTERMCONCT3,
   CODTIPODECLARACION,
   CODESTADIA,
   INDEXENTOT2,
   EXENTOT2,
   INDEXENTOT3,
   EXENTOT3,
   MODOVERSION,
   JUSTIFEXENTOT2,
   JUSTIFEXENTOT3,
   IND215,
   DESC215,
   CODTIPOIVAT2,
   TIPOIVAT2,
   CODTIPOIVAT3,
   TIPOIVAT3,
   CODTIPCONCT2,
   TIPCONCT2,
   CODPUEESC,
   ANYOESC,
   CODESC,
   REVISADO
)
AS
   SELECT TRA.CODPUE,
          PUE.NOMBRE,
          TRA.ANYO,
          TRA.CODSER,
          TRA.CODTRAMO,
          TRA.IDCONSIGNATARIO,
          USU.NOMBRECOMPLETO,
          USU.NUMDOC,
          CAB.NUMDECLARACION,
          TCAB.DESCRIPCION,
          TRA.INDNOLIQUIDABLE,
          TRA.INDLIQT2,
          DECODE (TRA.INDLIQT2, '1', 'Si', 'No'),
          TRA.INDLIQT3,
          DECODE (TRA.INDLIQT3, '1', 'Si', 'No'),
          USU2.CODUSUARIO AS IDSUJETOPASIVO,
          USU2.NUMDOC AS CIFSUJETOPASIVO,
          USU2.NOMBRECOMPLETO AS SUJETOPASIVO,
          DECODE (TRA.INDNOLIQUIDABLE, '1', 'Si', 'No'),
          CAB.NUMESCALA,
          TRA.NOMBUQUE,
          TRA.IDENTBUQUE,
          TRA.CODPAIANTERIOR,
          TRA.CODPUEANTERIOR,
          TRA.CODPAISIGUIENTE,
          TRA.CODPUESIGUIENTE,
          TRA.CODMUELLE,
          TRA.INDREGSIMPLIF,
          DECODE (TRA.INDREGSIMPLIF, '1', 'Si', 'No'),
          CAB.FECDECLARACION,
          USU3.CODUSUARIO AS IDSUJETOPASIVOT2,
          USU3.NUMDOC AS CIFSUJETOPASIVOT2,
          USU3.NOMBRECOMPLETO AS SUJETOPASIVOT2,
          ESC.CODSERVMARIT,
          SM.NOMBRE,
          DECODE (SM.INDREGULAR,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDTMCD,  '1', 'Si',  '0', 'No',  NULL),
          DECODE (SM.INDRORO,  '1', 'Si',  '0', 'No',  NULL),
          CAB.TIPODECLARACION,
          CAB.FECINIREALESCALA,
          CASE
             WHEN TRA.INDTERMDESCONOCIDA = '1' THEN NULL
             ELSE DECODE (TRA.ESTINDTERMCONCT3, '1', 'Si', 'No')
          END,
          TRA.CODTIPOMOVMERC,
          TRA.INDMANUAL,
          DECODE (TRA.INDMANUAL, '1', 'Si', 'No'),
          TRA.FECALTA,
          TRA.ESTINDEXENTA,
          DECODE (TRA.ESTINDEXENTA, '1', 'Si', 'No'),
          TRA.OBSERVACIONES,
          TRA.NUMVERSION,
          TRA.INDULTIMAVERSION,
          DECODE (TRA.INDULTIMAVERSION, '1', 'Si', 'No'),
          TRA.NUMTRAMOSIME,
          TRA.ESTINDTERMCONCT3,
          CAB.TIPODECLARACION,
          TRA.CODESTADIA,
          TRA.INDEXENTOT2,
          DECODE (TRA.INDEXENTOT2, '1', 'Si', 'No'),
          TRA.INDEXENTOT3,
          DECODE (TRA.INDEXENTOT3, '1', 'Si', 'No'),
          DECODE (TRA.MODOVERSION,  'M', 'Manual',  'A', 'Automatico'),
          TRA.JUSTIFEXENTOT2,
          TRA.JUSTIFEXENTOT3,
          TRA.IND215,
          TC3.DESCRIPCION,
          TRA.CODTIPOIVAT2,
          TIT2.DESCRIPCION,
          TRA.CODTIPOIVAT3,
          TIT3.DESCRIPCION,
          TRA.CODTIPCONCT2,
          TC2.DESCRIPCION,
          CAB.CODPUEESCALA,
          CAB.ANYOESCALA,
          CAB.CODESCALA,
          DECODE (TRA.REVISADO,  '1', 'Si',  '0', 'No',  NULL)
     FROM G3_TRAMO TRA
          INNER JOIN G3_CABECERA CAB
             ON     CAB.CODPUE = TRA.CODPUE
                AND CAB.ANYO = TRA.ANYO
                AND CAB.CODSER = TRA.CODSER
          INNER JOIN G3_TIPOCABECERA TCAB
             ON TCAB.CODIGO = CAB.TIPODECLARACION
          LEFT JOIN G3_ESTADO EST
             ON EST.CODIGO = TRA.CODESTADO
          LEFT JOIN M_USUARIO USU
             ON USU.CODUSUARIO = TRA.IDCONSIGNATARIO
          LEFT JOIN M_USUARIO USU2
             ON USU2.CODUSUARIO = TRA.IDSUJPASIVO
          LEFT JOIN M_USUARIO USU3
             ON USU3.CODUSUARIO = TRA.IDSUJPASIVOT2
          LEFT JOIN M_PUERTO_LOCAL PUE
             ON PUE.CODPUE = TRA.CODPUE
          LEFT JOIN ESCALA ESC
             ON     CAB.CODPUEESCALA = ESC.CODPUE
                AND CAB.ANYOESCALA = ESC.ANYO
                AND CAB.CODESCALA = ESC.CODESCALA
          LEFT JOIN M_SERVICIOMARITIMO SM
             ON ESC.CODSERVMARIT = SM.CODSERVICIO
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIT2
             ON TIT2.CODIGO = TRA.CODTIPOIVAT2
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL TIT3
             ON TIT3.CODIGO = TRA.CODTIPOIVAT3
          LEFT JOIN TIPO_CONCESIONB2 TC2
             ON TC2.CODIGO = TRA.CODTIPCONCT2
          LEFT JOIN TIPO_CONCESIONB3 TC3
             ON TC3.CODIGO = TRA.IND215;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TRAMOSCOARRICONT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TRAMOSCOARRICONT
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   CODCONTRASTE,
   NUMCN20LLEDEC,
   NUMCN20LLECOARRI,
   NUMCN20VACDEC,
   NUMCN20VACCOARRI,
   NUMCN40LLEDEC,
   NUMCN40LLECOARRI,
   NUMCN40VACDEC,
   NUMCN40VACCOARRI
)
AS
   SELECT C.CODPUE,
          C.anyo,
          C.CODSER,
          C.CODTRAMO,
          C.CODCONTRASTE,
          C.NUMCN20LLEDEC,
          C.NUMCN20LLECOARRI,
          C.NUMCN20VACDEC,
          C.NUMCN20VACCOARRI,
          C.NUMCN40LLEDEC,
          C.NUMCN40LLECOARRI,
          C.NUMCN40VACDEC,
          C.NUMCN40VACCOARRI
     FROM G3_TRAMO_COARRICONT C;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3TRAMOSCOARRIDETALLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3TRAMOSCOARRIDETALLE
(
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO,
   CODDETALLE,
   CODCALIFEQUIP,
   DESCALIFEQUIP,
   MATRICULA,
   CODTIPOTAMEQUIP,
   DESCTIPOTAMEQUIP,
   PESO,
   CODPAIORIGEN,
   CODPUEORIGEN,
   CODPAIDESTINO,
   CODPUEDESTINO,
   INDVACIO,
   VACIO,
   TIPOOPERACION,
   DESCTIPOOPERACION,
   CODTIPOCN,
   TIPOCN
)
AS
   SELECT D.CODPUE,
          D.anyo,
          D.CODSER,
          D.CODTRAMO,
          D.CODDETALLE,
          D.CODCALIFEQUIP,
          TIPEQUIP.DESCRIPCION,
          D.MATRICULA,
          D.CODTIPOTAMEQUIP,
          TIPTAMEQUIP.DESCRIPCION,
          D.PESO,
          D.CODPAIORIGEN,
          D.CODPUEORIGEN,
          D.CODPAIDESTINO,
          D.CODPUEDESTINO,
          D.INDVACIO,
          DECODE (D.INDVACIO, '1', 'Si', 'No'),
          D.TIPOOPERACION,
          O.DESCRIPCION,
          EL.CODIGO,
          EL.DESCRIPCION
     FROM G3_TRAMO_COARRIDETALLE D
          INNER JOIN G3_TIPOEQUIP TIPEQUIP
             ON (TIPEQUIP.CODIGO = D.CODCALIFEQUIP)
          INNER JOIN G3_TIPOTAMEQUIP TIPTAMEQUIP
             ON (TIPTAMEQUIP.CODIGO = D.CODTIPOTAMEQUIP)
          INNER JOIN G3_TIPOOPECOARRI O
             ON (O.CODIGO = D.TIPOOPERACION)
          LEFT JOIN G3_TIPOEQUIPLIQ EL
             ON (EL.CODIGO = D.CODTIPOCN);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G3_FICHEROCARGA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G3_FICHEROCARGA
(
   IDPROCESO,
   FICHERO,
   FECHA,
   BUQUE,
   DOCUMENTO,
   OPERACION,
   ESTADO,
   DESCESTADO
)
AS
   SELECT FC.IDPROCESO,
          FC.FICHERO,
          FC.FECHA,
          FC.BUQUE,
          FC.DOCUMENTO,
          FC.OPERACION,
          FC.ESTADO,
          DECODE (FC.ESTADO, 'ACE', 'Aceptado', 'Rechazado')
     FROM G3_FICHEROCARGA FC;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4CENTROPRIMERAVENTAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4CENTROPRIMERAVENTAS (CODIGO, NOMBRE)
AS
   SELECT C.CODIGO, C.NOMBRE
     FROM G4_CENTROPRIMERAVENTA C;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4COFRADIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4COFRADIAS (CODIGO, DESCRIPCION, ISLA)
AS
   SELECT C.CODIGO, C.DESCRIPCION, C.ISLA
     FROM G4_COFRADIA C;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4DECLARANTESCONFIG  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4DECLARANTESCONFIG
(
   CODDECLARANTE,
   CODUSUARIO,
   CIFUSUARIO,
   NOMBRECOMPLETO,
   CODAPSCTUSUARIO,
   TIPOGRAVAMEN,
   DESCTIPOGRAVAMEN,
   TIPOCAPTURA,
   DESCTIPOCAPTURA,
   INDCENTROCOM,
   CENTROCOM,
   CENTROPRIMERAVENTA,
   DESCCENTROPRIMERAVENTA,
   INDPESQUEL,
   PESQUEL
)
AS
   SELECT D.CODDECLARANTE,
          D.CODUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          D.TIPOGRAVAMEN,
          TG.DESCRIPCION,
          D.TIPOCAPTURA,
          TC.DESCRIPCION,
          D.INDCENTROCOM,
          DECODE (D.INDCENTROCOM, '1', 'Si', 'No'),
          D.CENTROPRIMERAVENTA,
          C.NOMBRE,
          D.INDPESQUEL,
          DECODE (D.INDPESQUEL, '1', 'Si', 'No')
     FROM G4_DECLARANTECONFIG D
          INNER JOIN M_USUARIO U
             ON D.CODUSUARIO = U.CODUSUARIO
          LEFT JOIN G4_TIPOGRAVAMEN TG
             ON TG.CODIGO = D.TIPOGRAVAMEN
          INNER JOIN G4_TIPOCAPTURA TC
             ON TC.CODIGO = D.TIPOCAPTURA
          LEFT JOIN G4_CENTROPRIMERAVENTA C
             ON C.CODIGO = D.CENTROPRIMERAVENTA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4ESPECIEPRECIOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4ESPECIEPRECIOS
(
   CODIGO,
   CODESPECIE,
   FECINICIO,
   FECFIN,
   PRECIO
)
AS
   SELECT P.CODIGO,
          P.CODESPECIE,
          P.FECINICIO,
          P.FECFIN,
          P.PRECIO
     FROM    G4_ESPECIEPRECIO P
          INNER JOIN
             G4_ESPECIE E
          ON E.CODESPECIE = P.CODESPECIE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4ESPECIES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4ESPECIES
(
   CODESPECIE,
   NOMBRE,
   CODFAMILIA,
   FAMILIA,
   CODCLASE,
   CLASE,
   NOMBREGENERICO,
   NOMBREFAO,
   NOMBRECIENTIFICO,
   CODPESQUEL,
   PRECIO,
   FECHAPRECIO
)
AS
   SELECT E.CODESPECIE,
          E.NOMBRE,
          E.CODFAMILIA,
          F.DESCRIPCION,
          E.CODCLASE,
          C.DESCRIPCION,
          E.NOMBREGENERICO,
          E.NOMBREFAO,
          E.NOMBRECIENTIFICO,
          E.CODPESQUEL,
          PRE.PRECIO,
          PRE.FECINICIO
     FROM G4_ESPECIE E
          INNER JOIN G4_FAMILIA F
             ON E.CODFAMILIA = F.CODIGO
          INNER JOIN G4_CLASE C
             ON E.CODCLASE = C.CODIGO
          LEFT JOIN (SELECT *
                       FROM G4_ESPECIEPRECIO PRE2
                      WHERE NOT EXISTS
                                   (SELECT 1
                                      FROM G4_ESPECIEPRECIO PRE1
                                     WHERE PRE2.CODESPECIE = PRE1.CODESPECIE
                                           AND PRE1.FECINICIO >
                                                  PRE2.FECINICIO)) PRE
             ON (E.CODESPECIE = PRE.CODESPECIE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4PARTIDAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4PARTIDAS
(
   CODSERVICIO,
   CODPARTIDA,
   CODESPECIE,
   ESPECIE,
   NUMKG,
   PRECIOKG,
   VALOR,
   FORMAPRESENTACION,
   DESCFORMAPRESENTACION,
   CLASE,
   DESCCLASE,
   FAMILIA,
   DESCFAMILIA,
   BUQUE,
   IMO
)
AS
   SELECT P.CODSERVICIO,
          P.CODPARTIDA,
          P.CODESPECIE,
          ES.NOMBRE,
          P.NUMKG,
          PRE.PRECIO,
          ROUND ( (P.NUMKG * PRE.PRECIO), 2),
          P.FORMAPRESENTACION,
          FP.DESCRIPCION,
          P.CLASE,
          C.DESCRIPCION,
          P.FAMILIA,
          F.DESCRIPCION,
          B.NOMBRE,
          B.CODIMO
     FROM G4_PARTIDA P
          INNER JOIN G4_ESPECIE ES
             ON ES.CODESPECIE = P.CODESPECIE
          INNER JOIN G4_PESCA PES
             ON PES.CODSERVICIO = P.CODSERVICIO
          LEFT JOIN G4_ESPECIEPRECIO PRE
             ON PRE.CODESPECIE = P.CODESPECIE
                AND ( (PES.FECOPERACION BETWEEN PRE.FECINICIO AND PRE.FECFIN)
                     OR PES.FECOPERACION >= PRE.FECINICIO
                        AND PRE.FECFIN IS NULL)
          INNER JOIN G4_FORMAPRESENTACION FP
             ON FP.CODIGO = P.FORMAPRESENTACION
          INNER JOIN G4_CLASE C
             ON C.CODIGO = P.CLASE
          INNER JOIN G4_FAMILIA F
             ON F.CODIGO = P.FAMILIA
          LEFT JOIN ESCALA E
             ON (    E.CODPUE = PES.CODPUEESCALA
                 AND E.ANYO = PES.ANYOESCALA
                 AND E.CODESCALA = PES.CODESCALA)
          LEFT JOIN M_BUQUE B
             ON (B.CODBUQUE = E.CODBUQUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4PESCAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4PESCAS
(
   CODSERVICIO,
   CODPUE,
   DESPUE,
   FECOPERACION,
   CODUSUARIO,
   CIFUSUARIO,
   NOMBRECOMPLETO,
   CODAPSCTUSUARIO,
   TIPOOPERACION,
   DESCTIPOOPERACION,
   TIPOGRAVAMEN,
   DESCTIPOGRAVAMEN,
   INDEXENTOLIQ,
   EXENTOLIQ,
   INDLIQUIDADO,
   LIQUIDADO,
   TIPOIGIC,
   DESCTIPOIGIC,
   BUQUE,
   IMO,
   CODPUEESCALA,
   ANYOESCALA,
   CODESCALA,
   CODESTADIA,
   NUMESCALA,
   ANYO,
   JUSTIFEXENTOT4,
   TOTALKGCRUST,
   PRECIOVENTACRUST,
   TOTALKGMOLUSC,
   PRECIOVENTAMOLUSC,
   TOTALKGPECES,
   PRECIOVENTAPECES,
   TOTALKGMAMIF,
   PRECIOVENTAMAMIF,
   TOTALKG,
   PRECIOVENTA,
   CODEMBARCACION,
   EMBARCACION,
   MATRICULA,
   OBSERVACIONES
)
AS
   SELECT P.CODSERVICIO,
          P.CODPUE,
          PU.NOMBRE,
          P.FECOPERACION,
          P.CODUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          P.TIPOOPERACION,
          TOP.DESCRIPCION,
          P.TIPOGRAVAMEN,
          TG.DESCRIPCION,
          P.INDEXENTOLIQ,
          DECODE (P.INDEXENTOLIQ, '1', 'Si', 'No'),
          P.INDLIQUIDADO,
          DECODE (P.INDLIQUIDADO, '1', 'Si', 'No'),
          P.TIPOIGIC,
          TI.DESCRIPCION,
          B.NOMBRE,
          B.CODIMO,
          P.CODPUEESCALA,
          P.ANYOESCALA,
          P.CODESCALA,
          P.CODESTADIA,
          E.NUMESCALA,
          EXTRACT (YEAR FROM P.FECOPERACION),
          P.JUSTIFEXENTOT4,
          P.TOTALKGCRUST,
          P.PRECIOVENTACRUST,
          P.TOTALKGMOLUSC,
          P.PRECIOVENTAMOLUSC,
          P.TOTALKGPECES,
          P.PRECIOVENTAPECES,
          P.TOTALKGMAMIF,
          P.PRECIOVENTAMAMIF,
            NVL (P.TOTALKGCRUST, 0)
          + NVL (P.TOTALKGMOLUSC, 0)
          + NVL (P.TOTALKGPECES, 0)
          + NVL (P.TOTALKGMAMIF, 0),
            NVL (P.PRECIOVENTACRUST, 0)
          + NVL (P.PRECIOVENTAMOLUSC, 0)
          + NVL (P.PRECIOVENTAPECES, 0)
          + NVL (P.PRECIOVENTAMAMIF, 0),
          P.CODEMBARCACION,
          EM.NOMBRE,
          EM.MATRICULA,
          P.OBSERVACIONES
     FROM G4_PESCA P
          INNER JOIN M_PUERTO_LOCAL PU
             ON P.CODPUE = PU.CODPUE
          INNER JOIN M_USUARIO U
             ON P.CODUSUARIO = U.CODUSUARIO
          INNER JOIN G4_TIPOOPERACION TOP
             ON TOP.CODIGO = P.TIPOOPERACION
          LEFT JOIN G4_TIPOGRAVAMEN TG
             ON TG.CODIGO = P.TIPOGRAVAMEN
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON TI.CODIGO = P.TIPOIGIC
          LEFT JOIN ESCALA E
             ON (    E.CODPUE = P.CODPUEESCALA
                 AND E.ANYO = P.ANYOESCALA
                 AND E.CODESCALA = P.CODESCALA)
          LEFT JOIN M_BUQUE B
             ON (B.CODBUQUE = E.CODBUQUE)
          LEFT JOIN M_EMBPESCALITORAL EM
             ON (P.CODEMBARCACION = EM.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4PROCESOSCARGA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4PROCESOSCARGA
(
   IDPROCESO,
   FECPROCESO,
   USRPROCESO,
   NOMFICHERO,
   RESULTADO,
   DESCRESULTADO
)
AS
   SELECT P.IDPROCESO,
          P.FECPROCESO,
          P.USRPROCESO,
          P.NOMFICHERO,
          P.RESULTADO,
          DECODE (P.RESULTADO,
                  '0', 'Sin errores',
                  '1', 'Con errores',
                  '2', 'Procesado anteriormente',
                  '3', 'Sin errores con Avisos',
                  '9', 'En progreso')
     FROM G4_PROCESOCARGA P;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4PROCESOSCARGAERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4PROCESOSCARGAERROR
(
   IDPROCESO,
   IDERROR,
   FILAFICHERO,
   DESCERROR
)
AS
   SELECT E.IDPROCESO,
          E.IDERROR,
          E.FILAFICHERO,
          E.DESCERROR
     FROM G4_PROCESOCARGAERROR E;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G4PROCESOSCARGAWARNING  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G4PROCESOSCARGAWARNING
(
   IDPROCESO,
   IDWARNING,
   FILAFICHERO,
   DESCWARNING
)
AS
   SELECT W.IDPROCESO,
          W.IDWARNING,
          W.FILAFICHERO,
          W.DESCWARNING
     FROM G4_PROCESOCARGAWARNING W;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5AUTBASES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5AUTBASES
(
   CODEXP,
   CODPUE,
   DESPUE,
   IDEMBARCACION,
   EMBARCACION,
   TITULAR,
   CIFCONCESIONARIO,
   NOMBRECONCESIONARIO,
   CODAPSCTCONCESIONARIO,
   FECINICIO,
   FECFIN,
   CODINS,
   CODAPSCTINS,
   NOMBRE,
   CODPAN,
   CODAPSCTPAN,
   CODAMARRE,
   CODAPSCTAMARRE,
   INDAGUA,
   AGUA,
   INDELECTRICIDAD,
   ELECTRICIDAD,
   TIPOAMARRE,
   DESCTIPOAMARRE,
   FORMALIQBASE,
   FORMALIQ,
   PERIODICIDADBASE,
   PERIODICIDAD,
   INDEXENTOT0,
   EXENTOT0,
   INDEXENTOT5,
   EXENTOT5,
   FECULTLIQT0BASE,
   FECULTLIQT5BASE,
   FECEXTINCION,
   MOTIVEXTINCION,
   DESCEXTINCION,
   ESLORA,
   MANGA,
   TIPOPROPULSION,
   DESCTIPOPROPULSION,
   TIPOIGICT0,
   DESCTIPOIGICT0,
   TIPOIGICT5,
   DESCTIPOIGICT5,
   CODESTADO,
   ESTADO,
   NUMREGISTRO,
   FECREGISTRO,
   REFERENCIA,
   INDREVT0,
   REVT0,
   INDREVT5,
   REVT5,
   MATRICULA,
   FECPAGOINDEFT0,
   VALIDEZINDEFINIDAT0,
   JUSTIFEXENTOT0EMB,
   JUSTIFEXENTOT0,
   JUSTIFEXENTOT5
)
AS
   SELECT M.CODEXP,
          M.CODPUE,
          PU.NOMBRE,
          M.IDEMBARCACION,
          E.NOMBRE,
          M.TITULAR,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          M.FECINICIO,
          M.FECFIN,
          M.CODINS,
          I.CODAPSCT,
          I.NOMBRE,
          M.CODPAN,
          P.CODAPSCT,
          M.CODAMARRE,
          A.CODAPSCT,
          M.INDAGUA,
          DECODE (M.INDAGUA, '1', 'Si', 'No'),
          M.INDELECTRICIDAD,
          DECODE (M.INDELECTRICIDAD, '1', 'Si', 'No'),
          M.TIPOAMARRE,
          TA.DESCRIPCION,
          M.FORMALIQBASE,
          FL.DESCRIPCION,
          M.PERIODICIDADBASE,
          PL.DESCRIPCION,
          M.INDEXENTOT0,
          DECODE (M.INDEXENTOT0, '1', 'Si', 'No'),
          M.INDEXENTOT5,
          DECODE (M.INDEXENTOT5, '1', 'Si', 'No'),
          M.FECULTLIQT0BASE,
          M.FECULTLIQT5BASE,
          M.FECEXTINCION,
          M.MOTIVEXTINCION,
          ME.DESCRIPCION,
          E.ESLORA,
          E.MANGA,
          E.TIPOPROPULSION,
          TP.DESCRIPCION,
          M.TIPOIGICT0,
          TT0.DESCRIPCION,
          M.TIPOIGICT5,
          TT5.DESCRIPCION,
          M.CODESTADO,
          EST.DESCRIPCION,
          M.NUMREGISTRO,
          M.FECREGISTRO,
          CASE
             WHEN M.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN M.NUMREGISTRO IS NOT NULL AND M.FECREGISTRO IS NULL
             THEN
                M.NUMREGISTRO
             WHEN M.NUMREGISTRO IS NOT NULL AND M.FECREGISTRO IS NOT NULL
             THEN
                   M.NUMREGISTRO
                || ' - '
                || TO_CHAR (M.FECREGISTRO, 'dd/MM/rrrr')
          END,
          M.INDREVT0,
          DECODE (M.INDREVT0, '1', 'Si', 'No'),
          M.INDREVT5,
          DECODE (M.INDREVT5, '1', 'Si', 'No'),
          E.MATRICULA,
          E.FECPAGOINDEFT0,
          DECODE (E.FECPAGOINDEFT0, NULL, 'No', 'Si'),
          E.JUSTIFEXENTOT0,
          M.JUSTIFEXENTOT0,
          M.JUSTIFEXENTOT5
     FROM G5_EXPGESTDIRECTA M
          INNER JOIN M_EMBARCACION E
             ON E.CODIGO = M.IDEMBARCACION
          INNER JOIN TIPO_PROPULSION TP
             ON TP.CODIGO = E.TIPOPROPULSION
          INNER JOIN M_INSTALACION I
             ON I.CODINS = M.CODINS
          LEFT JOIN M_PANTALAN P
             ON P.CODPAN = M.CODPAN
          INNER JOIN M_AMARRE A
             ON A.CODAMARRE = M.CODAMARRE
          INNER JOIN M_PUERTO_LOCAL PU
             ON M.CODPUE = PU.CODPUE
          INNER JOIN M_USUARIO U
             ON M.TITULAR = U.CODUSUARIO
          INNER JOIN TIPO_AMARRE TA
             ON TA.CODIGO = M.TIPOAMARRE
          LEFT JOIN LQ_FORMALIQ FL
             ON FL.CODIGO = M.FORMALIQBASE
          LEFT JOIN LQ_PERIODICIDAD PL
             ON PL.CODIGO = M.PERIODICIDADBASE
          LEFT JOIN G5_MOTIVEXTINCION ME
             ON ME.CODIGO = M.MOTIVEXTINCION
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TT0
             ON TT0.CODIGO = M.TIPOIGICT0
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TT5
             ON TT5.CODIGO = M.TIPOIGICT5
          LEFT JOIN G5_ESTADOAUTBASE EST
             ON EST.CODIGO = M.CODESTADO
    WHERE M.INDTRANSITO = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5BASEAGUAPDTELIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5BASEAGUAPDTELIQ
(
   CODIGO,
   CODEXPCONTADOR,
   FECINICIO,
   FECFIN
)
AS
   SELECT G5_BASEAGUA_PDTELIQ.CODIGO,
          G5_BASEAGUA_PDTELIQ.CODEXPCONTADOR,
          G5_BASEAGUA_PDTELIQ.FECINICIO,
          G5_BASEAGUA_PDTELIQ.FECFIN
     FROM G5_BASEAGUA_PDTELIQ;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5BASECONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5BASECONTADOR
(
   CODIGO,
   CODEXP,
   CODPUECONTADOR,
   CODCONTADOR,
   FECINICIO,
   FECFIN,
   FECINICIOEXP,
   FECFINEXP,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   DESPUE,
   CODPUE,
   FECULTLIQ,
   INDREVANULACION,
   REVANULACION,
   TIPOIGIC,
   DESCTIPOIGIC,
   INDEXENTOLIQ,
   EXENTOLIQ,
   REFERENCIA,
   CONTADOR,
   CODMOTIVEXENTOLIQ,
   MOTIVEXENTOLIQ,
   EMBARCACION,
   MATRICULA
)
AS
   SELECT C.CODIGO,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          E.FECINICIO,
          E.FECFIN,
          C.IDUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          PU.NOMBRE,
          C.CODPUECONTADOR,
          C.FECULTLIQ,
          C.INDREVANULACION,
          DECODE (C.INDREVANULACION, '1', 'Si', 'No'),
          C.TIPOIGIC,
          TI.DESCRIPCION,
          C.INDEXENTOLIQ,
          DECODE (C.INDEXENTOLIQ, '1', 'Si', 'No'),
          CASE
             WHEN E.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NULL
             THEN
                E.NUMREGISTRO
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NOT NULL
             THEN
                   E.NUMREGISTRO
                || ' - '
                || TO_CHAR (E.FECREGISTRO, 'dd/MM/rrrr')
          END,
          CE.DESCRIPCION,
          C.CODMOTIVEXENTOLIQ,
          M.DESCRIPCION,
          EM.NOMBRE,
          EM.MATRICULA
     FROM G5_BASE_CONTADOR C
          INNER JOIN M_PUERTO_LOCAL PU
             ON C.CODPUECONTADOR = PU.CODPUE
          INNER JOIN G5_EXPGESTDIRECTA E
             ON C.CODEXP = E.CODEXP
          INNER JOIN M_EMBARCACION EM
             ON E.IDEMBARCACION = EM.CODIGO
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON TI.CODIGO = C.TIPOIGIC
          INNER JOIN M_CONTADOR CE
             ON (CE.CODPUE = C.CODPUECONTADOR AND CE.NUMCON = C.CODCONTADOR)
          LEFT JOIN AGUA_MOTIVEXENCION M
             ON (M.CODIGO = C.CODMOTIVEXENTOLIQ);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5EXPGESTDIRECTAPDTELIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5EXPGESTDIRECTAPDTELIQ
(
   CODIGO,
   CODEXP,
   TIPOTASA,
   TASA,
   FECINICIO,
   FECFIN
)
AS
   SELECT G5_EXPGESTDIRECTA_PDTELIQ.CODIGO,
          G5_EXPGESTDIRECTA_PDTELIQ.CODEXP,
          G5_EXPGESTDIRECTA_PDTELIQ.TIPOTASA,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          G5_EXPGESTDIRECTA_PDTELIQ.FECINICIO,
          G5_EXPGESTDIRECTA_PDTELIQ.FECFIN
     FROM    G5_EXPGESTDIRECTA_PDTELIQ
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (G5_EXPGESTDIRECTA_PDTELIQ.TIPOTASA = LQ_TIPO_SERVICIO.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5MARINACOEF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5MARINACOEF (CODMARINA, ANYO, COEFICIENTE)
AS
   SELECT M.CODMARINA, M.ANYO, M.COEFICIENTE
     FROM G5_MARINA_COEF M;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5MARINACOMPLEMENTARIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5MARINACOMPLEMENTARIA
(
   CODIGO,
   CODMARINA,
   FECINICIO,
   FECFIN,
   TIPOTASA,
   TASA,
   TIPOREVISION,
   REVISION,
   NUMRESOLUCION,
   FACTRECTIF,
   FECREGSALIDA,
   DOCSUSTRECT,
   OBSERVACIONES,
   FECLIQ
)
AS
   SELECT C.CODIGO,
          C.CODMARINA,
          C.FECINICIO,
          C.FECFIN,
          C.TIPOTASA,
          T.DESCRIPCION,
          C.TIPOREVISION,
          DECODE (C.TIPOREVISION,  'O', 'Oficio',  'I', 'Instancia de parte'),
          C.NUMRESOLUCION,
          C.FACTRECTIF,
          C.FECREGSALIDA,
          C.DOCSUSTRECT,
          C.OBSERVACIONES,
          C.FECLIQ
     FROM    G5_MARINACOMPLEMENTARIA C
          INNER JOIN
             LQ_TIPO_SERVICIO T
          ON T.CODIGO = C.TIPOTASA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5MARINAPDTELIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5MARINAPDTELIQ
(
   CODIGO,
   CODEXP,
   TIPOTASA,
   TASA,
   FECINICIO,
   FECFIN
)
AS
   SELECT G5_MARINA_PDTELIQ.CODIGO,
          G5_MARINA_PDTELIQ.CODEXP,
          G5_MARINA_PDTELIQ.TIPOTASA,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          G5_MARINA_PDTELIQ.FECINICIO,
          G5_MARINA_PDTELIQ.FECFIN
     FROM    G5_MARINA_PDTELIQ
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (G5_MARINA_PDTELIQ.TIPOTASA = LQ_TIPO_SERVICIO.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5MOTIVEXTINCION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5MOTIVEXTINCION (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM G5_MOTIVEXTINCION;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5PROCESOSCARGA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5PROCESOSCARGA
(
   IDPROCESO,
   FECPROCESO,
   USRPROCESO,
   NOMFICHERO,
   RESULTADO,
   DESCRESULTADO,
   CODMARINA,
   DESCMARINA
)
AS
   SELECT P.IDPROCESO,
          P.FECPROCESO,
          P.USRPROCESO,
          P.NOMFICHERO,
          P.RESULTADO,
          DECODE (P.RESULTADO,
                  '0', 'Sin errores',
                  '1', 'Con errores',
                  '2', 'Procesado anteriormente'),
          M.CODEXP,
          M.DESCRIPCION
     FROM G5_PROCESOCARGA P JOIN G5_MARINA M ON M.CODEXP = P.CODMARINA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5PROCESOSCARGAERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5PROCESOSCARGAERROR
(
   IDPROCESO,
   IDERROR,
   FILAFICHERO,
   DESCERROR
)
AS
   SELECT E.IDPROCESO,
          E.IDERROR,
          E.FILAFICHERO,
          E.DESCERROR
     FROM G5_PROCESOCARGAERROR E;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_G5TRANSITOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_G5TRANSITOS
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   FECINICIO,
   FECFIN,
   CODTITULAR,
   NOMTITULAR,
   NIF,
   CODAPSCT,
   CODTIPOAMARRE,
   DESCTIPOAMARRE,
   NOMBREEMB,
   ESLORAEMB,
   MANGAEMB,
   CODTIPOPROPULSION,
   DESCTIPOPROPULSION,
   INDEXENTOB0,
   EXENTOB0,
   INDEXENTOB5,
   EXENTOB5,
   MOTIVEXENTOB0,
   MOTIVEXENTOB5,
   INDLIQUIDADOB0,
   LIQUIDADOB0,
   INDLIQUIDADOB5,
   LIQUIDADOB5,
   INDAGUA,
   AGUA,
   INDELECTRICIDAD,
   ELECTRICIDAD,
   CODMUELLE,
   DESCMUELLE,
   OBSERVACIONES,
   MATRICULAEMB,
   CODTIPOIVAT0,
   CODTIPOIVAT5,
   IDMARINA,
   MARINA,
   INDEXTRANJERO,
   INDZONA2,
   ZONA2,
   INDVIAFICHERO,
   VIAFICHERO,
   NOMFICHERO,
   FECFICHERO
)
AS
   SELECT G5.CODPUE,
          CP.NOMBRE,
          G5.ANYO,
          G5.CODSER,
          G5.FECINICIO,
          G5.FECFIN,
          G5.TITULAR,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          G5.CODTIPOAMARRE,
          TA.DESCRIPCION,
          G5.NOMBREEMB,
          G5.ESLORAEMB,
          G5.MANGAEMB,
          G5.CODTIPOPROPULSION,
          TP.DESCRIPCION,
          G5.INDEXENTOB0,
          DECODE (G5.INDEXENTOB0, '1', 'Si', 'No'),
          G5.INDEXENTOB5,
          DECODE (G5.INDEXENTOB5, '1', 'Si', 'No'),
          G5.MOTIVEXENTOB0,
          G5.MOTIVEXENTOB5,
          G5.INDLIQUIDADOB0,
          DECODE (G5.INDLIQUIDADOB0, '1', 'Si', 'No'),
          G5.INDLIQUIDADOB5,
          DECODE (G5.INDLIQUIDADOB5, '1', 'Si', 'No'),
          G5.INDAGUA,
          DECODE (G5.INDAGUA, '1', 'Si', 'No'),
          G5.INDELECTRICIDAD,
          DECODE (G5.INDELECTRICIDAD, '1', 'Si', 'No'),
          G5.CODMUELLE,
          MU.DESCRIPCION,
          G5.OBSERVACIONES,
          G5.MATRICULAEMB,
          G5.CODTIPOIVAT0,
          G5.CODTIPOIVAT5,
          G5.IDMARINA,
          M.DESCRIPCION,
          G5.INDEXTRANJERO,
          G5.INDZONA2,
          DECODE (G5.INDZONA2, '1', 'Si', 'No'),
          G5.INDVIAFICHERO,
          DECODE (G5.INDVIAFICHERO, '1', 'Si', 'No'),
          G5.NOMFICHERO,
          G5.FECFICHERO
     FROM G5_TRANSITO G5
          INNER JOIN M_PUERTO_LOCAL CP
             ON G5.CODPUE = CP.CODPUE
          INNER JOIN M_USUARIO U
             ON G5.TITULAR = U.CODUSUARIO
          INNER JOIN TIPO_AMARRE TA
             ON G5.CODTIPOAMARRE = TA.CODIGO
          INNER JOIN TIPO_PROPULSION TP
             ON G5.CODTIPOPROPULSION = TP.CODIGO
          LEFT JOIN M_MUELLE MU
             ON G5.CODMUELLE = MU.CODIGO
          LEFT JOIN G5_MARINA M
             ON G5.IDMARINA = M.CODEXP;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GEASOCIACIONDOCUMENTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GEASOCIACIONDOCUMENTOS
(
   GUIDSRV,
   IDDOC,
   DESCRIPCION,
   FECCREACION,
   IDTIPODOCASOC,
   TIPODOCASOC,
   NOMBRE,
   CODPUEEXPDP,
   CODEXPDP
)
AS
   SELECT GE_ASOCIACION_DOCUMENTOS.GUIDSRV,
          GE_ASOCIACION_DOCUMENTOS.IDDOC,
          GE_ASOCIACION_DOCUMENTOS.DESCRIPCION,
          GE_ASOCIACION_DOCUMENTOS.FECCREACION,
          GE_ASOCIACION_DOCUMENTOS.IDTIPODOCASOC,
          GE_TIPO_DOCUMENTO_ASOC.DESCRIPCION,
          GE_ASOCIACION_DOCUMENTOS.NOMBRE,
          GE_ASOCIACION_DOCUMENTOS.CODPUEEXPDP,
          GE_ASOCIACION_DOCUMENTOS.CODEXPDP
     FROM    GE_ASOCIACION_DOCUMENTOS
          LEFT JOIN
             GE_TIPO_DOCUMENTO_ASOC
          ON GE_TIPO_DOCUMENTO_ASOC.IDTIPO =
                GE_ASOCIACION_DOCUMENTOS.IDTIPODOCASOC;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GETIPODOCUMENTOASOC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GETIPODOCUMENTOASOC (IDTIPO, DESCRIPCION)
AS
   SELECT E.IDTIPO, E.DESCRIPCION
     FROM GE_TIPO_DOCUMENTO_ASOC E;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GE_CAMBIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GE_CAMBIO
(
   IDCAMBIO,
   TABLA,
   TITULOTABLA,
   CLAVEPRIMARIA,
   CLAVELOGICA,
   CAMPO,
   TITULOCAMPO,
   VALORANTERIOR,
   VALORACTUAL,
   FECHACAMBIO,
   USRCAMBIO,
   IDCONTROLCAMBIO,
   OBSERVACIONES,
   IDOPERACIONCAMBIO,
   DESOPERACION,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF,
   FECBAJA
)
AS
   SELECT CA.IDCAMBIO,
          CA.TABLA,
          CA.TITULOTABLA,
          CA.CLAVEPRIMARIA,
          CA.CLAVELOGICA,
          CA.CAMPO,
          CA.TITULOCAMPO,
          CA.VALORANTERIOR,
          CA.VALORACTUAL,
          CA.FECHACAMBIO,
          CA.USRCAMBIO,
          CA.IDCONTROLCAMBIO,
          CA.OBSERVACIONES,
          CA.IDOPERACIONCAMBIO,
          OC.DESOPERACION,
          CA.FECALTA,
          CA.USRALTA,
          CA.FECMODIF,
          CA.USRMODIF,
          CA.FECBAJA
     FROM    GE_CAMBIO CA
          LEFT JOIN
             GE_OPERACION_CAMBIO OC
          ON OC.IDOPERACIONCAMBIO = CA.IDOPERACIONCAMBIO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GE_CONTROL_CAMBIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GE_CONTROL_CAMBIO
(
   IDCONTROLCAMBIO,
   ENTIDAD,
   CLAVEPRIMARIA,
   CLAVELOGICA,
   IDORIGENCAMBIO,
   DESORIGENCAMBIO,
   USRINICIACAMBIO,
   FECINICIOCAMBIO,
   USRFINCAMBIO,
   FECFINCAMBIO,
   OBSERVACIONES,
   IDMENSAJE,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF,
   FECBAJA
)
AS
   SELECT CC.IDCONTROLCAMBIO,
          CC.ENTIDAD,
          CC.CLAVEPRIMARIA,
          CC.CLAVELOGICA,
          CC.IDORIGENCAMBIO,
          OC.DESORIGENCAMBIO,
          CC.USRINICIACAMBIO,
          CC.FECINICIOCAMBIO,
          CC.USRFINCAMBIO,
          CC.FECFINCAMBIO,
          CC.OBSERVACIONES,
          CC.IDMENSAJE,
          CC.FECALTA,
          CC.USRALTA,
          CC.FECMODIF,
          CC.USRMODIF,
          CC.FECBAJA
     FROM    GE_CONTROL_CAMBIO CC
          LEFT JOIN
             GE_ORIGEN_CAMBIO_TIPO OC
          ON OC.IDORIGENCAMBIO = CC.IDORIGENCAMBIO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GRUAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GRUAS
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   CODTIPOPROPIETARIO,
   TIPOPROPIETARIO,
   CODTIPOTONELAJE,
   TIPOTONELAJE,
   CODTIPOENGANCHE,
   TIPOENGANCHE
)
AS
   SELECT M_GRUA.CODIGO,
          M_GRUA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_GRUA.DESCRIPCION,
          M_GRUA.CODTIPOPROPIETARIO,
          TIPO_PROPIETARIOGRUA.DESCRIPCION,
          M_GRUA.CODTIPOTONELAJE,
          TIPO_TONELAJEGRUA.DESCRIPCION,
          M_GRUA.CODTIPOENGANCHE,
          TIPO_ENGANCHEGRUA.DESCRIPCION
     FROM M_GRUA
          INNER JOIN M_PUERTO_LOCAL
             ON (M_GRUA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN TIPO_PROPIETARIOGRUA
             ON (TIPO_PROPIETARIOGRUA.CODIGO = M_GRUA.CODTIPOPROPIETARIO)
          LEFT JOIN TIPO_TONELAJEGRUA
             ON (TIPO_TONELAJEGRUA.CODIGO = M_GRUA.CODTIPOTONELAJE)
          LEFT JOIN TIPO_ENGANCHEGRUA
             ON (TIPO_ENGANCHEGRUA.CODIGO = M_GRUA.CODTIPOENGANCHE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GU_FUNCIONALIDAD  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GU_FUNCIONALIDAD
(
   CODFUN,
   DESFUN,
   CODSUB,
   DESSUB
)
AS
   SELECT GU_FUNCIONALIDAD.CODFUN,
          GU_FUNCIONALIDAD.DESFUN,
          GU_FUNCIONALIDAD.CODSUB,
          GU_SUBSISTEMA.DESSUB
     FROM    GU_FUNCIONALIDAD
          LEFT JOIN
             GU_SUBSISTEMA
          ON (GU_FUNCIONALIDAD.CODSUB = GU_SUBSISTEMA.CODSUB)
    WHERE GU_FUNCIONALIDAD.BAJA = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GU_PERFIL_FUNCIONALIDAD  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GU_PERFIL_FUNCIONALIDAD
(
   CODPERFIL,
   NOMBRE,
   CODFUN
)
AS
   SELECT GU_PERFIL.CODPERFIL,
          GU_PERFIL.NOMBRE,
          GU_PERFIL_FUNCIONALIDAD.CODFUN
     FROM    GU_PERFIL
          LEFT JOIN
             GU_PERFIL_FUNCIONALIDAD
          ON GU_PERFIL_FUNCIONALIDAD.CODPERFIL = GU_PERFIL.CODPERFIL;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_GU_USUAPLI_PERFIL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_GU_USUAPLI_PERFIL
(
   CODPERFIL,
   USR,
   NOMBRE,
   PERFIL,
   OBSERVACIONES
)
AS
   SELECT GU_USUAPLI_PERFIL.CODPERFIL,
          GU_USUAPLI_PERFIL.USR,
          GU_USUARIO_APLICACION.NOMBRE,
          GU_PERFIL.NOMBRE,
          GU_PERFIL.OBSERVACIONES
     FROM GU_USUAPLI_PERFIL
          LEFT JOIN GU_USUARIO_APLICACION
             ON GU_USUARIO_APLICACION.USR = GU_USUAPLI_PERFIL.USR
          LEFT JOIN GU_PERFIL
             ON GU_PERFIL.CODPERFIL = GU_USUAPLI_PERFIL.CODPERFIL;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_HISTASOCEXPAGUACONT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_HISTASOCEXPAGUACONT
(
   CODIGO,
   CODPUEEXP,
   CODEXP,
   CODPUE,
   NUMCON,
   FECINICIO,
   FECFIN,
   CONCESIONARIO,
   CIF,
   NOMBRECOMPLETO,
   CODAPSCT,
   EXPEDIENTE,
   CODTIPOEXPEDIENTE,
   TIPOEXPEDIENTE
)
AS
   SELECT C.CODIGO,
          C.CODPUEEXP,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          E.CONCESIONARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.OBJETO,
          'D',
          'Dominio publico'
     FROM DP_EXPCONTADORAGUA C
          INNER JOIN DP_EXPEDIENTE E
             ON C.CODPUEEXP = E.CODPUE AND C.CODEXP = E.CODIGO
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO
   UNION ALL
   SELECT C.CODIGO,
          NULL,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          C.IDUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          E.DESCRIPCION,
          'O',
          'Obra/Servicio'
     FROM EXPAGUA_NODP_CONTADOR C
          INNER JOIN EXPAGUA_NODP E
             ON C.CODEXP = E.CODIGO
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO
   UNION ALL
   SELECT C.CODIGO,
          NULL,
          C.CODEXP,
          C.CODPUECONTADOR,
          C.CODCONTADOR,
          C.FECINICIO,
          C.FECFIN,
          C.IDUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          CASE
             WHEN E.NUMREGISTRO IS NULL
             THEN
                NULL
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NULL
             THEN
                E.NUMREGISTRO
             WHEN E.NUMREGISTRO IS NOT NULL AND E.FECREGISTRO IS NOT NULL
             THEN
                   E.NUMREGISTRO
                || ' - '
                || TO_CHAR (E.FECREGISTRO, 'dd/MM/rrrr')
          END,
          'A',
          'Plaza base'
     FROM G5_BASE_CONTADOR C
          INNER JOIN G5_EXPGESTDIRECTA E
             ON C.CODEXP = E.CODEXP
          INNER JOIN M_USUARIO U
             ON C.IDUSUARIO = U.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_INSTALACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_INSTALACIONES
(
   CODINS,
   CODPUE,
   DESPUE,
   CODAPSCT,
   NOMBRE,
   INDAGUA,
   AGUA,
   INDELECTRICIDAD,
   ELECTRICIDAD,
   CODCENTROCOSTE,
   CENTROCOSTE
)
AS
   SELECT I.CODINS,
          I.CODPUE,
          P.NOMBRE,
          I.CODAPSCT,
          I.NOMBRE,
          I.INDAGUA,
          DECODE (I.INDAGUA, '1', 'Si', 'No'),
          I.INDELECTRICIDAD,
          DECODE (I.INDELECTRICIDAD, '1', 'Si', 'No'),
          I.CODCENTROCOSTE,
          LQ.DESCRIPCION
     FROM M_INSTALACION I
          INNER JOIN M_PUERTO_LOCAL P
             ON I.CODPUE = P.CODPUE
          LEFT JOIN LQ_CENTROCOSTE LQ
             ON I.CODCENTROCOSTE = LQ.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGAE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGAE
(
   CODIGO,
   DESCRIPCION,
   CODERROR,
   ACCION,
   CODPUE,
   DESPUE,
   NUMBORRADORAE,
   FECCREACION
)
AS
   SELECT LOGAE.CODIGO,
          LOGAE.DESCRIPCION,
          LOGAE.CODERROR,
          LOGAE.ACCION,
          LOGAE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          LOGAE.NUMBORRADORAE,
          LOGAE.FECALTA
     FROM    LOGAE
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (LOGAE.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGCONTMERC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGCONTMERC
(
   CODIGO,
   DESCRIPCION,
   CODERROR,
   ACCION,
   CODPUE,
   FECHA,
   DESPUE,
   NUMDECLARACION,
   CODMENSAJESIME
)
AS
   SELECT LOGCONTMERC.CODIGO,
          LOGCONTMERC.DESCRIPCION,
          LOGCONTMERC.CODERROR,
          LOGCONTMERC.ACCION,
          LOGCONTMERC.CODPUE,
          LOGCONTMERC.FECHA,
          M_PUERTO_LOCAL.NOMBRE,
          LOGCONTMERC.NUMDECLARACION,
          LOGCONTMERC.CODMENSAJESIME
     FROM    LOGCONTMERC
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (LOGCONTMERC.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGDP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGDP
(
   CODIGO,
   DESCRIPCION,
   CODERROR,
   ACCION,
   CODEXPEDIENTEAE,
   CODPUE,
   DESPUE,
   FECHA
)
AS
   SELECT LOGDP.CODIGO,
          LOGDP.DESCRIPCION,
          LOGDP.CODERROR,
          LOGDP.ACCION,
          LOGDP.CODEXPEDIENTEAE,
          LOGDP.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          LOGDP.FECHA
     FROM    LOGDP
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (LOGDP.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGMAESTROCOARRIS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGMAESTROCOARRIS
(
   CODIGO,
   CODTAMANYO,
   NUMESCALA,
   BUQUE,
   CODMENSAJECOARRI,
   TIPOOPERACION,
   DESCTIPOOPERACION
)
AS
   SELECT L.CODIGO,
          L.CODTAMANYO,
          M.NUMESCALA,
          M.NOMBREBUQUE,
          L.CODMENSAJECOARRI,
          M.TIPOOPERACION,
          DECODE (M.TIPOOPERACION,  '270', 'Carga',  '98', 'Descarga')
     FROM    LOGMAESTROCOARRI L
          INNER JOIN
             MEN_COARRI M
          ON L.CODMENSAJECOARRI = M.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGMENSAJERIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGMENSAJERIAS
(
   CODIGO,
   DESCRIPCION,
   CODERROR,
   ACCION,
   NUMESCALA,
   CODPUE,
   FECHA,
   DESPUE,
   NUMDECLARACION
)
AS
   SELECT LOGMENSAJERIA.CODIGO,
          LOGMENSAJERIA.DESCRIPCION,
          LOGMENSAJERIA.CODERROR,
          LOGMENSAJERIA.ACCION,
          LOGMENSAJERIA.NUMESCALA,
          LOGMENSAJERIA.CODPUE,
          LOGMENSAJERIA.FECHA,
          M_PUERTO_LOCAL.NOMBRE,
          LOGMENSAJERIA.NUMDECLARACION
     FROM    LOGMENSAJERIA
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (LOGMENSAJERIA.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGRODANTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGRODANTES
(
   CODIGO,
   DESCRIPCION,
   CODERROR,
   ACCION,
   MATRICULA,
   CODPUE,
   FECHA,
   DESPUE,
   USRINVOCA
)
AS
   SELECT LOGRODANTE.CODIGO,
          LOGRODANTE.DESCRIPCION,
          LOGRODANTE.CODERROR,
          LOGRODANTE.ACCION,
          LOGRODANTE.MATRICULA,
          LOGRODANTE.CODPUE,
          LOGRODANTE.FECHA,
          M_PUERTO_LOCAL.NOMBRE,
          LOGRODANTE.USRINVOCA
     FROM    LOGRODANTE
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (LOGRODANTE.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LOGTRAMITATRAQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LOGTRAMITATRAQUE
(
   CODIGO,
   CODPUE,
   ANYOESCALA,
   CODESCALA,
   CODESTADIA,
   FECEJECUCION,
   TIPOACCION,
   RESULTADO,
   DESCERROR,
   NUMESCALA,
   DESPUE,
   CODBUQUE,
   NOMBUQUE
)
AS
   SELECT LOG_TRAMITATRAQUE.CODIGO,
          LOG_TRAMITATRAQUE.CODPUEESCALA,
          LOG_TRAMITATRAQUE.ANYOESCALA,
          LOG_TRAMITATRAQUE.CODESCALA,
          LOG_TRAMITATRAQUE.CODESTADIA,
          LOG_TRAMITATRAQUE.FECEJECUCION,
          DECODE (LOG_TRAMITATRAQUE.TIPOACCION,
                  'A', 'Autorizacin',
                  'I', 'Inicio',
                  'F', 'Fin',
                  'AA', 'Modificacin autorizacin',
                  'II', 'Modificacin inicio'),
          DECODE (LOG_TRAMITATRAQUE.RESULTADO,
                  '0', 'Correcto',
                  '1', 'Error'),
          LOG_TRAMITATRAQUE.DESCERROR,
          ESCALA.NUMESCALA,
          M_PUERTO_LOCAL.NOMBRE,
          ESCALA.CODBUQUE,
          M_BUQUE.NOMBRE
     FROM LOG_TRAMITATRAQUE
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = LOG_TRAMITATRAQUE.CODPUEESCALA
                 AND ESCALA.ANYO = LOG_TRAMITATRAQUE.ANYOESCALA
                 AND ESCALA.CODESCALA = LOG_TRAMITATRAQUE.CODESCALA)
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = LOG_TRAMITATRAQUE.CODPUEESCALA
                 AND ESTADIA.ANYO = LOG_TRAMITATRAQUE.ANYOESCALA
                 AND ESTADIA.CODESCALA = LOG_TRAMITATRAQUE.CODESCALA
                 AND ESTADIA.CODESTADIA = LOG_TRAMITATRAQUE.CODESTADIA)
          LEFT JOIN M_BUQUE
             ON (M_BUQUE.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = LOG_TRAMITATRAQUE.CODPUEESCALA);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQACUMCLIENTEBONIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQACUMCLIENTEBONIF
(
   CODCLIENTE,
   ANYO,
   CODBONIFICACION,
   ACUMULADO,
   NOMBRECLIENTE,
   CIFCLIENTE,
   CODAPSCT,
   IDBONIFICACION,
   BONIFICACION
)
AS
   SELECT A.CODCLIENTE,
          A.ANYO,
          A.CODBONIFICACION,
          A.ACUMULADO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          B.CODBONIFICACION,
          B.DESCRIPCION
     FROM LQ_ACUMCLIENTEBONIF A
          INNER JOIN M_USUARIO U
             ON U.CODUSUARIO = A.CODCLIENTE
          INNER JOIN M_BONIFICACION B
             ON B.CODIGO = A.CODBONIFICACION;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBAREMOAP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBAREMOAP
(
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   CODIGO,
   DESCRIPCION,
   CODBAREMO,
   FECINIVIG,
   FECFINVIG,
   VALOR,
   LITUNIDADES1,
   LITUNIDADES2
)
AS
   SELECT LQ_BAREMOAP.IDTARIFA,
          LQ_BAREMOAP.IDSUBTARIFA,
          LQ_BAREMOAP.EXTENSION,
          LQ_BAREMOAP.CODIGO,
          LQ_BAREMOAP.DESCRIPCION,
          LQ_BAREMOAP.CODBAREMO,
          LQ_BAREMOAP.FECINIVIG,
          LQ_BAREMOAP.FECFINVIG,
          LQ_BAREMOAP.VALOR,
          LQ_BAREMOAP.LITUNIDADES1,
          LQ_BAREMOAP.LITUNIDADES2
     FROM LQ_BAREMOAP;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBONIFICACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBONIFICACIONES
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   CODLINEA,
   DESPUERTO,
   CODSERFACTURA,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   EXTENSION,
   BONIFICACION,
   IMPORTE,
   IDBONIFICACION,
   CODBONIFICACION,
   FECINISER,
   FECFINSER,
   IDCLIENTE,
   CIFCLIENTE,
   NOMBRECLIENTE,
   NUMESCALA,
   NOMBREBUQUE,
   IMOBUQUE,
   GTBUQUE,
   EXPEDIENTEDP,
   OBJETODP,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODPUEDP,
   CODDP,
   CODPUEFACEMIT,
   CODSERFACEMIT,
   ANYOFACEMIT,
   NUMFACEMIT
)
AS
   SELECT LQ_BORRADORLINEA.CODPUE,
          LQ_BORRADORLINEA.ANYO,
          LQ_BORRADORLINEA.CODBORRADOR,
          LQ_BORRADORLINEA.CODLINEA,
          M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.CODSERFACTURA,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          M_BONIFICACION.DESCRIPCION,
          LQ_BORRADORLINEA.IMPORTE,
          LQ_BORRADORLINEA.IDBONIFICACION,
          M_BONIFICACION.CODBONIFICACION,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.IDCLIENTE,
          LQ_BORRADOR.CIFCLIENTE,
          LQ_BORRADOR.NOMBRECLIENTE,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.NOMBREBUQUE,
          LQ_BORRADOR.IMOBUQUE,
          LQ_BORRADOR.GTBUQUE,
          LQ_BORRADOR.EXPEDIENTEDP,
          LQ_BORRADOR.OBJETODP,
          LQ_BORRADOR.CODPUEESC,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.CODPUEDP,
          LQ_BORRADOR.CODDP,
          LQ_BORRADOR.CODPUEFACEMIT,
          LQ_BORRADOR.CODSERFACEMIT,
          LQ_BORRADOR.ANYOFACEMIT,
          LQ_BORRADOR.NUMFACEMIT
     FROM LQ_BORRADORLINEA
          INNER JOIN M_PUERTO_LOCAL
             ON (LQ_BORRADORLINEA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN LQ_BORRADOR
             ON (    LQ_BORRADORLINEA.CODPUE = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORLINEA.ANYO = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORLINEA.CODBORRADOR = LQ_BORRADOR.CODBORRADOR)
          INNER JOIN M_BONIFICACION
             ON (M_BONIFICACION.CODIGO = LQ_BORRADORLINEA.IDBONIFICACION)
    WHERE LQ_BORRADORLINEA.IDBONIFICACION IS NOT NULL;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBORRADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBORRADORES
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   CODTIPO,
   TIPO,
   INDMANUAL,
   CONCEPTO,
   TIPOIMPUESTO,
   IMPUESTO,
   PUERTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT,
   NUMESCALA,
   IDCLIENTE,
   CIF,
   NOMBRECOMPLETO,
   CODAPSCT,
   NOMBREBUQUE,
   IMOBUQUE,
   FECINISER,
   FECFINSER,
   FECLIQ,
   IDPROCESO,
   ANYOEST,
   MANUAL,
   CODESTADO,
   DESCESTADO,
   CODPUELOTE,
   CODLOTE,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   CODPUEFACEMIT,
   CODSERFACEMIT,
   ANYOFACEMIT,
   NUMFACEMIT,
   CONTADO,
   INDMULTIIVA,
   MULTIIVA,
   EXPEDIENTEDP,
   OBJETODP,
   CODSERFACTURA,
   FACANULSERIETXT,
   FACANULANYOTXT,
   FACANULNUMTXT,
   INDMODIFMANUAL,
   MODIFMANUAL,
   USUARIOMODIFMANUAL,
   FECMODIFMANUAL,
   ANYOESC,
   CODESC,
   INDBLOQUEADO
)
AS
   SELECT LQ_BORRADOR.CODPUE,
          LQ_BORRADOR.ANYO,
          LQ_BORRADOR.CODBORRADOR,
          LQ_BORRADOR.CODTIPO,
          LQ_TIPOBORRADOR.DESCRIPCION,
          LQ_BORRADOR.INDMANUAL,
          LQ_BORRADOR.CONCEPTO,
          LQ_BORRADOR.CODTIPIMPUESTO,
          LQ_TIPO_IMPUESTO.DESCRIPCION,
          M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.IMPIMPUESTO,
          LQ_BORRADOR.IMPTOT,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.IDCLIENTE,
          LQ_BORRADOR.CIFCLIENTE,
          LQ_BORRADOR.NOMBRECLIENTE,
          LQ_BORRADOR.CODAPSCTCLIENTE,
          LQ_BORRADOR.NOMBREBUQUE,
          LQ_BORRADOR.IMOBUQUE,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADOR.FECLIQ,
          LQ_BORRADOR.IDPROCESO,
          EXTRACT (YEAR FROM LQ_BORRADOR.FECINISER),
          DECODE (LQ_BORRADOR.INDMANUAL, '1', 'Si', 'No'),
          LQ_BORRADOR.CODESTADO,
          LQ_ESTADOBORRADOR.DESCRIPCION,
          LQ_BORRADOR.CODPUELOTE,
          LQ_BORRADOR.CODLOTE,
          LQ_BORRADOR.IDASPECTOTARIFA,
          LQ_BORRADOR.IDASPECTOSUBTARIFA,
          LQ_BORRADOR.IDASPECTOEXTENSION,
          LQ_BORRADOR.CODPUEFACEMIT,
          LQ_BORRADOR.CODSERFACEMIT,
          LQ_BORRADOR.ANYOFACEMIT,
          LQ_BORRADOR.NUMFACEMIT,
          DECODE (LQ_BORRADOR.INDCONTADO, '1', 'Si', 'No'),
          LQ_BORRADOR.INDMULTIIVA,
          DECODE (LQ_BORRADOR.INDMULTIIVA, '1', 'Si', 'No'),
          LQ_BORRADOR.EXPEDIENTEDP,
          LQ_BORRADOR.OBJETODP,
          LQ_BORRADOR.CODSERFACTURA,
          LQ_BORRADOR.FACANULSERIETXT,
          LQ_BORRADOR.FACANULANYOTXT,
          LQ_BORRADOR.FACANULNUMTXT,
          LQ_BORRADOR.INDMODIFMANUAL,
          DECODE (LQ_BORRADOR.INDMODIFMANUAL, '1', 'Si', 'No'),
          LQ_BORRADOR.USUARIOMODIFMANUAL,
          LQ_BORRADOR.FECMODIFMANUAL,
          LQ_BORRADOR.ANYOESC,
          LQ_BORRADOR.CODESC,
          LQ_BORRADOR.INDBLOQUEADO
     FROM LQ_BORRADOR
          INNER JOIN LQ_TIPOBORRADOR
             ON (LQ_BORRADOR.CODTIPO = LQ_TIPOBORRADOR.CODIGO)
          LEFT JOIN LQ_TIPO_IMPUESTO
             ON (LQ_BORRADOR.CODTIPIMPUESTO = LQ_TIPO_IMPUESTO.CODIGO)
          INNER JOIN M_PUERTO_LOCAL
             ON (LQ_BORRADOR.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN LQ_ESTADOBORRADOR
             ON (LQ_BORRADOR.CODESTADO = LQ_ESTADOBORRADOR.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBORRADORES_LOG_ANUL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBORRADORES_LOG_ANUL
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   IDANUL,
   IMPORTE,
   FECCAMBIO,
   CODMOTCAMBIO,
   DESMOTCAMBIO
)
AS
   SELECT LQ_BORRADOR_LOG_ANUL.CODPUE,
          LQ_BORRADOR_LOG_ANUL.ANYO,
          LQ_BORRADOR_LOG_ANUL.CODBORRADOR,
          LQ_BORRADOR_LOG_ANUL.IDANUL,
          LQ_BORRADOR_LOG_ANUL.IMPORTE,
          LQ_BORRADOR_LOG_ANUL.FECCAMBIO,
          LQ_BORRADOR_LOG_ANUL.CODMOTCAMBIO,
          LQ_BORRADOR_MOTIVO_ANUL.DESMOTCAMBIO
     FROM    LQ_BORRADOR_LOG_ANUL
          INNER JOIN
             LQ_BORRADOR_MOTIVO_ANUL
          ON (LQ_BORRADOR_LOG_ANUL.CODMOTCAMBIO =
                 LQ_BORRADOR_MOTIVO_ANUL.CODMOTCAMBIO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBORRADORLINEACOEF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBORRADORLINEACOEF
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   CODLINEA,
   CODLINEACOEF,
   VALORCOEF,
   DESCRIPCIONCOEF,
   CODCUANTIABASICA,
   LETRACUANTIA,
   CODCOEFPUERTO,
   CODCOEFSERVICIO,
   CODCOEFICIENTE,
   CODBONIFICACION,
   BONIFICACION
)
AS
   SELECT E.CODPUE,
          E.ANYO,
          E.CODBORRADOR,
          E.CODLINEA,
          E.CODLINEACOEF,
          E.VALORCOEF,
          E.DESCRIPCIONCOEF,
          E.CODCUANTIABASICA,
          F.LETRA,
          E.CODCOEFPUERTO,
          E.CODCOEFSERVICIO,
          H.CODCOEFICIENTE,
          E.CODBONIFICACION,
          I.CODBONIFICACION
     FROM LQ_BORRADORLINEACOEF E
          LEFT JOIN LQ_CUANTIABASICA F
             ON E.CODCUANTIABASICA = F.CODIGO
          LEFT JOIN LQ_COEFPUERTO G
             ON E.CODCOEFPUERTO = G.CODIGO
          LEFT JOIN LQ_COEFSERVICIO H
             ON E.CODCOEFSERVICIO = H.CODIGO
          LEFT JOIN M_BONIFICACION I
             ON E.CODBONIFICACION = I.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQBORRADORLINEAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQBORRADORLINEAS
(
   CODPUE,
   ANYO,
   CODBORRADOR,
   CODLINEA,
   INFOLINEA,
   IMPORTE,
   PUERTO,
   IMPIMPUESTO,
   IMPTOT,
   TIPOIMPUESTO,
   IMPUESTO
)
AS
   SELECT LQ_BORRADORLINEA.CODPUE,
          LQ_BORRADORLINEA.ANYO,
          LQ_BORRADORLINEA.CODBORRADOR,
          LQ_BORRADORLINEA.CODLINEA,
          LQ_BORRADORLINEA.INFOLINEA,
          LQ_BORRADORLINEA.IMPORTE,
          M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADORLINEA.IMPIMPUESTO,
          LQ_BORRADORLINEA.IMPTOT,
          LQ_BORRADORLINEA.CODTIPIMPUESTO,
          LQ_TIPO_IMPUESTO.DESCRIPCION
     FROM LQ_BORRADORLINEA
          INNER JOIN LQ_BORRADOR
             ON (    LQ_BORRADOR.CODPUE = LQ_BORRADORLINEA.CODPUE
                 AND LQ_BORRADOR.ANYO = LQ_BORRADORLINEA.ANYO
                 AND LQ_BORRADOR.CODBORRADOR = LQ_BORRADORLINEA.CODBORRADOR)
          INNER JOIN M_PUERTO_LOCAL
             ON (LQ_BORRADORLINEA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          LEFT JOIN LQ_TIPO_IMPUESTO
             ON (LQ_BORRADORLINEA.CODTIPIMPUESTO = LQ_TIPO_IMPUESTO.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQCAMBIOSERVVALORADO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQCAMBIOSERVVALORADO
(
   CODIGO,
   FECCAMBIO,
   USRCAMBIO,
   DESCCAMBIO,
   INDTRAMITADO,
   TRAMITADO,
   IDTARIFA,
   CODPUETITULODP,
   CODTITULODP,
   CODPUEOCUPSUP,
   ANYOOCUPSUP,
   CODOCUPSUP,
   ACCIONREALIZADA,
   TARIFA,
   CODPUE,
   DESPUE,
   CODDIVERSOPERIODICO
)
AS
   SELECT C.CODIGO,
          C.FECCAMBIO,
          C.USRCAMBIO,
          C.DESCCAMBIO,
          C.INDTRAMITADO,
          DECODE (C.INDTRAMITADO, '1', 'Si', 'No'),
          C.IDTARIFA,
          C.CODPUETITULODP,
          C.CODTITULODP,
          C.CODPUEOCUPSUP,
          C.ANYOOCUPSUP,
          C.CODOCUPSUP,
          C.ACCIONREALIZADA,
          T.DESCRIPCION,
          CASE
             WHEN C.CODPUETITULODP IS NOT NULL THEN C.CODPUETITULODP
             WHEN C.CODPUEOCUPSUP IS NOT NULL THEN C.CODPUEOCUPSUP
             WHEN D.CODPUE IS NOT NULL THEN D.CODPUE
          END,
          CASE
             WHEN C.CODPUETITULODP IS NOT NULL THEN PDP.NOMBRE
             WHEN C.CODPUEOCUPSUP IS NOT NULL THEN POCUP.NOMBRE
             WHEN D.CODPUE IS NOT NULL THEN PD.NOMBRE
          END,
          C.CODDIVERSOPERIODICO
     FROM LQ_CAMBIOSERVVALORADO C
          INNER JOIN LQ_TIPO_SERVICIO T
             ON T.CODIGO = C.IDTARIFA
          LEFT JOIN M_PUERTO_LOCAL PDP
             ON PDP.CODPUE = C.CODPUETITULODP
          LEFT JOIN M_PUERTO_LOCAL POCUP
             ON POCUP.CODPUE = C.CODPUETITULODP
          LEFT JOIN DIVERSO_PERIODICO D
             ON D.CODIGO = C.CODDIVERSOPERIODICO
          LEFT JOIN M_PUERTO_LOCAL PD
             ON PD.CODPUE = D.CODPUE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQCOEFPUERTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQCOEFPUERTO
(
   CODIGO,
   DESTIPOSERV,
   CODTIPOTASA,
   FECINIVIG,
   FECFINVIG,
   VALOR
)
AS
   SELECT LQ_COEFPUERTO.CODIGO,
          LQ_TIPO_SERVICIO.DESCRIPCION AS DESTIPOSERV,
          LQ_COEFPUERTO.CODTIPOTASA,
          LQ_COEFPUERTO.FECINIVIG,
          LQ_COEFPUERTO.FECFINVIG,
          LQ_COEFPUERTO.VALOR
     FROM    LQ_COEFPUERTO
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (LQ_COEFPUERTO.CODTIPOTASA = LQ_TIPO_SERVICIO.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQCUANTIASBASICAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQCUANTIASBASICAS
(
   CODIGO,
   CODTIPOSERVICIO,
   SERVICIO,
   LETRA,
   VALOR,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT LQ_CUANTIABASICA.CODIGO,
          LQ_CUANTIABASICA.CODTIPOSERVICIO,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          LQ_CUANTIABASICA.LETRA,
          LQ_CUANTIABASICA.VALOR,
          LQ_CUANTIABASICA.FECINIVIG,
          LQ_CUANTIABASICA.FECFINVIG
     FROM    LQ_CUANTIABASICA
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (LQ_CUANTIABASICa.CODTIPOSERVICIO = LQ_TIPO_SERVICIO.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQFACTURA_HECHOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQFACTURA_HECHOS
(
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   NUMHECHO,
   CODPUE,
   ANYO,
   CODBORRADOR,
   FECFACTURA,
   CODCLIENTE,
   NOMCLIENTE,
   NIF,
   IDASPECTOTARIFA,
   IDASPECTOSUBTARIFA,
   IDASPECTOEXTENSION,
   IDASPECTO,
   IMPNET,
   IMPIMPUESTO,
   IMPTOT
)
AS
   SELECT LQFHI.CODPUEFACTURA,
          LQFHI.CODSERFACTURA,
          LQFHI.ANYOFACTURA,
          LQFHI.NUMFACTURA,
          LQFHI.NUMHECHO,
          LQFHI.CODPUE,
          LQFHI.ANYO,
          LQFHI.CODBORRADOR,
          LQF.FECFACTURA,
          LQF.CODCLIENTE,
          LQF.NOMCLIENTE,
          LQF.NIF,
          LQB.IDASPECTOTARIFA,
          LQB.IDASPECTOSUBTARIFA,
          LQB.IDASPECTOEXTENSION,
          LQB.IDASPECTO,
          LQB.IMPNET,
          LQB.IMPIMPUESTO,
          LQB.IMPTOT
     FROM LQ_FACTURA_HECHO_IMPONIBLE LQFHI
          JOIN LQ_FACTURA LQF
             ON     LQF.CODPUEFACTURA = LQFHI.CODPUEFACTURA
                AND LQF.CODSERFACTURA = LQFHI.CODSERFACTURA
                AND LQF.ANYOFACTURA = LQFHI.ANYOFACTURA
                AND LQF.NUMFACTURA = LQFHI.NUMFACTURA
          JOIN LQ_BORRADOR LQB
             ON     LQB.CODPUE = LQFHI.CODPUE
                AND LQB.ANYO = LQFHI.ANYO
                AND LQB.CODBORRADOR = LQFHI.CODBORRADOR;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQFACTURA_SERIE_NUM  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQFACTURA_SERIE_NUM
(
   CODSERFACTURA,
   ANYO,
   NUMFACTURA,
   FECNUMFACTURA
)
AS
   SELECT LQFSN.CODSERFACTURA,
          LQFSN.ANYO,
          LQFSN.NUMFACTURA,
          LQFSN.FECNUMFACTURA
     FROM LQ_FACTURA_SERIE_NUMERACION LQFSN;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQLINEASBORGLOBAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQLINEASBORGLOBAL
(
   CODPUE,
   DESPUE,
   ANYO,
   CODBORRADOR,
   CODLINEA,
   INFOLINEA,
   IMPORTELINEA,
   IMPORTEBORRADOR,
   CIF,
   NOMBRECOMPLETO,
   CODAPSCT,
   NUMESCALA,
   NUMDECLARACION,
   GT,
   NOMBREBUQUE,
   IMO,
   FECINISER,
   FECFINSER,
   CODMUELLE,
   FECLIQ,
   INDTERMCONCESIONADA,
   ANYOEST,
   CODTIPO,
   MANUAL,
   MESEST,
   TIPOOPERACION,
   INDIMPORTECERO,
   CUOTAINTEGRA,
   RECARDEV,
   LLENOVACIO,
   CODTIPOOPERACION,
   CODTIPOREGIMEN,
   CODPUECERTT7,
   TIPOMARPOL,
   VALORMINMAX,
   INDAPLICAMINMAX
)
AS
   SELECT LQ_BORRADORLINEA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          LQ_BORRADORLINEA.ANYO,
          LQ_BORRADORLINEA.CODBORRADOR,
          LQ_BORRADORLINEA.CODLINEA,
          LQ_BORRADORLINEA.INFOLINEA,
          LQ_BORRADORLINEA.IMPORTE,
          LQ_BORRADOR.IMPNET,
          LQ_BORRADOR.CIFCLIENTE,
          LQ_BORRADOR.NOMBRECLIENTE,
          LQ_BORRADOR.CODAPSCTCLIENTE,
          LQ_BORRADOR.NUMESCALA,
          LQ_BORRADOR.NUMDECLARACION,
          LQ_BORRADOR.GTBUQUE,
          LQ_BORRADOR.NOMBREBUQUE,
          LQ_BORRADOR.IMOBUQUE,
          LQ_BORRADOR.FECINISER,
          LQ_BORRADOR.FECFINSER,
          LQ_BORRADORLINEA.CODMUELLE,
          LQ_BORRADOR.FECLIQ,
          DECODE (LQ_BORRADORLINEA.INDTERMCONCESIONADA, '1', 'Si', 'No'),
          EXTRACT (YEAR FROM LQ_BORRADOR.FECINISER),
          LQ_BORRADOR.CODTIPO,
          DECODE (LQ_BORRADOR.INDMANUAL, '1', 'Si', 'No'),
          DECODE (TO_CHAR (LQ_BORRADOR.FECINISER, 'MM'),
                  '01', 'Enero',
                  '02', 'Febrero',
                  '03', 'Marzo',
                  '04', 'Abril',
                  '05', 'Mayo',
                  '06', 'Junio',
                  '07', 'Julio',
                  '08', 'Agosto',
                  '09', 'Septiembre',
                  '10', 'Octubre',
                  '11', 'Noviembre',
                  '12', 'Diciembre'),
          LQ_BORRADOR.TIPOOPERACION,
          DECODE (LQ_BORRADORLINEA.INDIMPORTECERO, '1', 'Si', 'No'),
          CASE
             WHEN LQ_BORRADORLINEA.RECARDEV <> 0 THEN 0
             ELSE NVL (LQ_BORRADORLINEA.IMPORTE, 0)
          END,
          LQ_BORRADORLINEA.RECARDEV,
          LQ_BORRADORLINEA.LLENOVACIO,
          LQ_BORRADORLINEA.CODTIPOOPERACION,
          LQ_BORRADORLINEA.CODTIPOREGIMEN,
          LQ_BORRADORLINEA.CODPUECERTT7,
          LQ_BORRADORLINEA.TIPOMARPOL,
          LQ_BORRADORLINEA.VALORMINMAX,
          DECODE (LQ_BORRADORLINEA.INDAPLICAMINMAX, '1', 'Si', 'No')
     FROM LQ_BORRADORLINEA
          INNER JOIN M_PUERTO_LOCAL
             ON (LQ_BORRADORLINEA.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN LQ_BORRADOR
             ON (    LQ_BORRADORLINEA.CODPUE = LQ_BORRADOR.CODPUE
                 AND LQ_BORRADORLINEA.ANYO = LQ_BORRADOR.ANYO
                 AND LQ_BORRADORLINEA.CODBORRADOR = LQ_BORRADOR.CODBORRADOR)
          LEFT JOIN LQ_BORRADORLINEACOEF
             ON (LQ_BORRADORLINEACOEF.CODPUE = LQ_BORRADORLINEA.CODPUE
                 AND LQ_BORRADORLINEACOEF.ANYO = LQ_BORRADORLINEA.ANYO
                 AND LQ_BORRADORLINEACOEF.CODBORRADOR =
                        LQ_BORRADORLINEA.CODBORRADOR
                 AND LQ_BORRADORLINEACOEF.CODLINEA =
                        LQ_BORRADORLINEA.CODLINEA);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQMOTIVOSIMPORTECERO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQMOTIVOSIMPORTECERO
(
   CODIGO,
   DESCRIPCION
)
AS
   SELECT LQ_MOTIVOIMPORTECERO.CODIGO, LQ_MOTIVOIMPORTECERO.DESCRIPCION
     FROM LQ_MOTIVOIMPORTECERO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQPERIODOANULADO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQPERIODOANULADO
(
   CODIGO,
   GUIDSRV,
   FECINI,
   FECFIN,
   IDTARIFA,
   TARIFA,
   CODPUEOCUP,
   ANYOOCUP,
   CODSEROCUP,
   CODPUEEXP,
   CODEXP,
   CODPUECON,
   NUMCON,
   CODMARINA,
   CODBUQUEPESQUERO,
   CODDIVERSOPERIODICO
)
AS
   SELECT LQ_PERIODOANULADO.CODIGO,
          LQ_PERIODOANULADO.GUIDSRV,
          LQ_PERIODOANULADO.FECINI,
          LQ_PERIODOANULADO.FECFIN,
          LQ_PERIODOANULADO.IDTARIFA,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          LQ_PERIODOANULADO.CODPUEOCUP,
          LQ_PERIODOANULADO.ANYOOCUP,
          LQ_PERIODOANULADO.CODSEROCUP,
          LQ_PERIODOANULADO.CODPUEEXP,
          LQ_PERIODOANULADO.CODEXP,
          LQ_PERIODOANULADO.CODPUECON,
          LQ_PERIODOANULADO.NUMCON,
          LQ_PERIODOANULADO.CODMARINA,
          LQ_PERIODOANULADO.CODBUQUEPESQUERO,
          LQ_PERIODOANULADO.CODDIVERSOPERIODICO
     FROM    LQ_PERIODOANULADO
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (LQ_PERIODOANULADO.IDTARIFA = LQ_TIPO_SERVICIO.CODIGO)
    WHERE LQ_PERIODOANULADO.INDLIQUIDADO = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQREGLALIQNOCTURNA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQREGLALIQNOCTURNA
(
   CODIGO,
   CODPUE,
   DESPUE,
   CODTASA,
   TASA,
   FECINI,
   FECFIN,
   CODCONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODAPSCTCONSIGNATARIO,
   CONSIGNATARIO,
   CODBUQUE,
   NOMBUQUE,
   CODIMO,
   CODTIPOTRAFICO,
   TIPOTRAFICO,
   INDDESACTIVADA,
   DESACTIVADA,
   FECDESACTIVACION,
   INDTODOSPUERTOS,
   TODOSPUERTOS
)
AS
   SELECT R.CODIGO,
          R.CODPUE,
          P.NOMBRE,
          R.CODTASA,
          T.DESCRIPCION,
          R.FECINI,
          R.FECFIN,
          R.CODCONSIGNATARIO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          U.NOMBRECOMPLETO,
          R.CODBUQUE,
          B.NOMBRE,
          B.CODIMO,
          R.CODTIPOTRAFICO,
          TT.DESCRIPCION,
          R.INDDESACTIVADA,
          DECODE (R.INDDESACTIVADA, '1', 'Si', 'No'),
          R.FECDESACTIVACION,
          R.INDTODOSPUERTOS,
          DECODE (R.INDTODOSPUERTOS, '1', 'Si', 'No')
     FROM LQ_REGLALIQNOCTURNA R
          LEFT JOIN M_PUERTO_LOCAL P
             ON R.CODPUE = P.CODPUE
          INNER JOIN LQ_TIPO_SERVICIO T
             ON R.CODTASA = T.CODIGO
          LEFT JOIN M_TIPO_TRAFICO TT
             ON R.CODTIPOTRAFICO = TT.CODIGO
          LEFT JOIN M_USUARIO U
             ON R.CODCONSIGNATARIO = U.CODUSUARIO
          LEFT JOIN M_BUQUE B
             ON R.CODBUQUE = B.CODBUQUE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQSUBCUENTAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQSUBCUENTAS (CODIGO, DESCRIPCION)
AS
   SELECT S.CODIGO, S.DESCRIPCION
     FROM LQ_SUBCUENTA S;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQTARIFAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQTARIFAS
(
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   DESCRIPCION,
   INDPRECIOPUBLICO,
   PRECIOPUBLICO,
   CODSUBCUENTA,
   CENTROCOSTE,
   DESCENTROCOSTE,
   CODSUBCUENTA2,
   CODTIPOSUJETO,
   TIPOSUJETO,
   INDAPLICADIVERSOS,
   APLICADIVERSOS,
   CODSUBCUENTAANYOANT,
   CODSUBCUENTAANYOANT2,
   CODGRUPO,
   MOTIVOEXENIVA,
   INDRECALCULOIVA
)
AS
   SELECT T.IDTARIFA,
          T.IDSUBTARIFA,
          T.EXTENSION,
          T.DESCRIPCION,
          T.INDPRECIOPUBLICO,
          DECODE (T.INDPRECIOPUBLICO, '1', 'Si', 'No'),
          T.CODSUBCUENTA,
          T.CENTROCOSTE,
          C.DESCRIPCION,
          T.CODSUBCUENTA2,
          T.CODTIPOSUJETO,
          TS.DESCRIPCION,
          T.INDAPLICADIVERSOS,
          DECODE (T.INDAPLICADIVERSOS, '1', 'Si', 'No'),
          T.CODSUBCUENTAANYOANT,
          T.CODSUBCUENTAANYOANT2,
          T.CODGRUPO,
          T.MOTIVOEXENIVA,
          DECODE (T.INDRECALCULOIVA, '1', 'Si', 'No')
     FROM LQ_TARIFA T
          INNER JOIN LQ_CENTROCOSTE C
             ON (T.CENTROCOSTE = C.CODIGO)
          LEFT JOIN LQ_TIPOSUJETO TS
             ON (TS.CODIGO = T.CODTIPOSUJETO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQTEMPORADA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQTEMPORADA
(
   CODIGO,
   FECINICIO,
   FECFIN,
   CODTIPOTEMPORADA,
   TIPOTEMPORADA
)
AS
   SELECT T.CODIGO,
          T.FECINICIO,
          T.FECFIN,
          T.CODTIPOTEMPORADA,
          TT.DESCRIPCION
     FROM    LQ_TEMPORADA T
          JOIN
             LQ_TIPOTEMPORADA TT
          ON TT.CODIGO = T.CODTIPOTEMPORADA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_ASPECTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_ASPECTO
(
   IDTARIFA,
   IDSUBTARIFA,
   IDEXTENSION,
   IDASPECTO,
   FECINIVIGENCIA,
   FECFINVIGENCIA,
   LINNUMMASCARA,
   CABNUMMASCARA,
   LINANUMMASCARA,
   CABANUMMASCARA,
   INDHAYESCALA,
   USRALTA,
   USRMODIF,
   FECALTA,
   FECMODIF,
   PREFORMATO,
   DESCTARIFA,
   DESCASPECTO,
   CODIDIOMA,
   LITCABNUM1,
   LITCABNUM2,
   LITCABNUM3,
   LITCABNUM4,
   LITCABNUM5,
   LITCABNUM6,
   LITCABNUM7,
   LITCABNUM8,
   LITCABNUM9,
   LITCABNUM10,
   LITCABANUM1,
   LITCABANUM2,
   LITCABANUM3,
   LITCABANUM4,
   LITCABANUM5,
   LITCABANUM6,
   LITCABANUM7,
   LITCABANUM8,
   LITCABANUM9,
   LITCABANUM10,
   LITLINNUM1,
   LITLINNUM2,
   LITLINNUM3,
   LITLINNUM4,
   LITLINNUM5,
   LITLINNUM6,
   LITLINNUM7,
   LITLINNUM8,
   LITLINNUM9,
   LITLINNUM10,
   LITLINANUM1,
   LITLINANUM2,
   LITLINANUM3,
   LITLINANUM4,
   LITLINANUM5,
   LITLINANUM6,
   LITLINANUM7,
   LITLINANUM8,
   LITLINANUM9,
   LITLINANUM10,
   ULTIMA
)
AS
   SELECT LQA.IDTARIFA,
          LQA.IDSUBTARIFA,
          LQA.IDEXTENSION,
          LQA.IDASPECTO,
          LQA.FECINIVIGENCIA,
          LQA.FECFINVIGENCIA,
          LQA.LINNUMMASCARA,
          LQA.CABNUMMASCARA,
          LQA.LINANUMMASCARA,
          LQA.CABANUMMASCARA,
          DECODE (LQA.INDHAYESCALA, '1', 'Si', 'No'),
          LQA.USRALTA,
          LQA.USRMODIF,
          LQA.FECALTA,
          LQA.FECMODIF,
          LQA.PREFORMATO,
          LQT.DESCRIPCION,
          LQAI.DESCASPECTO,
          LQAI.CODIDIOMA,
          LQAI.LITCABNUM1,
          LQAI.LITCABNUM2,
          LQAI.LITCABNUM3,
          LQAI.LITCABNUM4,
          LQAI.LITCABNUM5,
          LQAI.LITCABNUM6,
          LQAI.LITCABNUM7,
          LQAI.LITCABNUM8,
          LQAI.LITCABNUM9,
          LQAI.LITCABNUM10,
          LQAI.LITCABANUM1,
          LQAI.LITCABANUM2,
          LQAI.LITCABANUM3,
          LQAI.LITCABANUM4,
          LQAI.LITCABANUM5,
          LQAI.LITCABANUM6,
          LQAI.LITCABANUM7,
          LQAI.LITCABANUM8,
          LQAI.LITCABANUM9,
          LQAI.LITCABANUM10,
          LQAI.LITLINNUM1,
          LQAI.LITLINNUM2,
          LQAI.LITLINNUM3,
          LQAI.LITLINNUM4,
          LQAI.LITLINNUM5,
          LQAI.LITLINNUM6,
          LQAI.LITLINNUM7,
          LQAI.LITLINNUM8,
          LQAI.LITLINNUM9,
          LQAI.LITLINNUM10,
          LQAI.LITLINANUM1,
          LQAI.LITLINANUM2,
          LQAI.LITLINANUM3,
          LQAI.LITLINANUM4,
          LQAI.LITLINANUM5,
          LQAI.LITLINANUM6,
          LQAI.LITLINANUM7,
          LQAI.LITLINANUM8,
          LQAI.LITLINANUM9,
          LQAI.LITLINANUM10,
          CASE WHEN ULT.IDASPECTO IS NOT NULL THEN '1' ELSE '0' END
     FROM LQ_ASPECTO LQA
          JOIN LQ_TARIFA LQT
             ON     LQT.IDTARIFA = LQA.IDTARIFA
                AND LQT.IDSUBTARIFA = LQA.IDSUBTARIFA
                AND LQT.EXTENSION = LQA.IDEXTENSION
          JOIN LQ_ASPECTO_IDIOMA LQAI
             ON     LQAI.IDTARIFA = LQA.IDTARIFA
                AND LQAI.IDSUBTARIFA = LQA.IDSUBTARIFA
                AND LQAI.IDEXTENSION = LQA.IDEXTENSION
                AND LQAI.IDASPECTO = LQA.IDASPECTO
          LEFT JOIN (  SELECT TMP.IDTARIFA,
                              TMP.IDSUBTARIFA,
                              TMP.IDEXTENSION,
                              MAX (TMP.IDASPECTO) IDASPECTO
                         FROM LQ_ASPECTO TMP
                     GROUP BY TMP.IDTARIFA, TMP.IDSUBTARIFA, TMP.IDEXTENSION) ULT
             ON     ULT.IDTARIFA = LQA.IDTARIFA
                AND ULT.IDSUBTARIFA = LQA.IDSUBTARIFA
                AND ULT.IDEXTENSION = LQA.IDEXTENSION
                AND ULT.IDASPECTO = LQA.IDASPECTO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_CENTROCOSTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_CENTROCOSTES (CODIGO, DESCRIPCION)
AS
   SELECT C.CODIGO, C.DESCRIPCION
     FROM LQ_CENTROCOSTE C;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_COEFSERVICIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_COEFSERVICIO
(
   CODIGO,
   DESCRIPCION,
   CODTIPOSERVICIO,
   SERVICIO,
   CODCOEFICIENTE,
   FECINIVIG,
   FECFINVIG,
   VALOR
)
AS
   SELECT LQ_COEFSERVICIO.CODIGO,
          LQ_COEFSERVICIO.DESCRIPCION,
          LQ_COEFSERVICIO.CODTIPOSERVICIO,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          LQ_COEFSERVICIO.CODCOEFICIENTE,
          LQ_COEFSERVICIO.FECINIVIG,
          LQ_COEFSERVICIO.FECFINVIG,
          LQ_COEFSERVICIO.VALOR
     FROM    LQ_COEFSERVICIO
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (LQ_COEFSERVICIO.CODTIPOSERVICIO = LQ_TIPO_SERVICIO.CODIGO)
    WHERE LQ_COEFSERVICIO.BAJA = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURACION_COLA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURACION_COLA
(
   CODPUE,
   NOMPUERTO,
   CODLOTE,
   FECINSERCION,
   FECINICIO,
   FECULTMOFIF,
   NIVSIMULACION,
   PORCEJECUCION,
   SERIESFACTURA,
   INDURGENTE,
   USRFACTURACION,
   CODIDIOMA,
   IDIOMA,
   IDBATCH,
   INDCANCELACION,
   OBSERVACIONES,
   NUMBORRADORES
)
AS
   SELECT LFC.CODPUELOTE,
          MPL.NOMBRE,
          LFC.CODLOTE,
          LFC.FECINSERCION,
          LFC.FECINICIO,
          LFC.FECULTMOFIF,
          DECODE (LFC.NIVSIMULACION, '-1', 'Facturar', 'Simular'),
          DECODE (LFC.PORCEJECUCION,
                  '-1', 'En Espera',
                  LFC.PORCEJECUCION || '%'),
          LFC.SERIESFACTURA,
          DECODE (LFC.INDURGENTE, '1', 'Si', 'No'),
          LFC.USRFACTURACION,
          LFC.CODIDIOMA,
          GI.DESCIDIOMA,
          LFC.IDBATCH,
          DECODE (LFC.INDCANCELACION, '1', 'Si', 'No'),
          LFL.OBSERVACIONES,
          LFL.NUMBORRADORES
     FROM LQ_FACTURACION_COLA LFC
          LEFT JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = LFC.CODPUELOTE
          LEFT JOIN GU_IDIOMA GI
             ON GI.CODIDIOMA = LFC.CODIDIOMA
          LEFT JOIN LQ_FACTURA_LOTE LFL
             ON LFL.CODPUELOTE = LFC.CODPUELOTE AND LFL.CODLOTE = LFC.CODLOTE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURAE_APERAK  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURAE_APERAK
(
   IDAPERAK,
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   MENSAJE,
   FUNCION,
   FECHA
)
AS
   SELECT "IDAPERAK",
          "CODPUEFACTURA",
          "CODSERFACTURA",
          "ANYOFACTURA",
          "NUMFACTURA",
          "MENSAJE",
          "FUNCION",
          "FECHA"
     FROM LQ_FACTURAE_APERAK;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURAE_APERAK_ERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURAE_APERAK_ERROR
(
   IDERROR,
   IDAPERAK,
   CODERROR,
   DESCERROR
)
AS
   SELECT "IDERROR",
          "IDAPERAK",
          "CODERROR",
          "DESCERROR"
     FROM LQ_FACTURAE_APERAK_ERROR;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURAE_INCID  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURAE_INCID
(
   CODINCIDENCIA,
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   FECFACTURA,
   CODTIPINCID,
   DESTIPINCID,
   FECINCIDENCIA,
   CODCLIENTE,
   NOMCLIENTE,
   CODPUELOTE,
   CODLOTE,
   DESCINCIDENCIA
)
AS
   SELECT FI.CODINCIDENCIA,
          FI.CODPUEFACTURA,
          FI.CODSERFACTURA,
          FI.ANYOFACTURA,
          FI.NUMFACTURA,
          F.FECFACTURA,
          FI.CODTIPINCID,
          FTI.DESTIPINCID,
          FI.FECINCIDENCIA,
          F.CODCLIENTE,
          F.NOMCLIENTE,
          F.CODPUELOTE,
          F.CODLOTE,
          FI.DESCINCIDENCIA
     FROM LQ_FACTURAE_INCID FI
          LEFT JOIN LQ_FACTURA F
             ON     FI.CODPUEFACTURA = F.CODPUEFACTURA
                AND FI.CODSERFACTURA = F.CODSERFACTURA
                AND FI.ANYOFACTURA = F.ANYOFACTURA
                AND FI.NUMFACTURA = F.NUMFACTURA
          LEFT JOIN LQ_FACTURAE_TIPO_INCID FTI
             ON FI.CODTIPINCID = FTI.CODTIPINCID;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURAS
(
   CODPUEFACTURA,
   NOMPUEFACTURA,
   ANYOFACTURA,
   CODSERFACTURA,
   NUMFACTURA,
   FECFACTURA,
   CODCLIENTE,
   NOMCLIENTE,
   DIRECCION,
   CODPOSTAL,
   POBLACION,
   PROVINCIA,
   PAIS,
   NIF,
   IMPBASE,
   IMPIVA,
   IMPTOTAL,
   CODPUELOTE,
   CODLOTE,
   CODESTFACTURA,
   DESESTFACTURA,
   CODPUEFACANULADA,
   CODSERFACANULADA,
   ANYOFACANULADA,
   NUMFACANULADA,
   CODPUEFACANULACION,
   CODSERFACANULACION,
   ANYOFACANULACION,
   NUMFACANULACION,
   PDFSIZE,
   CODPUENOTIF,
   ANYONOTIF,
   NUMNOTIF,
   CODTIPNOTIF,
   DESTIPNOTIF,
   INDTRASPASARSEDE,
   INDTRASPASOSEDE,
   FECTRASPASOSEDE,
   TASASTARIFAS,
   CODPUE,
   REFERENCIA,
   FACANULSERIETXT,
   FACANULANYOTXT,
   FACANULNUMTXT,
   INDFACTURAFACE
)
AS
   SELECT LQF.CODPUEFACTURA,
          MPL.NOMBRE,
          LQF.ANYOFACTURA,
          LQF.CODSERFACTURA,
          LQF.NUMFACTURA,
          LQF.FECFACTURA,
          LQF.CODCLIENTE,
          LQF.NOMCLIENTE,
          LQF.DIRECCION,
          LQF.CODPOSTAL,
          LQF.POBLACION,
          LQF.PROVINCIA,
          LQF.PAIS,
          LQF.NIF,
          LQF.IMPBASE,
          LQF.IMPIVA,
          LQF.IMPTOTAL,
          LQF.CODPUELOTE,
          LQF.CODLOTE,
          LQF.CODESTFACTURA,
          LQFE.DESESTFACTURA,
          LQF.CODPUEFACANULADA,
          LQF.CODSERFACANULADA,
          LQF.ANYOFACANULADA,
          LQF.NUMFACANULADA,
          LQF.CODPUEFACANULACION,
          LQF.CODSERFACANULACION,
          LQF.ANYOFACANULACION,
          LQF.NUMFACANULACION,
          NVL (LENGTH (LQF.PDFFACTURA), 0),
          LQF.CODPUENOTIF,
          LQF.ANYONOTIF,
          LQF.NUMNOTIF,
          LQF.CODTIPNOTIF,
          LTN.DESTIPNOTIF,
          LQF.INDTRASPASARSEDE,
          LQF.INDTRASPASOSEDE,
          LQF.FECTRASPASOSEDE,
          LQF.TASASTARIFAS,
          LQF.CODPUEFACTURA,
          LQF.REFERENCIA,
          LQF.FACANULSERIETXT,
          LQF.FACANULANYOTXT,
          LQF.FACANULNUMTXT,
          LQF.INDFACTURAFACE
     FROM LQ_FACTURA LQF
          JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = LQF.CODPUEFACTURA
          JOIN LQ_FACTURA_ESTADO LQFE
             ON LQFE.CODESTFACTURA = LQF.CODESTFACTURA
          LEFT JOIN LQ_TIPO_NOTIFICACION LTN
             ON LTN.CODTIPNOTIF = LQF.CODTIPNOTIF;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURA_INCID_SPYRO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURA_INCID_SPYRO
(
   CODINCIDENCIA,
   CODPUEFACTURA,
   CODSERFACTURA,
   ANYOFACTURA,
   NUMFACTURA,
   FECHA,
   DESCRIPCION,
   CODCLIENTE,
   NOMCLIENTE,
   CODPUELOTE,
   CODLOTE
)
AS
   SELECT FI.CODINCIDENCIA,
          FI.CODPUEFACTURA,
          FI.CODSERFACTURA,
          FI.ANYOFACTURA,
          FI.NUMFACTURA,
          FI.FECHA,
          FI.DESCRIPCION,
          F.CODCLIENTE,
          F.NOMCLIENTE,
          F.CODPUELOTE,
          F.CODLOTE
     FROM    LQ_FACTURA_INCIDENCIA_SPYRO FI
          LEFT JOIN
             LQ_FACTURA F
          ON     FI.CODPUEFACTURA = F.CODPUEFACTURA
             AND FI.CODSERFACTURA = F.CODSERFACTURA
             AND FI.ANYOFACTURA = F.ANYOFACTURA
             AND FI.NUMFACTURA = F.NUMFACTURA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURA_LOTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURA_LOTE
(
   CODPUELOTE,
   NOMPUERTO,
   CODLOTE,
   FECFACTURA,
   CODESTLOTE,
   FECINIPROCESO,
   FECFINPROCESO,
   FECVALIDACION,
   OBSERVACIONES,
   IMPBASE,
   IMPIVA,
   IMPTOTAL,
   NUMFACTURAS,
   NUMBORRADORES,
   INDINCULTEJECUCIO,
   DESESTLOTE,
   INDPDFRESUMEN,
   INDPDFFACTURAS,
   INDTRASPASARSEDE,
   FECULTTRASPASOSEDE,
   INDBLOQUEADO,
   CODPUE
)
AS
   SELECT LQFL.CODPUELOTE,
          MPL.NOMBRE,
          LQFL.CODLOTE,
          LQFL.FECFACTURA,
          LQFL.CODESTLOTE,
          LQFL.FECINIPROCESO,
          LQFL.FECFINPROCESO,
          LQFL.FECVALIDACION,
          LQFL.OBSERVACIONES,
          LQFL.IMPBASE,
          LQFL.IMPIVA,
          LQFL.IMPTOTAL,
          NVL (LQFL.NUMFACTURAS, 0),
          NVL (LQFL.NUMBORRADORES, 0),
          LQFL.INDINCULTEJECUCION,
          LQFEL.DESESTLOTE,
          DECODE (NVL (LENGTH (LQFLP.PDFRESUMEN), 0), 0, '0', '1'),
          DECODE (NVL (LENGTH (LQFLP.PDFFACTURAS), 0), 0, '0', '1'),
          LQFL.INDTRASPASARSEDE,
          LQFL.FECULTTRASPASOSEDE,
          CASE WHEN LQFL.INDBLOQUEADO = '1' THEN 'S' ELSE 'No' END,
          LQFL.CODPUELOTE
     FROM LQ_FACTURA_LOTE LQFL
          LEFT JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = LQFL.CODPUELOTE
          LEFT JOIN LQ_FACTURA_ESTADO_LOTE LQFEL
             ON LQFEL.CODESTLOTE = LQFL.CODESTLOTE
          LEFT JOIN LQ_FACTURA_LOTE_PDF LQFLP
             ON LQFLP.CODPUELOTE = LQFL.CODPUELOTE
                AND LQFLP.CODLOTE = LQFL.CODLOTE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURA_MOTIVO_ANUL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURA_MOTIVO_ANUL
(
   CODMOTANULACION,
   DESMOTANULACION
)
AS
   SELECT CODMOTANULACION, DESMOTANULACION FROM LQ_FACTURA_MOTIVO_ANULACION;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_FACTURA_SERIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_FACTURA_SERIE
(
   CODSERFACTURA,
   DESSERFACTURA,
   USADA
)
AS
   SELECT LQFS.CODSERFACTURA, LQFS.DESSERFACTURA, NVL (LQSFMC.USADA, 0)
     FROM    LQ_FACTURA_SERIE LQFS
          LEFT JOIN
             (  SELECT CODSERFACTURA, '1' USADA
                  FROM LQ_FACTURA_SERIE_NUMERACION
              GROUP BY CODSERFACTURA) LQSFMC
          ON LQSFMC.CODSERFACTURA = LQFS.CODSERFACTURA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_TARIFA_SERIE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_TARIFA_SERIE
(
   CODIGO,
   IDTARIFA,
   IDSUBTARIFA,
   IDEXTENSION,
   DESTARIFA,
   FECINIVIG,
   FECFINVIG,
   CODSERIEPOSITIVA,
   SERIEPOSITIVA,
   CODSERIENEGATIVA,
   SERIENEGATIVA,
   CODSERIEPOSITIVACONT,
   SERIEPOSITIVACONT,
   CODSERIENEGATIVACONT,
   SERIENEGATIVACONT
)
AS
   SELECT E.CODIGO,
          E.IDTARIFA,
          E.IDSUBTARIFA,
          E.IDEXTENSION,
          F.DESCRIPCION,
          E.FECINIVIG,
          E.FECFINVIG,
          E.CODSERIEPOSITIVA,
          SP.DESSERFACTURA,
          E.CODSERIENEGATIVA,
          SN.DESSERFACTURA,
          E.CODSERIEPOSITIVACONT,
          SPC.DESSERFACTURA,
          E.CODSERIENEGATIVACONT,
          SNC.DESSERFACTURA
     FROM LQ_TARIFA_SERIE E
          INNER JOIN LQ_TARIFA F
             ON     E.IDTARIFA = F.IDTARIFA
                AND E.IDSUBTARIFA = F.IDSUBTARIFA
                AND E.IDEXTENSION = F.EXTENSION
          INNER JOIN LQ_FACTURA_SERIE SP
             ON E.CODSERIEPOSITIVA = SP.CODSERFACTURA
          INNER JOIN LQ_FACTURA_SERIE SN
             ON E.CODSERIENEGATIVA = SN.CODSERFACTURA
          INNER JOIN LQ_FACTURA_SERIE SPC
             ON E.CODSERIEPOSITIVACONT = SPC.CODSERFACTURA
          INNER JOIN LQ_FACTURA_SERIE SNC
             ON E.CODSERIENEGATIVACONT = SNC.CODSERFACTURA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_LQ_TEXTOSBOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_LQ_TEXTOSBOR
(
   CODIGO,
   CODNEGOCIO,
   DESCRIPCION,
   CODSER,
   SERVICIO,
   OBSERVACIONES,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT LQ_TEXTOSBOR.CODIGO,
          LQ_TEXTOSBOR.CODNEGOCIO,
          LQ_TEXTOSBOR.DESCRIPCION,
          LQ_TEXTOSBOR.CODSER,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          LQ_TEXTOSBOR.OBSERVACIONES,
          LQ_TEXTOSBOR.FECINIVIG,
          LQ_TEXTOSBOR.FECFINVIG
     FROM    LQ_TEXTOSBOR
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (LQ_TEXTOSBOR.CODSER = LQ_TIPO_SERVICIO.CODIGO)
    WHERE LQ_TEXTOSBOR.BAJA = '0';


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MALLAAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MALLAAGUA
(
   CODIGO,
   CODPUE,
   DESPUE,
   FECINICIO,
   FECFIN,
   NOMBRE
)
AS
   SELECT M.CODIGO,
          M.CODPUE,
          P.NOMBRE,
          M.FECINICIO,
          M.FECFIN,
          M.NOMBRE
     FROM MALLAAGUA M INNER JOIN M_PUERTO_LOCAL P ON M.CODPUE = P.CODPUE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MALLAAGUACONTADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MALLAAGUACONTADOR
(
   CODIGO,
   CODMALLA,
   CODPUECONTADOR,
   CODCONTADOR,
   CONTADOR
)
AS
   SELECT M.CODIGO,
          M.CODMALLA,
          M.CODPUECONTADOR,
          M.CODCONTADOR,
          C.DESCRIPCION
     FROM    MALLAAGUA_CONTADOR M
          INNER JOIN
             M_CONTADOR C
          ON M.CODPUECONTADOR = C.CODPUE AND M.CODCONTADOR = C.NUMCON;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MAREAGEOGPUERTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MAREAGEOGPUERTOS
(
   CODIGO,
   CODAREA,
   AREA,
   CODPAIS,
   PAIS,
   CODPUE,
   PUERTO,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT E.CODIGO,
          E.CODAREA,
          A.DESCRIPCION,
          E.CODPAIS,
          P.NOMBRE,
          E.CODPUE,
          PU.NOMBRE,
          E.FECINIVIG,
          E.FECFINVIG
     FROM M_AREAGEOG_PUERTO E
          INNER JOIN M_AREA_GEOGRAFICA A
             ON (E.CODAREA = A.CODIGO)
          INNER JOIN M_PAIS P
             ON (E.CODPAIS = P.CODPAIS)
          INNER JOIN M_PUERTO PU
             ON (E.CODPAIS = PU.CODPAIS AND E.CODPUE = PU.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MAREAGEOGRAFICAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MAREAGEOGRAFICAS (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM M_AREA_GEOGRAFICA;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MAREAOPPE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MAREAOPPE (CODIGO, DESCRIPCION)
AS
   SELECT A.CODIGO, A.DESCRIPCION
     FROM M_AREAOPPE A;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MAREAOPPEPAIS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MAREAOPPEPAIS
(
   CODIGO,
   CODAREAOPPE,
   AREAOPPE,
   CODPAIS,
   PAIS,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT E.CODIGO,
          E.CODAREAOPPE,
          A.DESCRIPCION,
          E.CODPAIS,
          P.NOMBRE,
          E.FECINIVIG,
          E.FECFINVIG
     FROM M_AREAOPPE_PAIS E
          INNER JOIN M_AREAOPPE A
             ON E.CODAREAOPPE = A.CODIGO
          INNER JOIN M_PAIS P
             ON E.CODPAIS = P.CODPAIS;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MARINAATRAQUES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MARINAATRAQUES
(
   CODEXP,
   CODATRAQUE,
   FECINICIO,
   FECFIN,
   ESLORA,
   MANGA,
   TIPOPROPULSION,
   DESCTIPOPROPULSION,
   INDEXENTOT0,
   EXENTOT0,
   MATRICULAEMB,
   NOMBREEMB,
   JUSTIFEXENTOT0,
   INDFICHERO,
   FICHERO,
   NOMFICHERO,
   ANYO,
   INDPTOBASE,
   PTOBASE,
   INDEXENTOB5,
   EXENTOB5,
   JUSTIFEXENTOB5,
   TIPOATRAQUEB0,
   TIPOATRAQUEB5,
   TOTALOCUPB0,
   TOTALOCUPB5
)
AS
   SELECT M.CODEXP,
          M.CODATRAQUE,
          M.FECINICIO,
          M.FECFIN,
          M.ESLORA,
          M.MANGA,
          M.TIPOPROPULSION,
          P.DESCRIPCION,
          M.INDEXENTOT0,
          DECODE (M.INDEXENTOT0, '1', 'Si', 'No'),
          M.MATRICULAEMB,
          M.NOMBREEMB,
          M.JUSTIFEXENTOT0,
          M.INDFICHERO,
          DECODE (M.INDFICHERO, '1', 'Si', 'No'),
          M.NOMFICHERO,
          EXTRACT (YEAR FROM M.FECINICIO),
          M.INDPTOBASE,
          DECODE (M.INDPTOBASE, '1', 'Si', 'No'),
          M.INDEXENTOB5,
          DECODE (M.INDEXENTOB5, '1', 'Si', 'No'),
          M.JUSTIFEXENTOB5,
          CASE
             WHEN INDPTOBASE = '1'
                  AND ( (ESLORA >= 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA > 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Base General'
             WHEN INDPTOBASE = '1' AND (ESLORA < 9 AND TIPOPROPULSION = 'M')
             THEN
                'Base Pequea'
             WHEN INDPTOBASE = '0'
                  AND ( (ESLORA >= 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA > 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Transente General'
             WHEN INDPTOBASE = '0' AND (ESLORA < 9 AND TIPOPROPULSION = 'M')
             THEN
                'Transente Pequea'
          END
             AS TIPOATRAQUEB0,
          CASE
             WHEN INDPTOBASE = '1'
                  AND ( (ESLORA > 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA > 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Base General'
             WHEN INDPTOBASE = '1'
                  AND ( (ESLORA <= 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA <= 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Base Pequea'
             WHEN INDPTOBASE = '0'
                  AND ( (ESLORA > 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA > 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Transente General'
             WHEN INDPTOBASE = '0'
                  AND ( (ESLORA <= 9 AND TIPOPROPULSION = 'M')
                       OR (ESLORA <= 12 AND TIPOPROPULSION = 'V'))
             THEN
                'Transente Pequea'
          END
             AS TIPOATRAQUEB5,
          CASE
             WHEN INDPTOBASE = '1'
             THEN
                M.ESLORA * M.MANGA
             WHEN INDPTOBASE = '0'
             THEN
                ROUND (
                   M.ESLORA * M.MANGA
                   * ( (M.FECFIN - M.FECINICIO + 1)
                      / (SELECT ADD_MONTHS (TRUNC (M.FECINICIO, 'YYYY'), 12)
                                - TRUNC (M.FECINICIO, 'YYYY')
                           FROM DUAL)),
                   6)
          END
             AS TOTALOCUPB0,
          M.ESLORA * M.MANGA * (M.FECFIN - M.FECINICIO + 1)
     FROM    G5_MARINAATRAQUE M
          INNER JOIN
             TIPO_PROPULSION P
          ON M.TIPOPROPULSION = P.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MARINAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MARINAS
(
   CODEXP,
   CODPUE,
   DESPUE,
   CONCESIONARIO,
   CIFCONCESIONARIO,
   NOMBRECONCESIONARIO,
   CODAPSCTCONCESIONARIO,
   FECINICIO,
   FECFIN,
   FECULTLIQT0,
   FECULTLIQT5,
   PERIODICIDAD,
   DESCPERIODICIDAD,
   INDFINALIZADO,
   FINALIZADO,
   CODTIPOIVAB0,
   TIPOIVAB0,
   CODTIPOIVAB5,
   TIPOIVAB5,
   DESCRIPCION,
   GUIDSRV,
   INDZONA2,
   ZONA2
)
AS
   SELECT M.CODEXP,
          M.CODPUE,
          PU.NOMBRE,
          M.CONCESIONARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          M.FECINICIO,
          M.FECFIN,
          M.FECULTLIQT0,
          M.FECULTLIQT5,
          M.PERIODICIDAD,
          P.DESCRIPCION,
          M.INDFINALIZADO,
          DECODE (M.INDFINALIZADO, '1', 'Si', 'No'),
          M.CODTIPOIVAB0,
          TT0.DESCRIPCION,
          M.CODTIPOIVAB5,
          TT5.DESCRIPCION,
          M.DESCRIPCION,
          M.GUIDSRV,
          M.INDZONA2,
          DECODE (M.INDZONA2, '1', 'Si', 'No')
     FROM G5_MARINA M
          INNER JOIN M_PUERTO_LOCAL PU
             ON M.CODPUE = PU.CODPUE
          INNER JOIN M_USUARIO U
             ON M.CONCESIONARIO = U.CODUSUARIO
          INNER JOIN LQ_PERIODICIDAD P
             ON M.PERIODICIDAD = P.CODIGO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TT0
             ON TT0.CODIGO = M.CODTIPOIVAB0
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TT5
             ON TT5.CODIGO = M.CODTIPOIVAB5;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MBONIFICACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MBONIFICACION
(
   CODIGO,
   CODBONIFICACION,
   DESCRIPCION,
   FECINIVIG,
   FECFINVIG,
   PORCENTAJEBONIFICACION,
   TASATARIFA,
   TIPO245,
   INDVALORDEFECTO,
   VALORDEFECTO,
   INDT3TRAMOCOMPLETO,
   T3TRAMOCOMPLETO,
   INDAPLICAMUELLE,
   APLICAMUELLE,
   INDAPLICABUQUE,
   APLICABUQUE
)
AS
   SELECT B.CODIGO,
          B.CODBONIFICACION,
          B.DESCRIPCION,
          B.FECINIVIG,
          B.FECFINVIG,
          B.PORCENTAJEBONIFICACION,
          B.TASATARIFA,
          B.TIPO245,
          B.INDVALORDEFECTO,
          DECODE (B.INDVALORDEFECTO, '1', 'Si', 'No'),
          B.INDT3TRAMOCOMPLETO,
          DECODE (B.INDT3TRAMOCOMPLETO, '1', 'Si', 'No'),
          B.INDAPLICAMUELLE,
          DECODE (B.INDAPLICAMUELLE, '1', 'Si', 'No'),
          B.INDAPLICABUQUE,
          DECODE (B.INDAPLICABUQUE, '1', 'Si', 'No')
     FROM M_BONIFICACION B;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MBUQUEBONIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MBUQUEBONIF
(
   CODIGO,
   CODBUQUE,
   BUQUE,
   IMO,
   FECINICIO,
   FECFIN,
   IDBONIFICACION,
   CODBONIFICACION,
   BONIFICACION,
   PORCENTAJEBONIFICACION
)
AS
   SELECT E.CODIGO,
          E.CODBUQUE,
          B.NOMBRE,
          B.CODIMO,
          E.FECINICIO,
          E.FECFIN,
          E.IDBONIFICACION,
          BON.CODBONIFICACION,
          BON.DESCRIPCION,
          E.PORCBONIFICACION
     FROM M_BUQUEBONIF E
          INNER JOIN M_BUQUE B
             ON E.CODBUQUE = B.CODBUQUE
          INNER JOIN M_BONIFICACION BON
             ON E.IDBONIFICACION = BON.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MBUQUEVERSION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MBUQUEVERSION
(
   CODBUQUE,
   VERSION,
   FECINIVIG,
   FECFINVIG,
   IMO,
   NOMBRE,
   GT,
   ARMADOR,
   CODTIPOBUQUE,
   TIPOBUQUE,
   CALMAXIMO,
   MANGA,
   ESLORATOTAL,
   POTENCIA,
   TPM,
   TBR,
   CODBANDERA,
   BANDERA,
   INDMERCANTE,
   MERCANTE,
   ESTCODTIPBUQOPPE,
   ESTTIPBUQOPPE,
   INDRORO,
   RORO,
   INDPDTEREV,
   INDGNL,
   OBSERVACIONES
)
AS
   SELECT M_BUQUE.CODBUQUE,
          M_BUQUEVERSION.VERSION,
          M_BUQUEVERSION.FECINIVIG,
          M_BUQUEVERSION.FECFINVIG,
          M_BUQUE.CODIMO,
          M_BUQUE.NOMBRE,
          M_BUQUEVERSION.GT,
          M_USUARIO.NOMBRECOMPLETO,
          M_BUQUEVERSION.CODTIPOBUQUE,
          TIPO_BUQUE.DESCRIPCION,
          M_BUQUEVERSION.CALMAXIMO,
          M_BUQUEVERSION.MANGA,
          M_BUQUEVERSION.ESLORATOTAL,
          M_BUQUEVERSION.POTENCIA,
          M_BUQUEVERSION.TPM,
          M_BUQUEVERSION.TRB,
          M_BUQUEVERSION.BANDERA,
          M_PAIS.NOMBRE,
          TIPO_BUQUEOPPE.INDMERCANTE,
          DECODE (TIPO_BUQUEOPPE.INDMERCANTE, '1', 'Si', 'No'),
          TIPO_BUQUE.CODTIPOOPPE,
          TIPO_BUQUEOPPE.DESCRIPCION,
          TIPO_BUQUEOPPE.INDRORO,
          DECODE (TIPO_BUQUEOPPE.INDRORO, '1', 'Si', 'No'),
          DECODE (M_BUQUE.INDPDTEREV, '1', 'Si', 'No'),
          DECODE (M_BUQUEVERSION.INDGNL, '1', 'Si', 'No'),
          M_BUQUEVERSION.OBSERVACIONES
     FROM M_BUQUEVERSION
          INNER JOIN M_BUQUE
             ON M_BUQUEVERSION.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN TIPO_BUQUE
             ON (M_BUQUEVERSION.CODTIPOBUQUE = TIPO_BUQUE.CODTIPOBUQUE)
          LEFT JOIN M_PAIS
             ON (M_BUQUEVERSION.BANDERA = M_PAIS.CODPAIS)
          LEFT JOIN M_USUARIO
             ON (M_BUQUEVERSION.CODARMADOR = M_USUARIO.CODUSUARIO)
          INNER JOIN TIPO_BUQUEOPPE
             ON (TIPO_BUQUEOPPE.CODIGO = TIPO_BUQUE.CODTIPOOPPE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MEMBARCACIONCERT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MEMBARCACIONCERT
(
   CODIGO,
   FECINICIO,
   FECFIN,
   DOCJUSTIFICATIVO,
   NOMBRE,
   MATRICULA,
   ESLORA,
   MANGA,
   PROPIETARIO,
   DESCPROPIETARIO,
   CIFPROPIETARIO,
   CODAPSCTPROPIETARIO,
   CODEMBARCACION
)
AS
   SELECT C.CODIGO,
          C.FECINICIO,
          C.FECFIN,
          C.DOCJUSTIFICATIVO,
          E.NOMBRE,
          E.MATRICULA,
          E.ESLORA,
          E.MANGA,
          E.PROPIETARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          C.CODEMBARCACION
     FROM M_EMBARCACIONCERT C
          INNER JOIN M_EMBARCACION E
             ON E.CODIGO = C.CODEMBARCACION
          INNER JOIN M_USUARIO U
             ON E.PROPIETARIO = U.CODUSUARIO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MENCOARRI  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MENCOARRI
(
   CODIGO,
   CODSIME,
   FECRECEPCION,
   CODPUE,
   DESPUE,
   NUMESCALA,
   IMOBUQUE,
   NOMBREBUQUE,
   TIPOOPERACION,
   DESCTIPOOPERACION,
   CODTERMINAL,
   DESCTERMINAL,
   INDBAJA,
   BAJA,
   FECBAJA,
   NUMVIAJEBUQUE,
   CODLINEA,
   CALLSIGNBUQUE,
   NACIONALIDADBUQUE,
   CODPAICARGA,
   CODPUECARGA,
   CODPAIDESCARGA,
   CODPUEDESCARGA,
   FECLLEGADA,
   FECSALIDA,
   TIPOENTIDAD,
   IDENTIDAD,
   NUMCNHUERFANO,
   NUMROROHUERFANO,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCT,
   NUMCNIFCVACSINMATRIC,
   NUMROROIFCVACSINMATRIC
)
AS
   SELECT MC.CODIGO,
          MC.CODSIME,
          MC.FECRECEPCION,
          MC.CODPUE,
          P.NOMBRE,
          MC.NUMESCALA,
          MC.IMOBUQUE,
          MC.NOMBREBUQUE,
          MC.TIPOOPERACION,
          DECODE (MC.TIPOOPERACION,  '270', 'Carga',  '98', 'Descarga'),
          MC.CODTERMINAL,
          MC.DESCTERMINAL,
          MC.INDBAJA,
          DECODE (MC.INDBAJA, '1', 'Si', 'No'),
          MC.FECBAJA,
          MC.NUMVIAJEBUQUE,
          MC.CODLINEA,
          MC.CALLSIGNBUQUE,
          MC.NACIONALIDADBUQUE,
          MC.CODPAICARGA,
          MC.CODPUECARGA,
          MC.CODPAIDESCARGA,
          MC.CODPUEDESCARGA,
          MC.FECLLEGADA,
          MC.FECSALIDA,
          MC.TIPOENTIDAD,
          MC.IDENTIDAD,
          MC.NUMCNHUERFANO,
          MC.NUMROROHUERFANO,
          MC.CODPUEESC,
          MC.ANYOESC,
          MC.CODESC,
          E.CODCONSIGNATARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          MC.NUMCNIFCVACSINMATRIC,
          MC.NUMROROIFCVACSINMATRIC
     FROM MEN_COARRI MC
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = MC.CODPUE)
          INNER JOIN ESCALA E
             ON (    E.CODPUE = MC.CODPUEESC
                 AND E.ANYO = MC.ANYOESC
                 AND E.CODESCALA = MC.CODESC)
          INNER JOIN M_USUARIO U
             ON (E.CODCONSIGNATARIO = U.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MEN_COARRIDETALLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MEN_COARRIDETALLE
(
   CODMENSAJE,
   CODIGO,
   CODARMADOR,
   ARMADOR,
   CODARMADORNOTIP,
   INDARMADORNOTIP,
   ARMADORNOTIP,
   CODCALIFEQUIP,
   DESCTIPEQUIP,
   CODTIPOTAMEQUIP,
   DESCTIPTAMEQUIP,
   MATRICULA,
   NUMEROBL,
   LLENOVACIO,
   ESTADO,
   NUMEROBOOKING,
   MATVEHICULO,
   FECHACARDES,
   UBICACIONDES,
   TIPOENTIDADDES,
   IDENTIDADDES,
   CODPAI1,
   CODPUE1,
   CODPAI2,
   CODPUE2,
   UBICACIONCAR,
   TIPOENTIDADCAR,
   IDENTIDADCAR,
   CODPAI3,
   CODPUE3,
   CODPAI4,
   CODPUE4,
   TIPOPESO,
   UNIDADPESO,
   VALORPESO,
   TEMPERATURA,
   TEMPERATURAUND,
   TEMPERATURAMIN,
   TEMPERATURAMAX,
   TEMPERATURARANGOUND,
   IDCONSIGNATARIO,
   NOMBRECOMPLETO,
   NUMDOC,
   CODAPSCT,
   NUMTRAMOSIME,
   NUMVERSION,
   NUMESCALA,
   NOMBREBUQUE,
   OPERACION,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODCONSIGNATARIO,
   CONSIGNATARIO,
   CIFCONSIGNATARIO,
   CODIGOAPSCTCONSIGNATARIO
)
AS
   SELECT EQUIP.CODMENSAJE,
          EQUIP.CODIGO,
          EQUIP.CODARMADOR,
          AR.NOMBRE,
          EQUIP.CODARMADORNOTIP,
          EQUIP.INDARMADORNOTIP,
          DECODE (EQUIP.INDARMADORNOTIP, '1', 'Si', 'No'),
          EQUIP.CODCALIFEQUIP,
          TIPEQUIP.CODIGO || ' - ' || TIPEQUIP.DESCRIPCION,
          EQUIP.CODTIPOTAMEQUIP,
          TIPTAMEQUIP.DESCRIPCION,
          EQUIP.MATRICULA,
          EQUIP.NUMEROBL,
          DECODE (EQUIP.LLENOVACIO,  '4', 'Vacio',  '5', 'Lleno',  NULL),
          DECODE (EQUIP.ESTADO,
                  '2', 'Exportacion',
                  '3', 'Importacion',
                  '6', 'Transbordo(en la misma instalacion)',
                  '61', 'Transbordo(entre dos terminales)',
                  NULL),
          EQUIP.NUMEROBOOKING,
          EQUIP.MATVEHICULO,
          EQUIP.FECHACARDES,
          EQUIP.UBICACIONDES,
          EQUIP.TIPOENTIDADDES,
          EQUIP.IDENTIDADDES,
          EQUIP.CODPAI1,
          EQUIP.CODPUE1,
          EQUIP.CODPAI2,
          EQUIP.CODPUE2,
          EQUIP.UBICACIONCAR,
          EQUIP.TIPOENTIDADCAR,
          EQUIP.IDENTIDADCAR,
          EQUIP.CODPAI3,
          EQUIP.CODPUE3,
          EQUIP.CODPAI4,
          EQUIP.CODPUE4,
          EQUIP.TIPOPESO,
          EQUIP.UNIDADPESO,
          EQUIP.VALORPESO,
          EQUIP.TEMPERATURA,
          EQUIP.TEMPERATURAUND,
          EQUIP.TEMPERATURAMIN,
          EQUIP.TEMPERATURAMAX,
          EQUIP.TEMPERATURARANGOUND,
          T.IDCONSIGNATARIO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          T.NUMTRAMOSIME,
          T.NUMVERSION,
          M.NUMESCALA,
          M.NOMBREBUQUE,
          DECODE (M.TIPOOPERACION,  '270', 'Carga',  '98', 'Descarga'),
          M.CODPUEESC,
          M.ANYOESC,
          M.CODESC,
          E.CODCONSIGNATARIO,
          C.NOMBRECOMPLETO,
          C.NUMDOC || C.LETRANIF,
          C.CODAPSCT
     FROM MEN_COARRIDETALLE EQUIP
          INNER JOIN MEN_COARRI M
             ON M.CODIGO = EQUIP.CODMENSAJE
          LEFT JOIN M_ARMADORCONTENEDOR AR
             ON AR.CODIGO = EQUIP.CODARMADOR
          INNER JOIN G3_TIPOEQUIP TIPEQUIP
             ON TIPEQUIP.CODIGO = EQUIP.CODCALIFEQUIP
          LEFT JOIN G3_TIPOTAMEQUIP TIPTAMEQUIP
             ON TIPTAMEQUIP.CODIGO = EQUIP.CODTIPOTAMEQUIP
          LEFT JOIN G3_TRAMO T
             ON     T.CODPUE = EQUIP.CODPUEEQUIPIFC
                AND T.ANYO = EQUIP.ANYEQUIPIFC
                AND T.CODSER = EQUIP.CODSEREQUIPIFC
                AND T.CODTRAMO = EQUIP.CODTRAMOEQUIPIFC
          LEFT JOIN M_USUARIO U
             ON T.IDCONSIGNATARIO = U.CODUSUARIO
          INNER JOIN ESCALA E
             ON (    E.CODPUE = M.CODPUEESC
                 AND E.ANYO = M.ANYOESC
                 AND E.CODESCALA = M.CODESC)
          INNER JOIN M_USUARIO C
             ON (E.CODCONSIGNATARIO = C.CODUSUARIO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MEN_COARRIDETALLE_ADIC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MEN_COARRIDETALLE_ADIC
(
   CODMENSAJE,
   CODEQUIP,
   CODIGO,
   CALIFICADOR,
   EQUIPOID
)
AS
   SELECT ADIC.CODMENSAJE,
          ADIC.CODEQUIP,
          ADIC.CODIGO,
          ADIC.CALIFICADOR,
          ADIC.EQUIPOID
     FROM MEN_COARRIDETALLE_ADIC ADIC;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MEN_COARRIDETALLE_ENTI  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MEN_COARRIDETALLE_ENTI
(
   CODMENSAJE,
   CODEQUIP,
   CODIGO,
   TIPOENTIDAD,
   IDENTIDAD
)
AS
   SELECT ENTI.CODMENSAJE,
          ENTI.CODEQUIP,
          ENTI.CODIGO,
          ENTI.TIPOENTIDAD,
          ENTI.IDENTIDAD
     FROM MEN_COARRIDETALLE_ENTI ENTI;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MEN_COARRIDETALLE_INFO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MEN_COARRIDETALLE_INFO
(
   CODMENSAJE,
   CODEQUIP,
   CODIGO,
   TIPOINFO,
   INSTRUCCION,
   OBSERVACIONES
)
AS
   SELECT INFO.CODMENSAJE,
          INFO.CODEQUIP,
          INFO.CODIGO,
          INFO.TIPOINFO,
          INFO.INSTRUCCION,
          INFO.OBSERVACIONES
     FROM MEN_COARRIDETALLE_INFO INFO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MERCANCIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MERCANCIAS
(
   CODARAN,
   DESCRIPCION,
   CODGRUPO,
   DESCGRUPOMERC,
   OBSERVACIONES,
   DESCAMPLIADA,
   CODSUBGRUPONATURALEZA,
   NATURALEZA,
   ESTINDINSTALESPECIAL,
   ESTINSTALESPECIAL,
   ESTCODMERC43,
   ESTMERC43,
   ESTCODTUCAOPPE,
   ESTTUCAOPPE,
   VERSION,
   FECINIVIG,
   FECFINVIG,
   EXENTOLIQ,
   ESTEXENTA
)
AS
   SELECT MER.CODARAN,
          MER.DESCRIPCION,
          MER.CODGRUPO,
          GRUP.DESCRIPCION AS DESCGRUPOMERC,
          MER.OBSERVACIONES,
          MER.DESCAMPLIADA,
          MER.CODSUBGRUPONATURALEZA,
          NAT.DESCRIPCION,
          MER.ESTINDINSTALESPECIAL,
          DECODE (MER.ESTINDINSTALESPECIAL, '1', 'Si', 'No'),
          MER.ESTCODMERC43,
          MER43.DESCRIPCION,
          MER.ESTCODTUCAOPPE,
          TUCA.DESCRIPCION,
          MER.VERSION,
          MER.FECINIVIG,
          MER.FECFINVIG,
          DECODE (MER.INDEXENTOLIQ, '1', 'Si', 'No'),
          DECODE (MER.ESTINDEXENTA, '1', 'Si', 'No')
     FROM M_MERCANCIA MER
          LEFT JOIN G3_GRUPOMERCANCIA GRUP
             ON GRUP.CODIGO = MER.CODGRUPO
          LEFT JOIN EST_SUBGRUPO_NATURALEZA NAT
             ON NAT.CODIGO = MER.CODSUBGRUPONATURALEZA
          LEFT JOIN EST_TIPOMERC43 MER43
             ON MER43.CODIGO = MER.ESTCODMERC43
          LEFT JOIN EST_TUCAOPPE TUCA
             ON TUCA.CODIGO = MER.ESTCODTUCAOPPE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MERCANCIASPESOVEHIC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MERCANCIASPESOVEHIC
(
   CODIGO,
   CODARAN,
   DESCRIPCION,
   FECINICIO,
   FECFIN,
   MEDIA,
   LIMINF,
   LIMSUP
)
AS
   SELECT MP.CODIGO,
          MP.CODARAN,
          M.DESCRIPCION,
          MP.FECINICIO,
          MP.FECFIN,
          MP.MEDIA,
          MP.LIMINF,
          MP.LIMSUP
     FROM    M_MERCANCIAPESOVEHIC MP
          INNER JOIN
             M_MERCANCIA M
          ON (M.CODARAN = MP.CODARAN
              AND (MP.FECINICIO BETWEEN M.FECINIVIG AND M.FECFINVIG
                   OR (MP.FECINICIO >= M.FECINIVIG AND M.FECFINVIG IS NULL)));


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MINSTALESPECIAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MINSTALESPECIAL (CODIGO, DESCRIPCION)
AS
   SELECT I.CODIGO, I.DESCRIPCION
     FROM M_INSTALESPECIAL I;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MMUELLEBONIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MMUELLEBONIF
(
   CODIGO,
   CODMUELLE,
   MUELLE,
   CODPUE,
   DESPUE,
   FECINICIO,
   FECFIN,
   IDBONIFICACION,
   CODBONIFICACION,
   BONIFICACION,
   PORCENTAJEBONIFICACION
)
AS
   SELECT E.CODIGO,
          E.CODMUELLE,
          B.DESCRIPCION,
          B.CODPUE,
          P.NOMBRE,
          E.FECINICIO,
          E.FECFIN,
          E.IDBONIFICACION,
          BON.CODBONIFICACION,
          BON.DESCRIPCION,
          E.PORCBONIFICACION
     FROM M_MUELLEBONIF E
          INNER JOIN M_MUELLE B
             ON E.CODMUELLE = B.CODIGO
          INNER JOIN M_PUERTO_LOCAL P
             ON P.CODPUE = B.CODPUE
          INNER JOIN M_BONIFICACION BON
             ON E.IDBONIFICACION = BON.CODIGO;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MOTIVOVERSIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MOTIVOVERSIONES
(
   CODIGO,
   DESCRIPCION,
   AMBITO
)
AS
   SELECT M_MOTIVOVERSION.CODIGO,
          M_MOTIVOVERSION.DESCRIPCION,
          DECODE (M_MOTIVOVERSION.AMBITO,
                  'E', 'Escalas',
                  'T', 'Tramos',
                  'A', 'Escalas y Tramos')
     FROM M_MOTIVOVERSION;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MRECEPTORMERCANCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MRECEPTORMERCANCIA (CODIGO, NOMBRE)
AS
   SELECT R.CODIGO, R.NOMBRE
     FROM M_RECEPTOR_MERCANCIA R;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MUELLES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MUELLES
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   CALADO,
   CONCESIONADO,
   LONGITUD,
   ANCHO,
   NORAYINI,
   NORAYFIN,
   CODZONAAGUA,
   INDRAMPAASOCIADA,
   INDFONDEO,
   CODMUELLEIZQUIERDA,
   CODMUELLEDERECHA,
   DIRECNORAYS,
   DIRECCIONNORAYS,
   ESTINDINSTALESPECIAL,
   ESTINSTALESPECIAL,
   INDCONCT3,
   CONCT3,
   CODCENTROCOSTE,
   CENTROCOSTE,
   CODZONAMUELLE,
   ZONAMUELLE,
   CODTIPCONCT2,
   TIPCONCT2,
   CODEDI,
   INDNOOPEAIS,
   NOOPEAIS
)
AS
   SELECT M_MUELLE.CODIGO,
          M_MUELLE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_MUELLE.DESCRIPCION,
          M_MUELLE.CALADO,
          TIPO_CONCESIONMUELLE.DESCRIPCION,
          M_MUELLE.LONGITUD,
          M_MUELLE.ANCHO,
          M_MUELLE.NORAYINI,
          M_MUELLE.NORAYFIN,
          M_MUELLE.CODZONAAGUA,
          DECODE (M_MUELLE.INDRAMPA, '1', 'Si', 'No'),
          DECODE (M_MUELLE.INDFONDEO, '1', 'Si', 'No'),
          M_MUELLE.CODMUELLEIZQUIERDA,
          M_MUELLE.CODMUELLEDERECHA,
          M_MUELLE.DIRECNORAYS,
          TIPODIRECNORAY.DESCRIPCION,
          M_MUELLE.ESTINDINSTALESPECIAL,
          DECODE (M_MUELLE.ESTINDINSTALESPECIAL, '1', 'Si', 'No'),
          M_MUELLE.INDCONCT3,
          TIPO_CONCESIONB3.DESCRIPCION,
          M_MUELLE.CODCENTROCOSTE,
          LQ_CENTROCOSTE.DESCRIPCION,
          M_MUELLE.CODZONAMUELLE,
          M_ZONAMUELLE.DESCRIPCION,
          M_MUELLE.CODTIPCONCT2,
          TIPO_CONCESIONB2.DESCRIPCION,
          M_MUELLE.CODEDI,
          M_MUELLE.INDNOOPEAIS,
          DECODE (M_MUELLE.INDNOOPEAIS, '1', 'Si', 'No')
     FROM M_MUELLE
          INNER JOIN M_PUERTO_LOCAL
             ON (M_MUELLE.CODPUE = M_PUERTO_LOCAL.CODPUE)
          INNER JOIN TIPO_CONCESIONMUELLE
             ON (M_MUELLE.CODTIPCONCESION = TIPO_CONCESIONMUELLE.CODIGO)
          LEFT JOIN TIPODIRECNORAY
             ON (M_MUELLE.DIRECNORAYS = TIPODIRECNORAY.CODIGO)
          LEFT JOIN LQ_CENTROCOSTE
             ON (M_MUELLE.CODCENTROCOSTE = LQ_CENTROCOSTE.CODIGO)
          LEFT JOIN M_ZONAMUELLE
             ON (M_MUELLE.CODZONAMUELLE = M_ZONAMUELLE.CODIGO)
          LEFT JOIN TIPO_CONCESIONB2
             ON (M_MUELLE.CODTIPCONCT2 = TIPO_CONCESIONB2.CODIGO)
          LEFT JOIN TIPO_CONCESIONB3
             ON (M_MUELLE.INDCONCT3 = TIPO_CONCESIONB3.CODIGO);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_MZONAMUELLE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_MZONAMUELLE
(
   CODIGO,
   DESCRIPCION,
   CODPUE,
   DESPUE
)
AS
   SELECT E.CODIGO,
          E.DESCRIPCION,
          E.CODPUE,
          P.NOMBRE
     FROM M_ZONAMUELLE E INNER JOIN M_PUERTO_LOCAL P ON (E.CODPUE = P.CODPUE);


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_M_BUQUES_ART194  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_BUQUES_ART194
(
   CODIGO,
   FECINI,
   FECFIN,
   IDBUQUE,
   BUQUE
)
AS
   SELECT M_BUQUE_ART194.CODIGO,
          M_BUQUE_ART194.FECINI,
          M_BUQUE_ART194.FECFIN,
          M_BUQUE_ART194.IDBUQUE,
          M_BUQUE.NOMBRE
     FROM    M_BUQUE_ART194
          INNER JOIN
             M_BUQUE
          ON M_BUQUE_ART194.IDBUQUE = M_BUQUE.CODBUQUE;


/* Formatted on 03/06/2016 9:02:49 (QP5 v5.139.911.3011) */
--
-- V_TC_M_DOMICILIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_DOMICILIO
(
   CODUSUARIO,
   CODDOMICILIO,
   CODPAI,
   PAIS,
   CODPROVINCIA,
   PROVINCIA,
   CODPROVPOB,
   CODPOB,
   POBLACION,
   PROVEXT,
   POBEXT,
   CP,
   CODSIG,
   TIPOVIA,
   DIRECCION,
   NUMPOR,
   ESCALERA,
   NUMPISO,
   NUMPUERTA,
   TELPARTICULAR,
   TELMOVIL,
   TELTRABAJO,
   FAX,
   EMAIL,
   INDDOMNOTIF,
   INDDOMFISCAL,
   OBSERVACIONES,
   CODPUE,
   PUERTO,
   PERCON
)
AS
   SELECT D.CODUSUARIO,
          D.CODDOMICILIO,
          D.CODPAI,
          PAIS.NOMBRE AS PAIS,
          D.CODPROVINCIA,
          PROV.NOMBRE AS PROVINCIA,
          D.CODPROVPOB,
          D.CODPOB,
          POBL.NOMBRE AS POBLACION,
          D.PROVEXT,
          D.POBEXT,
          D.CP,
          D.CODSIG,
          DS.DESCRIPCION AS TIPOVIA,
          D.DIRECCION,
          D.NUMPOR,
          D.ESCALERA,
          D.NUMPISO,
          D.NUMPUERTA,
          D.TELPARTICULAR,
          D.TELMOVIL,
          D.TELTRABAJO,
          D.FAX,
          D.EMAIL,
          DECODE (D.INDDOMNOTIF, '1', 'Si', 'No'),
          DECODE (D.INDDOMFISCAL, '1', 'Si', 'No'),
          D.OBSERVACIONES,
          D.CODPUE,
          PUERTO.NOMBRE AS PUERTO,
          D.PERCON
     FROM M_DOMICILIO D
          LEFT JOIN M_PUERTO_LOCAL PUERTO
             ON D.CODPUE = PUERTO.CODPUE
          LEFT JOIN M_PAIS PAIS
             ON D.CODPAI = PAIS.CODPAIS
          LEFT JOIN M_PROVINCIA PROV
             ON D.CODPROVINCIA = PROV.CODPROVINCIA
          LEFT JOIN M_POBLACION POBL
             ON D.CODPROVINCIA = POBL.CODPROVINCIA AND D.CODPOB = POBL.CODPOB
          LEFT JOIN M_DOMICILIO_SIGLAS DS
             ON D.CODSIG = DS.CODSIG
    WHERE INDDOMNOTIF = '1';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_M_DOMICILIOGLOBAL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_DOMICILIOGLOBAL
(
   CODUSUARIO,
   CODDOMICILIO,
   CODPAI,
   PAIS,
   CODPROVINCIA,
   PROVINCIA,
   CODPROVPOB,
   CODPOB,
   POBLACION,
   PROVEXT,
   POBEXT,
   CP,
   CODSIG,
   TIPOVIA,
   DIRECCION,
   NUMPOR,
   ESCALERA,
   NUMPISO,
   NUMPUERTA,
   TELPARTICULAR,
   TELMOVIL,
   TELTRABAJO,
   FAX,
   EMAIL,
   INDDOMNOTIF,
   INDDOMFISCAL,
   OBSERVACIONES,
   CODPUE,
   PUERTO,
   PERCON,
   NOMBRE,
   TIPODOC,
   NUMDOC,
   INDBAJA,
   BAJA
)
AS
   SELECT D.CODUSUARIO,
          D.CODDOMICILIO,
          D.CODPAI,
          PAIS.NOMBRE AS PAIS,
          D.CODPROVINCIA,
          PROV.NOMBRE AS PROVINCIA,
          D.CODPROVPOB,
          D.CODPOB,
          POBL.NOMBRE AS POBLACION,
          D.PROVEXT,
          D.POBEXT,
          D.CP,
          D.CODSIG,
          DS.DESCRIPCION AS TIPOVIA,
          D.DIRECCION,
          D.NUMPOR,
          D.ESCALERA,
          D.NUMPISO,
          D.NUMPUERTA,
          D.TELPARTICULAR,
          D.TELMOVIL,
          D.TELTRABAJO,
          D.FAX,
          D.EMAIL,
          DECODE (D.INDDOMNOTIF, '1', 'Si', 'No'),
          DECODE (D.INDDOMFISCAL, '1', 'Si', 'No'),
          D.OBSERVACIONES,
          D.CODPUE,
          PUERTO.NOMBRE AS PUERTO,
          D.PERCON,
          U.NOMBRECOMPLETO,
          TD.DESCRIPCION,
          U.NUMDOC || U.LETRANIF,
          U.INDBAJA,
          DECODE (U.INDBAJA, '1', 'Si', 'No')
     FROM M_DOMICILIO D
          LEFT JOIN M_USUARIO U
             ON (U.CODUSUARIO = D.CODUSUARIO)
          INNER JOIN TIPO_DOCUMENTO TD
             ON (U.CODTIPODOCUMENTO = TD.CODIGO)
          LEFT JOIN M_PUERTO_LOCAL PUERTO
             ON D.CODPUE = PUERTO.CODPUE
          LEFT JOIN M_PAIS PAIS
             ON D.CODPAI = PAIS.CODPAIS
          LEFT JOIN M_PROVINCIA PROV
             ON D.CODPROVINCIA = PROV.CODPROVINCIA
          LEFT JOIN M_POBLACION POBL
             ON D.CODPROVINCIA = POBL.CODPROVINCIA AND D.CODPOB = POBL.CODPOB
          LEFT JOIN M_DOMICILIO_SIGLAS DS
             ON D.CODSIG = DS.CODSIG;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_M_MAQUINARIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_MAQUINARIA
(
   IDMAQUINA,
   CODPUE,
   NOMPUERTO,
   REFERENCIA,
   DESCMAQUINA,
   CODCENTROCOSTE,
   DESCRIPCION,
   IDTIPOMAQUINARIA,
   DESCTIPOMAQUINARIA,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF,
   INDBAJA,
   FECBAJA
)
AS
   SELECT M.IDMAQUINA,
          M.CODPUE,
          PU.NOMBRE AS NOMPUERTO,
          M.REFERENCIA,
          M.DESCMAQUINA,
          M.CODCENTROCOSTE,
          LQ.DESCRIPCION,
          M.IDTIPOMAQUINARIA,
          MT.DESCTIPOMAQUINARIA,
          M.FECALTA,
          M.USRALTA,
          M.FECMODIF,
          M.USRMODIF,
          M.INDBAJA,
          M.FECBAJA
     FROM M_MAQUINARIA M,
          SGC_MAQUINARIA_TIPO MT,
          LQ_CENTROCOSTE LQ,
          M_PUERTO_LOCAL PU
    WHERE     M.CODPUE = PU.CODPUE
          AND M.IDTIPOMAQUINARIA = MT.IDTIPOMAQUINARIA
          AND M.CODCENTROCOSTE = LQ.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_M_USUARIO_CONTACTO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_USUARIO_CONTACTO
(
   CODUSUARIO,
   CODCONTACTO,
   NOMBRE,
   CARGO,
   DIRECCION,
   EMAIL,
   TELEFONO,
   OBSERVACIONES,
   PUERTOS
)
AS
   SELECT USU.CODUSUARIO,
          USU.CODCONTACTO,
          USU.NOMBRE,
          USU.CARGO,
          USU.DIRECCION,
          USU.EMAIL,
          USU.TELEFONO,
          USU.OBSERVACIONES,
          USU.PUERTOS
     FROM M_USUARIO_CONTACTO USU;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_M_USUARIO_CUENTAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_USUARIO_CUENTAS
(
   CODUSUARIO,
   CODCUENTA,
   CODBANCO,
   NOMBANCO,
   CODSUCURSAL,
   NOMSUCURSAL,
   DC,
   NUMCTA,
   DESCRIPCION,
   OBSERVACIONES
)
AS
   SELECT C.CODUSUARIO,
          C.CODCUENTA,
          C.CODBANCO,
          B.NOMBRE AS NOMBANCO,
          C.CODSUCURSAL,
          S.NOMBRE AS NOMSUCURSAL,
          C.DC,
          C.NUMCTA,
          C.DESCRIPCION,
          C.OBSERVACIONES
     FROM M_USUARIO_CUENTAS C, M_BANCO B, M_SUCURSAL S
    WHERE C.CODBANCO = B.CODBANCO AND C.CODSUCURSAL = S.CODSUCURSAL;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_M_USUARIO_SUBCUENTA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_M_USUARIO_SUBCUENTA
(
   IDSUBCUENTA,
   CODUSUARIO,
   SUBCUENTA,
   FECINIVIG,
   FECFINVIG
)
AS
   SELECT IDSUBCUENTA,
          CODUSUARIO,
          SUBCUENTA,
          FECINIVIG,
          FECFINVIG
     FROM M_USUARIO_SUBCUENTA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_NAVIERAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_NAVIERAS
(
   CODIGO,
   NOMBRE,
   CIF,
   IDCLIENTE,
   NOMBRECOMPLETO,
   CODAPSCT,
   NUMDOC,
   OBSERVACIONES,
   IMOREGOWNER,
   CODNAVIERAPORTEL
)
AS
   SELECT M_NAVIERA.CODIGO,
          M_NAVIERA.NOMBRE,
          M_NAVIERA.CIF,
          M_NAVIERA.IDCLIENTE,
          M_USUARIO.NOMBRECOMPLETO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC,
          M_NAVIERA.OBSERVACIONES,
          M_NAVIERA.IMOREGOWNER,
          M_NAVIERA.CODNAVIERAPORTEL
     FROM    M_NAVIERA
          LEFT JOIN
             M_USUARIO
          ON M_USUARIO.CODUSUARIO = M_NAVIERA.IDCLIENTE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_NORAYS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_NORAYS
(
   CODPUE,
   DESPUE,
   CODMUELLE,
   MUELLE,
   CODIGO,
   CALADO
)
AS
   SELECT N.CODPUE,
          P.NOMBRE,
          N.CODMUELLE,
          M.DESCRIPCION,
          N.CODIGO,
          N.CALADO
     FROM M_NORAY N
          INNER JOIN M_PUERTO_LOCAL P
             ON P.CODPUE = N.CODPUE
          INNER JOIN M_MUELLE M
             ON M.CODIGO = N.CODMUELLE
    WHERE BAJA = '0';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_NOTIFICACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_NOTIFICACIONES
(
   CODPUENOTIF,
   DESPUENOTIF,
   ANYONOTIF,
   NUMNOTIF,
   CODUSUARIO,
   NOMUSUARIO,
   IMPTOTAL,
   CODTIPNOTIF,
   DESTIPNOTIF,
   CODPUEPRONOTIF,
   SECPRONOTIF,
   DIRTIPOVIA,
   DIRNOMVIA,
   DIRNUMPORTAL,
   DIRESCALERA,
   DIRPISO,
   DIRPUERTA,
   DIRPAIS,
   DIRPROVINCIA,
   DIRMUNICIPIO,
   DIRCODPOSTAL,
   CODPUE
)
AS
   SELECT LN.CODPUENOTIF,
          MPL.NOMBRE,
          LN.ANYONOTIF,
          LN.NUMNOTIF,
          LN.CODUSUARIO,
          MU.NOMBRECOMPLETO,
          LN.IMPTOTAL,
          LN.CODTIPNOTIF,
          LTN.DESTIPNOTIF,
          LN.CODPUEPRONOTIF,
          LN.SECPRONOTIF,
          LN.DIRTIPOVIA,
          LN.DIRNOMVIA,
          LN.DIRNUMPORTAL,
          LN.DIRESCALERA,
          LN.DIRPISO,
          LN.DIRPUERTA,
          LN.DIRPAIS,
          LN.DIRPROVINCIA,
          LN.DIRMUNICIPIO,
          LN.DIRCODPOSTAL,
          LN.CODPUENOTIF
     FROM LQ_NOTIFICACION LN
          JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = LN.CODPUENOTIF
          LEFT JOIN M_USUARIO MU
             ON MU.CODUSUARIO = LN.CODUSUARIO
          LEFT JOIN LQ_TIPO_NOTIFICACION LTN
             ON LTN.CODTIPNOTIF = LN.CODTIPNOTIF
--LEFT JOIN LQ_NOTIFICACION_PROCESO LNP
--   ON LNP.CODPUEPRONOTIF=LN.CODPUEPRONOTIF AND LNP.SECPRONOTIF=LN.SECPRONOTIF
;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_NOTIFICACION_INCID  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_NOTIFICACION_INCID
(
   CODPUEPRONOTIF,
   SECPRONOTIF,
   SECINCIDENCIA,
   CODPUEFACTURA,
   ANYOFACTURA,
   CODSERFACTURA,
   NUMFACTURA,
   CODTIPINCIDNOTIF,
   DESTIPINCIDNOTIF,
   DESCINCIDENCIA
)
AS
   SELECT LNI.CODPUEPRONOTIF,
          LNI.SECPRONOTIF,
          LNI.SECINCIDENCIA,
          LNI.CODPUEFACTURA,
          LNI.ANYOFACTURA,
          LNI.CODSERFACTURA,
          LNI.NUMFACTURA,
          LNI.CODTIPINCIDNOTIF,
          LNIT.DESTIPINCIDNOTIF,
          LNI.DESCINCIDENCIA
     FROM    LQ_NOTIFICACION_INCID LNI
          JOIN
             LQ_NOTIF_INCID_TIPO LNIT
          ON LNIT.CODTIPINCIDNOTIF = LNI.CODTIPINCIDNOTIF;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_NOVEDADRODANTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_NOVEDADRODANTES
(
   CODIGO,
   DESCRIPCION,
   FECHA,
   CODPUE,
   DESPUE,
   INDBAJA,
   BAJA,
   FECBAJA,
   USRBAJA,
   INDALTATABLET,
   ALTATABLET
)
AS
   SELECT N.CODIGO,
          N.DESCRIPCION,
          N.FECHA,
          N.CODPUE,
          P.NOMBRE,
          N.INDBAJA,
          DECODE (N.INDBAJA, '1', 'Si', 'No'),
          N.FECBAJA,
          N.USRBAJA,
          N.INDALTATABLET,
          DECODE (N.INDALTATABLET, '1', 'Si', 'No')
     FROM    NOVEDAD_RODANTE N
          INNER JOIN
             M_PUERTO_LOCAL P
          ON (N.CODPUE = P.CODPUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OCUPSUPBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OCUPSUPBUQUE
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   FECINI,
   FECFIN,
   CODTIPOOPERACION,
   INDFINALIZADO,
   FINALIZADO,
   FECULTLIQ,
   OBSERVACIONES,
   IDCLIENTE,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   TIPOOPERACION,
   CODZONA,
   ZONA,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CODTIPOIVA,
   TIPOIVA,
   CODTIPOALM,
   TIPOALM,
   CODEXENHORAS,
   EXENHORAS,
   INDLIQUIDADO,
   GUIDSRV,
   MOTEXENTOLIQ,
   CODIMO,
   BUQUE
)
AS
   SELECT OCUPSUPBUQUE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          OCUPSUPBUQUE.ANYO,
          OCUPSUPBUQUE.CODSER,
          OCUPSUPBUQUE.CODPUEESC,
          OCUPSUPBUQUE.ANYOESC,
          OCUPSUPBUQUE.CODESC,
          ESCALA.NUMESCALA,
          OCUPSUPBUQUE.CODESTADIA,
          OCUPSUPBUQUE.FECINI,
          OCUPSUPBUQUE.FECFIN,
          OCUPSUPBUQUE.CODTIPOOPERACION,
          OCUPSUPBUQUE.INDFINALIZADO,
          DECODE (OCUPSUPBUQUE.INDFINALIZADO, '1', 'Si', 'No'),
          OCUPSUPBUQUE.FECULTLIQ,
          OCUPSUPBUQUE.OBSERVACIONES,
          OCUPSUPBUQUE.IDCLIENTE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          OCUPSUP_TIPOOPE.DESCRIPCION,
          OCUPSUPBUQUE.CODZONA,
          M_ZONAOCUP.DESCRIPCION,
          OCUPSUPBUQUE.INDEXENTOLIQ,
          DECODE (OCUPSUPBUQUE.INDEXENTOLIQ, '1', 'Si', 'No'),
          OCUPSUPBUQUE.CODTIPOIVA,
          LQ_TIPO_IMPUESTOGLOBAL.DESCRIPCION,
          OCUPSUPBUQUE.CODTIPOALM,
          OCUPSUP_TIPOALM.DESCRIPCION,
          OCUPSUPBUQUE.CODEXENHORAS,
          OCUPSUP_EXENHORAS.DESCRIPCION,
          CASE
             WHEN INDLIQUIDADO = '1' THEN '1'
             WHEN FECULTLIQ IS NOT NULL THEN '1'
             ELSE '0'
          END,
          OCUPSUPBUQUE.GUIDSRV,
          OCUPSUPBUQUE.MOTEXENTOLIQ,
          M_BUQUE.CODIMO,
          M_BUQUE.NOMBRE
     FROM OCUPSUPBUQUE
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = OCUPSUPBUQUE.CODPUEESC
                 AND ESCALA.ANYO = OCUPSUPBUQUE.ANYOESC
                 AND ESCALA.CODESCALA = OCUPSUPBUQUE.CODESC)
          LEFT JOIN M_BUQUE
             ON (M_BUQUE.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = OCUPSUPBUQUE.CODPUEESC
                 AND ESTADIA.ANYO = OCUPSUPBUQUE.ANYOESC
                 AND ESTADIA.CODESCALA = OCUPSUPBUQUE.CODESC
                 AND ESTADIA.CODESTADIA = OCUPSUPBUQUE.CODESTADIA)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = OCUPSUPBUQUE.CODPUE)
          LEFT JOIN M_USUARIO
             ON (OCUPSUPBUQUE.IDCLIENTE = M_USUARIO.CODUSUARIO)
          LEFT JOIN OCUPSUP_TIPOOPE
             ON (OCUPSUP_TIPOOPE.CODIGO = OCUPSUPBUQUE.CODTIPOOPERACION)
          LEFT JOIN M_ZONAOCUP
             ON (M_ZONAOCUP.CODPUE = OCUPSUPBUQUE.CODPUEZONA
                 AND M_ZONAOCUP.CODZONA = OCUPSUPBUQUE.CODZONA)
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL
             ON (LQ_TIPO_IMPUESTOGLOBAL.CODIGO = OCUPSUPBUQUE.CODTIPOIVA)
          LEFT JOIN OCUPSUP_TIPOALM
             ON (OCUPSUP_TIPOALM.CODIGO = OCUPSUPBUQUE.CODTIPOALM)
          LEFT JOIN OCUPSUP_EXENHORAS
             ON (OCUPSUP_EXENHORAS.CODIGO = OCUPSUPBUQUE.CODEXENHORAS)
    WHERE (OCUPSUPBUQUE.CODTIPOEMBARQUE IS NULL
           OR OCUPSUPBUQUE.CODTIPOEMBARQUE != 'Z');


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OCUPSUPBUQUEROD  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OCUPSUPBUQUEROD
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   FECINI,
   FECFIN,
   CODTIPOEMBARQUE,
   CODTIPOOPERACION,
   INDRORO,
   RORO,
   INDFINALIZADO,
   FINALIZADO,
   FECULTLIQ,
   GUIDSRV,
   OBSERVACIONES,
   INDNOMERCANCIA,
   NOMERCANCIA,
   IDCLIENTE,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   INDUNALIQ,
   UNALIQ,
   TIPOEMBARQUE,
   TIPOOPERACION,
   CODZONA,
   ZONA,
   INDLIQUIDADO,
   LIQUIDADO,
   INDEXENTOLIQ,
   EXENTOLIQ,
   INDTABLET,
   TABLET,
   INDSINELEMRODMAESTRO,
   SINELEMRODMAESTRO,
   MATRICULATABLET,
   FECMEDIDATABLET,
   FECCAPTMEDIDATABLET,
   CODTIPOELEMRODTABLET,
   TIPOELEMRODTABLET
)
AS
   SELECT OCUPSUPBUQUE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          OCUPSUPBUQUE.ANYO,
          OCUPSUPBUQUE.CODSER,
          OCUPSUPBUQUE.CODPUEESC,
          OCUPSUPBUQUE.ANYOESC,
          OCUPSUPBUQUE.CODESC,
          ESCALA.NUMESCALA,
          OCUPSUPBUQUE.CODESTADIA,
          OCUPSUPBUQUE.FECINI,
          OCUPSUPBUQUE.FECFIN,
          OCUPSUPBUQUE.CODTIPOEMBARQUE,
          OCUPSUPBUQUE.CODTIPOOPERACION,
          OCUPSUPBUQUE.INDRORO,
          DECODE (OCUPSUPBUQUE.INDRORO, '1', 'Si', 'No'),
          OCUPSUPBUQUE.INDFINALIZADO,
          DECODE (OCUPSUPBUQUE.INDFINALIZADO, '1', 'Si', 'No'),
          OCUPSUPBUQUE.FECULTLIQ,
          OCUPSUPBUQUE.GUIDSRV,
          OCUPSUPBUQUE.OBSERVACIONES,
          OCUPSUPBUQUE.INDNOMERCANCIA,
          DECODE (OCUPSUPBUQUE.INDNOMERCANCIA, '1', 'Si', 'No'),
          OCUPSUPBUQUE.IDCLIENTE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          OCUPSUPBUQUE.INDUNALIQ,
          DECODE (OCUPSUPBUQUE.INDUNALIQ, '1', 'Si', 'No'),
          OCUPSUP_TIPOEMB.DESCRIPCION,
          OCUPSUP_TIPOOPE.DESCRIPCION,
          OCUPSUPBUQUE.CODZONA,
          M_ZONAOCUP.DESCRIPCION,
          OCUPSUPBUQUE.INDLIQUIDADO,
          DECODE (OCUPSUPBUQUE.INDLIQUIDADO, '1', 'Si', 'No'),
          OCUPSUPBUQUE.INDEXENTOLIQ,
          DECODE (OCUPSUPBUQUE.INDEXENTOLIQ, '1', 'Si', 'No'),
          OCUPSUPBUQUE.INDTABLET,
          DECODE (OCUPSUPBUQUE.INDTABLET, '1', 'Si', 'No'),
          OCUPSUPBUQUE.INDSINELEMRODMAESTRO,
          DECODE (OCUPSUPBUQUE.INDSINELEMRODMAESTRO, '1', 'Si', 'No'),
          OCUPSUPBUQUE.MATRICULATABLET,
          OCUPSUPBUQUE.FECMEDIDATABLET,
          OCUPSUPBUQUE.FECCAPTMEDIDATABLET,
          OCUPSUPBUQUE.CODTIPOELEMRODTABLET,
          TIPO_ELEM_RODANTE_TABLET.DESCRIPCION
     FROM OCUPSUPBUQUE
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = OCUPSUPBUQUE.CODPUEESC
                 AND ESCALA.ANYO = OCUPSUPBUQUE.ANYOESC
                 AND ESCALA.CODESCALA = OCUPSUPBUQUE.CODESC)
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = OCUPSUPBUQUE.CODPUEESC
                 AND ESTADIA.ANYO = OCUPSUPBUQUE.ANYOESC
                 AND ESTADIA.CODESCALA = OCUPSUPBUQUE.CODESC
                 AND ESTADIA.CODESTADIA = OCUPSUPBUQUE.CODESTADIA)
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = OCUPSUPBUQUE.CODPUE)
          LEFT JOIN M_USUARIO
             ON (OCUPSUPBUQUE.IDCLIENTE = M_USUARIO.CODUSUARIO)
          LEFT JOIN OCUPSUP_TIPOOPE
             ON (OCUPSUP_TIPOOPE.CODIGO = OCUPSUPBUQUE.CODTIPOOPERACION)
          LEFT JOIN OCUPSUP_TIPOEMB
             ON (OCUPSUP_TIPOEMB.CODIGO = OCUPSUPBUQUE.CODTIPOEMBARQUE)
          LEFT JOIN M_ZONAOCUP
             ON (M_ZONAOCUP.CODPUE = OCUPSUPBUQUE.CODPUEZONA
                 AND M_ZONAOCUP.CODZONA = OCUPSUPBUQUE.CODZONA)
          LEFT JOIN TIPO_ELEM_RODANTE_TABLET
             ON (OCUPSUPBUQUE.CODTIPOELEMRODTABLET =
                    TIPO_ELEM_RODANTE_TABLET.CODIGO)
    WHERE OCUPSUPBUQUE.CODTIPOEMBARQUE = 'Z';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OCUPSUPBUQUE_LECTURA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OCUPSUPBUQUE_LECTURA
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   FECLEC,
   NUMM2,
   OBSERVACIONES
)
AS
   SELECT OCUPSUPBUQUE_LECTURA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          OCUPSUPBUQUE_LECTURA.ANYO,
          OCUPSUPBUQUE_LECTURA.CODSER,
          OCUPSUPBUQUE_LECTURA.FECLEC,
          OCUPSUPBUQUE_LECTURA.NUMM2,
          OCUPSUPBUQUE_LECTURA.OBSERVACIONES
     FROM    OCUPSUPBUQUE_LECTURA
          LEFT JOIN
             M_PUERTO_LOCAL
          ON (M_PUERTO_LOCAL.CODPUE = OCUPSUPBUQUE_LECTURA.CODPUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OCUPSUPRODANTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OCUPSUPRODANTE
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   FECINI,
   FECFIN,
   OBSERVACIONES,
   IDCLIENTE,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   CODZONA,
   ZONA,
   INDEXENTOLIQ,
   EXENTOLIQ,
   CODTIPOIVA,
   TIPOIVA,
   INDLIQUIDADO,
   LIQUIDADO,
   GUIDSRV,
   MOTEXENTOLIQ,
   IDBONIFICACION,
   CODBONIFICACION,
   BONIFICACION,
   PORCBONIFICACION,
   CODTIPORODANTE,
   TIPORODANTE,
   INDBONIF,
   BONIF,
   UNIDADES,
   NUMDIAS
)
AS
   SELECT OCUPSUP_RODANTE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          OCUPSUP_RODANTE.ANYO,
          OCUPSUP_RODANTE.CODSER,
          OCUPSUP_RODANTE.FECINI,
          OCUPSUP_RODANTE.FECFIN,
          OCUPSUP_RODANTE.OBSERVACIONES,
          OCUPSUP_RODANTE.IDCLIENTE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          OCUPSUP_RODANTE.CODZONA,
          M_ZONAOCUP.DESCRIPCION,
          OCUPSUP_RODANTE.INDEXENTOLIQ,
          DECODE (OCUPSUP_RODANTE.INDEXENTOLIQ, '1', 'Si', 'No'),
          OCUPSUP_RODANTE.CODTIPOIVA,
          LQ_TIPO_IMPUESTOGLOBAL.DESCRIPCION,
          OCUPSUP_RODANTE.INDLIQUIDADO,
          DECODE (OCUPSUP_RODANTE.INDLIQUIDADO, '1', 'Si', 'No'),
          OCUPSUP_RODANTE.GUIDSRV,
          OCUPSUP_RODANTE.MOTEXENTOLIQ,
          OCUPSUP_RODANTE.CODBONIFICACION,
          M_BONIFICACION.CODBONIFICACION,
          M_BONIFICACION.DESCRIPCION,
          OCUPSUP_RODANTE.PORCBONIFICACION,
          OCUPSUP_RODANTE.CODTIPORODANTE,
          OCUPSUP_TIPORODANTE.DESCRIPCION,
          OCUPSUP_RODANTE.INDBONIF,
          DECODE (OCUPSUP_RODANTE.INDBONIF, '1', 'Si', 'No'),
          OCUPSUP_RODANTE.UNIDADES,
          OCUPSUP_RODANTE.NUMDIAS
     FROM OCUPSUP_RODANTE
          INNER JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = OCUPSUP_RODANTE.CODPUE)
          LEFT JOIN M_USUARIO
             ON (OCUPSUP_RODANTE.IDCLIENTE = M_USUARIO.CODUSUARIO)
          LEFT JOIN M_ZONAOCUP
             ON (M_ZONAOCUP.CODPUE = OCUPSUP_RODANTE.CODPUEZONA
                 AND M_ZONAOCUP.CODZONA = OCUPSUP_RODANTE.CODZONA)
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL
             ON (LQ_TIPO_IMPUESTOGLOBAL.CODIGO = OCUPSUP_RODANTE.CODTIPOIVA)
          INNER JOIN OCUPSUP_TIPORODANTE
             ON (OCUPSUP_TIPORODANTE.CODIGO = OCUPSUP_RODANTE.CODTIPORODANTE)
          LEFT JOIN M_BONIFICACION
             ON (M_BONIFICACION.CODIGO = OCUPSUP_RODANTE.CODBONIFICACION);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OPERACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OPERACIONES
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   FECINI,
   FECFIN,
   CODTIPOPE,
   TIPOPERACION,
   CODTIPCARGA,
   TIPOCARGA,
   CANTIDAD,
   INDLIQUIDADO,
   LIQUIDADO,
   IDSUJPASIVO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   DIAINI,
   HORAINI,
   DIAFIN,
   HORAFIN,
   INDRECJORNLAB,
   FECFINOPMAYORESCALA,
   INDEXENTOLIQ,
   EXENTOLIQ,
   NUMKGGASOIL,
   NUMKGDIESEL,
   NUMKGFUELOIL,
   NUMKGACEITES,
   CODPUECONTADOR,
   CODCONTADOR,
   CONTADOR,
   LECINICIAL,
   LECFINAL
)
AS
   SELECT OPERACION.CODPUE,
          OPERACION.ANYO,
          OPERACION.CODESCALA,
          OPERACION.CODESTADIA,
          operacion.codoperacion,
          OPERACION.FECINI,
          OPERACION.FECFIN,
          TIPO_OPERACION.CODTIPOPE,
          TIPO_OPERACION.NOMBRE,
          TIPO_CARGA_OPERACION.CODTIPCARGA,
          TIPO_CARGA_OPERACION.NOMBRE,
          OPERACION.NUMUNIDADES,
          OPERACION.INDLIQUIDADO,
          DECODE (OPERACION.INDLIQUIDADO, '1', 'Si', 'No'),
          OPERACION.IDSUJPASIVO,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          TO_CHAR (OPERACION.FECINI, 'dd/MM/rrrr'),
          TO_CHAR (OPERACION.FECINI, 'HH24:mi'),
          TO_CHAR (OPERACION.FECFIN, 'dd/MM/rrrr'),
          TO_CHAR (OPERACION.FECFIN, 'HH24:mi'),
          CASE
             WHEN OPERACION.CODTIPOPE <> '10' THEN NULL
             ELSE DECODE (OPERACION.INDRECJORNLAB, '1', 'Si', 'No')
          END,
          CASE
             WHEN ESCALA.FECFINREAL IS NULL THEN NULL
             WHEN OPERACION.FECFIN > ESCALA.FECFINREAL THEN 'Si'
             ELSE 'No'
          END,
          OPERACION.INDEXENTOLIQ,
          DECODE (OPERACION.INDEXENTOLIQ, '1', 'Si', 'No'),
          OPERACION.NUMKGGASOIL,
          OPERACION.NUMKGDIESEL,
          OPERACION.NUMKGFUELOIL,
          OPERACION.NUMKGACEITES,
          OPERACION.CODPUECONTADOR,
          OPERACION.NUMCONTADOR,
          M_CONTADOR.DESCRIPCION,
          OPERACION.LECINICIAL,
          OPERACION.LECFINAL
     FROM operacion
          INNER JOIN tipo_operacion
             ON OPERACION.CODTIPOPE = TIPO_OPERACION.CODTIPOPE
          LEFT JOIN tipo_carga_operacion
             ON operacion.codtipcarga = TIPO_CARGA_OPERACION.CODTIPCARGA
          LEFT JOIN M_USUARIO
             ON OPERACION.IDSUJPASIVO = M_USUARIO.CODUSUARIO
          INNER JOIN ESCALA
             ON     ESCALA.CODPUE = OPERACION.CODPUE
                AND ESCALA.ANYO = OPERACION.ANYO
                AND ESCALA.CODESCALA = OPERACION.CODESCALA
          LEFT JOIN M_CONTADOR
             ON OPERACION.CODPUECONTADOR = M_CONTADOR.CODPUE
                AND OPERACION.NUMCONTADOR = M_CONTADOR.NUMCON
    WHERE INDDUE = '0';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_OPERACIONESDUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_OPERACIONESDUE
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   CODTIPOPE,
   NUMESCALA,
   CODIMO,
   BUQUE,
   GT,
   ESLORA,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   CODMUELLEINIREAL,
   TIPOPERACION,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   FECINI,
   FECFIN,
   UNIDADES,
   DIAINI,
   HORAINI,
   DIAFIN,
   HORAFIN,
   CODTIPCARGA,
   TIPCARGA,
   CODTIPUNIDAD,
   TIPUNIDAD,
   PESOMAXPORUNIDAD,
   CODOPERACIONDUE
)
AS
   SELECT OPERACION.CODPUE,
          OPERACION.ANYO,
          OPERACION.CODESCALA,
          OPERACION.CODESTADIA,
          OPERACION.CODOPERACION,
          TIPO_OPERACION.CODTIPOPE,
          ESCALA.NUMESCALA,
          BU.CODIMO,
          BU.NOMBRE,
          BV.GT,
          BV.ESLORATOTAL,
          ESTADIA.FECATRAQUEREAL,
          ESTADIA.FECDESATRAQUEREAL,
          ESTADIA.CODMUELLEINIREAL,
          TIPO_OPERACION.NOMBRE,
          M_USUARIO.CODAPSCT,
          M_USUARIO.NUMDOC || M_USUARIO.LETRANIF,
          M_USUARIO.NOMBRECOMPLETO,
          OPERACION.FECINI,
          OPERACION.FECFIN,
          OPERACION.NUMUNIDADES,
          TO_CHAR (OPERACION.FECINI, 'dd/MM/rrrr'),
          TO_CHAR (OPERACION.FECINI, 'HH24:mi'),
          TO_CHAR (OPERACION.FECFIN, 'dd/MM/rrrr'),
          TO_CHAR (OPERACION.FECFIN, 'HH24:mi'),
          OPERACION.CODTIPCARGA,
          TIPO_CARGA_OPERACION.NOMBRE,
          OPERACION.CODTIPUNIDAD,
          TIPO_UNIDAD_OPERACION.NOMBRE,
          OPERACION.PESOMAXPORUNIDAD,
          OPERACION.CODOPERACIONDUE
     FROM OPERACION
          INNER JOIN TIPO_OPERACION
             ON OPERACION.CODTIPOPE = TIPO_OPERACION.CODTIPOPE
          INNER JOIN ESCALA
             ON (    OPERACION.CODPUE = ESCALA.CODPUE
                 AND OPERACION.ANYO = ESCALA.ANYO
                 AND OPERACION.CODESCALA = ESCALA.CODESCALA)
          INNER JOIN ESTADIA
             ON (    ESCALA.CODPUE = ESTADIA.CODPUE
                 AND ESCALA.ANYO = ESTADIA.ANYO
                 AND ESCALA.CODESCALA = ESTADIA.CODESCALA
                 AND OPERACION.CODESTADIA = ESTADIA.CODESTADIA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = ESCALA.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG >=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG <=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN M_USUARIO
             ON OPERACION.IDSUJPASIVO = M_USUARIO.CODUSUARIO
          LEFT JOIN TIPO_CARGA_OPERACION
             ON OPERACION.CODTIPCARGA = TIPO_CARGA_OPERACION.CODTIPCARGA
          LEFT JOIN TIPO_UNIDAD_OPERACION
             ON OPERACION.CODTIPUNIDAD = TIPO_UNIDAD_OPERACION.CODTIPUNIDAD
    WHERE TIPO_OPERACION.INDDUE = '1';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PAISES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PAISES (CODPAIS, NOMBRE, CODPAIFAC)
AS
   SELECT CODPAIS, NOMBRE, CODPAIFAC FROM M_PAIS;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PAISESUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PAISESUE
(
   CODIGO,
   IDPAIS,
   PAIS,
   FECINICIO,
   FECFIN
)
AS
   SELECT M_PAISUE.CODIGO,
          M_PAISUE.IDPAIS,
          M_PAIS.NOMBRE,
          M_PAISUE.FECINICIO,
          M_PAISUE.FECFIN
     FROM M_PAISUE INNER JOIN M_PAIS ON (M_PAISUE.IDPAIS = M_PAIS.CODPAIS);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PANTALANES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PANTALANES
(
   CODPAN,
   CODINS,
   CODPUE,
   DESPUE,
   CODAPSCT,
   CODAPSCTINS,
   NOMBRE,
   INDAGUA,
   AGUA,
   INDELECTRICIDAD,
   ELECTRICIDAD
)
AS
   SELECT P.CODPAN,
          P.CODINS,
          P.CODPUE,
          PU.NOMBRE,
          P.CODAPSCT,
          I.CODAPSCT,
          I.NOMBRE,
          I.INDAGUA,
          DECODE (I.INDAGUA, '1', 'Si', 'No'),
          I.INDELECTRICIDAD,
          DECODE (I.INDELECTRICIDAD, '1', 'Si', 'No')
     FROM M_PANTALAN P
          INNER JOIN M_INSTALACION I
             ON I.CODINS = P.CODINS
          INNER JOIN M_PUERTO_LOCAL PU
             ON P.CODPUE = PU.CODPUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMCODARAN2453  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMCODARAN2453
(
   CODIGO,
   FECINIVIG,
   FECFINVIG,
   CODARAN,
   UNIDADESINI,
   UNIDADESFIN,
   TASATARIFA,
   CODBONIFICACION,
   PORCBONIF,
   BONIFICACION
)
AS
   SELECT P.CODIGO,
          P.FECINIVIG,
          P.FECFINVIG,
          P.CODARAN,
          P.UNIDADESINI,
          P.UNIDADESFIN,
          P.TASATARIFA,
          P.CODBONIFICACION,
          P.PORCBONIF,
          B.DESCRIPCION
     FROM    LQ_PARAMCODARAN2453 P
          LEFT JOIN
             M_BONIFICACION B
          ON (B.CODBONIFICACION = P.CODBONIFICACION
              AND ( (B.FECFINVIG IS NOT NULL
                     AND P.FECINIVIG BETWEEN B.FECINIVIG AND B.FECFINVIG)
                   OR (B.FECFINVIG IS NULL AND P.FECINIVIG >= B.FECINIVIG)))
    WHERE P.TASATARIFA = 'B3';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMCODARANT2  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMCODARANT2
(
   CODARAN,
   MERCANCIA,
   FECINIVIG,
   FECFINVIG,
   GRAVAMEN,
   DESCGRAVAMEN,
   VALOR
)
AS
   SELECT P.CODARAN,
          M.DESCRIPCION,
          P.FECINIVIG,
          P.FECFINVIG,
          P.GRAVAMEN,
          C.DESCRIPCION,
          C.VALOR
     FROM LQ_PARAMCODARANT2 P
          LEFT JOIN M_MERCANCIA M
             ON (M.CODARAN = P.CODARAN
                 AND ( (M.FECFINVIG IS NOT NULL
                        AND P.FECINIVIG BETWEEN M.FECINIVIG AND M.FECFINVIG)
                      OR (M.FECFINVIG IS NULL AND P.FECINIVIG >= M.FECINIVIG)))
          LEFT JOIN LQ_COEFSERVICIO C
             ON (C.CODCOEFICIENTE = P.GRAVAMEN
                 AND ( (C.FECFINVIG IS NOT NULL
                        AND P.FECINIVIG BETWEEN C.FECINIVIG AND C.FECFINVIG)
                      OR (C.FECFINVIG IS NULL AND P.FECINIVIG >= C.FECINIVIG)));


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMEQUIPT3  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMEQUIPT3
(
   CODIGO,
   FECINIVIG,
   FECFINVIG,
   TIPOEQUIP,
   TIPOISO,
   INICIOTIPOISO,
   REGIMEN,
   LLENOVACIO,
   GRAVAMEN,
   DESCGRAVAMEN,
   VALOR,
   DESCREGIMEN,
   DESCLLENOVACIO
)
AS
   SELECT P.CODIGO,
          P.FECINIVIG,
          P.FECFINVIG,
          P.TIPOEQUIP,
          P.TIPOISO,
          P.INICIOTIPOISO,
          P.REGIMEN,
          P.LLENOVACIO,
          P.GRAVAMEN,
          C.DESCRIPCION,
          C.VALOR,
          R.DESCRIPCION,
          LV.DESCRIPCION
     FROM LQ_PARAMEQUIPT3 P
          LEFT JOIN LQ_COEFSERVICIO C
             ON (C.CODCOEFICIENTE = P.GRAVAMEN
                 AND ( (C.FECFINVIG IS NOT NULL
                        AND P.FECINIVIG BETWEEN C.FECINIVIG AND C.FECFINVIG)
                      OR (C.FECFINVIG IS NULL AND P.FECINIVIG >= C.FECINIVIG)))
          LEFT JOIN G3_TIPOREGIMEN R
             ON (R.CODIGO = P.REGIMEN)
          LEFT JOIN G3_LLENOVACIO LV
             ON (LV.CODIGO = P.LLENOVACIO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMESTADISTICA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMESTADISTICA
(
   CODIGO,
   NOMBREREGLA,
   DESCRIPCIONREGLA,
   VALOR
)
AS
   SELECT P.CODIGO,
          P.NOMBREREGLA,
          P.DESCRIPCIONREGLA,
          P.VALOR
     FROM PARAM_ESTADISTICA P;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMVALORADOR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMVALORADOR
(
   CODIGO,
   NOMBREREGLA,
   DESCRIPCIONREGLA,
   VALORADORASOCIADO,
   VALOR,
   INDAP,
   AP
)
AS
   SELECT P.CODIGO,
          P.NOMBREREGLA,
          P.DESCRIPCIONREGLA,
          P.VALORADORASOCIADO,
          P.VALOR,
          P.INDAP,
          DECODE (P.INDAP, '1', 'Si', 'No')
     FROM PARAM_VALORADOR P
    WHERE BAJA = '0';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PARAMVEHICT3  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PARAMVEHICT3
(
   CODIGO,
   FECINIVIG,
   FECFINVIG,
   CODARAN
)
AS
   SELECT P.CODIGO,
          P.FECINIVIG,
          P.FECFINVIG,
          P.CODARAN
     FROM LQ_PARAMVEHICT3 P;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PASARELAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PASARELAS
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION
)
AS
   SELECT M_PASARELA.CODIGO,
          M_PASARELA.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          M_PASARELA.DESCRIPCION
     FROM M_PASARELA, M_PUERTO_LOCAL
    WHERE M_PASARELA.CODPUE = M_PUERTO_LOCAL.CODPUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PERFIL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PERFIL (CODPERFIL, NOMBRE, OBSERVACIONES)
AS
   SELECT CODPERFIL, NOMBRE, OBSERVACIONES FROM GU_PERFIL;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_POBLACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_POBLACION
(
   CODPROVINCIA,
   NOMPROV,
   CODPOB,
   NOMBRE
)
AS
   SELECT CE.CODPROVINCIA,
          MP.NOMBRE,
          CE.CODPOB,
          CE.NOMBRE
     FROM    M_POBLACION CE
          LEFT JOIN
             M_PROVINCIA MP
          ON CE.CODPROVINCIA = MP.CODPROVINCIA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PRACTICOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PRACTICOS
(
   CODIGO,
   NIF,
   NOMBRE,
   APELLIDOS
)
AS
   SELECT M_PRACTICO.CODIGO,
          M_PRACTICO.NIF,
          M_PRACTICO.NOMBRE,
          M_PRACTICO.APELLIDOS
     FROM M_PRACTICO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSCOARRI  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSCOARRI
(
   IDPROCESO,
   FECPROCESO,
   NUMERRORES,
   NUMCONTRASTES,
   ESTADO,
   DESESTADO
)
AS
   SELECT PROCESO_COARRI.IDPROCESO,
          PROCESO_COARRI.FECPROCESO,
          PROCESO_COARRI.NUMERRORES,
          PROCESO_COARRI.NUMCONTRASTES,
          PROCESO_COARRI.ESTADO,
          DECODE (PROCESO_COARRI.ESTADO,
                  'P', 'En proceso',
                  'F', 'Finalizado')
     FROM PROCESO_COARRI;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSCOARRIERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSCOARRIERROR
(
   IDPROCESO,
   IDERROR,
   DESCERROR,
   DESCTRAMO,
   CODPUE,
   ANYO,
   CODSER,
   CODTRAMO
)
AS
   SELECT PROCESO_COARRI_ERROR.IDPROCESO,
          PROCESO_COARRI_ERROR.IDERROR,
          PROCESO_COARRI_ERROR.DESCERROR,
          PROCESO_COARRI_ERROR.DESCTRAMO,
          PROCESO_COARRI_ERROR.CODPUE,
          PROCESO_COARRI_ERROR.ANYO,
          PROCESO_COARRI_ERROR.CODSER,
          PROCESO_COARRI_ERROR.CODTRAMO
     FROM PROCESO_COARRI_ERROR;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSFACT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSFACT
(
   IDPROCESOFACT,
   FECPROCESO,
   FECFACTURACION,
   NUMERRORES,
   NUMFACTURAS,
   USR,
   ESTADO,
   DESESTADO
)
AS
   SELECT PROCESOFACT.IDPROCESOFACT,
          PROCESOFACT.FECPROCESO,
          PROCESOFACT.FECFACTURACION,
          PROCESOFACT.NUMERRORES,
          PROCESOFACT.NUMFACTURAS,
          PROCESOFACT.USR,
          PROCESOFACT.ESTADO,
          DECODE (PROCESOFACT.ESTADO,  'P', 'En proceso',  'F', 'Finalizado')
     FROM PROCESOFACT;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSFACTERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSFACTERROR
(
   IDPROCESOFACT,
   IDERROR,
   DESCSERVICIO,
   CODPUE,
   PUERTO,
   ANYO,
   CODBORRADOR
)
AS
   SELECT PROCESOFACT_ERROR.IDPROCESOFACT,
          PROCESOFACT_ERROR.IDERROR,
          PROCESOFACT_ERROR.DESCSERVICIO,
          PROCESOFACT_ERROR.CODPUE,
          M_PUERTO_LOCAL.NOMBRE,
          PROCESOFACT_ERROR.ANYO,
          PROCESOFACT_ERROR.CODBORRADOR
     FROM    PROCESOFACT_ERROR
          INNER JOIN
             M_PUERTO_LOCAL
          ON (PROCESOFACT_ERROR.CODPUE = M_PUERTO_LOCAL.CODPUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSLIQ  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSLIQ
(
   IDPROCESO,
   FECPROCESO,
   FECLIQUIDACION,
   CODSER,
   SERVICIO,
   NUMERRORES,
   NUMBORRADORES,
   USR,
   ESTADO,
   DESESTADO,
   INDAUTOMATICO,
   AUTOMATICO
)
AS
   SELECT PROCESOLIQUID.IDPROCESO,
          PROCESOLIQUID.FECPROCESO,
          PROCESOLIQUID.FECLIQUIDACION,
          PROCESOLIQUID.CODSER,
          LQ_TIPO_SERVICIO.DESCRIPCION,
          PROCESOLIQUID.NUMERRORES,
          PROCESOLIQUID.NUMBORRADORES,
          PROCESOLIQUID.USR,
          PROCESOLIQUID.ESTADO,
          DECODE (PROCESOLIQUID.ESTADO,
                  'P', 'En proceso',
                  'F', 'Finalizado'),
          PROCESOLIQUID.INDAUTOMATICO,
          DECODE (PROCESOLIQUID.INDAUTOMATICO, '1', 'Si', 'No')
     FROM    PROCESOLIQUID
          INNER JOIN
             LQ_TIPO_SERVICIO
          ON (PROCESOLIQUID.CODSER = LQ_TIPO_SERVICIO.CODIGO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSLIQERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSLIQERROR
(
   IDPROCESO,
   IDERROR,
   DESCSERVICIO
)
AS
   SELECT PROCESOLIQUID_ERROR.IDPROCESO,
          PROCESOLIQUID_ERROR.IDERROR,
          PROCESOLIQUID_ERROR.DESCSERVICIO
     FROM PROCESOLIQUID_ERROR;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROCESOSSERVBAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROCESOSSERVBAS
(
   IDPROCESO,
   FECPROCESO,
   NUMERRORES,
   NUMSERVICIOS,
   USR,
   ESTADO,
   DESESTADO,
   TIPO,
   DESTIPO
)
AS
   SELECT PROCESOSERVBAS.IDPROCESO,
          PROCESOSERVBAS.FECPROCESO,
          PROCESOSERVBAS.NUMERRORES,
          PROCESOSERVBAS.NUMSERVICIOS,
          PROCESOSERVBAS.USR,
          PROCESOSERVBAS.ESTADO,
          DECODE (PROCESOSERVBAS.ESTADO,
                  'P', 'En proceso',
                  'F', 'Finalizado'),
          PROCESOSERVBAS.TIPO,
          DECODE (PROCESOSERVBAS.TIPO,
                  'A', 'Amarre-Desamarre',
                  'R', 'Remolcador',
                  'P', 'Practicaje')
     FROM PROCESOSERVBAS;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROC_NOTIFICACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROC_NOTIFICACIONES
(
   CODPUEPRONOTIF,
   DESPUEPRONOTIF,
   SECPRONOTIF,
   FECDESDE,
   FECHASTA,
   NUMNOTTOTAL,
   CODPUE
)
AS
   SELECT LNP.CODPUEPRONOTIF,
          MPL.NOMBRE,
          LNP.SECPRONOTIF,
          LNP.FECDESDE,
          LNP.FECHASTA,
          LNP.NUMNOTTOTAL,
          LNP.CODPUEPRONOTIF
     FROM    LQ_NOTIFICACION_PROCESO LNP
          JOIN
             M_PUERTO_LOCAL MPL
          ON MPL.CODPUE = LNP.CODPUEPRONOTIF;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PROVINCIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PROVINCIA (CODPROVINCIA, NOMBRE)
AS
   SELECT CE.CODPROVINCIA, CE.NOMBRE
     FROM M_PROVINCIA CE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_PUERTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_PUERTOS
(
   CODPAI,
   PAIS,
   CODPUE,
   PUERTO
)
AS
   SELECT M_PAIS.CODPAIS AS CODPAI,
          M_PAIS.NOMBRE AS PAIS,
          M_PUERTO.CODPUE,
          M_PUERTO.NOMBRE AS PUERTO
     FROM M_PUERTO INNER JOIN M_PAIS ON (M_PUERTO.CODPAIS = M_PAIS.CODPAIS);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_REMOLCADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_REMOLCADORES
(
   IDREMOLCADOR,
   NOMBRE,
   IDBUQUE,
   IMO,
   BUQUE,
   VOLUMEN,
   POTENCIA
)
AS
   SELECT M_REMOLCADOR.IDREMOLCADOR,
          M_REMOLCADOR.NOMBRE,
          M_REMOLCADOR.IDBUQUE,
          M_BUQUE.CODIMO,
          M_BUQUE.NOMBRE,
          M_REMOLCADOR.VOLUMEN,
          M_REMOLCADOR.POTENCIA
     FROM    M_REMOLCADOR
          LEFT JOIN
             M_BUQUE
          ON (M_REMOLCADOR.IDBUQUE = M_BUQUE.CODBUQUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_RENDIMIENTOGRUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_RENDIMIENTOGRUA
(
   CODPUE,
   ANYO,
   CODESCALA,
   CODESTADIA,
   CODOPERACION,
   SECUENCIAL,
   FECINICIO,
   FECFIN,
   CODGRUA,
   GRUA,
   NUMTON,
   OBSERVACIONES,
   CODTIPOTONELAJE,
   TIPOTONELAJE,
   CODTIPOPROPIETARIO,
   TIPOPROPIETARIO,
   CODTIPOENGANCHE,
   TIPOENGANCHE
)
AS
   SELECT RG.CODPUE,
          RG.ANYO,
          RG.CODESCALA,
          RG.CODESTADIA,
          RG.CODOPERACION,
          RG.SECUENCIAL,
          RG.FECINICIO,
          RG.FECFIN,
          RG.CODGRUA,
          G.DESCRIPCION,
          RG.NUMTON,
          RG.OBSERVACIONES,
          TNG.CODIGO,
          TNG.DESCRIPCION,
          TPG.CODIGO,
          TPG.DESCRIPCION,
          TEG.CODIGO,
          TEG.DESCRIPCION
     FROM RENDIMIENTO_GRUA RG
          JOIN M_GRUA G
             ON G.CODIGO = RG.CODGRUA
          JOIN TIPO_TONELAJEGRUA TNG
             ON TNG.CODIGO = G.CODTIPOTONELAJE
          JOIN TIPO_PROPIETARIOGRUA TPG
             ON TPG.CODIGO = G.CODTIPOPROPIETARIO
          JOIN TIPO_ENGANCHEGRUA TEG
             ON TEG.CODIGO = G.CODTIPOENGANCHE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_RUTACONTADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_RUTACONTADORES
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   CODZONA,
   ZONA
)
AS
   SELECT R.CODIGO,
          R.CODPUE,
          P.NOMBRE,
          R.DESCRIPCION,
          R.CODZONA,
          Z.DESCRIPCION
     FROM M_RUTACONTADOR R
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = R.CODPUE)
          LEFT JOIN M_ZONACONTAGUA Z
             ON (R.CODZONA = Z.CODIGO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_APARTADO_ARTICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_APARTADO_ARTICULO
(
   CODARTICULO,
   CODAPARTADO,
   DESAPARTADO
)
AS
   SELECT CODARTICULO, CODAPARTADO, DESAPARTADO FROM SAN_APARTADO_ARTICULO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_ARTICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_ARTICULO (CODARTICULO, DESARTICULO)
AS
   SELECT CODARTICULO, DESARTICULO FROM SAN_ARTICULO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_DENUNCIADO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_DENUNCIADO
(
   IDDENUNCIADO,
   NUMDOCUMENTO,
   NUMPERCONDUCCION,
   NOMBRE,
   DOMICILIO,
   LOCALIDAD,
   PROVINCIA,
   CODPOSTAL
)
AS
   SELECT IDDENUNCIADO,
          NUMDOCUMENTO,
          NUMPERCONDUCCION,
          NOMBRE,
          DOMICILIO,
          LOCALIDAD,
          PROVINCIA,
          CODPOSTAL
     FROM SAN_DENUNCIADO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_EXPEDIENTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_EXPEDIENTE
(
   CODPUE,
   NOMPUE,
   ANYO,
   NUMEXPEDIENTE,
   CODESTADO,
   DESESTADO,
   IDINFRACCION,
   TEXTOHECHO,
   CODARTICULO,
   DESARTICULO,
   CODAPARTADO,
   DESAPARTADO,
   LUGAR,
   IMPORTE,
   IMPDESCUENTO,
   HECHODENUNCIADO,
   IDVEHICULO,
   VEHMATRICULA,
   IDDENUNCIADO,
   DENNOMBRE,
   BOLFECHA,
   BOLFECLIMDESCUENTO,
   BOLINDGRAFICA,
   INIEXPFECHA,
   INIEXPFECLIMDTOALEG,
   INIEXPINDALEGACIONES,
   INIEXPTXTALEGACIONES,
   INIEXPINDDEVOLUCION,
   INIEXPFECPUBINI,
   INIEXPFECLIMPUBINI,
   INIEXPFECPUBFIN,
   INIEXPFECLIMPUBFIN,
   PRORESFECHA,
   PRORESFECLIMITE,
   PRORESINDALEGACIONES,
   PRORESTXTALEGACIONES,
   PRORESFECPUBINI,
   PRORESFECLIMPUBINI,
   PRORESFECPUBFIN,
   PRORESFECLIMPUBFIN,
   RESOLFECHA,
   RESOLFECPUBINI,
   RESOLFECLIMPUBINI,
   RESOLFECPUBFIN,
   RESOLFECLIMPUBFIN,
   APREMIOFECHA,
   INDPAGADO,
   FECPAGO,
   INDFINALIZADO,
   GUIDSRV,
   FECPUBBOP,
   FECRESBOP
)
AS
   SELECT EXP.CODPUE,
          PUERTO.NOMBRE AS NOMPUE,
          EXP.ANYO,
          EXP.NUMEXPEDIENTE,
          EXP.CODESTADO,
          EST.DESESTADO,
          EXP.IDINFRACCION,
          INF.TEXTOHECHO,
          EXP.CODARTICULO,
          ART.DESARTICULO,
          EXP.CODAPARTADO,
          APART.DESAPARTADO,
          EXP.LUGAR,
          EXP.IMPORTE,
          EXP.IMPDESCUENTO,
          EXP.HECHODENUNCIADO,
          EXP.IDVEHICULO,
          VEH.MATRICULA AS VEHMATRICULA,
          EXP.IDDENUNCIADO,
          DEN.NOMBRE AS DENNOMBRE,
          BOL_FECHA,
          BOL_FECLIMDESCUENTO,
          BOL_INDGRAFICA,
          INIEXP_FECHA,
          INIEXP_FECLIMDTOALEG,
          INIEXP_INDALEGACIONES,
          INIEXP_TXTALEGACIONES,
          INIEXP_INDDEVOLUCION,
          INIEXP_FECPUBINI,
          INIEXP_FECLIMPUBINI,
          INIEXP_FECPUBFIN,
          INIEXP_FECLIMPUBFIN,
          PRORES_FECHA,
          PRORES_FECLIMITE,
          PRORES_INDALEGACIONES,
          PRORES_TXTALEGACIONES,
          PRORES_FECPUBINI,
          PRORES_FECLIMPUBINI,
          PRORES_FECPUBFIN,
          PRORES_FECLIMPUBFIN,
          RESOL_FECHA,
          RESOL_FECPUBINI,
          RESOL_FECLIMPUBINI,
          RESOL_FECPUBFIN,
          RESOL_FECLIMPUBFIN,
          APREMIO_FECHA,
          INDPAGADO,
          FECPAGO,
          INDFINALIZADO,
          GUIDSRV,
          FECPUBBOP,
          FECRESBOP
     FROM SAN_EXPEDIENTE EXP
          LEFT JOIN M_PUERTO_LOCAL PUERTO
             ON EXP.CODPUE = PUERTO.CODPUE
          LEFT JOIN SAN_ESTADO_EXP EST
             ON EXP.CODESTADO = EST.CODESTADO
          LEFT JOIN SAN_ARTICULO ART
             ON EXP.CODARTICULO = ART.CODARTICULO
          LEFT JOIN SAN_APARTADO_ARTICULO APART
             ON EXP.CODARTICULO = APART.CODARTICULO
                AND EXP.CODAPARTADO = APART.CODAPARTADO
          LEFT JOIN SAN_VEHICULO VEH
             ON EXP.IDVEHICULO = VEH.IDVEHICULO
          LEFT JOIN SAN_DENUNCIADO DEN
             ON EXP.IDDENUNCIADO = DEN.IDDENUNCIADO
          LEFT JOIN SAN_INFRACCION_COMUN INF
             ON EXP.IDINFRACCION = INF.IDINFRACCION;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_INFRACCION_COMUN  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_INFRACCION_COMUN
(
   IDINFRACCION,
   CODARTICULO,
   DESARTICULO,
   CODAPARTADO,
   DESAPARTADO,
   TEXTOHECHO,
   IMPORTE,
   INDVISTABLET
)
AS
   SELECT IDINFRACCION,
          INF.CODARTICULO,
          ART.DESARTICULO,
          INF.CODAPARTADO,
          APART.DESAPARTADO,
          INF.TEXTOHECHO,
          INF.IMPORTE,
          INF.INDVISTABLET
     FROM SAN_INFRACCION_COMUN INF
          LEFT JOIN SAN_ARTICULO ART
             ON INF.CODARTICULO = ART.CODARTICULO
          LEFT JOIN SAN_APARTADO_ARTICULO APART
             ON INF.CODARTICULO = APART.CODARTICULO
                AND INF.CODAPARTADO = APART.CODAPARTADO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_PARTE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_PARTE
(
   NUMPARTE,
   ANYO,
   CODPUE,
   NOMPUE,
   FECPARTE,
   CODTURNO,
   DESTURNO,
   EQUIPO,
   AGENTES,
   DESCRIPCION,
   INDGRAFICA
)
AS
   SELECT PARTE.NUMPARTE,
          PARTE.ANYO,
          PARTE.CODPUE,
          PUERTO.NOMBRE AS NOMPUE,
          PARTE.FECPARTE,
          PARTE.CODTURNO,
          TURNO.DESCRIPCION AS DESTURNO,
          PARTE.EQUIPO,
          PARTE.AGENTES,
          PARTE.DESCRIPCION,
          DECODE (PARTE.INDGRAFICA, '1', 'Si', 'No')
     FROM SAN_PARTE PARTE
          LEFT JOIN M_PUERTO_LOCAL PUERTO
             ON PARTE.CODPUE = PUERTO.CODPUE
          LEFT JOIN SAN_TURNO TURNO
             ON PARTE.CODTURNO = TURNO.CODTURNO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SAN_VEHICULO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SAN_VEHICULO
(
   IDVEHICULO,
   MATRICULA,
   MARCAMODELO,
   CLASE,
   PROPIETARIO,
   OBSERVACIONES
)
AS
   SELECT V.IDVEHICULO,
          V.MATRICULA,
          V.MARCAMODELO,
          V.CLASE,
          D.NOMBRE,
          V.OBSERVACIONES
     FROM    SAN_VEHICULO V
          LEFT JOIN
             SAN_DENUNCIADO D
          ON V.IDDENUNCIADO = D.IDDENUNCIADO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASAMARRE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASAMARRE
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   FECINIAMARRE,
   FECFINAMARRE,
   NORAYDESDE,
   NORAYHASTA,
   IDTIPOCABO,
   DESTIPOCABO,
   NUMCABOS,
   NUMAMARRADORES,
   FECINIDESAMARRE,
   FECFINDESAMARRE,
   NUMFALUASAMARRE,
   NUMFALUASDESAMARRE,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLESINIREAL,
   NUMPERSONAS,
   GT,
   NUMCABOSSALIDA,
   DIAINIAMARRE,
   HORAINIAMARRE,
   DIAFINAMARRE,
   HORAFINAMARRE,
   DIAINIDESAMARRE,
   HORAINIDESAMARRE,
   DIAFINDESAMARRE,
   HORAFINDESAMARRE,
   INDREFUERZOSAMARRE,
   REFUERZOSAMARRE,
   INDREFUERZOSDESAMARRE,
   REFUERZOSDESAMARRE
)
AS
   SELECT SERVBAS_AMARRE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_AMARRE.ANYO,
          SERVBAS_AMARRE.CODSER,
          SERVBAS_AMARRE.CODPUEESC,
          SERVBAS_AMARRE.ANYOESC,
          SERVBAS_AMARRE.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_AMARRE.CODESTADIA,
          SERVBAS_AMARRE.FECINIAMARRE,
          SERVBAS_AMARRE.FECFINAMARRE,
          SERVBAS_AMARRE.NORAYDESDE,
          SERVBAS_AMARRE.NORAYHASTA,
          SERVBAS_AMARRE.IDTIPOCABO,
          CLASECABO.DESCRIPCION AS DESTIPOCABO,
          SERVBAS_AMARRE.NUMCABOS,
          SERVBAS_AMARRE.NUMAMARRADORES,
          SERVBAS_AMARRE.FECINIDESAMARRE,
          SERVBAS_AMARRE.FECFINDESAMARRE,
          SERVBAS_AMARRE.NUMFALUASAMARRE,
          SERVBAS_AMARRE.NUMFALUASDESAMARRE,
          SERVBAS_AMARRE.GUIDSRV,
          SERVBAS_AMARRE.OBSERVACIONES,
          BU.NOMBRE AS NOMBUQUE,
          BU.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLESINIREAL,
          SERVBAS_AMARRE.NUMPERSONAS,
          BV.GT,
          SERVBAS_AMARRE.NUMCABOSSALIDA,
          TO_CHAR (SERVBAS_AMARRE.FECINIAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECINIAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECFINAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECFINAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECINIDESAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECINIDESAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECFINDESAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECFINDESAMARRE, 'HH24:mi'),
          SERVBAS_AMARRE.INDREFUERZOSAMARRE,
          DECODE (SERVBAS_AMARRE.INDREFUERZOSAMARRE, '1', 'Si', 'No'),
          SERVBAS_AMARRE.INDREFUERZOSDESAMARRE,
          DECODE (SERVBAS_AMARRE.INDREFUERZOSDESAMARRE, '1', 'Si', 'No')
     FROM SERVBAS_AMARRE
          LEFT JOIN CLASECABO
             ON (CLASECABO.CODIGO = SERVBAS_AMARRE.IDTIPOCABO)
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_AMARRE.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_AMARRE.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_AMARRE.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_AMARRE.CODPUE)
          LEFT JOIN M_BUQUE BU
             ON (ESCALA.CODBUQUE = BU.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_AMARRE.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_AMARRE.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_AMARRE.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_AMARRE.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASAMARREESTADIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASAMARREESTADIA
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   FECINIAMARRE,
   FECFINAMARRE,
   NORAYDESDE,
   NORAYHASTA,
   IDTIPOCABO,
   DESTIPOCABO,
   NUMCABOS,
   NUMAMARRADORES,
   FECINIDESAMARRE,
   FECFINDESAMARRE,
   NUMFALUASAMARRE,
   NUMFALUASDESAMARRE,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLESINIREAL,
   NUMPERSONAS,
   GT,
   NUMCABOSSALIDA,
   DIAINIAMARRE,
   HORAINIAMARRE,
   DIAFINAMARRE,
   HORAFINAMARRE,
   DIAINIDESAMARRE,
   HORAINIDESAMARRE,
   DIAFINDESAMARRE,
   HORAFINDESAMARRE,
   INDREFUERZOSAMARRE,
   REFUERZOSAMARRE,
   INDREFUERZOSDESAMARRE,
   REFUERZOSDESAMARRE
)
AS
   SELECT SERVBAS_AMARRE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_AMARRE.ANYO,
          SERVBAS_AMARRE.CODSER,
          SERVBAS_AMARRE.CODPUEESC,
          SERVBAS_AMARRE.ANYOESC,
          SERVBAS_AMARRE.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_AMARRE.CODESTADIA,
          SERVBAS_AMARRE.FECINIAMARRE,
          SERVBAS_AMARRE.FECFINAMARRE,
          SERVBAS_AMARRE.NORAYDESDE,
          SERVBAS_AMARRE.NORAYHASTA,
          SERVBAS_AMARRE.IDTIPOCABO,
          CLASECABO.DESCRIPCION AS DESTIPOCABO,
          SERVBAS_AMARRE.NUMCABOS,
          SERVBAS_AMARRE.NUMAMARRADORES,
          SERVBAS_AMARRE.FECINIDESAMARRE,
          SERVBAS_AMARRE.FECFINDESAMARRE,
          SERVBAS_AMARRE.NUMFALUASAMARRE,
          SERVBAS_AMARRE.NUMFALUASDESAMARRE,
          SERVBAS_AMARRE.GUIDSRV,
          SERVBAS_AMARRE.OBSERVACIONES,
          M_BUQUE.NOMBRE AS NOMBUQUE,
          M_BUQUE.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLESINIREAL,
          SERVBAS_AMARRE.NUMPERSONAS,
          BV.GT,
          SERVBAS_AMARRE.NUMCABOSSALIDA,
          TO_CHAR (SERVBAS_AMARRE.FECINIAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECINIAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECFINAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECFINAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECINIDESAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECINIDESAMARRE, 'HH24:mi'),
          TO_CHAR (SERVBAS_AMARRE.FECFINDESAMARRE, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_AMARRE.FECFINDESAMARRE, 'HH24:mi'),
          SERVBAS_AMARRE.INDREFUERZOSAMARRE,
          DECODE (SERVBAS_AMARRE.INDREFUERZOSAMARRE, '1', 'Si', 'No'),
          SERVBAS_AMARRE.INDREFUERZOSDESAMARRE,
          DECODE (SERVBAS_AMARRE.INDREFUERZOSDESAMARRE, '1', 'Si', 'No')
     FROM SERVBAS_AMARRE
          LEFT JOIN CLASECABO
             ON (CLASECABO.CODIGO = SERVBAS_AMARRE.IDTIPOCABO)
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_AMARRE.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_AMARRE.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_AMARRE.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_AMARRE.CODPUE)
          LEFT JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_AMARRE.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_AMARRE.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_AMARRE.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_AMARRE.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASPRACTIC  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASPRACTIC
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   IDPRACTICO1,
   NOMPRACTICO1,
   CIFPRACTICO1,
   IDPRACTICO2,
   NOMPRACTICO2,
   CIFPRACTICO2,
   FECINI1,
   FECFIN1,
   FECINI2,
   FECFIN2,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLEINIREAL,
   CODTIPOMANIOBRA1,
   TIPOMANIOBRA1,
   CODTIPOMANIOBRA2,
   TIPOMANIOBRA2,
   GT,
   DIAINI1,
   HORAINI1,
   DIAINI2,
   HORAINI2,
   DIAFIN1,
   HORAFIN1,
   DIAFIN2,
   HORAFIN2,
   INDSINPROP,
   SINPROP,
   INDBUNKERING,
   BUNKERING
)
AS
   SELECT SERVBAS_PRACTICAJE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_PRACTICAJE.ANYO,
          SERVBAS_PRACTICAJE.CODSER,
          SERVBAS_PRACTICAJE.CODPUEESC,
          SERVBAS_PRACTICAJE.ANYOESC,
          SERVBAS_PRACTICAJE.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_PRACTICAJE.CODESTADIA,
          SERVBAS_PRACTICAJE.IDPRACTICO1,
          PRAC1.NOMBRE || ' ' || PRAC1.APELLIDOS AS NOMPRACTICO1,
          PRAC1.NIF AS CIFPRACTICO1,
          SERVBAS_PRACTICAJE.IDPRACTICO2,
          PRAC2.NOMBRE || ' ' || PRAC2.APELLIDOS AS NOMPRACTICO2,
          PRAC2.NIF AS CIFPRACTICO2,
          SERVBAS_PRACTICAJE.FECINI1,
          SERVBAS_PRACTICAJE.FECFIN1,
          SERVBAS_PRACTICAJE.FECINI2,
          SERVBAS_PRACTICAJE.FECFIN2,
          SERVBAS_PRACTICAJE.GUIDSRV,
          SERVBAS_PRACTICAJE.OBSERVACIONES,
          BU.NOMBRE AS NOMBUQUE,
          BU.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLEINIREAL,
          SERVBAS_PRACTICAJE.CODTIPOMANIOBRA1,
          TM1.DESCRIPCION,
          SERVBAS_PRACTICAJE.CODTIPOMANIOBRA2,
          TM2.DESCRIPCION,
          BV.GT,
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI1, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI2, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN1, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN2, 'HH24:mi'),
          SERVBAS_PRACTICAJE.INDSINPROP,
          DECODE (SERVBAS_PRACTICAJE.INDSINPROP, '1', 'Si', 'No'),
          SERVBAS_PRACTICAJE.INDBUNKERING,
          DECODE (SERVBAS_PRACTICAJE.INDBUNKERING, '1', 'Si', 'No')
     FROM SERVBAS_PRACTICAJE
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_PRACTICAJE.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_PRACTICAJE.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_PRACTICAJE.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_PRACTICAJE.CODPUE)
          LEFT JOIN M_BUQUE BU
             ON (ESCALA.CODBUQUE = BU.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_PRACTICAJE.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_PRACTICAJE.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_PRACTICAJE.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_PRACTICAJE.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL)
          LEFT JOIN M_PRACTICO PRAC1
             ON (PRAC1.CODIGO = SERVBAS_PRACTICAJE.IDPRACTICO1)
          LEFT JOIN M_PRACTICO PRAC2
             ON (PRAC2.CODIGO = SERVBAS_PRACTICAJE.IDPRACTICO2)
          LEFT JOIN TIPOMANIOBRA TM1
             ON (TM1.CODIGO = SERVBAS_PRACTICAJE.CODTIPOMANIOBRA1)
          LEFT JOIN TIPOMANIOBRA TM2
             ON (TM2.CODIGO = SERVBAS_PRACTICAJE.CODTIPOMANIOBRA2);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASPRACTICESTADIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASPRACTICESTADIA
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   IDPRACTICO1,
   NOMPRACTICO1,
   CIFPRACTICO1,
   IDPRACTICO2,
   NOMPRACTICO2,
   CIFPRACTICO2,
   FECINI1,
   FECFIN1,
   FECINI2,
   FECFIN2,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLEINIREAL,
   CODTIPOMANIOBRA1,
   TIPOMANIOBRA1,
   CODTIPOMANIOBRA2,
   TIPOMANIOBRA2,
   GT,
   DIAINI1,
   HORAINI1,
   DIAINI2,
   HORAINI2,
   DIAFIN1,
   HORAFIN1,
   DIAFIN2,
   HORAFIN2,
   INDSINPROP,
   SINPROP,
   INDBUNKERING,
   BUNKERING
)
AS
   SELECT SERVBAS_PRACTICAJE.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_PRACTICAJE.ANYO,
          SERVBAS_PRACTICAJE.CODSER,
          SERVBAS_PRACTICAJE.CODPUEESC,
          SERVBAS_PRACTICAJE.ANYOESC,
          SERVBAS_PRACTICAJE.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_PRACTICAJE.CODESTADIA,
          SERVBAS_PRACTICAJE.IDPRACTICO1,
          PRAC1.NOMBRE || ' ' || PRAC1.APELLIDOS AS NOMPRACTICO1,
          PRAC1.NIF AS CIFPRACTICO1,
          SERVBAS_PRACTICAJE.IDPRACTICO2,
          PRAC2.NOMBRE || ' ' || PRAC2.APELLIDOS AS NOMPRACTICO2,
          PRAC2.NIF AS CIFPRACTICO2,
          SERVBAS_PRACTICAJE.FECINI1,
          SERVBAS_PRACTICAJE.FECFIN1,
          SERVBAS_PRACTICAJE.FECINI2,
          SERVBAS_PRACTICAJE.FECFIN2,
          SERVBAS_PRACTICAJE.GUIDSRV,
          SERVBAS_PRACTICAJE.OBSERVACIONES,
          M_BUQUE.NOMBRE AS NOMBUQUE,
          M_BUQUE.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLEINIREAL,
          SERVBAS_PRACTICAJE.CODTIPOMANIOBRA1,
          TM1.DESCRIPCION,
          SERVBAS_PRACTICAJE.CODTIPOMANIOBRA2,
          TM2.DESCRIPCION,
          BV.GT AS GT,
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI1, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECINI2, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN1, 'HH24:mi'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_PRACTICAJE.FECFIN2, 'HH24:mi'),
          SERVBAS_PRACTICAJE.INDSINPROP,
          DECODE (SERVBAS_PRACTICAJE.INDSINPROP, '1', 'Si', 'No'),
          SERVBAS_PRACTICAJE.INDBUNKERING,
          DECODE (SERVBAS_PRACTICAJE.INDBUNKERING, '1', 'Si', 'No')
     FROM SERVBAS_PRACTICAJE
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_PRACTICAJE.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_PRACTICAJE.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_PRACTICAJE.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_PRACTICAJE.CODPUE)
          LEFT JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_PRACTICAJE.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_PRACTICAJE.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_PRACTICAJE.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_PRACTICAJE.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL)
          LEFT JOIN M_PRACTICO PRAC1
             ON (PRAC1.CODIGO = SERVBAS_PRACTICAJE.IDPRACTICO1)
          LEFT JOIN M_PRACTICO PRAC2
             ON (PRAC2.CODIGO = SERVBAS_PRACTICAJE.IDPRACTICO2)
          LEFT JOIN TIPOMANIOBRA TM1
             ON (TM1.CODIGO = SERVBAS_PRACTICAJE.CODTIPOMANIOBRA1)
          LEFT JOIN TIPOMANIOBRA TM2
             ON (TM2.CODIGO = SERVBAS_PRACTICAJE.CODTIPOMANIOBRA2);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASREMOL  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASREMOL
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLEINIREAL,
   IDREMOL1,
   REMOLCADOR1,
   FECINI1,
   FECFIN1,
   IDREMOL2,
   REMOLCADOR2,
   FECINI2,
   FECFIN2,
   IDREMOL3,
   REMOLCADOR3,
   FECINI3,
   FECFIN3,
   IDREMOL4,
   REMOLCADOR4,
   FECINI4,
   FECFIN4,
   CODTIPOMANIOBRA1,
   TIPOMANIOBRA1,
   CODTIPOMANIOBRA2,
   TIPOMANIOBRA2,
   CODTIPOMANIOBRA3,
   TIPOMANIOBRA3,
   CODTIPOMANIOBRA4,
   TIPOMANIOBRA4,
   GT,
   DIAINI1,
   HORAINI1,
   DIAINI2,
   HORAINI2,
   DIAINI3,
   HORAINI3,
   DIAINI4,
   HORAINI4,
   DIAFIN1,
   HORAFIN1,
   DIAFIN2,
   HORAFIN2,
   DIAFIN3,
   HORAFIN3,
   DIAFIN4,
   HORAFIN4
)
AS
   SELECT SERVBAS_REMOLCADOR.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_REMOLCADOR.ANYO,
          SERVBAS_REMOLCADOR.CODSER,
          SERVBAS_REMOLCADOR.CODPUEESC,
          SERVBAS_REMOLCADOR.ANYOESC,
          SERVBAS_REMOLCADOR.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_REMOLCADOR.CODESTADIA,
          SERVBAS_REMOLCADOR.GUIDSRV,
          SERVBAS_REMOLCADOR.OBSERVACIONES,
          BU.NOMBRE AS NOMBUQUE,
          BU.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLEINIREAL,
          SERVBAS_REMOLCADOR.IDREMOL1,
          REMOL1.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI1,
          SERVBAS_REMOLCADOR.FECFIN1,
          SERVBAS_REMOLCADOR.IDREMOL2,
          REMOL2.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI2,
          SERVBAS_REMOLCADOR.FECFIN2,
          SERVBAS_REMOLCADOR.IDREMOL3,
          REMOL3.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI3,
          SERVBAS_REMOLCADOR.FECFIN3,
          SERVBAS_REMOLCADOR.IDREMOL4,
          REMOL4.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI4,
          SERVBAS_REMOLCADOR.FECFIN4,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA1,
          TM1.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA2,
          TM2.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA3,
          TM3.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA4,
          TM4.DESCRIPCION,
          BV.GT,
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI1, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI2, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI3, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI3, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI4, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI4, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN1, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN2, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN3, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN3, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN4, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN4, 'HH24:mi')
     FROM SERVBAS_REMOLCADOR
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_REMOLCADOR.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_REMOLCADOR.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_REMOLCADOR.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_REMOLCADOR.CODPUE)
          LEFT JOIN M_BUQUE BU
             ON (ESCALA.CODBUQUE = BU.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = BU.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_REMOLCADOR.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_REMOLCADOR.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_REMOLCADOR.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_REMOLCADOR.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL)
          LEFT JOIN M_REMOLCADOR REMOL1
             ON SERVBAS_REMOLCADOR.IDREMOL1 = REMOL1.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL2
             ON SERVBAS_REMOLCADOR.IDREMOL2 = REMOL2.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL3
             ON SERVBAS_REMOLCADOR.IDREMOL3 = REMOL3.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL4
             ON SERVBAS_REMOLCADOR.IDREMOL4 = REMOL4.IDREMOLCADOR
          LEFT JOIN TIPOMANIOBRA TM1
             ON (TM1.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA1)
          LEFT JOIN TIPOMANIOBRA TM2
             ON (TM2.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA2)
          LEFT JOIN TIPOMANIOBRA TM3
             ON (TM3.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA3)
          LEFT JOIN TIPOMANIOBRA TM4
             ON (TM4.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA4);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVBASREMOLESTADIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVBASREMOLESTADIA
(
   CODPUE,
   NOMPUE,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   NUMESCALA,
   CODESTADIA,
   GUIDSRV,
   OBSERVACIONES,
   NOMBUQUE,
   CODIMO,
   CODMUELLEINIREAL,
   DESMUELLEINIREAL,
   IDREMOL1,
   REMOLCADOR1,
   FECINI1,
   FECFIN1,
   IDREMOL2,
   REMOLCADOR2,
   FECINI2,
   FECFIN2,
   IDREMOL3,
   REMOLCADOR3,
   FECINI3,
   FECFIN3,
   IDREMOL4,
   REMOLCADOR4,
   FECINI4,
   FECFIN4,
   CODTIPOMANIOBRA1,
   TIPOMANIOBRA1,
   CODTIPOMANIOBRA2,
   TIPOMANIOBRA2,
   CODTIPOMANIOBRA3,
   TIPOMANIOBRA3,
   CODTIPOMANIOBRA4,
   TIPOMANIOBRA4,
   GT,
   DIAINI1,
   HORAINI1,
   DIAINI2,
   HORAINI2,
   DIAINI3,
   HORAINI3,
   DIAINI4,
   HORAINI4,
   DIAFIN1,
   HORAFIN1,
   DIAFIN2,
   HORAFIN2,
   DIAFIN3,
   HORAFIN3,
   DIAFIN4,
   HORAFIN4
)
AS
   SELECT SERVBAS_REMOLCADOR.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          SERVBAS_REMOLCADOR.ANYO,
          SERVBAS_REMOLCADOR.CODSER,
          SERVBAS_REMOLCADOR.CODPUEESC,
          SERVBAS_REMOLCADOR.ANYOESC,
          SERVBAS_REMOLCADOR.CODESC,
          ESCALA.NUMESCALA,
          SERVBAS_REMOLCADOR.CODESTADIA,
          SERVBAS_REMOLCADOR.GUIDSRV,
          SERVBAS_REMOLCADOR.OBSERVACIONES,
          M_BUQUE.NOMBRE AS NOMBUQUE,
          M_BUQUE.CODIMO,
          ESTADIA.CODMUELLEINIREAL,
          M_MUELLE.DESCRIPCION AS DESMUELLEINIREAL,
          SERVBAS_REMOLCADOR.IDREMOL1,
          REMOL1.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI1,
          SERVBAS_REMOLCADOR.FECFIN1,
          SERVBAS_REMOLCADOR.IDREMOL2,
          REMOL2.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI2,
          SERVBAS_REMOLCADOR.FECFIN2,
          SERVBAS_REMOLCADOR.IDREMOL3,
          REMOL3.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI3,
          SERVBAS_REMOLCADOR.FECFIN3,
          SERVBAS_REMOLCADOR.IDREMOL4,
          REMOL4.NOMBRE,
          SERVBAS_REMOLCADOR.FECINI4,
          SERVBAS_REMOLCADOR.FECFIN4,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA1,
          TM1.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA2,
          TM2.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA3,
          TM3.DESCRIPCION,
          SERVBAS_REMOLCADOR.CODTIPOMANIOBRA4,
          TM4.DESCRIPCION,
          BV.GT,
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI1, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI2, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI3, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI3, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI4, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECINI4, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN1, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN1, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN2, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN2, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN3, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN3, 'HH24:mi'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN4, 'dd/MM/rrrr'),
          TO_CHAR (SERVBAS_REMOLCADOR.FECFIN4, 'HH24:mi')
     FROM SERVBAS_REMOLCADOR
          LEFT JOIN ESCALA
             ON (    ESCALA.CODPUE = SERVBAS_REMOLCADOR.CODPUEESC
                 AND ESCALA.ANYO = SERVBAS_REMOLCADOR.ANYOESC
                 AND ESCALA.CODESCALA = SERVBAS_REMOLCADOR.CODESC)
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = SERVBAS_REMOLCADOR.CODPUE)
          LEFT JOIN M_BUQUE
             ON (ESCALA.CODBUQUE = M_BUQUE.CODBUQUE)
          LEFT JOIN M_BUQUEVERSION BV
             ON (BV.CODBUQUE = M_BUQUE.CODBUQUE
                 AND BV.FECINIVIG <=
                        (CASE
                            WHEN ESCALA.FECINIREAL IS NOT NULL
                            THEN
                               TRUNC (ESCALA.FECINIREAL)
                            ELSE
                               TRUNC (ESCALA.ETA)
                         END)
                 AND (BV.FECFINVIG >=
                         (CASE
                             WHEN ESCALA.FECINIREAL IS NOT NULL
                             THEN
                                TRUNC (ESCALA.FECINIREAL)
                             ELSE
                                TRUNC (ESCALA.ETA)
                          END)
                      OR BV.FECFINVIG IS NULL))
          LEFT JOIN ESTADIA
             ON (    ESTADIA.CODPUE = SERVBAS_REMOLCADOR.CODPUEESC
                 AND ESTADIA.ANYO = SERVBAS_REMOLCADOR.ANYOESC
                 AND ESTADIA.CODESCALA = SERVBAS_REMOLCADOR.CODESC
                 AND ESTADIA.CODESTADIA = SERVBAS_REMOLCADOR.CODESTADIA)
          LEFT JOIN M_MUELLE
             ON (M_MUELLE.CODIGO = ESTADIA.CODMUELLEINIREAL)
          LEFT JOIN M_REMOLCADOR REMOL1
             ON SERVBAS_REMOLCADOR.IDREMOL1 = REMOL1.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL2
             ON SERVBAS_REMOLCADOR.IDREMOL2 = REMOL2.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL3
             ON SERVBAS_REMOLCADOR.IDREMOL3 = REMOL3.IDREMOLCADOR
          LEFT JOIN M_REMOLCADOR REMOL4
             ON SERVBAS_REMOLCADOR.IDREMOL4 = REMOL4.IDREMOLCADOR
          LEFT JOIN TIPOMANIOBRA TM1
             ON (TM1.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA1)
          LEFT JOIN TIPOMANIOBRA TM2
             ON (TM2.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA2)
          LEFT JOIN TIPOMANIOBRA TM3
             ON (TM3.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA3)
          LEFT JOIN TIPOMANIOBRA TM4
             ON (TM4.CODIGO = SERVBAS_REMOLCADOR.CODTIPOMANIOBRA4);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVICIOMARIT_NAV  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVICIOMARIT_NAV
(
   CODINTERNO,
   CODSERVICIO,
   SERVICIO,
   IDUSUARIO,
   NOMUSUARIO,
   NUMDOC,
   LETRANIF,
   FECINICIO,
   FECFIN,
   OBSERVACIONES
)
AS
   SELECT M_SERVICIOMARIT_NAV.CODINTERNO,
          M_SERVICIOMARIT_NAV.CODSERVICIO,
          M_SERVICIOMARITIMO.NOMBRE AS SERVICIO,
          M_SERVICIOMARIT_NAV.IDUSUARIO,
          M_USUARIO.NOMBRECOMPLETO AS NOMUSUARIO,
          M_USUARIO.NUMDOC,
          M_USUARIO.LETRANIF,
          M_SERVICIOMARIT_NAV.FECINICIO,
          M_SERVICIOMARIT_NAV.FECFIN,
          M_SERVICIOMARIT_NAV.OBSERVACIONES
     FROM M_SERVICIOMARIT_NAV
          INNER JOIN M_USUARIO
             ON M_SERVICIOMARIT_NAV.IDUSUARIO = M_USUARIO.CODUSUARIO
          INNER JOIN M_SERVICIOMARITIMO
             ON M_SERVICIOMARIT_NAV.CODSERVICIO =
                   M_SERVICIOMARITIMO.CODSERVICIO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVICIOSMARITIMOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVICIOSMARITIMOS
(
   CODSERVICIO,
   NOMBRE,
   INDREGULAR,
   INDTMCD,
   NUMESCPREVISTAS,
   CIF,
   NOMBRECOMPLETO,
   CODPUE,
   PUERTO,
   ENCALIDADDE,
   DESENCALIDADE,
   CIFNAVIERA,
   NOMBRENAVIERA,
   INDACUERDOEXP,
   INDRORO,
   RORO
)
AS
   SELECT M_SERVICIOMARITIMO.CODSERVICIO,
          M_SERVICIOMARITIMO.NOMBRE,
          DECODE (M_SERVICIOMARITIMO.INDREGULAR, '1', 'Si', 'No'),
          DECODE (M_SERVICIOMARITIMO.INDTMCD, '1', 'Si', 'No'),
          M_SERVICIOMARITIMO.NUMESCPREVISTAS,
          M1.NUMDOC || M1.LETRANIF,
          M1.NOMBRECOMPLETO,
          M_SERVICIOMARITIMO.CODPUE,
          PU.NOMBRE,
          M_SERVMARITENCALIDAD.CODIGO,
          M_SERVMARITENCALIDAD.DESCRIPCION,
          M2.NUMDOC || M2.LETRANIF,
          M2.NOMBRECOMPLETO,
          DECODE (M_SERVICIOMARITIMO.INDACUERDOEXP, '1', 'Si', 'No'),
          M_SERVICIOMARITIMO.INDRORO,
          DECODE (M_SERVICIOMARITIMO.INDRORO, '1', 'Si', 'No')
     FROM M_SERVICIOMARITIMO
          LEFT JOIN M_USUARIO M1
             ON (M_SERVICIOMARITIMO.IDCONSIGSOL = M1.CODUSUARIO)
          LEFT JOIN M_USUARIO M2
             ON (M_SERVICIOMARITIMO.IDNAVIERA = M2.CODUSUARIO)
          LEFT JOIN M_SERVMARITENCALIDAD
             ON (M_SERVICIOMARITIMO.ENCALIDADDE = M_SERVMARITENCALIDAD.CODIGO)
          INNER JOIN M_PUERTO_LOCAL PU
             ON (PU.CODPUE = M_SERVICIOMARITIMO.CODPUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVMARIT_BUQUES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVMARIT_BUQUES
(
   CODINTERNO,
   FECINICIO,
   FECFIN,
   CODBUQUE,
   BUQUE,
   CODSERVICIO,
   SERVICIO,
   IMO,
   CODPUE,
   DESPUE
)
AS
   SELECT M_SERVMARIT_BUQUE.CODINTERNO,
          M_SERVMARIT_BUQUE.FECINICIO,
          M_SERVMARIT_BUQUE.FECFIN,
          M_SERVMARIT_BUQUE.CODBUQUE,
          M_BUQUE.NOMBRE,
          M_SERVMARIT_BUQUE.CODSERVICIO,
          M_SERVICIOMARITIMO.NOMBRE,
          M_BUQUE.CODIMO,
          M_SERVICIOMARITIMO.CODPUE,
          M_PUERTO_LOCAL.NOMBRE
     FROM M_SERVMARIT_BUQUE
          INNER JOIN M_BUQUE
             ON M_SERVMARIT_BUQUE.CODBUQUE = M_BUQUE.CODBUQUE
          INNER JOIN M_SERVICIOMARITIMO
             ON M_SERVMARIT_BUQUE.CODSERVICIO =
                   M_SERVICIOMARITIMO.CODSERVICIO
          INNER JOIN M_PUERTO_LOCAL
             ON M_PUERTO_LOCAL.CODPUE = M_SERVICIOMARITIMO.CODPUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVMARIT_NAVIERAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVMARIT_NAVIERAS
(
   CODINTERNO,
   CODSERVICIO,
   SERVICIO,
   IDNAVIERA,
   NOMNAVIERA,
   FECINICIO,
   FECFIN,
   OBSERVACIONES
)
AS
   SELECT M_SERVMARIT_NAVIERA.CODINTERNO,
          M_SERVMARIT_NAVIERA.CODSERVICIO,
          M_SERVICIOMARITIMO.NOMBRE AS SERVICIO,
          M_SERVMARIT_NAVIERA.IDNAVIERA,
          M_NAVIERA.NOMBRE,
          M_SERVMARIT_NAVIERA.FECINICIO,
          M_SERVMARIT_NAVIERA.FECFIN,
          M_SERVMARIT_NAVIERA.OBSERVACIONES
     FROM M_SERVMARIT_NAVIERA
          INNER JOIN M_NAVIERA
             ON M_SERVMARIT_NAVIERA.IDNAVIERA = M_NAVIERA.CODIGO
          INNER JOIN M_SERVICIOMARITIMO
             ON M_SERVMARIT_NAVIERA.CODSERVICIO =
                   M_SERVICIOMARITIMO.CODSERVICIO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SERVMARIT_PUERTOS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SERVMARIT_PUERTOS
(
   CODINTERNO,
   FECINICIO,
   FECFIN,
   CODPAIS,
   PAIS,
   CODPUE,
   PUERTO,
   CODSERVICIO,
   SERVICIO
)
AS
   SELECT M_SERVMARIT_PUERTO.CODINTERNO,
          M_SERVMARIT_PUERTO.FECINICIO,
          M_SERVMARIT_PUERTO.FECFIN,
          M_SERVMARIT_PUERTO.CODPAIS,
          M_PAIS.NOMBRE,
          M_SERVMARIT_PUERTO.CODPUE,
          M_PUERTO.NOMBRE,
          M_SERVMARIT_PUERTO.CODSERVICIO,
          M_SERVICIOMARITIMO.NOMBRE
     FROM M_SERVMARIT_PUERTO
          INNER JOIN M_PAIS
             ON M_SERVMARIT_PUERTO.CODPAIS = M_PAIS.CODPAIS
          INNER JOIN M_PUERTO
             ON (M_SERVMARIT_PUERTO.CODPAIS = M_PUERTO.CODPAIS
                 AND M_SERVMARIT_PUERTO.CODPUE = M_PUERTO.CODPUE)
          INNER JOIN M_SERVICIOMARITIMO
             ON M_SERVMARIT_PUERTO.CODSERVICIO =
                   M_SERVICIOMARITIMO.CODSERVICIO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SGC_MAQUINARIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SGC_MAQUINARIA
(
   IDSGM,
   CODPUE,
   NOMPUERTO,
   CODUSUARIO,
   NOMBRECOMPLETO,
   CODPUEESC,
   NOMPUERTOESC,
   ANYO,
   CODESCALA,
   CODEMBARCACION,
   NOMEMBARCACION,
   MATRICULA,
   IDTIPOSERVICIO,
   DESCTIPOSERVICIO,
   IDMAQUINA,
   DESCMAQUINA,
   REFMAQUINA,
   DESCTIPOMAQUINARIA,
   IDTRAMO,
   DESCTIPOTRAMO,
   BAREMO,
   IDTARIFA,
   IDSUBTARIFA,
   EXTENSION,
   CODIMPUESTO,
   DESCIMPUESTO,
   FECINICIO,
   FECFIN,
   OBSERVACION,
   OBSFACTURA,
   NUMREGISTRO,
   EMPLEADO,
   INDLIQUIDADO,
   GUIDSRV,
   INDEXENTOLIQ,
   MOTEXENTOLIQ,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF
)
AS
   SELECT SMA.IDSGM,
          SMA.CODPUE,
          MPL.NOMBRE,
          SMA.CODUSUARIO,
          USU.NOMBRECOMPLETO,
          SMA.CODPUEESC,
          MP2.NOMBRE,
          SMA.ANYO,
          SMA.CODESCALA,
          SMA.CODEMBARCACION,
          MEM.NOMBRE,
          MEM.MATRICULA,
          SMA.IDTIPOSERVICIO,
          SMS.DESCTIPOSERVICIO,
          SMA.IDMAQUINA,
          MMA.DESCMAQUINA,
          MMA.REFERENCIA,
          SMT.DESCTIPOMAQUINARIA,
          SMA.IDTRAMO,
          SMB.DESCTIPOTRAMO,
          SMB.BAREMO,
          LQB.IDTARIFA,
          LQB.IDSUBTARIFA,
          LQB.EXTENSION,
          SMA.CODIMPUESTO,
          LQI.DESCRIPCION,
          SMA.FECINICIO,
          SMA.FECFIN,
          SMA.OBSERVACION,
          SMA.OBSFACTURA,
          SMA.NUMREGISTRO,
          SMA.EMPLEADO,
          DECODE (SMA.INDLIQUIDADO, '1', 'Si', 'No'),
          SMA.GUIDSRV,
          DECODE (SMA.INDEXENTOLIQ, '1', 'Si', 'No'),
          SMA.MOTEXENTOLIQ,
          SMA.FECALTA,
          SMA.USRALTA,
          SMA.FECMODIF,
          SMA.USRMODIF
     FROM SGC_MAQUINARIA SMA
          JOIN M_PUERTO_LOCAL MPL
             ON MPL.CODPUE = SMA.CODPUE
          JOIN M_USUARIO USU
             ON USU.CODUSUARIO = SMA.CODUSUARIO
          LEFT JOIN M_PUERTO_LOCAL MP2
             ON MP2.CODPUE = SMA.CODPUEESC
          LEFT JOIN M_EMBARCACION MEM
             ON MEM.CODIGO = SMA.CODEMBARCACION
          JOIN SGC_MAQUINARIA_TIPOSERVICIO SMS
             ON SMS.IDTIPOSERVICIO = SMA.IDTIPOSERVICIO
          JOIN M_MAQUINARIA MMA
             ON MMA.IDMAQUINA = SMA.IDMAQUINA
          JOIN SGC_MAQUINARIA_TIPO SMT
             ON SMT.IDTIPOMAQUINARIA = MMA.IDTIPOMAQUINARIA
          JOIN SGC_MAQUINARIA_TIPOTRAMO SMB
             ON SMB.IDTRAMO = SMA.IDTRAMO
          LEFT JOIN LQ_BAREMOAP LQB
             ON     LQB.CODBAREMO = SMB.BAREMO
                AND LQB.FECINIVIG <= SMA.FECINICIO
                AND (LQB.FECFINVIG >= SMA.FECINICIO OR LQB.FECFINVIG IS NULL)
          JOIN LQ_TIPO_IMPUESTOGLOBAL LQI
             ON LQI.CODIGO = SMA.CODIMPUESTO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SHENGENS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SHENGENS
(
   CODIGO,
   IDPAIS,
   PAIS,
   FECINICIO,
   FECFIN
)
AS
   SELECT M_SHENGEN.CODIGO,
          M_SHENGEN.IDPAIS,
          M_PAIS.NOMBRE,
          FECINICIO,
          FECFIN
     FROM M_SHENGEN INNER JOIN M_PAIS ON (M_SHENGEN.IDPAIS = M_PAIS.CODPAIS);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_SUBTIPOACTIV  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_SUBTIPOACTIV (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM SUBTIPO_ACTIVIDAD;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T0EMBDEPBASENOAP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T0EMBDEPBASENOAP
(
   CODIGO,
   ANYO,
   CODPUE,
   DESPUE,
   CODEMBARCACION,
   ESLORA,
   MANGA,
   TIPOPROPULSION,
   DESCTIPOPROPULSION,
   EMBARCACION,
   MATRICULA,
   FECPAGOINDEFT0,
   VALIDEZINDEFINIDAT0,
   JUSTIFEXENTOT0,
   CODUSUARIO,
   CIFUSUARIO,
   NOMBREUSUARIO,
   CODAPSCTUSUARIO,
   TIPOIGIC,
   DESCTIPOIGIC,
   INDLIQUIDADO,
   LIQUIDADO,
   INDEXENTOLIQ,
   EXENTOLIQ,
   JUSTIFEXENTOLIQ,
   INDREVANULACION,
   REVANULACION
)
AS
   SELECT EB.CODIGO,
          EB.ANYO,
          EB.CODPUE,
          P.NOMBRE,
          EB.CODEMBARCACION,
          E.ESLORA,
          E.MANGA,
          E.TIPOPROPULSION,
          TP.DESCRIPCION,
          E.NOMBRE,
          E.MATRICULA,
          E.FECPAGOINDEFT0,
          DECODE (E.FECPAGOINDEFT0, NULL, 'No', 'Si'),
          E.JUSTIFEXENTOT0,
          EB.CODUSUARIO,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          EB.TIPOIGIC,
          TI.DESCRIPCION,
          EB.INDLIQUIDADO,
          DECODE (EB.INDLIQUIDADO, '1', 'Si', 'No'),
          EB.INDEXENTOLIQ,
          DECODE (EB.INDEXENTOLIQ, '1', 'Si', 'No'),
          EB.JUSTIFEXENTOLIQ,
          EB.INDREVANULACION,
          DECODE (EB.INDREVANULACION, '1', 'Si', 'No')
     FROM T0_EMBDEPBASENOAP EB
          INNER JOIN M_PUERTO_LOCAL P
             ON EB.CODPUE = P.CODPUE
          INNER JOIN M_EMBARCACION E
             ON EB.CODEMBARCACION = E.CODIGO
          INNER JOIN TIPO_PROPULSION TP
             ON TP.CODIGO = E.TIPOPROPULSION
          INNER JOIN M_USUARIO U
             ON EB.CODUSUARIO = U.CODUSUARIO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON EB.TIPOIGIC = TI.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T2EXCURSIONISTAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T2EXCURSIONISTAS
(
   CODPUE,
   PUERTO,
   ANYO,
   CODSER,
   CODPUEESCTI,
   ANYOESCTI,
   CODESCTI,
   FECINICIO,
   FECFIN,
   NUMVIAJES,
   NUMEXCURSIONISTAS,
   NUMESCALA,
   BUQUE,
   IMO,
   INDLIQ,
   LIQUIDADO,
   IDUSUARIO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   INDEXENTOLIQ,
   EXENTOLIQ,
   INDNOAPLICREGSIMPLIF,
   NOAPLICREGSIMPLIF,
   INDZONASERVPUERTO,
   ZONASERVPUERTO,
   CODTIPOIVA,
   TIPOIVA,
   CODTIPOSERVICIO,
   TIPOSERVICIO,
   NUMPASAJLOCALE,
   NUMMOTOLOCALE,
   NUMAUTOMPLOCALE,
   NUMAUTOMGLOCALE,
   NUMAUTOCARLOCALE,
   NUMPASAJLOCALD,
   NUMMOTOLOCALD,
   NUMAUTOMPLOCALD,
   NUMAUTOMGLOCALD,
   NUMAUTOCARLOCALD,
   CODTIPCONCT2,
   TIPCONCT2,
   OBSERVACIONES
)
AS
   SELECT EX.CODPUE,
          P.NOMBRE,
          EX.ANYO,
          EX.CODSER,
          EX.CODPUEESCTI,
          EX.ANYOESCTI,
          EX.CODESCTI,
          EX.FECINICIO,
          EX.FECFIN,
          EX.NUMVIAJES,
          EX.NUMEXCURSIONISTAS,
          E.NUMESCALA,
          BU.NOMBRE,
          BU.CODIMO,
          EX.INDLIQ,
          DECODE (EX.INDLIQ, '1', 'Si', 'No'),
          EX.IDUSUARIO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          EX.INDEXENTOLIQ,
          DECODE (EX.INDEXENTOLIQ, '1', 'Si', 'No'),
          EX.INDNOAPLICREGSIMPLIF,
          DECODE (EX.INDNOAPLICREGSIMPLIF, '1', 'Si', 'No'),
          EX.INDZONASERVPUERTO,
          DECODE (EX.INDZONASERVPUERTO, '1', 'Si', 'No'),
          EX.CODTIPOIVA,
          TI.DESCRIPCION,
          EX.CODTIPOSERVICIO,
          TT2.DESCRIPCION,
          NUMPASAJLOCALE,
          NUMMOTOLOCALE,
          NUMAUTOMPLOCALE,
          NUMAUTOMGLOCALE,
          NUMAUTOCARLOCALE,
          NUMPASAJLOCALD,
          NUMMOTOLOCALD,
          NUMAUTOMPLOCALD,
          NUMAUTOMGLOCALD,
          NUMAUTOCARLOCALD,
          EX.CODTIPCONCT2,
          TC2.DESCRIPCION,
          EX.OBSERVACIONES
     FROM T2_EXCURSIONISTA EX
          LEFT JOIN ESCALA E
             ON (    EX.CODPUEESCTI = E.CODPUE
                 AND EX.ANYOESCTI = E.ANYO
                 AND EX.CODESCTI = E.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          INNER JOIN M_USUARIO U
             ON (EX.IDUSUARIO = U.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL P
             ON (EX.CODPUE = P.CODPUE)
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL TI
             ON (TI.CODIGO = EX.CODTIPOIVA)
          INNER JOIN TIPO_T2EXCURSIONISTA TT2
             ON (TT2.CODIGO = EX.CODTIPOSERVICIO)
          LEFT JOIN TIPO_CONCESIONB2 TC2
             ON TC2.CODIGO = EX.CODTIPCONCT2;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T3SUMINTRAFINT  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T3SUMINTRAFINT
(
   CODPUE,
   PUERTO,
   ANYO,
   CODSER,
   CODPUEESC,
   ANYOESC,
   CODESC,
   FECINICIO,
   FECFIN,
   NUMESCALA,
   BUQUE,
   IMO,
   INDLIQ,
   LIQUIDADO,
   IDUSUARIO,
   CODAPSCT,
   CIF,
   NOMBRECOMPLETO,
   CODMODSUMIN,
   SUMINCOMB,
   INDEXENTOLIQ,
   EXENTOLIQ,
   NUMKGTOTAL,
   FECATRAQUEREAL,
   FECDESATRAQUEREAL,
   CODESTADIA,
   CODESTADIADUE,
   CODZONA,
   ZONA,
   INDOPEESCALA,
   OPEESCALA,
   CODTIPOIVA,
   TIPOIVA
)
AS
   SELECT S.CODPUE,
          P.NOMBRE,
          S.ANYO,
          S.CODSER,
          S.CODPUEESC,
          S.ANYOESC,
          S.CODESC,
          S.FECINICIO,
          S.FECFIN,
          E.NUMESCALA,
          BU.NOMBRE,
          BU.CODIMO,
          S.INDLIQ,
          DECODE (S.INDLIQ, '1', 'Si', 'No'),
          S.IDUSUARIO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          U.NOMBRECOMPLETO,
          S.CODMODSUMIN,
          TC.DESCRIPCION,
          S.INDEXENTOLIQ,
          DECODE (S.INDEXENTOLIQ, '1', 'Si', 'No'),
          S.NUMKGTOTAL,
          ES.FECATRAQUEREAL,
          ES.FECDESATRAQUEREAL,
          S.CODESTADIA,
          ES.CODESTADIADUE,
          S.CODZONA,
          Z.DESCRIPCION,
          S.INDOPEESCALA,
          DECODE (S.INDOPEESCALA, '1', 'Si', 'No'),
          S.CODTIPOIVA,
          I.DESCRIPCION
     FROM T3_SUMINTRAFINT S
          LEFT JOIN M_USUARIO U
             ON (S.IDUSUARIO = U.CODUSUARIO)
          INNER JOIN M_PUERTO_LOCAL P
             ON (S.CODPUE = P.CODPUE)
          LEFT JOIN TIPO_MOD_SUMINCOMB TC
             ON (S.CODMODSUMIN = TC.CODIGO)
          LEFT JOIN ESCALA E
             ON (    S.CODPUEESC = E.CODPUE
                 AND S.ANYOESC = E.ANYO
                 AND S.CODESC = E.CODESCALA)
          LEFT JOIN M_BUQUE BU
             ON (BU.CODBUQUE = E.CODBUQUE)
          LEFT JOIN ESTADIA ES
             ON (    S.CODPUEESC = ES.CODPUE
                 AND S.ANYOESC = ES.ANYO
                 AND S.CODESC = ES.CODESCALA
                 AND S.CODESTADIA = ES.CODESTADIA)
          LEFT JOIN M_ZONA_AGUA Z
             ON (S.CODZONA = Z.CODIGO)
          LEFT JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON S.CODTIPOIVA = I.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T8SUMINBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T8SUMINBUQUE
(
   CODPUE,
   DESPUE,
   ANYO,
   CODIGO,
   FECINICIO,
   FECFIN,
   IDSUJPASIVO,
   SUJETOPASIVO,
   CODAPSCT,
   CIFSUJETOPASIVO,
   CODPUEESC,
   ANYOESC,
   CODESC,
   CODESTADIA,
   NUMESCALA,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC,
   CODTIPOIVA,
   TIPOIVA,
   CODPUECONT,
   NUMCONT,
   CONTADOR,
   DESCONTADOR,
   CODTOMA,
   TOMA,
   LECINICIAL,
   LECFINAL,
   CONSUMO,
   INDNOPOSIBLELEC,
   NOPOSIBLELEC,
   INDEXENTOLIQ,
   EXENTOLIQ,
   MOTEXENTOLIQ,
   INDLIQUIDADO,
   LIQUIDADO,
   INDNOAPLICMIN,
   NOAPLICMIN,
   INDRECARGO,
   RECARGO,
   PORCRECARGO,
   MOTRECARGO,
   INDAGUASALADA,
   AGUASALADA,
   INDFIJOPARASUMINBUQUE,
   FIJOPARASUMINBUQUE,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA,
   CODIMO,
   CODBUQUE,
   NOMBUQUE
)
AS
   SELECT D.CODPUE,
          PU.NOMBRE,
          D.ANYO,
          D.CODIGO,
          D.FECINICIO,
          D.FECFIN,
          D.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          D.CODPUEESC,
          D.ANYOESC,
          D.CODESC,
          D.CODESTADIA,
          E.NUMESCALA,
          D.CODTIPOSUMINISTRO,
          TS.DESCRIPCION,
          D.CODTIPOSUMINELEC,
          TE.DESCRIPCION,
          D.CODTIPOIVA,
          I.DESCRIPCION,
          D.CODPUECONT,
          D.NUMCONT,
          C.DESCRIPCION,
          C.DESCRIP,
          D.CODTOMA,
          TC.DESCRIPCION,
          D.LECINICIAL,
          D.LECFINAL,
          D.CONSUMO,
          D.INDNOPOSIBLELEC,
          DECODE (D.INDNOPOSIBLELEC, '1', 'Si', 'No'),
          D.INDEXENTOLIQ,
          DECODE (D.INDEXENTOLIQ, '1', 'Si', 'No'),
          D.MOTEXENTOLIQ,
          D.INDLIQUIDADO,
          DECODE (D.INDLIQUIDADO, '1', 'Si', 'No'),
          D.INDNOAPLICMIN,
          DECODE (D.INDNOAPLICMIN, '1', 'Si', 'No'),
          D.INDRECARGO,
          DECODE (D.INDRECARGO, '1', 'Si', 'No'),
          D.PORCRECARGO,
          D.MOTRECARGO,
          C.INDAGUASALADA,
          CASE
             WHEN C.CODTIPOSUMINISTRO = 'A' AND C.INDAGUASALADA = '1'
             THEN
                'Si'
             WHEN C.CODTIPOSUMINISTRO = 'A' AND C.INDAGUASALADA = '0'
             THEN
                'No'
             WHEN C.CODTIPOSUMINISTRO = 'E'
             THEN
                NULL
          END,
          C.INDFIJOPARASUMINBUQUE,
          CASE
             WHEN C.CODTIPOSUMINISTRO = 'A' AND C.INDFIJOPARASUMINBUQUE = '1'
             THEN
                'Si'
             WHEN C.CODTIPOSUMINISTRO = 'A' AND C.INDFIJOPARASUMINBUQUE = '0'
             THEN
                'No'
             WHEN C.CODTIPOSUMINISTRO = 'E'
             THEN
                NULL
          END,
          D.CODTIPOSUMINAGUA,
          TA.DESCRIPCION,
          B.CODIMO,
          E.CODBUQUE,
          B.NOMBRE
     FROM T8_SUMINBUQUE D
          INNER JOIN M_PUERTO_LOCAL PU
             ON D.CODPUE = PU.CODPUE
          LEFT JOIN M_CONTADOR C
             ON D.CODPUECONT = C.CODPUE AND D.NUMCONT = C.NUMCON
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON D.CODTIPOIVA = I.CODIGO
          INNER JOIN M_USUARIO U
             ON D.IDSUJPASIVO = U.CODUSUARIO
          LEFT JOIN ESCALA E
             ON     D.CODPUEESC = E.CODPUE
                AND D.ANYOESC = E.ANYO
                AND D.CODESC = E.CODESCALA
          INNER JOIN T8_TIPOSUMINISTRO TS
             ON D.CODTIPOSUMINISTRO = TS.CODIGO
          LEFT JOIN T8_TIPOSUMINELEC TE
             ON TE.CODIGO = D.CODTIPOSUMINELEC
          LEFT JOIN M_TOMACONTADOR TC
             ON TC.CODIGO = D.CODTOMA
          LEFT JOIN T8_TIPOSUMINAGUA TA
             ON TA.CODIGO = D.CODTIPOSUMINAGUA
          LEFT JOIN M_BUQUE B
             ON B.CODBUQUE = E.CODBUQUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T8SUMINGENERICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T8SUMINGENERICO
(
   CODPUE,
   DESPUE,
   ANYO,
   CODIGO,
   FECINICIO,
   FECFIN,
   IDSUJPASIVO,
   SUJETOPASIVO,
   CODAPSCT,
   CIFSUJETOPASIVO,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA,
   CODTIPOIVA,
   TIPOIVA,
   CODPUECONT,
   NUMCONT,
   CONTADOR,
   DESCONTADOR,
   CODTOMA,
   TOMA,
   LECINICIAL,
   LECFINAL,
   CONSUMO,
   INDNOPOSIBLELEC,
   NOPOSIBLELEC,
   INDEXENTOLIQ,
   EXENTOLIQ,
   MOTEXENTOLIQ,
   INDLIQUIDADO,
   LIQUIDADO,
   INDNOAPLICMIN,
   NOAPLICMIN,
   INDRECARGO,
   RECARGO,
   PORCRECARGO
)
AS
   SELECT D.CODPUE,
          PU.NOMBRE,
          D.ANYO,
          D.CODIGO,
          D.FECINICIO,
          D.FECFIN,
          D.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          D.CODTIPOSUMINISTRO,
          TS.DESCRIPCION,
          D.CODTIPOSUMINELEC,
          TE.DESCRIPCION,
          D.CODTIPOSUMINAGUA,
          TA.DESCRIPCION,
          D.CODTIPOIVA,
          I.DESCRIPCION,
          D.CODPUECONT,
          D.NUMCONT,
          C.DESCRIPCION,
          C.DESCRIP,
          D.CODTOMA,
          TC.DESCRIPCION,
          D.LECINICIAL,
          D.LECFINAL,
          D.CONSUMO,
          D.INDNOPOSIBLELEC,
          DECODE (D.INDNOPOSIBLELEC, '1', 'Si', 'No'),
          D.INDEXENTOLIQ,
          DECODE (D.INDEXENTOLIQ, '1', 'Si', 'No'),
          D.MOTEXENTOLIQ,
          D.INDLIQUIDADO,
          DECODE (D.INDLIQUIDADO, '1', 'Si', 'No'),
          D.INDNOAPLICMIN,
          DECODE (D.INDNOAPLICMIN, '1', 'Si', 'No'),
          D.INDRECARGO,
          DECODE (D.INDRECARGO, '1', 'Si', 'No'),
          D.PORCRECARGO
     FROM T8_SUMINGENERICO D
          INNER JOIN M_PUERTO_LOCAL PU
             ON D.CODPUE = PU.CODPUE
          LEFT JOIN M_CONTADOR C
             ON D.CODPUECONT = C.CODPUE AND D.NUMCONT = C.NUMCON
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON D.CODTIPOIVA = I.CODIGO
          INNER JOIN M_USUARIO U
             ON D.IDSUJPASIVO = U.CODUSUARIO
          INNER JOIN T8_TIPOSUMINISTRO TS
             ON D.CODTIPOSUMINISTRO = TS.CODIGO
          LEFT JOIN T8_TIPOSUMINELEC TE
             ON TE.CODIGO = D.CODTIPOSUMINELEC
          LEFT JOIN T8_TIPOSUMINAGUA TA
             ON TA.CODIGO = D.CODTIPOSUMINAGUA
          LEFT JOIN M_TOMACONTADOR TC
             ON TC.CODIGO = D.CODTOMA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_T8SUMININSTFIJA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_T8SUMININSTFIJA
(
   CODIGO,
   CODTIPOSUMIN,
   TIPOSUMIN,
   CODPUECONT,
   NUMCONT,
   CONTADOR,
   DESCONTADOR,
   CODPUEBP,
   CODBP,
   BIENPUBLICO,
   PORCUSOCONTADOR,
   CODTIPOCANONXUNTA,
   TIPOCANONXUNTA,
   FECCONEXION,
   FECDESCONEXION,
   CODTIPOIVA,
   TIPOIVA,
   CODPUE,
   DESPUE,
   CODTIPOSUMINELEC,
   TIPOSUMINELEC,
   IDSUJPASIVO,
   SUJPASIVO,
   CIFSUJPASIVO,
   CODAPSCTSUJPASIVO,
   CODTIPOSUMINAGUA,
   TIPOSUMINAGUA
)
AS
   SELECT S.CODIGO,
          S.CODTIPOSUMIN,
          TS.DESCRIPCION,
          S.CODPUECONT,
          S.NUMCONT,
          C.DESCRIPCION,
          C.DESCRIP,
          S.CODPUEBP,
          S.CODBP,
          B.DESCRIPCION,
          S.PORCUSOCONTADOR,
          S.CODTIPOCANONXUNTA,
          X.DESCRIPCION,
          S.FECCONEXION,
          S.FECDESCONEXION,
          S.CODTIPOIVA,
          I.DESCRIPCION,
          S.CODPUE,
          PU.NOMBRE,
          S.CODTIPOSUMINELEC,
          SE.DESCRIPCION,
          S.IDSUJPASIVO,
          U.NOMBRECOMPLETO,
          U.NUMDOC || U.LETRANIF,
          U.CODAPSCT,
          S.CODTIPOSUMINAGUA,
          SA.DESCRIPCION
     FROM T8_SUMININSTFIJA S
          INNER JOIN T8_TIPOSUMINISTRO TS
             ON S.CODTIPOSUMIN = TS.CODIGO
          INNER JOIN M_CONTADOR C
             ON S.CODPUECONT = C.CODPUE AND S.NUMCONT = C.NUMCON
          LEFT JOIN DP_BIENPUBLICO B
             ON S.CODPUEBP = B.CODPUE AND S.CODBP = B.CODIGO
          LEFT JOIN T8_TIPOCANONXUNTA X
             ON S.CODTIPOCANONXUNTA = X.CODIGO
          INNER JOIN LQ_TIPO_IMPUESTOGLOBAL I
             ON I.CODIGO = S.CODTIPOIVA
          LEFT JOIN T8_TIPOSUMINELEC SE
             ON SE.CODIGO = S.CODTIPOSUMINELEC
          LEFT JOIN T8_TIPOSUMINAGUA SA
             ON SA.CODIGO = S.CODTIPOSUMINAGUA
          INNER JOIN M_PUERTO_LOCAL PU
             ON PU.CODPUE = S.CODPUE
          LEFT JOIN M_USUARIO U
             ON U.CODUSUARIO = S.IDSUJPASIVO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TERMINALES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TERMINALES
(
   CODTERMINAL,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   IDUSUARIO,
   NOMBRECOMPLETO,
   CODAPSCT,
   CIF,
   OBSERVACIONES,
   CODTIPOCONCB3,
   TIPOCONCB3,
   CODTIPOCONCB2,
   TIPOCONCB2
)
AS
   SELECT TER.CODTERMINAL,
          TER.CODPUE,
          PU.NOMBRE,
          TER.DESCRIPCION,
          TER.IDUSUARIO,
          U.NOMBRECOMPLETO,
          U.CODAPSCT,
          U.NUMDOC || U.LETRANIF,
          TER.OBSERVACIONES,
          TER.CODTIPOCONCB3,
          TCB3.DESCRIPCION,
          TER.CODTIPOCONCB2,
          TCB2.DESCRIPCION
     FROM M_TERMINAL TER
          LEFT JOIN TIPO_CONCESIONB3 TCB3
             ON (TER.CODTIPOCONCB3 = TCB3.CODIGO)
          LEFT JOIN TIPO_CONCESIONB2 TCB2
             ON (TER.CODTIPOCONCB2 = TCB2.CODIGO)
          LEFT JOIN M_USUARIO U
             ON U.CODUSUARIO = TER.IDUSUARIO
          LEFT JOIN M_PUERTO_LOCAL PU
             ON PU.CODPUE = TER.CODPUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOBUQUE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOBUQUE
(
   CODTIPOBUQUE,
   DESCRIPCION,
   CODTIPOOPPE,
   DESTIPOOPPE,
   TIPTRAFICO,
   TIPOTRAFICO,
   GUERRA
)
AS
   SELECT TIPO_BUQUE.CODTIPOBUQUE,
          TIPO_BUQUE.DESCRIPCION,
          TIPO_BUQUEOPPE.CODIGO,
          TIPO_BUQUEOPPE.DESCRIPCION,
          TIPO_BUQUE.TIPTRAFICO,
          M_TIPO_TRAFICO.DESCRIPCION,
          DECODE (TIPO_BUQUE.INDGUERRA, '1', 'Si', 'No')
     FROM TIPO_BUQUE
          INNER JOIN TIPO_BUQUEOPPE
             ON (TIPO_BUQUE.CODTIPOOPPE = TIPO_BUQUEOPPE.CODIGO)
          LEFT JOIN M_TIPO_TRAFICO
             ON TIPO_BUQUE.TIPTRAFICO = M_TIPO_TRAFICO.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOBUQUEBONIF  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOBUQUEBONIF
(
   CODIGO,
   CODTIPOBUQUE,
   TIPOBUQUE,
   FECINICIO,
   FECFIN,
   IDBONIFICACION,
   CODBONIFICACION,
   BONIFICACION,
   PORCENTAJEBONIFICACION
)
AS
   SELECT E.CODIGO,
          E.CODTIPOBUQUE,
          B.DESCRIPCION,
          E.FECINICIO,
          E.FECFIN,
          E.IDBONIFICACION,
          BON.CODBONIFICACION,
          BON.DESCRIPCION,
          E.PORCBONIFICACION
     FROM TIPO_BUQUEBONIF E
          INNER JOIN TIPO_BUQUE B
             ON E.CODTIPOBUQUE = B.CODTIPOBUQUE
          INNER JOIN M_BONIFICACION BON
             ON E.IDBONIFICACION = BON.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOBUQUEEDI  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOBUQUEEDI
(
   CODIGO,
   DESCRIPCION,
   CODTIPOBUQUEAP,
   TIPOBUQUEAP
)
AS
   SELECT T.CODIGO,
          T.DESCRIPCION,
          T.CODTIPOBUQUEAP,
          AP.DESCRIPCION
     FROM    TIPO_BUQUE_EDI T
          LEFT JOIN
             TIPO_BUQUE AP
          ON AP.CODTIPOBUQUE = T.CODTIPOBUQUEAP;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOBUQUEOPPE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOBUQUEOPPE
(
   CODIGO,
   DESCRIPCION,
   INDMERCANTE,
   MERCANTE,
   INDRORO,
   RORO
)
AS
   SELECT TIPO_BUQUEOPPE.CODIGO,
          TIPO_BUQUEOPPE.DESCRIPCION,
          TIPO_BUQUEOPPE.INDMERCANTE,
          DECODE (TIPO_BUQUEOPPE.INDMERCANTE, '1', 'Si', 'No'),
          TIPO_BUQUEOPPE.INDRORO,
          DECODE (TIPO_BUQUEOPPE.INDRORO, '1', 'Si', 'No')
     FROM TIPO_BUQUEOPPE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOCALIBREAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOCALIBREAGUA (CODIGO)
AS
   SELECT CODIGO FROM TIPO_CALIBREAGUA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOELEMRODANTES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOELEMRODANTES (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM TIPO_ELEM_RODANTE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOELEMRODANTETABLET  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOELEMRODANTETABLET (CODIGO, DESCRIPCION)
AS
   SELECT T.CODIGO, T.DESCRIPCION
     FROM TIPO_ELEM_RODANTE_TABLET T;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOOPPORTUARIA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOOPPORTUARIA (CODTIPOPE, NOMBRE)
AS
   SELECT T.CODTIPOPE, T.NOMBRE
     FROM TIPO_OPERACION T
    WHERE (T.BAJA IS NULL OR T.BAJA = '0') AND T.INDDUE = '1';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOTAMEQUIP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOTAMEQUIP (CODIGO, DESCRIPCION)
AS
   SELECT CODIGO, DESCRIPCION FROM G3_TIPOTAMEQUIP;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOTRAFICO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOTRAFICO
(
   CODIGO,
   DESCRIPCION,
   CODTIPFORMAPRESENT,
   FORMAPRESENT,
   INDRORO,
   RORO
)
AS
   SELECT M_TIPO_TRAFICO.CODIGO,
          M_TIPO_TRAFICO.DESCRIPCION,
          M_TIPO_TRAFICO.CODTIPFORMAPRESENT,
          EST_FORMAPRESENT.DESCRIPCION,
          M_TIPO_TRAFICO.INDRORO,
          DECODE (M_TIPO_TRAFICO.INDRORO, '1', 'Si', 'No')
     FROM    M_TIPO_TRAFICO
          LEFT JOIN
             EST_FORMAPRESENT
          ON (M_TIPO_TRAFICO.CODTIPFORMAPRESENT = EST_FORMAPRESENT.CODIGO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPOUSUARIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPOUSUARIO (CODTIPUSUARIO, DESCRIPCION)
AS
   SELECT CODTIPUSUARIO, DESCRIPCION FROM TIPO_USUARIO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPO_ACTIV_ESTADIAS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPO_ACTIV_ESTADIAS
(
   CODIGO,
   DESCRIPCION,
   CODTIPOPREST,
   DESTIPOPREST
)
AS
   SELECT TIPO_ACTIV_ESTADIA.CODIGO,
          TIPO_ACTIV_ESTADIA.DESCRIPCION,
          TIPO_PRESTACIONBUQUE.CODIGO,
          TIPO_PRESTACIONBUQUE.DESCRIPCION
     FROM    TIPO_ACTIV_ESTADIA
          LEFT JOIN
             TIPO_PRESTACIONBUQUE
          ON (TIPO_ACTIV_ESTADIA.CODTIPOPREST = TIPO_PRESTACIONBUQUE.CODIGO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPO_CARGA_OPERACION  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPO_CARGA_OPERACION (CODTIPCARGA, NOMBRE)
AS
   SELECT TCO.CODTIPCARGA, TCO.NOMBRE
     FROM TIPO_CARGA_OPERACION TCO
    WHERE TCO.BAJA IS NULL OR TCO.BAJA = '0';


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TIPO_USUARIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TIPO_USUARIO (CODTIPUSUARIO, DESCRIPCION)
AS
   SELECT MR.CODTIPUSUARIO, MR.DESCRIPCION
     FROM TIPO_USUARIO MR;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TMCDS  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TMCDS
(
   CODIGO,
   IDPAIS,
   PAIS,
   FECINICIO,
   FECFIN
)
AS
   SELECT M_TMCD.CODIGO,
          M_TMCD.IDPAIS,
          M_PAIS.NOMBRE,
          M_TMCD.FECINICIO,
          M_TMCD.FECFIN
     FROM M_TMCD INNER JOIN M_PAIS ON (M_TMCD.IDPAIS = M_PAIS.CODPAIS);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TMPROCESOCARGA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TMPROCESOCARGA
(
   IDPROCESO,
   FECPROCESO,
   USRPROCESO,
   NOMFICHERO,
   RESULTADO,
   DESCRESULTADO
)
AS
   SELECT P.IDPROCESO,
          P.FECPROCESO,
          P.USRPROCESO,
          P.NOMFICHERO,
          P.RESULTADO,
          DECODE (P.RESULTADO,
                  '0', 'Sin errores',
                  '1', 'Con errores',
                  '2', 'Procesado anteriormente')
     FROM TM_PROCESOCARGA P;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TMPROCESOCARGAERROR  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TMPROCESOCARGAERROR
(
   IDPROCESO,
   IDERROR,
   FILAFICHERO,
   DESCERROR
)
AS
   SELECT E.IDPROCESO,
          E.IDERROR,
          E.FILAFICHERO,
          E.DESCERROR
     FROM TM_PROCESOCARGAERROR E;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TMSERVICIO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TMSERVICIO
(
   CODPUE,
   ANYO,
   CODIGO,
   FECINI,
   FECFIN,
   IDCLIENTE,
   CLIENTE,
   TARJETA,
   TARIFA,
   CODTIPOIVA,
   CONSUMO,
   IMPORTE,
   PUERTOIE,
   OBSERVACIONES,
   INDVIAFICHERO,
   NOMFICHERO,
   INDLIQUIDADO,
   TIPOTARIFA,
   INDDIFIMPORTECALC
)
AS
   SELECT S.CODPUE,
          S.ANYO,
          S.CODIGO,
          S.FECINI,
          S.FECFIN,
          S.CLIENTE,
          U.NOMBRECOMPLETO,
          S.TARJETA,
          S.TARIFA,
          S.CODTIPOIVA,
          S.CONSUMO,
          S.IMPORTE,
          S.PUERTOIE,
          S.OBSERVACIONES,
          S.INDVIAFICHERO,
          S.NOMFICHERO,
          S.INDLIQUIDADO,
          TT.DESCRIPCION,
          S.INDDIFIMPORTECALC
     FROM TM_SERVICIO S
          JOIN M_USUARIO U
             ON S.CLIENTE = U.CODUSUARIO
          JOIN TM_TIPOTARIFA TT
             ON S.TARIFA = TT.CODIGO;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TOMACONTADORES  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TOMACONTADORES
(
   CODIGO,
   CODPUE,
   DESPUE,
   DESCRIPCION,
   ZONA,
   DESZONA,
   RUTA,
   DESRUTA,
   CODMUELLE,
   MUELLE,
   CODTIPOSUMINISTRO,
   TIPOSUMINISTRO
)
AS
   SELECT T.CODIGO,
          T.CODPUE,
          P.NOMBRE,
          T.DESCRIPCION,
          T.ZONA,
          Z.DESCRIPCION,
          T.RUTA,
          R.DESCRIPCION,
          T.CODMUELLE,
          M.DESCRIPCION,
          T.CODTIPOSUMINISTRO,
          TS.DESCRIPCION
     FROM M_TOMACONTADOR T
          INNER JOIN M_PUERTO_LOCAL P
             ON (P.CODPUE = T.CODPUE)
          LEFT JOIN M_ZONACONTAGUA Z
             ON (Z.CODIGO = T.ZONA)
          LEFT JOIN M_RUTACONTADOR R
             ON (R.CODIGO = T.RUTA)
          LEFT JOIN M_MUELLE M
             ON (T.CODMUELLE = M.CODIGO)
          INNER JOIN T8_TIPOSUMINISTRO TS
             ON (TS.CODIGO = T.CODTIPOSUMINISTRO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TRAMTIPOCAMPO  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TRAMTIPOCAMPO
(
   CODIGO,
   ETIQUETA,
   TIPODATOS,
   DESTIPODATOS,
   OBSERVACIONES
)
AS
   SELECT T.CODIGO,
          T.ETIQUETA,
          T.TIPODATOS,
          CASE
             WHEN T.TIPODATOS = 'S' THEN 'Texto'
             WHEN T.TIPODATOS = 'D' THEN 'Fecha'
             WHEN T.TIPODATOS = 'N' THEN 'Nmero'
             WHEN T.TIPODATOS = 'C' THEN 'Si/No'
             ELSE NULL
          END,
          T.OBSERVACIONES
     FROM TRAM_TIPOCAMPO T;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_TRAMTIPOTRAMITE  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_TRAMTIPOTRAMITE (CODIGO, DESCRIPCION)
AS
   SELECT T.CODIGO, T.DESCRIPCION
     FROM TRAM_TIPOTRAMITE T;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_USUAPLI  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_USUAPLI
(
   USR,
   INDBAJA,
   BAJA,
   FECBAJA,
   NOMBRE,
   EMAIL,
   FECALTA,
   USRALTA,
   FECMODIF,
   USRMODIF,
   CODIDIOMA,
   NUMAGENTE
)
AS
   SELECT usr,
          indbaja,
          CASE
             WHEN indbaja = '0' THEN 'No'
             WHEN indbaja = '1' THEN 'Si'
             ELSE NULL
          END
             AS baja,
          fecbaja,
          nombre,
          email,
          fecalta,
          usralta,
          fecmodif,
          usrmodif,
          codidioma,
          numagente
     FROM gu_usuario_aplicacion;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_ZONACONTAGUA  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ZONACONTAGUA
(
   CODIGO,
   DESCRIPCION,
   CODPUE,
   DESPUE
)
AS
   SELECT Z.CODIGO,
          Z.DESCRIPCION,
          Z.CODPUE,
          P.NOMBRE
     FROM M_ZONACONTAGUA Z INNER JOIN M_PUERTO_LOCAL P ON Z.CODPUE = P.CODPUE;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- V_TC_ZONAOCUP  (View)
--

CREATE OR REPLACE FORCE VIEW V_TC_ZONAOCUP
(
   CODPUE,
   NOMPUE,
   CODZONA,
   CODTIPOZONA,
   TIPOZONA,
   DESCRIPCION,
   CODCENTROCOSTE,
   CENTROCOSTE
)
AS
   SELECT M_ZONAOCUP.CODPUE,
          M_PUERTO_LOCAL.NOMBRE AS NOMPUE,
          M_ZONAOCUP.CODZONA,
          M_ZONAOCUP.CODTIPOZONA,
          OCUPSUP_TIPOOPE.DESCRIPCION,
          M_ZONAOCUP.DESCRIPCION,
          M_ZONAOCUP.CODCENTROCOSTE,
          LQ_CENTROCOSTE.DESCRIPCION
     FROM M_ZONAOCUP
          LEFT JOIN M_PUERTO_LOCAL
             ON (M_PUERTO_LOCAL.CODPUE = M_ZONAOCUP.CODPUE)
          LEFT JOIN OCUPSUP_TIPOOPE
             ON (OCUPSUP_TIPOOPE.CODIGO = M_ZONAOCUP.CODTIPOZONA)
          LEFT JOIN LQ_CENTROCOSTE
             ON (LQ_CENTROCOSTE.CODIGO = M_ZONAOCUP.CODCENTROCOSTE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X1_ESCALAS  (View)
--

CREATE OR REPLACE FORCE VIEW X1_ESCALAS
(
   ANYOESCA,
   BUQU_CODIGOID_REALIZAR,
   CODIGOID,
   ESTAESCA,
   FECHFINA,
   FECHINIC,
   HORAFINA,
   HORAINIC,
   LINE_CODIGOID,
   SUBP_CODIGOID_REALIZAR
)
AS
   SELECT E.ANYO,
          FB.CODIMO,
          E.CODESCALA,
          DECODE (E.CODESTADO,  'AN', 'A',  'DE', 'D',  'X'),
          TO_CHAR (E.ETD, 'DD/MM/RRRR'),
          TO_CHAR (E.ETA, 'DD/MM/RRRR'),
          TO_CHAR (E.ETD, 'DD/MM/RRRR HH24:mi'),
          TO_CHAR (E.ETA, 'DD/MM/RRRR HH24:mi'),
          E.CODSERVMARIT,
          E.CODPUE
     FROM ESCALA E INNER JOIN M_BUQUE FB ON (FB.CODBUQUE = E.CODBUQUE);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X1_LINEAS  (View)
--

CREATE OR REPLACE FORCE VIEW X1_LINEAS (CODIGOID, DESCRIPC)
AS
   SELECT SM.CODSERVICIO, SM.NOMBRE
     FROM M_SERVICIOMARITIMO SM;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X2_ATRAQUES_FONDEO  (View)
--

CREATE OR REPLACE FORCE VIEW X2_ATRAQUES_FONDEO
(
   ESCA_ANYOESCA,
   ESCA_CODIGOID,
   MUEL_CODIGOID_REAL
)
AS
   SELECT E.ANYO, E.CODESCALA, LPAD (ES.CODMUELLEINIREAL, 4, 0)
     FROM    ESTADIA ES
          INNER JOIN
             ESCALA E
          ON (    ES.CODPUE = E.CODPUE
              AND ES.ANYO = E.ANYO
              AND ES.CODESCALA = E.CODESCALA);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X2_OPERACIONES  (View)
--

CREATE OR REPLACE FORCE VIEW X2_OPERACIONES
(
   ATRA_CODIGOID,
   ESCA_ANYOESCA,
   ESCA_CODIGOID,
   TNAT_CODIGOID,
   USUA_CODIGOID
)
AS
   SELECT ES.CODESTADIA,
          E.ANYO,
          E.CODESCALA,
          SUBSTR (O.CODTIPCARGA, 2),
          LPAD (U.CODAPSCT, 5, 0)
     FROM OPERACION O
          INNER JOIN ESTADIA ES
             ON (    ES.CODPUE = O.CODPUE
                 AND ES.ANYO = O.ANYO
                 AND ES.CODESCALA = O.CODESCALA
                 AND ES.CODESTADIA = O.CODESTADIA)
          INNER JOIN ESCALA E
             ON (    ES.CODPUE = E.CODPUE
                 AND ES.ANYO = E.ANYO
                 AND ES.CODESCALA = E.CODESCALA)
          INNER JOIN M_USUARIO U
             ON (U.CODUSUARIO = E.CODCONSIGNATARIO);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X3_CABECERAS_PARTIDAS  (View)
--

CREATE OR REPLACE FORCE VIEW X3_CABECERAS_PARTIDAS
(
   MANI_ANYOMANI,
   MANI_CODIGOID,
   MANI_SUBP_CODIGOID,
   USUA_CODIGOID_ESTIBADOR
)
AS
   SELECT C.ANYO,
          C.NUMDECLARACION,
          C.CODPUE,
          U.CODAPSCT
     FROM    G3_CABECERA C
          LEFT JOIN
             M_USUARIO U
          ON (U.CODUSUARIO = C.IDESTIBADOR);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- X3_MANIFIESTOS  (View)
--

CREATE OR REPLACE FORCE VIEW X3_MANIFIESTOS
(
   ANYOMANI,
   CODIGOID,
   ESCA_ANYOESCA,
   ESCA_CODIGOID,
   ESCA_SUBP_CODIGOID,
   SUBP_CODIGOID
)
AS
   SELECT C.ANYO,
          C.NUMDECLARACION,
          E.ANYO,
          E.NUMESCALA,
          E.CODPUE,
          C.CODPUE
     FROM    G3_CABECERA C
          LEFT JOIN
             ESCALA E
          ON (E.CODPUE = C.CODPUE AND E.NUMESCALA = C.NUMESCALA);


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XE_MERCANCIA_POR_NATURALEZA  (View)
--

CREATE OR REPLACE FORCE VIEW XE_MERCANCIA_POR_NATURALEZA (CODIGOID, DESCRIPC)
AS
   SELECT SGN.CODIGO, SGN.DESCRIPCION
     FROM EST_SUBGRUPO_NATURALEZA SGN;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_ALINEACION  (View)
--

CREATE OR REPLACE FORCE VIEW XG_ALINEACION (CODIGOID, DESCRIPC)
AS
   SELECT LPAD (MU.CODIGO, 4, 0), MU.DESCRIPCION
     FROM M_MUELLE MU;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_BUQUES  (View)
--

CREATE OR REPLACE FORCE VIEW XG_BUQUES
(
   CALABUQ1,
   CALABUQ2,
   CODIGOID,
   CODILLOY,
   DESCRIPC,
   ESLOBUQU,
   GT,
   MANGBUQU,
   PAIS_CODIGOID,
   PAIS_CODIGOID_ABANDERAR,
   TBUQ_CODIGOID,
   TRB1BUQU
)
AS
   SELECT BV.CALMAXIMO,
          BV.CALMAXIMO,
          BU.CODIMO,
          BV.CODLLOYDS,
          BU.NOMBRE,
          BV.ESLORATOTAL,
          BV.GT,
          BV.MANGA,
          BV.BANDERA,
          BV.BANDERA,
          BV.CODTIPOBUQUE,
          BV.TRB
     FROM    M_BUQUE BU
          LEFT JOIN
             M_BUQUEVERSION BV
          ON (BV.CODBUQUE = BU.CODBUQUE)
    WHERE BV.FECFINVIG IS NULL;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_PAISES  (View)
--

CREATE OR REPLACE FORCE VIEW XG_PAISES (CODIGOID, DESCRIPC)
AS
   SELECT PA.CODPAIS, PA.NOMBRE
     FROM M_PAIS PA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_PUERTOS  (View)
--

CREATE OR REPLACE FORCE VIEW XG_PUERTOS (CODIGOID, DESCRIPC, PAIS_CODIGOID)
AS
   SELECT PU.CODPUE, PU.NOMBRE, PU.CODPAIS
     FROM M_PUERTO PU;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_TARIFA  (View)
--

CREATE OR REPLACE FORCE VIEW XG_TARIFA
(
   CODIEXTE,
   CODISUBT,
   CODITARI,
   DESCRIPC
)
AS
   SELECT TA.EXTENSION,
          TA.IDSUBTARIFA,
          TA.IDTARIFA,
          TA.DESCRIPCION
     FROM LQ_TARIFA TA;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_TIPOS_BUQUES  (View)
--

CREATE OR REPLACE FORCE VIEW XG_TIPOS_BUQUES (CODIGOID, DESCRIPC)
AS
   SELECT TB.CODTIPOBUQUE, TB.DESCRIPCION
     FROM TIPO_BUQUE TB;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_USUARIOS  (View)
--

CREATE OR REPLACE FORCE VIEW XG_USUARIOS (ACTIVO, CODIGOID, NOMBUSUA)
AS
   SELECT 'S', LPAD (U.CODAPSCT, 5, 0), U.NOMBRECOMPLETO
     FROM M_USUARIO U;


/* Formatted on 03/06/2016 9:02:50 (QP5 v5.139.911.3011) */
--
-- XG_USUARIOS_TIPOS_USUARIOS  (View)
--

CREATE OR REPLACE FORCE VIEW XG_USUARIOS_TIPOS_USUARIOS
(
   TIUS_CODIGOID,
   USUA_CODIGOID
)
AS
   SELECT TU.CODTIPUSUARIO, LPAD (U.CODAPSCT, 5, 0)
     FROM    M_USUARIO_TIPOUSUARIO TU
          INNER JOIN
             M_USUARIO U
          ON (U.CODUSUARIO = TU.CODUSUARIO);


GRANT SELECT ON V_GEXP_ATRAQUE TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_BORRADOR TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_CLIENTE TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_CLIENTETIPOUSUARIO TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_ESCALA TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_OPERACION TO ROL_GEXPLOTACION_R;

GRANT SELECT ON V_GEXP_TRAMO TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X1_ESCALAS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X1_LINEAS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X2_ATRAQUES_FONDEO TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X2_OPERACIONES TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X3_CABECERAS_PARTIDAS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON X3_MANIFIESTOS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XE_MERCANCIA_POR_NATURALEZA TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_ALINEACION TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_BUQUES TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_PAISES TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_PUERTOS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_TARIFA TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_TIPOS_BUQUES TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_USUARIOS TO ROL_GEXPLOTACION_R;

GRANT SELECT ON XG_USUARIOS_TIPOS_USUARIOS TO ROL_GEXPLOTACION_R;
