<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="xeredi.integra.model.dao.facturacion.ValoracionCargoDAO">
    <insert id="insertGenerate" parameterType="ValoracionCriterioVO">
    <![CDATA[
        INSERT INTO tbl_valoracion_cargo_vlrg (vlrg_vlrc_pk, vlrg_crgo_pk)
            SELECT vlrc_pk, crgo_pk
            FROM tbl_valoracion_vlrc
                , tbl_cargo_crgo
            WHERE
                EXISTS (
        		    SELECT 1
		            FROM tbl_regla_rgla
		            WHERE
			            rgla_crgo_pk = crgo_pk
			            AND EXISTS (
			                SELECT 1
			                FROM tbl_valoracion_lin_vlrl
			                WHERE
				                vlrl_rgla_pk = rgla_pk
				                AND vlrl_vlrc_pk = vlrc_pk
                        )
                        AND vlrc_pk = #{id}
                )
    ]]>
    </insert>

    <delete id="delete" parameterType="ValoracionCriterioVO">
    <![CDATA[
        DELETE FROM tbl_valoracion_cargo_vlrg
    ]]>
        <where>
            <if test="id != null">
                AND vlrg_vlrc_pk = #{id}
            </if>
        </where>
    </delete>
</mapper>
