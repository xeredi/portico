<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="xeredi.integra.model.dao.facturacion.ValoracionDAO">
    <resultMap type="ValoracionVO" id="ResultMap">
        <id column="vlrc_pk" property="id" />

        <result column="vlrc_fref" property="fref" />
        <result column="vlrc_falta" property="falta" />
        <result column="vlrc_fliq" property="fliq" />
        <result column="vlrc_fini" property="fini" />
        <result column="vlrc_ffin" property="ffin" />
        <result column="vlrc_es_suj_pasivo" property="sujPasivo" />
        <result column="vlrc_cod_exen" property="codExencion" />

        <result column="vlrc_importe" property="importe" />
        <result column="vlrc_impuesto" property="impuesto" />

        <result column="vlrc_info1" property="info1" />
        <result column="vlrc_info2" property="info2" />
        <result column="vlrc_info3" property="info3" />
        <result column="vlrc_info4" property="info4" />
        <result column="vlrc_info5" property="info5" />
        <result column="vlrc_info6" property="info6" />

        <association property="srvc" resultMap="xeredi.integra.model.dao.servicio.ServicioDAO.ResultMap" />
        <association property="aspc" resultMap="xeredi.integra.model.dao.facturacion.AspectoDAO.ResultMap" />
        <association property="pagador" resultMap="xeredi.integra.model.dao.maestro.ParametroDAO.ResultMap"
            columnPrefix="pagador_" />
    </resultMap>

    <insert id="insert" parameterType="ValoracionVO">
    <![CDATA[
        INSERT INTO tbl_valoracion_vlrc (
            vlrc_pk, vlrc_srvc_pk, vlrc_aspc_pk, vlrc_pagador_pk
            , vlrc_fref, vlrc_fliq, vlrc_falta, vlrc_fini, vlrc_ffin
            , vlrc_es_suj_pasivo, vlrc_cod_exen
            , vlrc_info1, vlrc_info2, vlrc_info3, vlrc_info4, vlrc_info5, vlrc_info6
        )
        VALUES (
            #{id}, #{srvc.id}, #{aspc.id}, #{pagador.id}
            , #{fref}, #{fliq}, #{falta}, #{fini}, #{ffin}
            , #{sujPasivo, jdbcType=INTEGER, javaType=Boolean}, #{codExencion}
            , #{info1}, #{info2}, #{info3}, #{info4}, #{info5}, #{info6}
        )
    ]]>
    </insert>

    <delete id="delete" parameterType="ValoracionCriterioVO">
    <![CDATA[
        DELETE FROM tbl_valoracion_vlrc
    ]]>
        <where>
            <if test="id != null">
                AND vlrc_pk = #{id}
            </if>
        </where>
    </delete>

    <sql id="SelectPrefix">
    <![CDATA[
        SELECT *
        FROM vw_valoracion_vlrc
    ]]>
    </sql>

    <sql id="SelectWhere">
        <where>
            <if test="id != null">
                AND vlrc_pk = #{id}
            </if>
        </where>
    </sql>

    <select id="select" parameterType="Long" resultMap="ResultMap">
        <include refid="SelectPrefix"/>
        WHERE vlrc_pk = #{value}
    </select>

    <select id="selectList" parameterType="ValoracionCriterioVO" resultMap="ResultMap">
        <include refid="SelectPrefix"/>
        <include refid="SelectWhere"/>
    </select>

    <select id="count" parameterType="ValoracionCriterioVO" resultType="Integer">
        SELECT COUNT(1)
        FROM vw_valoracion_vlrc
        <include refid="SelectWhere"/>
    </select>
</mapper>
