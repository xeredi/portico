<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="xeredi.integra.model.configuracion.dao.ClaveDAO">
	<resultMap type="ClaveVO" id="ResultMap">
		<id column="cncl_pk" property="id" />
		<result column="cncl_clave" property="clave" />
		<result column="cncl_tipo_valor" property="tipoValor" />
		<result column="cncl_valor_defecto" property="valorDefecto" />
	</resultMap>

	<sql id="SelectPrefix">
    <![CDATA[
    SELECT
        cncl_pk, cncl_clave, cncl_tipo_valor, cncl_valor_defecto
    FROM tbl_configuracion_clave_cncl
    ]]>
	</sql>

	<sql id="SelectCountPrefix">
    <![CDATA[
    SELECT
        COUNT(1)
    FROM tbl_configuracion_clave_cncl
    ]]>
	</sql>

	<sql id="SelectWhere">
		<where>
			<if test="clave != null">
				AND cncl_clave LIKE #{clave}
			</if>
			<if test="valorDefecto != null">
				AND cncl_valor_defecto LIKE #{valorDefecto}
			</if>
			<if test="tipoValor != null">
				AND cncl_tipo_valor = #{tipoValor}
			</if>
		</where>
	</sql>

	<select id="selectAllMap" resultMap="ResultMap">
		<include refid="SelectPrefix" />
	</select>

	<select id="selectList" parameterType="ClaveCriterioVO" resultMap="ResultMap">
		<include refid="SelectPrefix" />
		<include refid="SelectWhere" />

		ORDER BY cncl_clave
	</select>

	<select id="select" parameterType="Long" resultMap="ResultMap">
		<include refid="SelectPrefix" />
		WHERE cncl_pk = #{value}
	</select>

	<select id="selectCount" parameterType="ClaveCriterioVO" resultType="Integer">
		<include refid="SelectCountPrefix" />
		<include refid="SelectWhere" />
	</select>

	<select id="exists" parameterType="ClaveVO" resultType="Boolean">
		<include refid="SelectCountPrefix" />
		WHERE cncl_clave = #{clave}
	</select>

	<insert id="insert" parameterType="ClaveVO">
        <selectKey keyProperty="id" resultType="Long" order="BEFORE">
            SELECT
            NEXTVAL('sq_integra')
        </selectKey>
        <![CDATA[
        INSERT INTO tbl_configuracion_clave_cncl(cncl_pk, cncl_clave, cncl_tipo_valor, cncl_valor_defecto)
        VALUES(#{id}, #{clave}, #{tipoValor}, #{valorDefecto})
        ]]>
	</insert>

	<update id="update" parameterType="ClaveVO">
        <![CDATA[
        UPDATE tbl_configuracion_clave_cncl SET
        	cncl_tipo_valor = #{tipoValor}
        	, cncl_valor_defecto = #{valorDefecto}
        WHERE cncl_pk = #{id}
        ]]>
	</update>
</mapper>
